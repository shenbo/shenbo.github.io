[{"title":"分析设计SAD(2)","url":"/2025/12/11/SAD/sad2/","content":"SAD试卷二一、单选题（共30道题，本题共15分。）\n根据JB4732的应力分类原则，平盖中心部分的应力属于(    )类应力。A.Pm  B.PL  C.Pb  D.Q答案：C  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：平盖在内压作用下以弯曲应力为主，属于一次弯曲应力（Pb）。JB4732 应力分类中，Pb 是一次应力的子类，用于评估塑性垮塌。\n\n\n在下列情况下，峰值应力危害性较大：(    )。A.设备受疲劳载荷作用  B.设备壳体上有开孔  C.设备上有裂纹存在答案：A  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：峰值应力本身不引起显著变形，但在交变载荷下会引发疲劳裂纹，故在疲劳工况下危害最大。\n\n\nJB4732分析设计标准适用的设计温度应是(    )钢材蠕变控制其许用应力强度所对应的温度。A.高于  B.等于  C.低于答案：C  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：JB4732 适用于以塑性&#x2F;疲劳失效为主的中低温工况，不适用于蠕变控制设计（高温）。\n\n\nJB4732标准采用(    )作为失效理论。A.最大剪应力理论；  B.最大正应力理论；  C.最大线应变理论；  D.形状改变比能理论答案：A  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：即第三强度理论，应力强度 $S &#x3D; \\sigma_1 - \\sigma_3 &#x3D; 2\\tau_{\\max}$。\n\n\n若结构处于安定状态，则：(    )。A.不会发生疲劳破坏  B.不会出现新的塑性变形  C.不会产生二次应力答案：B  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：安定（Shakedown）指结构在初始循环后仅发生弹性响应，无新增塑性变形。\n\n\n\n\n\n\n形函数是(    )插值函数。A.应力  B.位移  C.应变答案：B  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：有限元中，形函数用于在单元内部插值节点位移，形成连续位移场。\n\n\n局部薄膜加一次弯曲应力强度的许用极限为(    )。A.KSm  B.1.5KSm  C.3Sm  D.Sa答案：B  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：PL + Pb 的应力强度限值为 1.5KSm，K 为载荷组合系数。\n\n\nJB4732标准中，对于螺栓连接的平盖厚度计算公式，平盖材料的许用应力取(    )。A.GB&#x2F;T150中相关材料的许用应力；  B.相关材料的设计应力强度；答案：B  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：JB4732 使用 设计应力强度 Sm（而非 GB&#x2F;T150 的[σ]）。Sm &#x3D; min{Rm&#x2F;nb, ReL&#x2F;ns}。\n\n\nJB4732中规定，冷成形的受压元件，碳素钢、16MnR的圆筒名义厚度不小于圆筒内直径的(    )时应于成形后进行热处理。A.1%  B.2%  C.3%  D.4%答案：C  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：冷成形变形量超过 δ&#x2F;D ≥ 3% 时，需进行恢复性热处理以消除加工硬化。\n\n\nU形管换热器数值分析时，下列描述正确的是((    )。A.计算时，应考虑U形管管束对管板的轴向弹性支撑作用；  B.a型连接的管板建模只考虑垫片支撑圆DG以内金属即可；C.e，f型连接的管板的数值分析，管板上的分程隔板沟槽可以忽略；D.e，f型连接的管板的数值分析，需要考虑螺栓预紧力。答案：D  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：e、f 型管板为法兰连接型，其密封与应力状态高度依赖螺栓预紧力，必须建模考虑。\n\n\n如果仅考虑压力载荷，下面哪些容器可以免除疲劳分析(    )。A.设计压力为1.2MPa，压力波值为0.5MPa的容器  B.全幅压力循环次数为600次，个别部件存在非整体连接件C.全幅压力循环次数为600次，设计压力为1.2MPa，压力波值为0.2MPa的容器D.全幅压力循环次数为600次，材料的设计应力强度大于230MPa的容器答案：C  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：JB4732 疲劳免除条款之一：压力波动 ≤ 20% 设计压力的循环可不计入，本题 0.2&#x2F;1.2 ≈ 16.7% &lt; 20%，且总循环 600 &lt; 1000，可免除。\n\n\n按JB4732的标准要求，下列哪些说法是正确的?(    )A.按要求需进行疲劳分析设计的容器，其A、B类焊接接头之焊缝应与母材圆滑过渡B.按要求需进行疲劳分析设计的容器，如果没有考虑焊接接头的疲劳强度减弱系数，其A、B类焊接接头表面应与母材表面齐平，不允许保留余高C.如容器按疲劳分析设计，打焊工钢印的部位应远离焊接接头D.碳素钢与低合金制低温容器如不做焊后热处理，那么不允许打焊工钢印答案：B  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：疲劳设计中，若未考虑焊接接头疲劳强度减弱系数，则 A、B 类焊缝必须与母材齐平，不允许余高（避免应力集中）。\n\n\n对一按应力分类法进行疲劳分析的结构，可选择(    )进行有限元应力分析。A.线弹性壳单元  B.弹塑性壳单元  C.线弹性六面体单元  D.弹塑性六面体单元答案：C  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：应力分类法基于线弹性分析，实体结构应采用线弹性六面体单元（如 SOLID185&#x2F;186），以进行后续应力线性化。\n\n\n需进行简化弹塑性分析的容器，其材料的屈强比应小于(    )。A.0.6  B.0.7  C.0.8  D.0.9答案：C  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：JB4732 规定：屈强比 ReL&#x2F;Rm &lt; 0.8 的材料才适合简化弹塑性分析（如极限载荷估算）。\n\n\n厚壁圆筒形容器径向温度分布不一致产生的温差应力(    )。A.具有一次总体薄膜应力和一次弯曲应力成分  B.具有一次局部薄膜应力和二次应力成分C.具有二次应力和一次弯曲应力成分  D.具有峰值应力和二次应力成分答案：D  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：温差引起的热应力中，整体协调部分为二次应力，局部突变处（如壁厚变化）为峰值应力。\n\n\n固定管板换热器数值计算分析时，下列描述正确的是(    )。A.数值分析时，换热管一般采用梁单元；  B.建模时，壳程建模厚度应按工况预判来确定按有效厚度还是名义厚度；C.建模时，壳程厚度用壳体有效厚度可得到保守结果；D.数值计算模型加载时，可不区分计算工况，用载荷最大值代替。答案：B  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：壳程建模厚度需根据是否考虑腐蚀裕量等工况预判，以准确反映结构刚度。\n\n\n设计压力0.6MPa、介质为液化石油气的Ⅱ类压力容器，关于管口法兰选型的描述哪个正确?(    )A.可按HG&#x2F;T20615选用WN法兰  B.可按HG&#x2F;T20592选用SO法兰C.可按SH3406选用SO法兰  D.可按GB&#x2F;T9124选用WN法兰答案：A  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：HG&#x2F;T20615 为Class 系列（美标体系），适用于较高要求场合；WN（带颈对焊）法兰强度高，适合液化石油气（易燃介质）。其他标准（如 HG&#x2F;T20592 的 SO 法兰）不适用于Ⅱ类容器关键部位。虽未标注标准，但符合工程实践及 HG&#x2F;T20615 适用范围。\n\n\n在有限元计算中，往往会采用高斯数值积分。其基本步骤是：在单元内选取某些点作为积分点，把这些点的坐标值代入，算出被积函数值，再乘以(    )，然后求其总和，就得到近似的积分值。A.单元面积  B.单元体积  C.积分区间  D.加权系数答案：D  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：高斯积分公式为 $\\int f(x)dx \\approx \\sum w_i f(x_i)$，其中 $w_i$ 为加权系数。\n\n\n四边受均布拉力q的无限大薄平板中有一小孔，按弹性理论可求得孔边沿板厚为常量的最大切向应力为2q，按应力分类方法，该应力应划为(    )。A.一次总体薄膜应力  B.一次局部薄膜应力  C.二次应力  D.一次应力+峰值应力答案：B  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：孔边应力由压力（机械载荷）引起，影响范围局部，属一次局部薄膜应力（PL）。\n\n\n为避免碳钢和低合金钢材料的石墨化倾向，通常在材料成分中添加一定量的(    )。A.Mn元素  B.Cr元素  C.Mo元素答案：B  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：Cr 与 C 形成稳定碳化物（如 Cr₂₃C₆），抑制石墨化（C 析出为游离石墨）。\n\n\n\n二、多选题（共25道题，本题共25分。）\n导致压力容器疲劳破坏的主要条件有哪些?A.包括峰值应力的总应力  B.足够的应力或应变循环  C.足够大的一次应力  D.足够大的二次应力答案：AB  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：疲劳破坏需同时满足两个条件：① 存在峰值应力（作为疲劳裂纹萌生驱动力）； ② 足够多的循环次数。一次&#x2F;二次应力幅值本身不足以直接导致疲劳，除非产生峰值成分。\n\n\n根据JB4732的应力分类原则，受内压的带平盖的薄壁长圆筒中间部分的环向应力属于(    )类应力；平盖中心部分的应力属于(    )类应力；筒体和平盖连接处的弯曲力属于(    )类应力。A.Pm  B.PL  C.Pb  D.Q答案：ACD  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：- 圆筒中部环向应力为一次总体薄膜应力（Pm）; 平盖中心在内压下主要受弯曲，属一次弯曲应力（Pb）；连接处因几何不连续产生变形协调应力，属二次应力（Q）。\n\n\nGB&#x2F;T150不适用于(    )。A.疲劳分析  B.热应力分析  C.设计压力-1.3MPa的钢制容器  D.设计压力为-0.015的铜制容器答案：ABD  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：GB&#x2F;T150 是常规设计标准，明确不适用于：① 疲劳（A）；② 热应力&#x2F;二次应力分析（B）；③ 非钢制容器（D）。 C项（-1.3MPa钢制）属于外压容器，GB&#x2F;T150 适用。\n\n\n等效线性化处理只能区分以下哪些应力(    )。A.薄膜应力  B.弯曲应力  C.非线性应力  D.二次应力  E.一次应力答案：ABC  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：应力线性化将沿壁厚的应力分布分解为：① 薄膜分量（均匀）；② 弯曲分量（线性）；③ 非线性剩余部分（对应峰值应力）。 不能直接区分一次&#x2F;二次性质（D&#x2F;E），需结合载荷物理意义判断。\n\n\n下列哪些因素要在结构分析前确定?(    )A.边界条件  B.材料性能参数  C.计算方法  D.应力分类答案：AB  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：有限元建模前必须确定：几何、材料、边界条件、载荷。 “计算方法”和“应力分类”是后续步骤。\n\n\nJB4732分析设计标准适用于设计压力大于或等于(    )且小于(    )、真空度高于或等于(    )的容器。A.0.1MPa  B.1MPa  C.100MPa  D.0.02MPa答案：ACD  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n塑性力学的特点(    )。A.材料的应力-应变关系非线性；  B.结果与加载历史有关；  C.结果与加载历史无关；D.压力容器考虑弹塑性分析时，利用叠加原理对载荷工况进行组合。答案：AB  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：塑性力学核心特点：①非线性本构；② 路径依赖（加载历史影响当前状态）。叠加原理不适用（D错误）。\n\n\n边缘应力具有：(    )性和(    )性。A.局部  B.自限  C.扩展  D.无限  E.分散  F.递增答案：AB  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：边缘应力（如筒体-封头连接处）：① 局部性：随远离边缘迅速衰减；② 自限性：局部屈服后应力不再增长。\n\n\n在有限元中，作用在弹性体上的外力，需要移置到相应的结点上成为结点载荷，载荷移置基于以下原则：(    )。A.虚功相等原则  B.位移相等原则  C.应力相等原则  D.圣维南原理答案：AD  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：虚功等效是载荷移置的数学基础；圣维南原理说明等效载荷在远离作用区时应力场近似。\n\n\n下面对二次应力描述正确的选项是(    )。A.二次应力主要是结构变形协调引起的；  B.局部应力一定是二次应力；C.峰值应力属于二次应力；  D.二次应力有自限性。答案：AD  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：二次应力源于变形协调（如热膨胀受约束）；具有自限性（局部屈服后停止增长）； 局部应力不一定是二次应力（B错）； 峰值应力不属于二次应力（C错）。  \n\n\n一次应力的强度条件对应的是(    )；一次加二次应力的强度条件对应的是(    )；一次加二次加峰值应力的强度条件对应的是(    )。A.一次加载下结构的塑性强度失效  B.一次加载下结构的脆性开裂失效C.多次加载下结构的塑性强度失效  D.交变载荷作用下结构的脆性开裂失效答案：ACD  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：（A） Pm → 防止塑性垮塌； （C） P + Q → 防止失去安定； （D） P + Q + F → 防止疲劳&#x2F;脆断。\n\n\n影响压力容器疲劳强度的主要条件有哪些?(    )A.峰值应力  B.足够的应力或应变循环  C.足够大的一次应力  D.足够大的二次应力答案：AB  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析： 峰值应力幅 + 循环次数是疲劳寿命的决定因素。\n\n\n法兰连接接头优化设计的主要准则包括(    )。A.垫片载荷尽量小准则  B.垫片载荷尽量大准则  C.法兰力矩最小载荷准则  D.满应力准则答案：ACD  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：  法兰优化目标： ①降低垫片载荷（A）； ②减小法兰力矩（C）； ③材料充分利用（满应力，D）。“垫片载荷尽量大”（B）会增加法兰负荷，不利设计。\n\n\nJB4732标准中的疲劳分析，其交变应力强度幅是基于(    )值确定的。A.弹性名义应力；  B.虚拟应力；  C.平均应力；答案：AB  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析： JB4732 疲劳分析基于线弹性分析结果（弹性名义应力），通过虚拟应力幅（即应力范围的一半）查 S-N 曲线。  \n\n\n关于薄圆平板的应力特点，下列表述正确的是(    )。A.板内为二向应力，切应力可予以忽略  B.正应力沿板厚分布均匀C.应力沿半径分布与周边支承方式有关  D.最大弯曲应力与(R&#x2F;t)的平方成正比答案：ACD  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析： 平盖受内压时：①主要为二向应力状态（A）；②无均匀薄膜应力（B错）；③支承方式（简支&#x2F;固支）影响应力分布（C）；④弯曲应力 ∝ (R&#x2F;t)²（D）。\n\n\n如采用弹塑性分析求塑性极限载荷，应采用哪些条件?A.结构材料的实际应力应变关系(包括考虑材料应变硬化)  B.结构的几何非线性C.应力应变关系按理想弹塑性关系  D.应力应变关系按理想塑性关系答案：AB  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析： 弹塑性分析需考虑： ①真实材料本构（非理想弹塑性）； ②大变形&#x2F;几何非线性（若存在）。 \n\n\n不宜采用应力分类法设计的是(    )。A.外压薄壁容器  B.玻璃制容器  C.材料标准抗拉强度下限值大于540MPa的低合金钢制低温球罐  D.管板答案：AB  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析： 应力分类法适用于钢制、中厚壁、静载&#x2F;疲劳容器； 外压容器以稳定性为主，应力分类不适用（A）；玻璃为脆性材料，不满足延性假设（B）。\n\n\n分析设计如采用对容器直接进行塑性分析的方法，需要满足哪些要求?(    )A.给定载荷不得超过结构塑性极限载荷的2&#x2F;3；  B.应考虑塑性应变集中对结构的疲劳破坏、棘轮破坏的影响；C.应校核结构的稳定性；  D.三个主应力的代数和不得超过4KSm答案：ABC  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析： 弹塑性分析作为替代方法，需满足： ①载荷限值（A）；②考虑局部效应（B）； ③稳定性校核（C）。三个主应力和 ≤ 4KSm（D）是应力分类法要求。\n\n\n压力容器疲劳设计曲线已经进行了平均应力修正，目的是(    )。A.为了使用对称应力循环的S-N曲线  B.为了考虑最大应力对疲劳寿命的影响C.为了考虑最小应力对疲劳寿命的影响  D.为了考虑平均应力对疲劳寿命的影响答案：AD  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析： 平均应力会显著影响疲劳寿命（拉应力降低寿命）， 修正后可统一使用对称循环S-N曲线。\n\n\n塑性力学的基本假设有哪些?(    )A.均质性  B.连续性  C.各向同性  D.完全弹性  E.小变形答案：ABCE  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：塑性力学通常假设： ①材料均质、连续、各向同性； ②小变形（几何线性）；不假设完全弹性（D错）。\n\n\n\n三、判断题（共43道题，本题共21.5分。）\nGB&#x2F;T4732.1-2024标准中，设计压力可以低于工作压力。答案：错误  （难度：容易｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第3章3.1.3｜试题用途： ）  \n\n解析：根据GB&#x2F;T4732.1-2024 第3章 3.1.3，设计压力不得低于容器在正常工作情况下可能达到的最高工作压力。\n\n\nGB&#x2F;T4732.1-2024适用于设计压力大于或等于0.1MPa且小于100MPa的容器。答案：正确  （难度：容易｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第1章1.2a)｜试题用途： ）\n\n真空度0.025MPa的容器可不按本标准设计。答案：错误  （难度：容易｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第1章1.2b｜试题用途： ）  \n\n解析：GB&#x2F;T4732.1-2024 第1章 1.2b 规定：真空度 ≥ 0.02 MPa的容器适用本标准。\n\n\n根据产生的原因和分布范围不同，弯曲应力可能是一次应力，也可能是二次应力。答案：正确  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：弯曲应力的性质取决于其产生原因。例如：平盖中心因内压产生的弯曲应力为一次弯曲应力（Pb）；法兰-筒体连接处因变形协调产生的弯曲应力为二次应力（Q）。  \n\n\n峰值应力具有自限性。答案：正确  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：峰值应力（F）无自限性；二次应力（Q）具有自限性。峰值应力可直接引发疲劳裂纹，不会因局部屈服而停止增长。\n\n\n低循环是指总的疲劳寿命一般在10²~10⁵次数之间，但它和人们常说的低频率不是一回事。答案：错误  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：题干前半句正确（低周疲劳范围约为 10²–10⁵ 次），但“低循环”与“低频率”无直接关系。然而，标准中并未定义“低循环”与“频率”的关系，且“低频率”通常指载荷变化速率，而非循环次数。  \n\n\n单元内各点处的应变一般也包含着坐标无关的常应变和与坐标有关的变应变两部分。答案：正确  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：在有限元中，单元应变场通常由常应变部分（对应薄膜）和线性&#x2F;非线性应变部分（对应弯曲&#x2F;峰值）组成。\n\n\n用于疲劳分析的角焊缝疲劳强度减弱系数取4.0。答案：正确  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：JB4732规定：角焊缝、螺纹等疲劳强度减弱系数 Kf ≥ 4.0。这是疲劳分析的基本要求。\n\n\nJB&#x2F;T4732-1995(2005确认)中压力容器分析设计方法中的应力分类法不适用于厚壁圆筒。答案：错误  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：JB4732的应力分类法适用于厚壁圆筒，只要满足小变形、材料均匀等前提。厚壁圆筒可通过弹性理论或有限元分析后进行应力分类。\n\n\n当容器壁厚较薄时可采用壳单元进行有限元分析，计算得到的最大应力即为峰值应力。答案：错误  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：壳单元无法反映沿厚度的非线性应力分布，因此不能直接用于峰值应力计算。峰值应力需通过实体单元+应力线性化获得。\n\n\n应力分析还需考虑结构的稳定性失效。答案：正确  （难度：容易｜试题级别：SAD｜出自标准：JB4732，｜试题用途： ）  \n\n解析：JB4732明确指出，分析设计需考虑稳定性（如外压失稳），尤其对薄壁壳体、换热器管板等结构。\n\n\n多层包扎容器层板纵向接头、凸缘与壳体对接连接的接头均属于A类接头。答案：错误  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：根据JB4732和TSG21，A类接头指筒体纵缝、球壳拼接缝、接管对接缝等主承压焊缝。多层包扎容器层板纵缝通常为C类接头，凸缘与壳体连接多为D类。故本题错误。\n\n\n塑性失效准则认为容器厚度截面整体屈服时，才算失效。答案：正确  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：塑性失效准则（如极限载荷法）认为，当结构形成塑性铰或整体屈服机构时，发生失效。\n\n\n设计文件中可以不注明最高允许工作压力(MAWP)。答案：正确  （难度：一般｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第3章3.1.6注｜试题用途： ）  \n\n解析：GB&#x2F;T4732.1-2024 3.1.6 注：非强制要求标注MAWP，仅在用户有要求或用于超压泄放装置整定时才需注明。\n\n\n移动式分析设计容器的类别划分与GB&#x2F;T150容器相同。答案：错误  （难度：一般｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第5章5.1.5｜试题用途： ）  \n\n解析：GB&#x2F;T4732.1-2024 5.1.5 ：移动式容器的类别划分不适用 GB&#x2F;T150 方法，需按TSG21 或专项标准执行。\n\n\n局部热应力属于二次应力范畴。答案：错误  （难度：一般｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第3章3.1.32｜试题用途： ）  \n\n解析：GB&#x2F;T4732.1-2024 3.1.32：局部热应力（如焊缝热影响区、复合板温差）通常属于峰值应力，因其由局部不连续引起。总体热应力才属于二次应力。\n\n\n按JB4732标准，圆柱壳与锥壳小端连接处，应该按照1.5KSm准则控制设计厚度。答案：错误  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：锥壳小端连接处属局部应力区，其评定应基于 PL -&gt; SⅡ ≤ 1.1KSm。\n\n\n有限元基本思想是将求解区域离散为一组有限个大小相同、且按一定方式相互连接在一起的单元的组合体。答案：错误  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：有限元单元 不要求大小相同，可根据应力梯度进行 非均匀网格划分（如局部加密）。故“大小相同”说法错误。\n\n\n进行线性化处理时，线性化路径必须要通过最大应力点。答案：错误  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：线性化路径应垂直于壁厚方向，且覆盖高应力区，但不要求必须通过最大应力点。路径选择以反映真实应力分布为准。\n\n\n疲劳免除条款的成立还基于所用的材料皆为韧性良好的钢材为前提。答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：JB4732疲劳免除条款隐含前提：材料具有良好韧性（如满足冲击功要求），脆性材料即使循环次数少也不能免除。\n\n\n法兰的螺栓圆中心直径变大，其他不变，则法兰厚度减小。(    )答案：错误  （难度：一般｜试题级别：SAD｜出自标准：GB&#x2F;T150｜试题用途： ）  \n\n解析：根据GB&#x2F;T150 法兰计算，螺栓圆直径Db 增大 会导致法兰力臂增大，弯矩增大，通常需要增加法兰厚度以满足强度。\n\n\n若采用壳单元进行有限元分析，就无法得到峰值应力。答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：壳单元假设应力沿厚度线性分布，无法反映非线性峰值成分。峰值应力必须通过实体单元+应力线性化获得。\n\n\n复合板由温差引起的薄膜应力是峰值应力。答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：复合板因基层与覆层热膨胀系数不同，在温差下产生自平衡、局部、非线性应力，属于峰值应力。\n\n\n设备在弹性状态下加卸载，不消耗能量，但会发生疲劳失效。答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：理想弹性体加卸载无能量耗散，但实际材料存在微观滑移、位错运动，导致损伤累积，可在完全弹性范围内发生疲劳失效。\n\n\nM36螺栓的许用应力取值与材料热处理状态无关。答案：错误  （难度：困难｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第5章5.4.1表2｜试题用途： ）  \n\n解析：GB&#x2F;T4732.1-2024 5.4.1 表2明确：螺栓许用应力与材料热处理状态（如调质、淬火+回火）密切相关。\n\n\n复合钢板覆层的热膨胀系数与基层不同时，必须考虑热应力。答案：正确  （难度：困难｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第3章3.1.32｜试题用途： ）  \n\n解析：GB&#x2F;T4732.1-2024 3.1.32要求：当覆层与基层热膨胀系数差异显著时，必须考虑热应力，其常为峰值应力来源。\n\n\n高周疲劳与低周疲劳的区别主要在于塑性变形的大小不同。答案：正确  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：高周疲劳（&gt;10⁴–10⁵ 次）以弹性变形为主；低周疲劳以显著塑性变形为特征。\n\n\n由于我国绝大多数地区只考虑设计近震且远震影响有限，故远震的破坏性没有近震强。答案：错误  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：远震对柔性结构（如高塔、长悬臂）可能造成更严重破坏（因长周期成分共振），不能一概认为破坏性小。\n\n\n分析设计标准提供了以弹性应力分析和塑性失效准则、弹塑性失效准则为基础的设计方法。答案：正确  （难度：困难｜试题级别：SAD｜出自标准：JB4732，｜试题用途： ）  \n\n解析：JB4732包含两种路径：应力分类法（基于弹性分析 + 塑性&#x2F;弹塑性失效准则）；直接塑性分析法（弹塑性分析 + 极限&#x2F;安定载荷）。  \n\n\n疲劳容器可按GB&#x2F;T150进行设计，同时需按JB4732附录C补充疲劳分析和评定。答案：正确  （难度：困难｜试题级别：SAD｜出自标准：JB4732， GB150｜试题用途： ）  \n\n解析：JB4732 与 GB&#x2F;T150 允许组合使用：主体按 GB&#x2F;T150 设计，疲劳部分按 JB4732 附录C 评定。这是工程常见做法。\n\n\n当长颈对焊法兰直边段厚度大于与其对接的圆筒段厚度时，可按JB4732或GB150中关于不同厚度筒体对接时将厚度较大圆筒削薄的有关规定削薄法兰直边段至与圆筒等厚后再焊接。答案：错误  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：法兰直边段为高应力区，不应削薄。规范通常要求筒体削薄过渡，而非削弱法兰强度。\n\n\n弹性应力分析得到的”弹性名义应力”，都是”虚拟应力”，不是结构中的真实应力。答案：错误  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：弹性名义应力是线弹性假设计算结果，在应力未超屈服时即为真实应力；超屈服后为虚拟应力，用于应力分类评定。\n\n\n\n四、简答题（共6道题，本题共18分。）\n根据各应力对应的载荷进行选择(3分)(1) 一次应力以什么压力计算?A.设计压力  B.操作压力  C.试验压力  D.最高允许工作压力答案：A  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(2) 二次应力以什么压力计算?A.设计压力  B.操作压力  C.试验压力  D.最高允许工作压力答案：B  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(3) 峰值应力以什么压力计算?A.设计压力  B.操作压力  C.循环载荷  D.最高允许工作压力答案：C  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n\n解析1：一次应力用于平衡外载，需按最严苛工况即设计压力计算。解析2：二次应力源于变形协调（如热膨胀），通常按实际运行工况即操作压力、温度计算。解析3：峰值应力用于疲劳分析，应基于交变载荷的应力范围，即循环载荷差值计算。\n\n\n根据一次应力的概念进行选择(3分)(1) 一次薄膜加一次弯曲应力强度的控制值?A.Sm  B.KSm  C.1.5KSm  D.2.2KSm  E.3Sm答案：C  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(2) 极限载荷法可以代替下列哪些应力强度限制条件?A.SI  B.SII  C.SIII  D.SIV  E.SV答案：ABC  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(3) 下列有关一次应力的说法哪些是正确的?A.一次应力是为平衡压力或其他机械载荷所必须的正应力或剪应力。B.一次应力是指可用静力平衡条件确定的应力。  C.由外载荷引起的应力都是一次应力。答案：A  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n\n解析1：PL + Pb（一次局部薄膜 + 一次弯曲）的应力强度限值为1.5KSm。解析2：极限载荷法直接校核结构承载能力，可替代一次应力（SI）、一次+局部（SII）、一次+二次（SIII）的评定。解析3：A 正确：一次应力必须满足外载平衡； B 错误：静力平衡仅用于求解，不是定义； C 错误：热应力等非外载引起的应力不属于一次应力。  \n\n\n根据厚壁圆筒微元体的平衡方程进行选择(3分)(1) 下述哪个公式是厚壁圆筒微元体的平衡方程?A.σ_r + R  B.σ_θ + σ_φ + P &#x3D; 0  C.dσ_r&#x2F;dr + (σ_r - σ_θ)&#x2F;r &#x3D; 0答案：C  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(2) 厚壁圆筒微元体的平衡方程是从什么角度列出的?A.力的平衡  B.力矩的平衡  C.应力与应变的关系  D.材料的性质答案：A  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(3) 厚壁圆筒微元体的平衡方程能否在弹塑性应力分析中适用?(    )A.适用  B.不适用  C.不能判定  D.有的情况适用，有的情况不适用答案：A  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n\n解析1：该式为轴对称厚壁筒径向力平衡微分方程。解析2：该方程基于微元体力的平衡，非力矩或本构关系。解析3：平衡方程是力学基本方程，与材料本构无关，在弹塑性分析中依然成立。\n\n五、综合题（共2道题，本题共16分。）\n根据压力容器应力分析(不考虑动载荷和疲劳)的主要设计步骤进行选择(8分)(1) 设计载荷分析，包括设计压力、液体静压头、容器自重、内装物料、附加载荷、管道载荷、地震载荷和风载荷。答案：错误  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(2) 确定设计条件，进行压力容器结构分析，合理地简化模型，建立有限元模型。答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(3) 确定计算方法，对有限元模型施加设计载荷和边界条件，然后进行有限元计算。答案：错误  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(4) 选择各组件的危险路径进行应力评定，如果不合格，调整结构参数按上述步骤重新计算并评定：然后生成应力分析报告。答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n\n解析1：不考虑动载荷时，不应包含地震、风载。题干自相矛盾。解析2：此为应力分析标准流程第一步。解析3：计算方法应在建模前确定*（如线弹性&#x2F;弹塑性、单元类型），非建模后。解析4：此为应力分析闭环流程，符合 JB4732 要求。\n\n\n关于轴对称结构的有限元分析，判断下列说法是否正确：(8分)(1) 对称结构的几何形状、约束条件以及作用的载荷都对称于某一固定轴。答案：正确  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）(2) 所有应力、应变和位移都与θ方向无关，只是r，z的函数。答案：正确  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）(3) 由于轴对称，θ方向的应力等于零。答案：错误  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）(4) 轴对称问题是二维问题，离散轴对称体时，采用的单元是一些圆柱体。答案：错误  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n\n解析1：轴对称问题三要素：几何、材料、载荷、边界均绕轴对称。解析2：轴对称意味着场变量不随周向角θ变化。解析3：环向应力 σ_θ ≠ 0，且常为主应力（如内压容器 σ_θ &#x3D; pR&#x2F;t）。解析4：离散采用三角形或四边形单元，绕轴旋转形成环状单元，非“圆柱体”。\n\n\n已知物体中一点的主应力分别为：σ1&#x3D;200MPa，σ2&#x3D;50MPa，σ3&#x3D;-50MPa，材料ReL&#x3D;235MPa，根据屈服条件进行选择(10分)(1) Tresca屈服条件是指当最大主应力达到一定数值时，材料开始进入塑性状态。答案：错误  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(2) Mises屈服条件是指当等效应力达到一定数值时，材料开始进入塑性状态。答案：正确  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(3) 按Tresca屈服条件计算的应力为(    )MPa。A.100  B.150  C.200  D.250答案：D  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(4) 按Mises屈服条件计算的应力为(    )MPa。A.154  B.200  C.218  D.308答案：C  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(5) 根据Tresca屈服条件，该物体的研究点处于弹性状态；根据Mises屈服条件，该物体的研究点处于塑性状态。答案：错误  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n\n解析1：Tresca 准则基于最大剪应力，即 σ₁ − σ₃ &#x3D; 2τ_max，非最大主应力。解析2：Mises 应力（等效应力）为 $\\sigma_{\\text{eq}} &#x3D; \\sqrt{[(\\sigma_1-\\sigma_2)^2 + (\\sigma_2-\\sigma_3)^2 + (\\sigma_3-\\sigma_1)^2]&#x2F;2}$，达屈服强度即塑性。解析3：σ₁ − σ₃ &#x3D; 200 − (−50) &#x3D; 250 MPa解析4：$\\sigma_{\\text{eq}} &#x3D; \\sqrt{200^2 + 50^2 + (-50)^2 - 200\\cdot50 - 50\\cdot(-50) - (-50)\\cdot200} \\&#x3D; \\sqrt{40000 + 2500 + 2500 - 10000 + 2500 + 10000} &#x3D; \\sqrt{47500} \\approx 218 \\text{ MPa}$解析5： Tresca 应力 250 MPa &gt; ReL (235 MPa) → 塑性; Mises 应力 218 MPa &lt; ReL → 弹性。故题目判断刚好相反，说法错误。\n\n","categories":["SAD"],"tags":["SAD"]},{"title":"分析设计SAD(1)","url":"/2025/12/11/SAD/sad1/","content":"SAD试卷一一、单选题（共30道题，本题共15分。）\n碳钢和低合金钢容器产生应力腐蚀的主要因素是：(    )。A. 压应力  B. 压应力+腐蚀介质  C. 拉应力和腐蚀介质答案：C  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：应力腐蚀开裂（SCC）发生的三个必要条件为：敏感材料、特定腐蚀介质和拉应力。压应力不会引起SCC。\n\n\n峰值应力是由局部结构不连续或局部热应力影响而引起的附加于(    )之上的应力增量。A. 一次加二次应力  B. 二次应力  C. 薄膜应力和弯曲应力答案：A  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：根据 JB4732 的应力分类原则，峰值应力（F）是叠加在一次应力（P）和二次应力（Q）之上的局部高应力增量，用于评估疲劳和脆断。\n\n\n在常温下工作的零件，如果弹性变形总量保持不变，则零件内的应力将保持(    )。A. 不变  B. 会变答案：A  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：在弹性范围内，应力与应变为线性关系（胡克定律）。若总弹性变形不变，且材料性能稳定，应力将保持恒定。\n\n\nJB4732标准中，对于螺栓连接的平盖厚度计算公式，平盖材料的许用应力取(    )。A. GB&#x2F;T150中相关材料的许用应力；  B. 相关材料的设计应力强度；答案：B  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：JB4732 采用“设计应力强度”（$S_m$）而非GB&#x2F;T150中的“许用应力”$[σ]$。设计应力强度 $S_m &#x3D; min{R_m&#x2F;n_b, R_{eL}&#x2F;n_s}$。\n\n\n我国分析设计标准JB4732采用什么强度理论(    )。A. 第一强度理论  B. 第二强度理论  C. 第三强度理论  D. 第四强度理论答案：C  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）  \n\n解析：JB4732 采用最大剪应力理论（即第三强度理论），其应力强度定义为最大主应力与最小主应力之差（σ1 - σ3）。\n\n\n\n\n\n螺纹的疲劳强度减弱系数不得小于(    )。A. 2.0  B. 2.5  C. 4.0  D. 20答案：C  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）**解析：**JB4732 附录C及相关条款规定，螺纹连接（包括螺栓、螺柱）的疲劳强度减弱系数 Kf ≥ 4.0。\n\n导致压力容器疲劳破坏的主要条件有哪些?(    )A. 包括峰值应力的总应力  B. 足够的应力或应变循环  C. 足够大的一次应力  D. 足够大的二次应力。答案：B  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）**解析：**疲劳破坏的首要条件是存在足够次数的应力&#x2F;应变循环。峰值应力是疲劳裂纹萌生的驱动力，但若循环次数不足，也不会发生疲劳破坏。\n\n应力强度为给定点处最大剪应力的(    )，即给定点处最大主应力与最小主应力的代数值(拉应力为正值，压应力为负值)之差。A. 2倍；  B. 1.5倍；  C. 3倍；答案：A  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：应力强度 S &#x3D; σ1 - σ3 &#x3D; 2 × τmax，即最大剪应力的2倍。第三强度理论的直接体现。\n\n\n总刚矩阵对角线上元素均为正值，原因在于：(    )。A. 结构上有正应力存在  B. 结构必须满足平衡方程  C. 载荷方向和它引起的位移方向不能相反答案：C  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：结构力学基本原理。对角线元素（主刚度）代表单位位移引起的同向力，对于稳定结构，其值必须为正，否则结构不稳定。\n\n\n奥氏体不锈钢晶间腐蚀主要表现为在晶界析出：(    )。A. Cr₂₃C₆  B. σ相  C. 金属间化合物答案：A  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：材料知识。奥氏体不锈钢在450-850℃敏化温度区间，碳与铬结合形成 Cr₂₃C₆ 析出在晶界，导致晶界贫铬而引发晶间腐蚀。\n\n\n铬钼钢材料产生回火脆性主要因素是(    )。A. 化学成分  B. 组织形态  C. 较高的强度答案：A  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：铬钼钢（如2.25Cr-1Mo）的回火脆性主要与钢中P、Sn、Sb、As等杂质元素的偏聚有关，属于化学成分敏感性问题。\n\n\n按JB4732的标准要求，下列哪些说法是正确的?(    )A. 按要求需进行疲劳分析设计的容器，其A、B类焊接接头之焊缝应与母材圆滑过渡B. 按要求需进行疲劳分析设计的容器，如果没有考虑焊接接头的疲劳强度减弱系数，其A、B类焊接接头表面应与母材表面齐平，不允许保留余高C. 如容器按疲劳分析设计打焊工钢印的部位应远离焊接接头D. 碳素钢与低合金制低温容器如不做焊后热处理，那么不允许打焊工钢印答案：B  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：根据 JB4732 疲劳设计要求，若未考虑焊接接头的疲劳强度减弱系数，则A、B类焊缝必须与母材齐平，不得保留余高，以避免应力集中。\n\n\nJB4732中，对疲劳分析免除条件描述正确的是(    )。A. 常温屈服限&lt;550MPa的钢材制压力容器，各项循环次数的总和不超过1000次；B. 常温抗拉强度&lt;550MPa的钢材制压力容器，各项循环次数的总和不超过400次；C. 对Q345R容器整体补强结构，压力波动范围超过设计压力20%的工作压力循环的循环次数才计入；D. 对Q345R容器带加强圈接管，压力波动范围超过设计压力20%的工作压力循环的循环次数不得超过1000次。答案：C  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：对于整体补强结构（如整体法兰、整体接管），只有压力波动范围超过设计压力20% 的循环才计入疲劳分析\n\n\n按标准的规定，整体设备法兰计算时的轴向应力是(    )。A. 弯曲应力  B. 薄膜应力  C. 薄膜+弯曲应力答案：A  （难度：一般｜试题级别：SAD｜出自标准：GB&#x2F;T150｜试题用途： ）\n\n解析：法兰在内压和螺栓载荷作用下，其危险截面（如锥颈大端）的轴向应力主要是由弯矩引起的弯曲应力。\n\n\n为避免碳钢和低合金钢材料的石墨化倾向，通常在材料成分中添加一定量的(    )。A. Mn元素  B. Cr元素  C. Mo元素答案：B  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：碳钢和C-Mn钢在高温（&gt;425℃）长期服役会发生石墨化。添加 Cr元素（形成稳定的碳化物）可有效抑制石墨化。\n\n\n当考虑地震载荷作用时，计算一次加二次应力强度范围和峰值应力范围是用(    )作为计算条件。A. 设计载荷  B. 操作载荷  C. 操作载荷×1.2  D. 无答案：B  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：地震载荷、风载等偶然载荷与操作载荷（而非设计载荷）进行组合，用于评定一次加二次应力和峰值应力范围。\n\n\n四边受均布拉力q的无限大薄平板中有一小孔，按弹性理论可求得孔边沿板厚为常量的最大切向应力为2q，按应力分类方法，该应力应划为(    )。A. 一次总体薄膜应力  B. 一次局部薄膜应力  C. 二次应力  D. 一次应力+峰值答案：B  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：由压力等机械载荷引起的、在结构不连续处（如开孔）产生的、影响范围有限的薄膜应力，属于一次局部薄膜应力（PL）。\n\n\n容器设备法兰采用长颈对焊法兰且工作压力大于0.8倍最大允许工作压力时，长颈法兰的直边段与圆筒的对接焊缝，应进行什么无损检测?(    )A. 进行100%RT或100%UT  B. 进行20%RT或20%UTC. 进行100%表面检测  D. 与容器其他AB类焊接接头检测要求一致答案：A  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：JB4732 对高应力区的焊接接头有严格要求。当工作压力 &gt; 0.8倍MAWP时，该焊缝为高应力区，需100% 无损检测（RT&#x2F;UT）。\n\n\n应力分类法中的各类应力采用的是(    )。A. 最大主应力  B. 塑性应力  C. 弹塑性应力  D. 弹性名义应力  E. 剪应力答案：D  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：JB4732 的应力分类法基于线弹性分析，其结果称为“弹性名义应力”，用于后续的应力分解和评定。\n\n\n固定管板换热器数值计算分析时，下列描述正确的是(    )。A. 数值分析时，换热管一般采用梁单元；B. 建模时，壳程建模厚度应按工况预判来确定按有效厚度还是名义厚度；C. 建模时，壳程厚度用壳体有效厚度可得到保守结果；D. 数值计算模型加载时，可不区分计算工况，用载荷最大值代替。答案：B  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：根据具体工况（如是否考虑腐蚀裕量）来决定使用有效厚度（扣除腐蚀裕量）还是名义厚度，以准确反映结构刚度。\n\n\n\n二、多选题（共25道题，本题共25分。）\nJB4732中，应力指数法仅适用于(    )。A. 单个开孔；  B. 孤立开孔；  C. 多个开孔；答案：AB  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：JB4732 的应力指数法（Stress Index Method）适用于单个、孤立的开孔，不适用于多个孔相互影响的情况。\n\n\n边缘应力具有：(    )性和(    )性。A. 局部  B. 自限  C. 扩展  D. 无限  E. 分散  F. 递增答案：AB  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：边缘应力是由于结构不连续（如筒体与封头连接处）产生的弯曲应力，其特点是局部性（随远离边缘迅速衰减）和自限性（材料局部屈服后应力不再增加）。\n\n\nGB&#x2F;T150不适用于(    )。A. 疲劳分析  B. 热应力分析  C. 设计压力-1.3MPa的钢制容器  D. 设计压力为-0.015的铜制容器答案：ABD  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：GB&#x2F;T150 是常规设计标准，明确不适用于疲劳分析（A）、热应力分析（B，因其未考虑二次应力） 和 非钢制容器（D）。\n\n\n塑性力学的特点(    )。A. 材料的应力-应变关系非线性；  B. 结果与加载历史有关；  C. 结果与加载历史无关；D. 压力容器考虑弹塑性分析时，利用叠加原理对载荷工况进行组合。答案：AB  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：塑性力学的核心特点是：1) 应力-应变关系非线性；2) 结果与加载历史相关（路径依赖）。\n\n\nJB4732钢制压力容器分析设计标准适用于(    )的压力容器。A. 设计压力大于或等于0.1MPa且小于100MPa的容器；B. 工作压力与容积的乘积大于或者等于2.5MPaL；C. 盛装介质为气体、液化气体以及介质最高工作温度高于或者等于其标准沸点的液体；D. 真空度高于或等于0.02MPa的容器。答案：AD  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\nJB4732分析设计标准适用于设计压力大于或等于(    )且小于(    )、真空度高于或等于(    )的容器。A. 0.1MPa  B. 1MPa  C. 100MPa  D. 0.02 MPa答案：ACD  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n导致压力容器疲劳破坏的主要条件有哪些?(    )A. 包括峰值应力的总应力  B. 足够的应力或应变循环  C. 足够大的一次应力  D. 足够大的二次应力答案：AB  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：疲劳破坏需同时满足两个条件：1) 存在峰值应力（总应力的一部分）；2) 足够多的循环次数。\n\n\nJB4732不适用(    )。A. 核能装置中的容器  B. 经常搬运的容器  C. 旋转或往复运动的机械设备中自成整体或作为部件的受压器室D. 内直径大于150mm的任何长度的容器  E. 直接火焰加热的容器答案：ABCE  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n在有限元中，作用在弹性体上的外力，需要移置到相应的结点上成为结点载荷，载荷移置基于以下原则：(    )。A. 虚功相等原则  B. 位移相等原则  C. 应力相等原则  D. 圣维南原理答案：AD  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：有限元中，将分布载荷移置为节点载荷需满足虚功等效。圣维南原理说明了这种等效处理在远离载荷作用区是合理的。\n\n\n影响法兰连接接头密封性能的因素包括(    )。A. 螺栓预紧力  B. 法兰密封面型式  C. 垫片宽度  D. 螺栓间距答案：ABCD  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：法兰密封性能是系统工程，受螺栓预紧力（A）、密封面型式（B）、垫片特性（C）、螺栓布置（D） 等多因素影响。\n\n\n强度理论用于判断材料在复杂应力状态下是否破坏，共有(    )强度理论，其中JB4732分析设计标准中的应力分类法采用的是(    )。A. 3个  B. 4个  C. 第1强度理论  D. 第3强度理论  E. 第4强度理论答案：BD  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：经典强度理论共4个（最大拉应力、最大拉应变、最大剪应力、形状改变比能）。JB4732 明确采用第三强度理论（最大剪应力理论）。\n\n\n峰值应力强度的许用极限取决于以下哪些因素?A. 峰值应力的大小  B. 峰值应力幅值的大小  C. 峰值应力对应的作用次数  D. 适用的疲劳设计曲线答案：BCD  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：根据 JB4732 附录C 疲劳分析要求，峰值应力评定需结合应力幅值、循环次数及对应材料的S-N 曲线（疲劳设计曲线）。\n\n\n应力强度是给定点处(    )和(    )的代数差。A. 剪应力  B. 平均应力  C. 最大主应力  D. 薄膜应力  E. 弯曲应力  F. 最小主应力答案：CF  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：JB4732 定义应力强度为 σ₁ − σ₃（最大与最小主应力代数差），等同于2倍最大剪应力。\n\n\n压力容器中的交变循环应力常常是由于以下几个方面的原因引起的?(    )A. 频繁的间隙操作和开停工造成的工作压力和各种载荷的变化B. 附属设备及隔热、衬里、容器、扶梯、平台等的质量C. 运行时出现的周期性温度变化或压力波动D. 在正常的温度变化时，容器及受压部件的膨胀或收缩受到了约束E. 外加机械载荷的交变产生的振动答案：ACDE  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：交变应力来源包括：频繁启停（A）、温压波动（C）、热胀受约束（D）、机械振动（E）。B项为静载，不产生交变应力。\n\n\n求厚壁圆筒的塑性极限载荷时，需要用到下列哪些关系式?(    )A. 平衡方程  B. 屈服条件  C. 边界条件  D. 安定性判据答案：ABC  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：塑性极限分析三大要素：静力平衡（A）、材料屈服准则（B，如Tresca）、边界条件（C）。安定性判据（D）用于安定分析，非极限载荷计算。\n\n\n分析设计中涉及到的失效模式有(    )。A. 过量的弹性变形、包括弹性不稳定性  B. 脆性断裂  C. 过量的塑性变形  D. 塑性不稳定–渐增性垮塌E. 应力腐蚀  F. 高应变–低循环疲劳  G. 腐蚀疲劳答案：ABCDF  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：JB4732 第1章 明确列出失效模式包括：过量弹性变形（A）、脆断（B）、过量塑性变形（C）、塑性失稳（D）、高应变疲劳（F）。腐蚀疲劳（G）与应力腐蚀（E） 属环境失效，标准未将其纳入应力分类法控制范围。\n\n\n固体力学中的非线性问题主要包括(    )。A. 几何非线性  B. 边界条件非线性  C. 应力非线性  D. 材料非线性答案：AD  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：结构非线性主要分为几何（大变形、大转角）和材料（塑性、蠕变）两类。边界非线性非常规分类，应力非线性是结果而非原因。\n\n\n用碳钢制造的(    )等结构可以采用应力分类方法进行强度计算和校核。A. 内压作用下的松式法兰  B. 内压作用下的椭圆封头上的开孔接管C. 换热器管板与换热管的焊接接头  D. 塔器封头与裙座相连的结构答案：BD  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：应力分类法适用于满足小变形、材料均匀、结构连续等条件的钢制压力容器部件。松式法兰（A）和焊接接头（C）因存在严重不连续或局部效应，不宜直接应用。\n\n\n下列哪些论述中哪些是极限分析的基本假设?(    )A. 材料是理想弹塑性的。B. 变形足够小，变形引起几何尺寸的改变可以不考虑；变形前后使用同一平衡方程，几何方程是线性的。C. 满足比例加载条件，所有载荷按同一比例增加。D. 结构有足够刚度，在达到极限载荷前不会失稳答案：ABC  （难度：困难｜试题级别：SAD｜出自标准：GB&#x2F;T4732｜试题用途： ）\n\n解析：GB&#x2F;T4732（即新版JB4732）极限分析假设：理想弹塑性材料（A）、小变形（B）、比例加载（C）。结构不失稳（D）是要求而非假设。\n\n\nJB4732中换热器管板分析计算时，下述正确选项为(    )。A. 管板径向应力主要成分属于弯曲应力；B. JB4732应力评价采用的第四强度准则；C. JB4732中管板解析法计算时，可依据工况进行组合叠加；D. 浮头换热器设计中，改变浮动端管板直径时，会影响固定端管板应力。答案：ACD  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：管板径向应力以弯曲为主（A）；JB4732 采用第三强度理论，非第四（B错误）；解析法允许工况组合（C）；浮头换热器两端管板相互影响（D）。\n\n\n\n三、判断题（共43道题，本题共21.5分。）\n设计温度低于-20℃的低合金钢容器属于低温容器。(    )答案：正确  （难度：容易｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第3章3.1.15｜试题用途： ）\n\n真空度0.015MPa的容器必须按GB&#x2F;T4732.1进行设计。(    )答案：错误  （难度：容易｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第1章1.4a｜试题用途： ）\n\n设计温度低于-20℃的碳钢容器必须按低温容器要求设计。(    )答案：正确  （难度：容易｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第3章3.1.15｜试题用途： ）\n\n焊接接头的设计原则基于等强度设计原则。(    )答案：正确  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：JB4732 强调焊接接头应与母材等强度，确保结构整体承载能力。\n\n\nJB&#x2F;T4732-1995(2005确认)中压力容器分析设计方法中的应力分类法不适用于厚壁圆筒。(    )答案：错误  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：JB4732 应力分类法适用于包括厚壁圆筒在内的各类结构，只要满足小变形、材料均匀等前提。\n\n\nJB4732附录C中的不锈钢疲劳曲线可用于循环次数10的9次方的情况。(    )答案：错误  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：JB4732 附录C 图C1C4 疲劳曲线最高仅到 10⁶10⁷ 次，10⁹次属高周疲劳，超出其适用范围。\n\n\n容器壳体在内压作用下产生的一次总体薄膜应力在内压继续增加时将会发生重新分布。(    )答案：错误  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：一次总体薄膜应力（Pm）由外载直接引起，不具自限性，但其分布形式固定，不会重分布（除非材料屈服进入塑性）。\n\n\n在有限元分析中，作用在结构上的载荷要按虚功相等原则等效到结构的所有结点上。(    )答案：错误  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：载荷只需等效到受载单元的结点，非“所有结点”。\n\n\n循环载荷工作的压力容器一定需要进行疲劳分析。(    )答案：错误  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：JB4732 有疲劳免除条款（如循环次数少、压力波动小等），满足条件可免除。\n\n\n当容器的使用条件非常苛刻时，应使用分析设计，否则可以使用常规设计。(    )答案：错误  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：常规设计（GB&#x2F;T150）通过提高安全系数也可用于苛刻工况，分析设计非强制。\n\n\n与采用常规设计方法不同，压力容器采用分析设计时，奥氏体不锈钢焊接接头必须进行热处理。(    )答案：错误  （难度：容易｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：奥氏体不锈钢通常不推荐焊后热处理，因其在敏化温度区间（约450–850℃）易析出 Cr₂₃C₆，导致晶间腐蚀。JB4732 未强制要求 对奥氏体不锈钢焊接接头进行热处理。\n\n\n结构的虚位移是指假定的、约束允许的、任意的微小的位移。(    )答案：正确  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：\n\n\n对于需进行疲劳分析设计的容器，不得采用硬印作为材料的确认标记。(    )答案：正确  （难度：容易｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：\n\n\n所有压力容器的风险评估报告必须由制造单位编制。(    )答案：错误  （难度：一般｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024附录A.3｜试题用途： ）\n\n解析：依据 GB&#x2F;T4732.1-2024 附录A.3，风险评估报告应由设计单位负责编制，制造单位可参与但非必须编制主体。\n\n\n奥氏体高合金钢制受压元件的许用应力最高可提高至0.9Rp0.2。(    )答案：正确  （难度：一般｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第5章表1注｜试题用途： ）\n\n解析：GB&#x2F;T4732.1-2024 对于奥氏体高合金钢，当满足一定条件（如无敏化、无应力腐蚀等），其许用应力可取 0.9倍规定塑性延伸强度 Rp0.2。\n\n\n设计文件可不注明腐蚀裕量。(    )答案：错误  （难度：一般｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第5章5.3.6｜试题用途： ）\n\n解析：GB&#x2F;T4732.1-2024 设计文件必须注明腐蚀裕量（C2），并说明其取值依据。\n\n\n圣维南原理认为作用在弹性体表面某一局部面积上的力系，可以用弹性体上另一静力等效力系所代替。(    )答案：错误  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：圣维南原理强调：静力等效的力系替换仅在远离作用区域时应力场相近，而非“可以用另一力系代替”。\n\n\n一个构件当经受机械应力、热应力，或者两者全有的循环作用，而产生逐次递增的非弹性变形，称为棘轮现象。(    )答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：在循环载荷（尤其含恒定内压+交变热载）下，结构产生不可逆、逐次累积的塑性变形，即为棘轮现象（Ratcheting）。\n\n\n如果采用实体单元建立有限元分析模型，必须进行沿厚度方向的应力线性化才能得到壳体上的薄膜应力和弯曲应力。(    )答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732，｜试题用途： ）\n\n解析：实体单元计算结果为非线性应力分布，需通过应力线性化（如沿壁厚路径分解为薄膜、弯曲、峰值分量）才能用于应力分类评定。\n\n\n峰值应力具有自限性。(    )答案：错误  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）？？\n\n解析：峰值应力（F）无自限性，二次应力（Q）才有。峰值应力可直接导致疲劳裂纹。\n\n\n按分析标准设计的厚度为28mm的Q345R制容器，无需制备产品焊接试件。(    )答案：错误  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：JB4732 对产品焊接试件有明确要求（如厚度、材料、使用条件等）。Q345R容器厚度 &gt; 一定限值（通常20mm或25mm）且用于重要场合时，需制备产品焊接试件。\n\n\n两较远距离的容器之间管道热胀冷缩，导致容器接管端部载荷引起的接管根部应力属于二次应力。(    )答案：错误  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：该应力由外部管道位移强制施加，属于外载直接引起的局部高应力，应划分为峰值应力（若为循环载荷）或一次局部应力（若为静载）。\n\n\n材料的冲击吸收能量Akv由裂纹形成功和裂纹扩展功组成，通常裂纹形成功高于扩展功。(    )答案：错误  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：在多数韧性材料中，裂纹扩展功远大于裂纹形成功。Akv 主要反映材料阻止裂纹扩展的能力\n\n\n峰值应力仅对低周疲劳和脆断的失效模式起作用，而对其他失效模式不起作用。(    )答案：正确  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：峰值应力主要影响疲劳（低周） 和脆性断裂，对塑性垮塌、失稳、安定性等失效模式无直接影响。\n\n\n采用弹塑性分析方法设计的容器，其耐压试验应力校核可豁免GB&#x2F;T4732.4的应力分类限值。(    )答案：错误  （难度：困难｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第5章5.7.3.3+GB&#x2F;T4732.5｜试题用途： ）\n\n解析：即使采用弹塑性分析，耐压试验仍需满足相应应力限值要求，不可完全豁免。\n\n\n外压容器设计时，试验压力可以低于设计压力。(    )答案：错误  （难度：困难｜试题级别：SAD｜出自标准：GB&#x2F;T4732.1-2024第5章5.7.2.3｜试题用途： ）\n\n解析：外压容器的液压试验压力不得低于设计压力的1.25倍，不得低于设计压力。\n\n\n弹性力学与板壳理论方法对同一问题的计算结果是相同的。(    )答案：错误  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：板壳理论是弹性力学在特定几何假设（如薄壁、小曲率）下的简化，二者结果在一般情况下不相同，尤其在复杂几何或高精度要求时。\n\n\n应力重分布就是从原来的应力分布减去一个自平衡力系，使最大应力水平降低，而低应力区的应力水平有所提高。(    )答案：正确  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：该描述符合弹塑性力学中应力重分布的基本概念：材料屈服后，应力从高应力区“转移”至低应力区，形成更均匀的分布。\n\n\n由于我国绝大多数地区只考虑设计近震且远震影响有限，故远震的破坏性没有近震强。(    )答案：错误  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：\n\n\n因弹塑性分析考虑了材料屈服后的应力应变关系，故按应力分类法进行应力分析和校核时，采用弹塑性分析可比采用线弹性分析得到更为准确的结果。(    )答案：错误  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：远震可能因长周期成分对大型柔性结构（如高塔、长悬臂）造成严重破坏，不能一概认为破坏性小于近震。\n\n\n高周疲劳与低周疲劳的区别主要在于塑性变形的大小不同。(    )答案：正确  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：JB4732 的应力分类法基于线弹性分析（弹性名义应力）。弹塑性分析用于直接失效评估（如极限载荷、安定分析），不能直接用于应力分类评定。\n\n\n当长颈对焊法兰直边段厚度大于与其对接的圆筒段厚度时，可按JB4732或GB150中关于不同厚度筒体对接时将厚度较大圆筒削薄的有关规定削薄法兰直边段至与圆筒等厚后再焊接。(    )答案：错误  （难度：困难｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析：法兰直边段与筒体连接处属高应力区，不应随意削薄法兰。JB4732 和 GB&#x2F;T150 通常要求筒体削薄过渡，而非削薄法兰。\n\n\n\n四、简答题（共6道题，本题共18分。）\n根据应力集中现象进行选择(3分)(1) 理论应力集中系数是指最大局部应力与计算名义应力之比。答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(2) 什么是应力集中现象?A. 在结构突变附近的局部小范围内，应力数值会急剧增加，而离开这个区域稍远，应力则大大降低，趋于均匀，这种现象称为应力集中。B. 在应力突变处应力数值相比其它部位有一个很大的变化而在稍远的地方又衰减到正常水平的现象称为应力集中。C. 在结构突变处应力数值相比其它部位有一个很大的变化，这种现象称为应力集中。D. 在集中受力处应力数值相比其它部位有一个很大的变化，这种现象称为应力集中。答案：A  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(3) 应力集中系数是如何定义的?A. 把最大应力与危险截面上的平均应力比值称为应力集中系数。B. 把最大应力与整个截面上的平均应力比值称为应力集中系数。C. 把最大局部应力与危险截面上的平均应力比值称为应力集中系数。D. 把最大局部应力与截面的平均应力比值称为应力集中系数。答案：C  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：理论应力集中系数 $K_t&#x3D;σmax&#x2F;σnom，其中σnom为名义应力（如按薄壁理论计算的应力）。应力集中是指在几何突变处（如开孔、缺口、台阶）附近，局部应力急剧升高，但随距离迅速衰减至均匀水平的现象。“局部性”和“衰减性”。应力集中系数 &#x3D; 最大局部应力 &#x2F; 危险截面上的平均应力（即名义应力）。危险截面指应力集中区域所在截面。\n\n\n根据一次应力、二次应力和峰值应力进行判断(3分)(1) 一次应力是平衡压力与其他机械载荷所必须的法向应力或剪应力。答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(2) 二次应力是为满足外部约束条件或结构自身变形连续要求所必须的法向应力或剪应力。答案：正确  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(3) 峰值应力是由总体结构不连续或总体热应力影响而引起的附加于一次与二次应力之上的应力增量。答案：错误  （难度：一般｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：一次应力用于满足外载平衡，无自限性，可导致塑性垮塌。二次应力源于变形协调（如热膨胀受约束、结构几何不连续），具有自限性。峰值应力是由局部结构不连续（如焊缝余高、小孔、缺口）或局部热应力引起，非“总体”。JB4732 特别区分“局部”与“总体”。\n\n\n根据焊接残余应力进行选择(3分)(1) 焊接应力系由变形不协调或变形不自由产生的，具有自限性。它属于内应力，无法用电阻应变片进行测量。答案：正确  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：焊接残余应力是自平衡内应力，不对外载平衡起作用，具有自限性；因材料已局部屈服，应变片无法直接测其“真实”残余值。\n\n\n\n(2) 焊接残余应力对容器强度有哪些影响?A. 加剧容器应力腐蚀  B. 对脆性断裂产生不良影响  C. 影响容器静力强度  D. 对疲劳容器容易产生裂纹答案：ABD  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）  \n\n解析：A. 残余拉应力 加剧应力腐蚀；B. 降低断裂韧性，促进脆断；D. 在交变载荷下，与工作应力叠加，加速疲劳裂纹萌生。C（静强度）通常不受影响，因静载下材料可重分布应力。\n\n(3) 疲劳容器需要评定哪些应力强度?A. 一次总体薄膜应力强度  B. 一次弯曲应力强度  C. 一次薄膜+一次弯曲应力强度D. 一次局部薄膜应力强度  E. 一次+二次应力强度  F. 峰值应力强度答案：ACDEF  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析：疲劳评定需评估：A. Pm（一次总体薄膜） C. Pm+Pb（一次+弯曲）D. PL（一次局部薄膜）E. P+Q（一次+二次）F. 峰值应力（用于疲劳幅计算）注意：B（单独Pb）通常不单独控制，因其已含在Pm+Pb中。\n\n\n计算实例：一换热器壳程为常压，管程压力在整个操作过程中不变。在操作过程中壳程和管程介质温度会发生周期性变化，由此可以确定存在交变的两种工况-管程压力单独作用以及管程压力和温差同时作用，在该设备的设计寿命内两种工况的交变次数可达20000次。通过计算可知：A)按设计压力和设计温度：换热管在管程压力单独作用下的环向应力和轴向应力分别为82MPa和65MPa；在管程压力和温差载荷同时作用下的环向应力和轴向应力分别为90MPa和-24MPa。B)按操作压力和操作温度：换热管在管程压力单独作用下的环向应力和轴向应力分别为78MPa和60MPa；在管程压力和温差载荷同时作用下的环向应力和轴向应力分别为86MPa和-22MPa。(3分)(1) 按应力分类设计方法，该换热管应按哪些失效模式进行校核?(    )A. 一次加载下的塑性强度失效  B. 疲劳失效  C. 腐蚀疲劳D. 轴向失稳  E. 多次加载下由于塑性变形的累积而发生的失效答案：ABDE  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(2) 换热管的一次总体薄膜应力强度是多少?(    )A. 90MPa  B. 86MPa  C. 82MPa  D. 78MPa  E. 45MPa答案：C  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(3) 换热管的峰值应力强度是多少?(    )A. 90MPa  B. 86MPa  C. 82MPa  D. 78MPa  E. 45MPa答案：E  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n解析1：A. 一次加载：校核 塑性垮塌； B、E：20000次循环 → 疲劳失效 和 棘轮（塑性累积）失效；D：换热管受压，需校核 轴向失稳（屈曲）。C（腐蚀疲劳）题干未提腐蚀介质，不选。解析2：一次应力按设计压力+设计温度工况计算。环向应力 &#x3D; 82 MPa（主应力 $\\sigma_1$），轴向 &#x3D; 65 MPa（$\\sigma_2$），径向 ≈ 0（$\\sigma_3$）。应力强度 &#x3D; $\\sigma_1 - \\sigma_3 &#x3D; 82$ MPa。\n\n\n\n五、综合题（共2道题，本题共16分。）\n关于轴对称结构的有限元分析，判断下列说法是否正确：(8分)(1) 对称结构的几何形状、约束条件以及作用的载荷都对称于某一固定轴。答案：正确  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）(2) 所有应力、应变和位移都与θ方向无关，只是r，z的函数。答案：正确  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）(3) 由于轴对称，θ方向的应力等于零。答案：错误  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）(4) 轴对称问题是二维问题，离散轴对称体时，采用的单元是一些圆柱体。答案：错误  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析1：轴对称问题三要素：几何、材料、载荷、边界条件均绕轴对称。解析2：轴对称意味着场变量不随周向角θ变化。解析3：轴对称下，环向应力 $\\sigma_\\theta \\neq 0$，是主应力之一（如内压容器 $\\sigma_\\theta &#x3D; pR&#x2F;t$）。解析4：离散时采用三角形或四边形截面单元，绕轴旋转形成环状单元，非“圆柱体”。\n\n\n有限元分析思路，就是：(8分)(1) 将复杂的几何和受力对象划分为一个一个形状比较简单的标准”构件”，称为(    )。A. 单元  B. 子结构  C. 微元体答案：A  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）(2) 给出单元节点的位移和受力描述，构建起单元的(    )。A. 几何方程  B. 刚度方程  C. 物理方程答案：B  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）(3) 再通过单元与单元之间的节点连接关系进行单元的(    )，可以得到结构的整体刚度方程。A. 组装  B. 协调  C. 扩展答案：A  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）(4) 进而根据位移约束和受力状态处理(    )，并进行求解。A. 本构关系  B. 网格密度  C. 边界条件答案：C  （难度：一般｜试题级别：SAD｜出自标准： ｜试题用途： ）\n\n解析1：有限元基本思想：离散为单元（Element）。解析2：单元刚度方程 $ {F_e} &#x3D; [K_e] {u_e} $。解析3：通过节点连接，组装（Assemble） 成整体刚度矩阵。解析4：施加位移约束和载荷，即处理边界条件。\n\n\n根据失去安定与疲劳破坏的联系与区别进行选择：(10分)(1) 失去安定与疲劳破坏的联系?(    )A. 失去安定和疲劳破坏同属疲劳断裂B. 失去安定和疲劳破坏都不需要很多的加载次数就能疲劳断裂C. 失去安定和疲劳破坏同属大应变疲劳破坏D. 失去安定和疲劳破坏的疲劳断裂遵循相同的累积损伤规律答案：AD  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(2) 失去安定与疲劳破坏的区别?(    )A. 失去安定是一种小应变疲劳破坏，一般疲劳破坏属大应变疲劳破坏B. 失去安定是一种大应变疲劳破坏，一般疲劳破坏属小应变疲劳破坏C. 失去安定的疲劳断裂不遵循累积损伤规律，疲劳破坏的疲劳断裂遵循累积损伤规律D. 失去安定时每次加载卸载产生极大的损伤，疲劳破坏时每次加卸载产生的损伤较少答案：BD  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(3) 二次应力的控制与峰值应力的控制的区别?(    )A. 二次应力不允许进入”疲劳”即失去安定B. 峰值应力不允许进入”疲劳”即失去安定C. 峰值应力允许进入疲劳过程，但应留有足够的安全系数D. 二次应力允许进入疲劳过程，但应留有足够的安全系数答案：AC  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(4) 对于一次加载情况，对应于什么失效准则?A. 弹性失效准则  B. 塑性失效准则  C. 弹塑性失效准则答案：B  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）(5) 对于反复加载、卸载即交变载荷情况，对应于什么失效准则?A. 弹性失效准则  B. 塑性失效准则  C. 弹塑性失效准则答案：C  （难度：困难｜试题级别：SAD｜出自标准：JB4732｜试题用途： ）\n\n解析1：A、D 正确：二者均属循环失效，遵循累积损伤规律（如Miner准则）。解析2：B：失去安定 &#x3D; 大应变；一般疲劳（高周）&#x3D; 小应变；D：失去安定单次循环损伤大（塑性累积快）。解析3：A：二次应力控制安定性，不允许进入塑性循环（即“疲劳”）；C：峰值应力允许进入疲劳，但需满足 $S_a$（疲劳许用幅）。解析4：一次加载下，结构失效模式为塑性垮塌，对应塑性失效准则。B 错：疲劳可需大量循环；C 错：失去安定属低周（大应变）疲劳。解析5：循环载荷下需同时考虑安定性（塑性累积）和疲劳（裂纹萌生），采用弹塑性失效准则。\n\n\n\n","categories":["SAD"],"tags":["SAD"]},{"title":"Win11-WSL-Ubuntu22.04-openmc 从源码编译安装","url":"/2025/11/27/wsl/wsl-ubuntu-openmc-build(uv)/","content":"一、WSL 安装 Ubuntu22.04\n启用 WSL\n\n打开 Microsoft Store，安装 Ubuntu22.04\n\n设置源，更新ref： https://linuxmirrors.cn/use/\n\n\n# 用户权限sudo -i# 安装 LinuxMirrors：bash &lt;(curl -sSL https://linuxmirrors.cn/main.sh)# 恢复原始设置：# bash &lt;(curl -sSL https://linuxmirrors.cn/main.sh) --use-official-source true# Docker 源：# bash &lt;(curl -sSL https://linuxmirrors.cn/docker.sh)sudo apt updatesudo apt upgrade\n\n\n安装 ZSH、oh-my-zsh\n\n参考 zsh &amp; oh-my-zsh 安装配置 \nsudo apt install zshsh -c &quot;$(wget https://gitee.com/mirrors/oh-my-zsh/raw/master/tools/install.sh -O -)&quot;# sh -c &quot;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)&quot;git clone https://github.com/zsh-users/zsh-autosuggestions $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-autosuggestionsgit clone https://github.com/zsh-users/zsh-syntax-highlighting $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlightingsource ~/.zshrc\n\n二、编译安装 openmcref： https://docs.openmc.org/en/stable/quickinstall.html\n\n参照 Manually Installing from Source, 安装编译所需的基础库\n\nsudo apt install g++ cmake libhdf5-dev libpng-dev\n\n\n编译 build\n\ngit clone --recurse-submodules https://github.com/openmc-dev/openmc.gitcd openmcmkdir build &amp;&amp; cd buildcmake ..makesudo make install\n\n\n创建虚拟环境，安装 openmc 库\n\n\n\npython3 -Vsudo apt install python3-pippip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simplecurl -LsSf https://astral.sh/uv/install.sh | sh# 创建虚拟环境uv venv source $HOME/.local/bin/envsource .venv/bin/activate# 安装 openmcuv pip install .\n\n\n下载材料数据集\n\ngit clone https://github.com/openmc-dev/data openmc-dev_datacd openmc-dev_datapython3 convert_nndc71.py\n\n把 cross_sections.xml 的路径加入环境变量，或直接在openmc程序中设置：\n# code /home/xxxx/.local/lib/python3.10/site-packages/openmc/config.pyconfig[&#x27;cross_sections&#x27;] = &quot;/home/xxxx/openmc-dev_data/nndc-b7.1-hdf5/cross_sections.xml&quot;# 或者 直接加在程序前面import openmcopenmc.config[&quot;cross_sections&quot;] = &quot;/home/bo/openmc_data/nndc-b7.1-hdf5/cross_sections.xml&quot;\n\n三、更新升级 openmccd openmcgit pullcd buildcmake ..makesudo make installsource .venv/bin/activateuv pip install .\n","categories":["WSL"],"tags":["Ubuntu","WSL","openmc"]},{"title":"注册核安全工程师-法律法规","url":"/2025/09/03/NSE/fagui/","content":"1.0 概述\n我国核安全法律法规按法律效力分为三个层级：国家法律&gt;国务院条例&gt;国务院各部委部门规章。\n\n国家核安全局制定：安全导则以及技术文件。核安全导则的层次低于部门规章，实践中视为强制性要求执行。\n\n根据《中华人民共和国标准化法》的规定，标准包括国家标准、行业标准、地方标准、团体标准和企业标准。国家标准分为强制性标准、推荐性标准，行业标准、地方标准是推荐性标准。强制性标准是必须执行的。国家鼓励采用推荐性标准。\n\n当出现低层级文件的规定与高层及文件规定相抵触时，应该以高层及文件规定为准，管理部门应当及时对较低层级文件进行修订。\n\n\n1.1 放射性污染防治法\n\n目的：为了防治放射性污染，保护环境，保障人体健康，促进核能、核技术的开发与和平利用。\n\n方针：实行预防为主、防治结合、严格管理、安全第一的方针。\n\n主管部门：国务院环境保护行政主管部门对全国放射性污染防治工作依法实施统一监督管理。\n\n标准制定：国家放射性污染防治标准由国务院环境保护行政主管部门制定。由国务院环境保护行政主管部门和国务院标准化行政主管部门联合发布。\n\n监测制度：分两级监督：①核设施、铀（钍）矿：国务院环境主管部门；②核技术利用、伴生矿：县级以上环境主管部门。\n\n国务院环境保护行政主管部门会同国务院其他有关部门组织环境监测网络，对放射性污染实施监督、监测管理。（监督性监测由行政部门实施）\n\n县级以上地方人民政府环境保护行政主管部门和同级其他有关部门，对本行政区域内核技术利用、伴生放射性矿开发利用中的放射性污染防治进行监督检查。\n\n资格资质管理：①国家对从事放射性污染防治的专业人员实行资格管理制度；②对核设施营运单位进行资质管理，在进行核设施建造、装料、运行、退役等活动申请领取核设施许可证和办理装料、退役等审批手续。③生产、销售、使用放射性同位素和射线装置的单位申请领取许可证。④从事放射性固体废物贮存、处置的单位，必须经国务院环境保护行政主管部门审查批准，取得许可证。\n\n环评报告书（必考点）①在办理核设施选址，申请核设施建造、运行许可证和办理退役审批手续前审批手续前应当编制环境影响报告书，报国务院环境保护行政主管部门审查批准；②生产、销售、使用放射性同位素和加速器、中子发生器以及含放射源的射线装置的单位，应当在申请领取许可证前编制环境影响评价文件，报省、自治区、直辖市人民政府环境保护行政主管部门审查批准；（重中之重）；③开发利用或者关闭铀（钍）矿的单位，应当在申请领取采矿许可证或者办理退役审批手续前编制环境影响报告书，报国务院环境保护行政主管部门审查批准。④开发利用伴生放射性矿的单位，应当在申请领取采矿许可证前编制环境影响报告书，报省级以上人民政府环境保护行政主管部门审查批准。⑤产生放射性废气、废液的单位向环境排放符合国家放射性污染防治标准的放射性废气、废液，应当向审批环境影响评价文件的环境保护行政主管部门申请放射性核素排放量，并定期报告排放计量结果。（对应部门申请放射性核素排放量；向谁申请排放量重点）。\n\n四同时：与核设施相配套、改建、扩建的工程，应当与主体工程同时设计、同时施工、同时投入使用。同时验收；验收合格的，主体工程方可投入生产或者使用。\n\n规划限制区：核动力厂等重要核设施外围地区应当划定规划限制区。规划限制区的划定和管理办法，由国务院规定。（由谁制定？核安全法里面有明确规定由省自治区直辖市人民政府划定，由国务院核安全监督管理部门同意后实施）\n\n场内应急计划：核设施营运单位应当按照核设施的规模和性质制定核事故场内应急计划，做好应急准备。\n\n应急报告：出现核事故应急状态时，核设施营运单位必须立即采取有效的应急措施控制事故，并向核设施主管部门和环境保护行政主管部门、卫生行政部门、公安部门以及其他有关部门报告。\n\n标识：放射性物质和射线装置应当设置明显的放射性标识和中文警示说明。生产、销售、使用、贮存、处置放射性物质和射线装置的场所，以及运输放射性物质和含放射源的射线装置的工具，应当设置明显的放射性标志。\n\n特殊要求：使用伴生放射性矿渣和含有天然放射性物质的石材做建筑和装修材料，应当符合国家建筑材料放射性核素控制标准。\n\n废旧放射源回收利用：生产放射源的单位，应当按照国务院环境保护行政主管部门的规定回收和利用废旧放射源；\n\n发生放射源丢失、被盗和放射性污染事故时，有关单位和个人必须立即向公安部门、卫生行政部门和环境保护行政主管部门报告。接到报告单位应当立即报告本级人民政府。\n\n放射性固体废物先处理再处置，低、中水平放射性固体废物在符合国家规定的区域实行近地表处置。α放射性固体废物、高水平放射性固体废物实行集中的深地质处置。\n\n禁在内河水域和海洋上处置放射性固体废物。\n\n国务院核设施主管部门会同国务院环境保护行政主管部门根据地质条件和放射性固体废物处置的需要，在环境影响评价的基础上编制放射性固体废物处置场所选址规划。（核安全法：第四十二条国务院核工业主管部门会同国务院有关部门和省、自治区、直辖市人民政府编制低、中水平放射性废物处置场所的选址规划，报国务院批准后组织实施。国务院核工业主管部门会同国务院有关部门编制高水平放射性废物处置场所的选址规划。）\n\n涉及到环境影响评价文件相关统计\n\n\n\n\n\n单位\n事项\n主管部门\n\n\n\n核设施\n申请选址、建造、运行、退役\n国务院环境保护行政主管部门\n\n\n放射性同位素和加速器、中子发生器以及含放射源许可证的射线装置的单位\n申请生产、销售、使用\n国务院环境保护行政主管部门\n\n\n开发利用或者关闭铀（钍）矿的单位\n申请采矿许可证或者退役\n国务院环境保护行政主管部门\n\n\n开发利用伴生放射性矿的单位\n申请采矿许可证或者退役\n省级以上人民政府环境保护行政主管部门\n\n\n产生放射性废气、废液单位向环境排放\n申请放射性核素排放量\n批环境影响评价文件的部门\n\n\n1.2 核安全法\n目的：为了保障核安全，预防与应对核事故，安全利用核能，保护公众和从业人员的安全与健康，保护生态环境，促进经济社会可持续发展。\n\n范围：在中华人民共和国领域及管辖的其他海域内，对核设施、核材料及相关放射性废物采取充分的预防、保护、缓解和监管等安全措施，防止由于技术原因、人为原因或者自然灾害造成核事故，最大限度减轻核事故情况下的放射性后果的活动。\n\n放射性废物，是指核设施运行、退役产生的，含有放射性核素或者被放射性核素污染，其浓度或者比活度大于国家确定的清洁解控水平。\n\n核安全观：国家坚持理性、协调、并进的核安全观。\n\n方针原则：核安全工作必须坚持安全第一、预防为主、严格管理、纵深防御、全面保障、独立监管、责任明确的原则。（放射性污染防治法方针：安全第一、预防为主、严格管理、防治结合）\n\n权责：国务院核安全监督管理部门负责核安全的监督管理，会同国务院有关部门编制国家核安全规划，报国务院批准后组织实施；核设施营运单位对核安全负全面责任；为核设施营运单位提供设备、工程以及服务等的单位，应当负相应责任。\n\n标准体系：国家坚持从高从严建立核安全标准体系。核安全标准是强制执行的标准，应当根据经济社会发展和科技进步适时修改。\n\n核安全文化：国务院核安全监督管理部门、核工业主管部门和能源主管部门应当建立培育核安全文化的机制。\n\n分类管理：国家根据核设施的性质和风险程度等因素，对核设施实行分类管理。\n\n监测：核设施营运单位应当对核设施周围环境中所含的放射性核素的种类、浓度以及核设施流出物中的放射性核素总量实施监测，并定期向国务院环境保护主管部门和所在地省自治区、直辖市人民政府环境保护主管部门报告监测结果。\n\n规划限制区：省、自治区、直辖市人民政府应当在核动力厂等重要核设施周围划定规划限制区，经国务院核安全监督管理部门同意后实施。\n\n资质管理：核设施营运单位进行核设施选址、建造、运行、退役等活动，为核设施提供核安全设备设计、制造、安装和无损检验服务的单位，从事放射性废物处理、贮存、处置的单位，应当向国务院核安全监督管理部门申请许可。国务院核安全监督管理部门负责批准核材料、放射性废物运输包装容器的许可申请。境外机构为境内核设施提供核安全设备设计、制造、安装和无损检验服务的，应当向国务院核安全监督管理部门申请注册。核设施操纵人员以及核安全设备焊接人员、无损检验人员等特种工艺人员应当按照国家规定取得相应资格证书。\n\n场址选择审查意见书：向国务院核安全监督管理部门提交核设施选址安全分析报告，经审查符合核安全要求后，取得核设施场址选择审查意见书。\n\n建造申请：核设施营运单位应当向国务院核安全监督管理部门提出建造申请，提交材料：①核设施建造申请书；②初步安全分析报告；③环境影响评价文件；④质量保证文件⑤其他材料。核设施建造许可证的有效期不得超过十年。\n\n运行申请：核设施首次装投料前，应向国务院核安全监督管理部门提出申请，提交材料：①核设施运行申请书；②最终安全分析报告；③质量保证文件；④应急预案；⑤其他材料。运行许可证的有效期为设计寿期，应当于有效期届满前五年，向国务院核安全监督管理部门提出延期申请。\n\n退役申请，应当向国务院核安全监督管理部门提出申请，提交材料：①核设施退役申请书；②安全分析报告；③环境影响评价文件；④质量保证文件；⑤其他材料。\n\n放射性废物应当实行分类处置：低、中水平放射性废物在国家规定的符合核安全要求的场所实行近地表或者中等深度处置高水平放射性废物实行集中深地质处置，由国务院指定的单位专营。单位应当对放射性废物进行减量化、无害化处理、处置，确保永久安全。\n\n选址规划：国务院核工业主管部门会同国务院有关部门和省、自治区、直辖市人民政府编制低、中水平放射性废物处置场所的选址规划，报国务院批准后组织实施。国务院核工业主管部门会同国务院有关部门编制高水平放射性废物处置场所的选址规划，报国务院批准后组织实施。\n\n记录保存：放射性废物处置单位应当建立放射性废物处置情况记录档案，如实记录处置的放射性废物的来源、数量、特征、存放位置等与处置活动有关的事项。记录档案应当永久保存。\n\n安全监护计划：放射性废物处置设施关闭前，放射性废物处置单位应当编制放射性废物处置设施关闭安监护计划，报国务院核安全监督管理部门批准。安全监护计划应当包括下列主要内容：①安全监护责任人及其责任；②安全监护费用；③安全监护措施；④安全监护期限。\n\n放射性废物处置设施关闭后，经国务院核安全监督管理部门会同国务院有关部门批准后，将其交由省、自治区、直辖市人民政府进行监护管理。\n\n国家对核材料、放射性废物的运输实行分类管理。（放射性物品分为一类、二类、三类）\n\n国务院核工业主管部门负责协调乏燃料运输管理活动，监督有关保密措施。\n\n公安机关对核材料、放射性废物道路运输的实物保护实施监督。\n\n通过道路运输核材料、放射性废物的，应当报启运地县级以上人民政府公安机关按照规定权限批准；通过道路运输乏燃料或者高水平放射性废物的，应当报国务院公安部门批准。\n\n核材料、放射性废物的托运人对运输中的核安全负责。\n\n核材料、放射性废物的托运人应当在运输中采取有效的辐射防护和安全保卫措施，对运输中的核安全负责。乏燃料、高水平放射性废物的托运人应当向国务院核安全监督管理部门提交有关核安全分析报告，经审查批准后方可开展运输活动。\n\n国家设立核事故应急协调委员会，组织、协调全国的核事故应急管理工作。①国务院核工业主管部门制定国家核事故应急预案，经国务院批准后组织实施。②国家核事故应急协调委员会成员单位根据国家核事故应急预案部署，制定本单位核事故应急预案，报国务院核工业主管部门备案。③省、自治区、直辖市人民政府指定的部门负责制定本行政区域内场外核事故应急预案，报国家核事故应急协调委员会审批后组织实施。④核设施营运单位负责制定本单位场内核事故应急预案，报国务院核工业主管部门、能源主管部门和省、自治区、直辖市人民政府指定的部门备案。\n\n国家对核事故应急实行分级管理。\n\n发生核事故时：核设施营运单位应当：①开展应急响应，减轻事故后果，②立即向国务院核工业主管部门、核安全监督管理部门和省、自治区、直辖市人民政府指定的部门报告核设施状况，③根据需要提出场外应急响应行动建议。国家核事故应急协调委员会按照国家核事故应急预案部署，组织协调国务院有关部门、地方人民政府、核设施营运单位实施核事故应急救援工作。国务院核工业主管部门或者省、自治区、直辖市人民政府指定的部门负责发布核事故应急信息。事故发生地省、自治区、直辖市人民政府负责应急响应。\n\n国务院核安全监督管理部门应当依法公开与核安全有关的行政许可，以及核安全有关活动的安全监督检查报告、总体安全状况、辐射环境质量和核事故等信息。\n\n国务院应当定期向全国人民代表大会常务委员会报告核安全情况。\n\n监督检查制度：国务院核安全监督管理部门可以在核设施集中的地区设立派出机构国务院核安全监督管理部门或者其派出机构应当向核设施建造、运行、退役等现场派遣监督检查人员，进行核安全监督检查。核安全监督检查人员应当具备与监督检查活动相应的专业知识和业务能力，并定期接受培训。\n\n纵深防御：是指通过设定一系列递进并且独立的防护、缓解措施或者实物屏障，防止核事故发生，减轻核事故后果。\n\n各主管部门与职能汇总\n\n\n2.1 民用核设施安全监督管理条例\n民用核设施的选址、设计、建造、运行和退役必须贯彻安全第一的方针。\n\n国家核安全局对全国核设施安全实施统一监督，独立行使核安全监督权。负责组织起草、制定有关核设施安全的规章和审查有关核安全的技术标准；\n\n核设施主管部门负责所属核设施的安全管理，接受国家核安全局的核安全监督。参与有关核安全法规的起草和制订，组织制订有关核安全的技术标准，并向国家核安全局备案组织所属核设施的场内应急计划的制订和实施，参与场外应急计划的制订和实施；组织核能发展方面的核安全科学研究工作。\n\n&quot;核设施主管部门&quot;是指对核设施营运单位负有领导责任的国务院和省、自治区、直辖市人民政府的有关行政机关。\n\n核设施营运单位对安全承担全面责任。\n\n核设施的迁移、转让或退役必须向国家核安全局提出申请，经审查批准后方可进行。\n\n资质管理：国家核安全局负责批准颁发核设施安全许可证件，包括：①核设施建造许可证；②核设施运行许可证；③核设施操纵员执照；\n\n核设施操纵员执照分《操纵员执照》和《高级操纵员执照》两种。持《操纵员执照》的人员方可担任操纵核设施控制系统的工作。持《高级操纵员执照》的人员方可担任操纵或者指导他人操纵核设施控制系统的工作。\n\n核设施营运单位有权拒绝有害于安全的任何要求，但对国家核安全局的强制性措施必须执行。\n\n\n2.2 核材料管制条例\n核材料是：铀-233、铀-235、钚-239、氚、锂-6以及含这些的材料和制品。铀矿石及其初级产品，不属于本条例管制范围。\n\n国家对核材料实行许可证制度。国家核安全局负责民用核材料的安全监督，拟订核材料管制法规；核准核材料许可证。\n\n必须申请许可证的条件：①累计的调入量式生产量大于或等于0.01有效公斤的铀、含铀材料和制品；②累计的调入量或生产量大于或等于3.7E13贝可（1000居里）的氚、含氚材料和制品；③累计的调入量或生产量大于或等于1公斤的浓缩锂、含浓缩锂材料和制品（以锂-6量计）；④任何量的钚-239、含钚-239的材料和制品。（10克铀、任意钚、千居氚、千克锂）\n\n许可证持有单位应当在当地公安部门的指导下，对生产、使用、贮存和处置核材料的场所，建立严格的安全保卫制度，\n\n运输核材料必须遵守国家的有关规定，核材料托运单位负责与有关部门制定运输保卫方案，落实保卫措施。\n\n核材料许可证持有单位对所持有的核材料负全面安全责任，直至核材料安全责任合法转移为止。\n\n核材料许可证持有单位的上级领导部门应当给所属持有单位以必要的支持和督促检查，并承担领导责任。\n\n\n2.3 核电厂核事故应急管理条例\n目的：为了加强核电厂核事故应急管理工作，控制和减少核事故危害。\n\n方针：核事故应急管理工作实行常备不懈，积极兼容，统一指挥，大力协同，保护公众，保护环境的方针。\n\n全国的核事故应急管理工作：由国务院指定的部门负责，拟定国家应急政策；统一协调全国应急工作；制定国家应急计划，审查批准场外核事故应急计划；批准进入和终止场外应急状态；审查批准核事故公报、国际通报，提出请求国际援助的方案。\n\n地区核事故应急管理工作：核电厂所在地的省、自治区、直辖市人民政府指定的部门负责本行政区域内的核事故应急管理工作。执行国家应急政策；组织制定场外核事故应急计划；指挥场外核事故应急响应行动；组织支援应急响应行动；通报核事故情况。\n\n核电厂的核事故应急机构的主要职责是：执行国家核事故应急工作的法规和政策；制定场内核事故应急计划，做好核事故应急准备工作；确定核事故应急状态等级，统一指挥本单位的核事故应急响应行动；及时向上级主管部门、国务院核安全部门和省级人民政府指定的部门报告事故情况，提出进入场外应急状态和采取应急防护措施的建议。\n\n核事故应急计划：核电厂的核事故应急机构、省级人民政府指定的部门和国务院指定的部门应当预先制定核事故应急计划。\n\n核事故应急计划包括场内核事故应急计划、场外核事故应急计划和国家核事故应急计划。各级核事故应急计划应当相互衔接、协调一致。\n\n场内核事故应急计划由核电厂核事故应急机构制定，经其主管部门审查后，送国务院核安全部门审评并报国务院指定的部门备案。\n\n场外核事故应急计划由核电厂所在地的省级人民政府指定的部门组织制定，报国务院指定的部门审查批准。\n\n国家核事故应急计划由国务院指定的部门组织制定。\n\n场内核事故应急计划、场外核事故应急计划应当包括下列内容：①核事故应急工作的基本任务；②核事故应急响应组织及其职责；③烟羽应急计划区和食入应急计划区的范围；④干预水平和导出干预水平；⑤核事故应急准备和应急响应的详细方案；⑥应急设施、设备、器材和其他物资；⑦核电厂核事故应急机构同省级人民政府指定的部门之间相互配合、支援的事项及措施。\n\n新建的核电厂必须在其场内和场外核事故应急计划审查批准后，方可装料。\n\n在核电厂首次装料前，核电厂的核事故应急机构和省级人民政府指定的部门应当组织场内、场外核事故应急演习。\n\n核事故应急状态分为下列四级：①应急待命。出现可能导致危及核电厂核安全的某些特定情况或者外部事件，核电厂有关人员进入戒备状态。②厂房应急。事故后果仅限于核电厂的局部区域，核电厂人员按照场内核事故应急计划的要求采取核事故应急响应行动，通知厂外有关核事故应急响应组织。③场区应急。事故后果蔓延至整个场区，场区内的人员采取核事故应急响应行动，通知省级人民政府指定的部门，某些厂外核事故应急响应组织可能采取核事故应急响应行动。④场外应急。事故后果超越场区边界，实施场内和场外核事故应急计划。\n\n当核电厂进入应急待命状态时，向上级主管部门和国务院核安全部门报告情况，并视情况决定是否向省级人民政府指定的部门报告。当出现可能或者已经有放射性物质释放的情况时，应当根据情况，及时决定进入厂房应急或者场区应急状态，并迅速向上级主管部门、国务院核安全部门和省级人民政府指定的部门报告情况；在放射性物质可能或者已经扩散到核电厂场区以外时，应当迅速向省级人民政府指定的部门提出进入场外应急状态并采取应急防护措施的建议。\n\n省级人民政府指定的部门接到核电厂核事故应急机构的事故情况报告后，应当迅速采取相应的核事故应急对策和应急防护措施，并及时向国务院指定的部门报告情况。需要决定进入场外应急状态时，应当经国务院指定的部门批准；在特殊情况下，省级人民政府指定的部门可以先行决定进入场外应急状态，但是应当立即向国务院指定的部门报告。\n\n核电厂的核事故应急机构和省级人民政府指定的部门应当做好核事故后果预测与评价以及环境放射性监测等工作，为采取核事故应急对策和应急防护措施提供依据。\n\n省级人民政府指定的部门应当适时选用隐蔽、服用稳定性碘制剂、控制通道、控制食物和水源、撤离、迁移、对受影响的区域去污等应急防护措施。\n\n现场核事故应急响应人员和其他人员都应当在辐射防护人员的监督和指导下活动，尽量防止接受过大剂量的照射。\n\n在核事故应急进入场外应急状态时，国务院指定的部门应当及时派出人员赶赴现场，指导核事故应急响应行动，必要时提出派出救援力量的建议。\n\n因核事故应急响应需要，可以实行地区封锁，跨省、自治区、直辖市的地区封锁，以及导致中断干线交通或者封锁国境的地区封锁，由国务院决定。\n\n有关核事故的新闻由国务院授权的单位统一发布。\n\n场外应急状态的终止由省级人民政府指定的部门会同核电厂核事故应急机构提出建议报国务院指定的部门批准，由省级人民政府指定的部门发布。\n\n省级人民政府指定的部门应当根据受影响地区的放射性水平，采取有效的恢复措施。\n\n核事故应急状态终止后，核电厂核事故应急机构应当向国务院指定的部门、核电厂的上级主管部门、国务院核安全部门和省级人民政府指定的部门提交详细的事故报告；省级人民政府指定的部门应当向国务院指定的部门提交场外核事故应急工作的总结报告。\n\n场内核事故应急准备资金由核电厂承担。场外核事故应急准备资金由核电厂和地方人民政府共同承担，资金数额由国务院指定的部门会同有关部门审定。核电厂承担的资金，在投产前根据核电厂容量、在投产后根据实际发电量确定一定的比例交纳。\n\n烟羽应急计划区，是指针对放射性烟云引起的照射而建立的应急计划区。\n\n食入应急计划区，是指针对食入放射性污染的水或者食物引起照射而建立的应急计划区\n\n干预水平，是指预先规定的用于在异常状态下确定需要对公众采取应急防护措施的剂量水平。\n\n导出干预水平，是指由干预水平推导得出的放射性物质在环境价质中的浓度或者水平。\n\n\n2.4 放射性同位素与射线装置安全和防护条例\n放射性同位素包括放射源和非密封放射性物质。\n\n国务院生态环境主管部门对全国放射性同位素、射线装置的安全和防护工作实施统一监督管理。国务院公安、卫生等部门实施监督管理。\n\n县级以上地方人民政府生态环境主管部门和其他有关部门对本行政区域内放射性同位素、射线装置的安全和防护工作实施监督管理。\n\n国家对放射源和射线装置实行分类管理,根据对人体健康和环境的潜在危害程度，从高到低，将放射源分为：I类、Ⅱ类、Ⅲ类、IV类、V类，具体分类办法由国务院生态环境主管部门制定；将射线装置分为：I类、Ⅱ类、Ⅲ类，具体分类办法由国务院生态环境主管部门与国务院卫生主管部门制定。\n\n生产、销售、使用放射性同位素和射线装置的单位，应当依照取得生态环境主管部门许可证，并自受理申请之日起20个工作日内完成审查。\n\n国务院生态环境主管部门审批颁发：除医疗使用Ⅰ类放射源、制备正电子发射计算机断层扫描用放射性药物自用的单位外，生产放射性同位素、销售和使用Ⅰ类放射源、销售和使用Ⅰ类射线装置的单位的许可证。\n\n省、自治区、直辖市人民政府生态环境主管部门审批颁发：医疗使用I类放射源；制备正电子发射计算机断层扫描用放射性药物自用的单位；使用Ⅱ类、Ⅲ类、IV类、V类放射源的单位；销售和使用Ⅱ类射线装置的单位；销售和使用Ⅲ类射线装置的单位；\n\n许可证有效期为5年。有效期届满，需要延续的，持证单位应当于许可证有效期届满30日前，向原发证机关提出延续申请。\n\n使用放射性同位素和射线装置进行放射诊疗的医疗卫生机构，还应当获得放射源诊疗技术和医用辐射机构许可。\n\n国务院对外贸易主管部门会同国务院生态环境主管部门、海关总署和生产放射性同位素的单位的行业主管部门制定并公布限制进出口放射性同位素目录和禁止进出口放射性同位素目录。\n\n进口列入限制进出口目录的放射性同位素，应当在国务院生态环境主管部门审查批准后，由国务院对外贸易主管部门依据国家对外贸易的有关规定签发进口许可证。国务院生态环境主管部门应当自受理申请之日起10个工作日内完成审查。对进口的放射源，国务院生态环境主管部门还应当同时确定与其标号相对应的放射源编码。\n\n转让放射性同位素，由转入单位向其所在地省、自治区、直辖市人民政府生态环境主管部门审批，主管部门应当自受理申请之日起15个工作日内完成审查。转出、转入单位应当在转让活动完成之日起20日内，分别向其所在地主管部门备案。\n\n生产放射性同位素的单位，应当建立放射性同位素产品台账，对生产的放射源统-编码，台账和编码清单报国务院生态环境主管部门备案。\n\n放射性同位素的包装容器、含放射性同位素的设备和射线装置，应当设置明显的放射性标识和中文警示说明。生产的放射源应当有明确标号和必要说明文件。其中，Ⅰ类、Ⅱ类、Ⅲ类放射源的标号应当刻制在放射源本体或者密封包壳体上，IV类、V类放射源的标号应当记录在相应说明文件中。\n\n持有放射源的单位将废旧放射源交回生产单位、返回原出口方或者送交放射性废物集中贮存单位贮存的，应当在该活动完成之日起20日内向其所在地省、自治区、直辖市人民政府生态环境主管部门备案。\n\n生产、进口放射源的单位销售Ⅰ类、Ⅱ类、Ⅲ类放射源给其他单位使用的，应当与使用放射源的单位签订废旧放射源返回协议；使用放射源的单位交回生产单位或者返回原出口方。确实无法交回送交有相应资质的放射性废物集中贮存单位贮存。\n\n使用放射源的单位应当按照国务院生态环境主管部门的规定，将IV类、V类废旧放射源进行包装整备后送交有相应资质的放射性废物集中贮存单位贮存。\n\n使用Ⅰ类、Ⅱ类、Ⅲ类放射源的场所和生产放射性同位素的场所，以及终结运行后产生放射性污染的射线装置，应当依法实施退役。\n\n生产、销售、使用、贮存放射性同位素和射线装置的场所，应当设置安全和防护设施以及必要的防护安全联锁、报警装置或者工作信号。射线装置的生产调试和使用场所，应当具有防止误操作、防止工作人员和公众受到意外照射的安全措施。（案例经常用）\n\n在野处进行放射性同位素示踪试验的，应当经省级以上人民政府生态环境主管部门商同级有关部门批准方可进行。\n\n使用放射性同位素和射线装置进行放射诊疗的医疗卫生机构，应当依据国务院卫生主管部门有关规定和国家标准，制定与本单位从事的诊疗项目相适应的质量保证方案，遵守质量保证监测规范，按照医疗照射正当化和辐射防护最优化的原则，避免一切不必要的照射，并事先告知患者和受检者辐射对健康的潜在影响。\n\n金属冶炼厂回收冶炼废旧金属时，监测中发现问题的，应当及时通知所在地设区的市级以上人民政府生态环境主管部门。\n\n根据辐射事故的性质、严重程度、可控性和影响范围等因素，从重到轻将辐射事故分为特别重大辐射事故、重大辐射事故、较大辐射事故和一般辐射事故四个等级。\n\n\n\n\n\n\n放射源丢失、被盗、失控\n辐射污染\n急性死亡\n急性重度放射病、局部器官残疾\n\n\n\n特别重大辐射事故\nⅠ类、Ⅱ类\n大范围严重辐射污染\n3人以上（含3人）\n\n\n\n重大辐射事故\nⅠ类、Ⅱ类\n\n2人以下（含2人）\n10人以上（含10人）\n\n\n较大辐射事故\nⅢ类\n\n\n9人以下（含9人）\n\n\n一般辐射事故\nⅣ类、Ｖ类\n\n\n人员受到超过年剂量限值\n\n\n\n县级以上人民政府生态环境主管部门应当会同同级公安、卫生、财政等部门编制辐射事故应急预案，报本级人民政府批准。\n\n生产、销售、使用放射性同位素和射线装置的单位，应当根据可能发生的辐射事故的风险，制定本单位的应急方案，做好应急准备。\n\n发生辐射事故时，单位应当立即向当地生态环境主管部门、公安部门、卫生主管部门报告。接到报告后的单位，应当立即派人赶赴现场，进行现场调查，采取有效措施，控制并消除事故影响，同时报告本级人民政府和上级人民政府生态环境主管部门、公安部门卫生主管部门。县级以工地方人民政府及其有关部门接到辐射事故报告后，应当按照事故分级报告的规定及时将辐射事故信息报告上级人民政府及其有关部门。\n\n发生特别重大辐射事故和重大辐射事故后，事故发生地省、自治区、直辖市人民政府和国务院有关部门应当在4小时内报告国务院；特殊情况下，事故发生地人民政府及其有关部门可以直接向国务院报告，并同时报告上级人民政府及其有关部门。\n\n辐射事故发生后，县级以上人民政府生态环境主管部门、公安部门、卫生主管部门，按照职责分工做好相应的辐射事故应急工作：①生态环境主管部门负责辐射事故的应急响应、调查处理和定性定级工作，协助公安部门监控追缴丢失、被盗的放射源；②公安部门负责丢失、被盗放射源的立案侦查和追缴；③卫生主管部门负责辐射事故的医疗应急。\n\n生态环境主管部门、公安部门、卫生主管部门应当及时相互通报辐射事故应急响应、调查处理、定性定级、立案侦查和医疗应急情况。国务院指定的部门根据生态环境主管部门确定的辐射事故的性质和级别，负责有关国际信息通报工作。\n\n县级以上人民政府生态环境主管部门进行监督检查，应当配备辐射防护安全监督员。辐射防护安全监督员由从事辐射防护工作，具有辐射防护安全知识并经省级以上人民政府生态环境主管部门认可的专业人员担任。\n\n\n2.5 民用核安全设备监督管理条例\n核安全设备，是指在民用核设施中使用的执行核安全功能的设备，包括核安全机械设备和核安全电气设备，民用核安全设备目录由国务院核安全监管部门商国务院有关部门制定并发布。\n\n国务院核安全监管部门对民用核安全设备设计、制造、安装和无损检验活动实施监督管理。监督检查分为例行检查和非例行检查。\n\n民用核设施营运单位，应当对在役的民用核安全设备进行检查、试验、检验和维修，并对民用核安全设备的使用和运行安全承担全面责任。\n\n民用核安全设备标准是从事民用核安全设备设计、制造、安装和无损检验活动的技术依据。民用核安全设备标准包括国家标准、行业标准和企业标准。\n\n\n\n\n\n\n\n\n\n\n\n\n国家标准-涉及核安全\n国务院核安全监管部门组织拟定\n&#x2F;\n国务院标准化主管部门和国务院核安全监管部门联合发布\n\n\n国家标准-不涉及核安全\n国务院核行业主管部门组织拟定\n国务院核安全监管部门认可\n国务院标准化主管部门发布\n\n\n行业标准\n国务院核行业主管部门组织拟定\n国务院核安全监管部门认可\n由国务院核行业主管部门发布报国务院标准化主管部门备案\n\n\n企业标准\n\n\n\n\n\n\n民用核安全设备设计、制造、安装和无损检验单位应当向国务院核安全监管部门申请领取许可证。申请单位条件之一有5年以上从事活动相关或者相近的工作业绩。申请领取设备制造许可证或者安装许可证的单位，还应当制作有代表性的模拟件。国务院核安全监管部门应当自受理申请之日起45个工作日内完成审查。\n\n民用核安全设备设计、制造、安装和无损检验许可证有效期为5年，效期届满6个月前，向国务院核安全监管部门提出延续申请。\n\n民用核设施营运单位，应当对民用核安全设备设计、制造、安装和无损检验活动进行质量管理（编制质量保证大纲&#x2F;总纲）和过程控制，做好监造和验收工作。\n\n民用核安全设备设计、制造、安装和无损检验单位，应当根据其质量保证大纲和民用核设施营运单位的要求，在民用核安全设备设计、制造、安装和无损检验活动开始前编制项目质量保证分大纲，并经民用核设施营运单位审查同意。\n\n民用核安全设备设计单位，应当在设计活动开始30日前，将下列文件报国务院核安全监管部门备案：①项目设计质量保证分大纲和程序清单；②设计内容和设计进度计划；③设计遵循的标准和规范目录清单，设计中使用的计算机软件清单；④设计验证活动清单。\n\n民用核安全设备制造、安装单位，应当在制造、安装活动开始30日前，将下列文件报国务院核安全监管部门备案：①项目制造、安装质量保证分大纲和程序清单；②制造、安装技术规格书；③分包项目清单；④制造、安装质量计划。\n\n民用核安全设备设计、制造、安装和无损检验单位，不得将国务院核安全监管部门确定的关键工艺环节分包给其他单位。\n\n民用核安全设备焊工、焊接操作工和无损检验人员由国务院核安全监管部门核准颁发资格证书。\n\n民用核安全设备无损检验单位和无损检验人员对无损检验结果报告负责。\n\n民用核安全设备设计单位应当对其设计进行设计验证。设计验证由未参与原设计的专业人员进行。设计验证可以采用设计评审、鉴定试验或者不同于设计中使用的计算方法的其他计算方法等形式。\n\n民用核安全设备设计、制造、安装和无损检验单位，应当于每年4月1日前向国务院核安全监管部门提交上一年度的评估报告。\n\n境外单位应在国内开展活动：应取得所在国核安全监管部门规定的相应资质；技术是成熟的或者经过验证的；采用我国国家标准、行业标准或者国务院核安全监管部门认可的标准；到国务院核安全监管部门办理注册登记手续。\n\n\n\n\n\n\n\n\n\n\n\n\n设计单位\n质保大纲、程序清单设计内容及计划标准规范清单、软件清单设计验证活动清单\n设计开始前30日\n国务院核安全监管部门备案\n\n\n制造、安装和无损单位\n质保大纲、程序清单技术规格书分包清单制造安装质量计划\n制造、安装前30日\n国务院核安全监管部门备案\n\n\n设计、制造、安装和无损\n年度评估报告\n每年4月1日\n国务院核安全监管部门报告\n\n\n2.6 放射性物品运输安全管理条例\n范围：放射性物品的运输和运输容器的设计、制造等活动。放射性物品是指含有放射性核素，并且其活度和比活度均高于国家规定的豁免值的物品。\n\n根据放射性物品的特性及其对人体健康和环境的潜在危害程度，将放射性物品分为一类、二类和三类。①一类放射性物品，是指Ⅰ类放射源、高水平放射性废物、乏燃料等释放到环境后对人体健康和环境产生重大辐射影响的放射性物品。②二类放射性物品，是指Ⅱ类和Ⅲ类放射源、中等水平放射性废物等释放到环境后对人体健康和环境产生一般辐射影响的放射性物品。③三类放射性物品，是指IV类和V类放射源、低水平放射性废物、放射性药品等释放到环境后对人体健康和环境产生较小辐射影响的放射性物品。\n\n\n\n\n\n\n\n\n\n\n\n一类放射性物品\nⅠ类放射源、高水平放射性废物、乏燃料\n重大辐射影响\n\n\n二类放射性物品\nⅡ类和Ⅲ类放射源、中等水平放射性废物\n一般辐射影响\n\n\n三类放射性物品\nⅣ类和Ⅴ类放射源、低水平放射性废物、放射性药品\n较小辐射影响\n\n\n\n国务院核安全监管部门对放射性物品运输的核与辐射安全实施监督管理。\n\n县级以上地方人民政府环境保护主管部门和公安、交通运输等有关主管部门，依照本条例规定和各自的职责，负责本行政区域放射性物品运输安全的有关监督管理工作。\n\n放射性物品的运输和放射性物品运输容器的设计、制造，应符合国家放射性物品运输安全标准，该标准由国务院核安全监管部门制定，由国务院核安全监管部门和国务院标准化主管部门联合发布。\n\n放射性物品的托运人应当制定核与辐射事故应急方案，在放射性物品运输中采取有效的辐射防护和安全保卫措施，并对放射性物品运输中的核与辐射安全负责。\n\n放射性物品运输容器设计单位进行一类放射性物品运输容器设计，应当编制设计安全评价报告书；进行二类放射性物品运输容器设计，应当编制设计安全评价报告表。\n\n一类运输容器的设计，应当在首次用于制造前报国务院核安全监管部门审查批准，45个工作日内完成审查。\n\n一类审批：设计单位应当向国务院核安全监管部门提出书面申请，并提交材料：设计总图及其设计说明书；设计安全评价报告书；质量保证大纲。审核机构45个工作日内完成审查。\n\n二类备案：设计单位应当在首次用于制造前，将设计总图及其设计说明书、设计安全评价报告表报国务院核安全监管部门备案。\n\n三类存档：放射性物品运输容器的设计，设计单位应当编制设计符合国家放射性物品运输安全标准的证明文件并存档备查。\n\n一类放射性物品运输容器制造单位（许可）：应当向国务院核安全监管部门申请领取-类放射性物品运输容器制造许可证及制造的运输容器型号，审核机构45个工作日内完成审查申请制造许可证提交以下证明材料：①有与所从事的制造活动相适应的专业技术人员；②有与所从事的制造活动相适应的生产条件和检测手段；③有健全的管理制度和完善的质量保证体系。\n\n制造许可证有效期为5年，需要延续的，一类放射性物品运输容器制造单位应当于制造许可证有效期届满6个月前向审核机构提出申请。\n\n二类放射性物品运输容器制造单位（备案）：应当在首次制造活动开始30日前，将其具备与所从事的制造活动相适应的专业技术人员、生产条件、检测手段，以及具有健全的管理制度和完善的质量保证体系的证明材料，报国务院核安全监管部门备案。\n\n编码：一类、二类放射性物品运输容器制造单位，应当对其制造的一类、二类放射性物品运输容器统一编码，并于每年1月31日前将上一年度的运输容器编码清单报国务院核安全监管部门备案。三类单位应当于每年1月31日前将上一年度制造的运输容器的型号和数量报国务院核安全监管部门备案。\n\n一类放射性物品运输容器使用单位还应当对其使用的一类放射性物品运输容器每两年进行一次安全性能评价，并将评价结果报国务院核安全监管部门备案。\n\n使用境外单位制造的一类放射性物品运输容器的，应当在首次使用前报国务院核安全监管部门审查批准（二类备案）。并提交下列材料：①设计单位所在国核安全监管部门颁发的设计批准文件；②设计安全评价报告书；③业绩的证明材料；④质量合格证明；⑤符合我国相关法规标准的说明材料。审核部门自受理申请之日起45个工作日内完成审查。\n\n托运一类放射性物品的，托运人应当委托有资质的辐射监测机构对其表面污染和辐射水平实施监测，辐射监测机构应当出具辐射监测报告。托运二类、三类放射性物品的，托运人应当对其表面污染和辐射水平实施监测，并编制辐射监测报告。\n\n托运人和承运人应当对直接从事放射性物品运输的工作人员进行运输安全和应急响应知识的培训，并进行考核。\n\n托运人和承运人应当在放射性物品运输容器和运输工具上设置警示标志。\n\n国家利用卫星定位系统对一类、二类放射性物品运输工具的运输过程实行在线监控。\n\n托运人和承运人应当按照国家职业病防治的有关规定，对直接从事放射性物品运输的工作人员进行个人剂量监测，建立个人剂量档案和职业健康监护档案。\n\n托运人应当向承运人提交运输说明书、辐射监测报告、核与辐射事故应急响应指南、装卸作业方法、安全防护指南，承运人应当查验、收存。\n\n托运一类放射性物品的，托运人应当编制放射性物品运输的核与辐射安全分析报告书报国务院核安全监管部门审查批准，45个工作日内完成审查。放射性物品运输的核与辐射安全分析报告书应当包括放射性物品的品名、数量、运输容器型号、运输方式、辐射防护措施、应急措施等内容。\n\n一类放射性物品启运前，托运人应当将放射性物品运输的核与辐射安全分析报告批准书、辐射监测报告，报启运地的省、自治区、直辖市人民政府环境保护主管部门备案。\n\n通过道路运输放射性物品的，应当经公安机关批准，按照指定的时间、路线、速度行驶，并悬挂警示标志，配备押运人员，使放射性物品处于押运人员的监管之下。通过道路运输核反应堆乏燃料的，托运人应当报国务院公安部门批准。通过道路运输其他放射性物品的，托运人应当报启运地县级以上人民政府公安机关批准。\n\n禁止邮寄一类、二类放射性物品。邮寄三类放射性物品的，按照国务院邮政管理部门的有关规定执行。\n\n生产、销售、使用或者处置放射性物品的单位，可以向设区的市级人民政府道路运输管理机构申请非营业性道路危险货物运输资质，运输本单位的放射性物品，并承担本条例规定的托运人和承运人的义务。\n\n一类放射性物品从境外运抵中华人民共和国境内，或者途经中华人民共和国境内运输的，托运人应当编制放射性物品运输的核与辐射安全分析报告书，报国务院核安全监管部门审查批准。二类、三类放射性物品开展以上活动托运人应当编制放射性物品运输的辐射监测报告，报国务院核安全监管部门备案。\n\n县级以上人民政府组织编制的突发环境事件应急预案，应当包括放射性物品运输中可能发生的核与辐射事故应急响应的内容。\n\n放射性物品运输中发生核与辐射事故的，承运人、托运人应当立即报告事故发生地的县级以上人民政府环境保护主管部门，环境保护主管部门应当立即派人赶赴现场，进行现场调查，采取有效措施控制事故影响，并及时向本级人民政府报告，通报同级公安、卫生、交通运输等有关主管部门。\n\n\n2.7 放射性废物安全管理条例\n放射性废物的处理：是指为了能够安全和经济地运输、贮存、处置放射性废物，通过净化、浓缩、固化、压缩和包装等手段，改变放射性废物的属性、形态和体积的活动。\n\n放射性废物贮存：是指将废旧放射源和其他放射性固体废物临时放置于专门建造的设施内进行保管的活动。\n\n放射性废物处置：是指将废旧放射源和其他放射性固体废物最终放置于专门建造的设施内并不再回取的活动。\n\n放射性废物的安全管理，应当坚持减量化、无害化和妥善处置、永久安全的原则。\n\n国务院环境保护主管部门统一负责全国放射性废物的安全监督管理工作。\n\n县级以上地方人民政府环境保护主管部门负责本行政区域放射性废物的有关管理工作。\n\n国家对放射性废物实行分类管理。根据放射性废物的特性及其对人体健康和环境的潜在危害程度，将放射性废物分为高水平放射性废物、中水平放射性废物和低水平放射性废物。\n\n核设施营运单位应当将不能回收利用并不能返回原生产单位或者出口方的废旧放射源，送交集中贮存或处置。\n\n核设施营运单位、核技术利用单位应当不能经净化排放的放射性废液转变为稳定的、标准化的固体废物贮存，或送交取得相应许可证的放射性固体废物处置单位处置。\n\n放射性固体废物应当向国务院环境保护主管部门申请领取贮存许可证，需提交证明材料之一为：健全的管理制度以及符合核安全监督管理要求的质量保证体系，包括质量保证大纲、贮存设施运行监测计划、辐射环境监测计划和应急方案等。主管部门应当自受理申请之日起20个工作日内完成审查。\n\n与核设施配套建设的贮存设施，贮存本单位产生的放射性固体废物的，不需要申请领取贮存许可证，贮存其他单位的则需要。\n\n放射性固体废物贮存许可证的有效期为10年，许可证有效期届满90日前，向国务院环境保护主管部门提出延续申请。\n\n放射性固体废物贮存单位应当按照国家有关放射性污染防治标准和国务院环境保护主管部门的规定，对其接收的废旧放射源和其他放射性固体废物进行分类存放和清理，及时予以清洁解控或者送交取得相应许可证的放射性固体废物处置单位处置。\n\n放射性固体废物贮存单位应当根据贮存设施的自然环境和放射性固体废物特性采取必要的防护措施，保证在规定的贮存期限内贮存设施、容器的完好和放射性固体废物的安全，并确保放射性固体废物能够安全回取。\n\n放射性固体废物贮存单位应当根据贮存设施运行监测计划和辐射环境监测计划，对贮存设施进行安全性检查，并对贮存设施周围的地下水、地表水、土壤和空气进行放射性监测。\n\n将废旧放射源和其他放射性固体废物送交放射性固体废物贮存、处置单位贮存、处置时，送交方应当一并提供放射性固体废物的种类、数量、活度等资料和废|旧放射源的原始档案，并按照规定承担贮存、处置的费用。\n\n国务院核工业行业主管部门会同国务院环境保护主管部门根据地质、环境、社会经济条件和放射性固体废物处置的需要，在进行环境影响评价的基础上编制放射性固体废物处置场所选址规划，报国务院批准后实施。\n\n建造放射性固体废物处置设施，应当按照放射性固体废物处置场所选址技术导则和标准的要求，与居住区、水源保护区、交通干道、工厂和企业等场所保持严格的安全防护距离，并对场址的地质构造、水文地质等自然条件以及社会经济条件进行充分研究论证。\n\n建造放射性固体废物处置设施，应当符合放射性固体废物处置场所选址规划，并依法办理选址批准手续和建造许可证。\n\n高水平放射性固体废物和α放射性固体废物深地质处置设施的工程和安全技术研究、地下实验、选址和建造，由国务院核工业行业主管部门组织实施。\n\n专门从事放射性固体废物处置活动的单位，应当符合下列条件，并依照本条例的规定申请领取放射性固体废物处置许可证：\n\n①有国有或者国有控股的企业法人资格；\n②低、中水平放射性固体废物处置单位应当具有10名以上放射性废物管理、辐射防护、环境监测方面的专业技术人员，其中至少有3名注册核安全工程师；高水平放射性固体废物和α放射性固体废物处置单位应当具有20名以上放射性废物管理、辐射防护、环境监测方面的专业技术人员，其中至少有5名注册核安全工程师；\n③低、中水平放射性固体废物处置设施关闭后应满足300年以上的安全隔离要求；高水平放射性固体废物和α放射性固体废物深地质处置设施关闭后应满足1万年以上的安全隔离要求；\n④低、中水平放射性固体废物处置单位的注册资金应不少于3000万元；高水平放射性固体废物和α放射性固体废物处置单位的注册资金应不少于1亿元；\n⑤有能保证其处置活动持续进行直至安全监护期满的财务担保；\n⑥有健全的管理制度以及符合核安全监督管理要求的质量保证体系。\n\n\n放射性固体废物处置单位应当建立放射性固体废物处置情况记录档案，如实记录处置的放射性固体废物的来源、数量、特征、存放位置等与处置活动有关的事项。放射性固体废物处置情况记录档案应当永久保存。\n\n放射性固体废物处置单位应当根据处置设施运行监测计划和辐射环境监测计划，对处置设施进行安全性检查，并对处置设施周围的地下水、地表水、土壤和空气进行放射性监测。\n\n放射性固体废物处置单位发现安全隐患或者周围环境中放射性核素超过国家规定的标准的，应当立即向国务院环境保护主管部门和核工业行业主管部门报告（贮存单位发现问题向省级环境保护主管部门报告）。构成辐射事故的，应当立即启动本单位的应急方案，并依照《**中华人民共和国放射性污染防治法》《放射性同位素与射线装置安全和防护条例》**的规定进行报告，开展有关事故应急工作。\n\n放射性固体废物处置设施服役期届满、已达到设计容量、地质条件发生重大变化关闭应当编制处置设施安全监护计划，报国务院环境保护主管部门批准。\n\n放射性固体废物处置单位应当于每年3月31日前，向国务院环境保护主管部门和核工业行业主管部门如实报告上一年度放射性固体废物接收、处置和设施运行等情况。\n\n\n3.001.1-3 核动力厂研究堆核燃料循环设施安全许可程序规定\n核设施营运单位申请核设施安全许可及变更、延续，报国家核安全局审查批准。\n\n核设施营运单位应当具备保障核设施安全运行的能力，并符合以下条件：组织管理体系及制度、技术人员和管理人员、安全评价和资源财务能力、技术支撑和持续改进能力、应急响应和赔偿保障能力、其他。\n\n核设施营运单位应当按照有关核设施场址选择的要求完成核设施场址的安全评估论证，并在满足核安全技术评价要求的前提下，向国家核安全局提交核设施场址选择审查申请书和核设施选址安全分析报告，经审查符合核安全要求后，取得核设施场址选择审查意见书。\n\n核设施营运单位取得核设施建造许可证后，方可按照核设施建造许可证规定的范围和条件从事相关的建造活动。核设施建造许可证的有效期不得超过十年。建造申请时提交材料：①核设施建造申请书；②初步安全分析报告；③环境影响评价文件；④质量保证文件；⑤其他材料。\n\n核设施首次装投料前，核设施营运单位应当向国家核安全局提出运行申请，核设施运行许可证的有效期为设计寿期，申请时提交材料：①核设施运行申请书；②最终安全分析报告；③质量保证文件；④应急预案；⑤其他材料。\n\n运行许可证有效期内，核设施营运单位应当按照要求对核设施进行定期安全评价，评价周期根据核设施具体情况和核安全法规和标准的变化情况确定，一般为十年。评价结果应当提交国家核安全局审查。\n\n核设施营运单位取得核设施运行许可证后，应当按照批准的调试大纲所确定的顺序、方法等要求完成调试试验项目。所有调试试验项目完成后两个月内，向国家核安全局提交调试报告。\n\n国家核安全局对核设施首次装投料以及装投料后的重要调试活动，可以设置控制点。\n\n拟转让核设施的，由持有核设施安全许可证的核设施营运单位和核设施拟受让单位共同向国家核安全局提出申请，并提交以下材料：①转让核设施的申请书；②核设施拟受让单位质量保证文件；③核设施拟受让单位应急预案；④其他需要申明的事项。\n\n迁移核设施的，核设施营运单位应当向国家核安全局提出申请，并提交下列材料：①核设施迁移申请书；②新场址的选址安全分析报告；③新场址的环境影响报告书；④新场址的应急预案；⑤核设施迁移活动的质量保证文件；⑥核设施安全分析报告相关内容的修订文件；⑦其他材料。\n\n核设施退役前，核设施营运单位应向国家核安全局提出退役申请，并提交下列材料：①核设施退役申请书；②退役安全分析报告；③环境影响评价文件；④质量保证文件；⑤其他材料。\n\n国家核安全局对核设施安全许可申请组织安全技术审查。技术审查内容包括申请材料与法规标准的符合情况、分析计算结果复核、试验结果审核等。技术审查流程包括文件审查、校核计算、试验验证、技术交流和专家咨询等。在技术审查完成之日起二十个工作日内，依法作出准予许可的决定。\n\n核设施建造许可证有效期届满三十日前，向国家核安全局办理延期手续\n\n核设施营运单位调整下列事项的，应当报国家核安全局批准：①作为颁发运行许可证依据的重要构筑物、系统和设备；②运行限值和条件；③国家核安全局批准的与核安全有关的程序和其他文件。\n\n核设施运行许可证有效期届满前五年，向国家核安全局提出延续申请。\n\n核设施运行许可证有效期延续的期限按照核设施的实际状态和安全评估情况确定，但每次不超过二十年。\n\n\n核动力厂、研究堆、核燃料循环设施许可申请及审批\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n选址\n建造\n运行(首次装投料)\n退役\n转让\n迁移\n\n\n申请材料\n营运单位\n营运单位\n营运单位\n营运单位\n原单位+受让单位\n营运单位\n\n\n1\n选择审查申请\n建造申请书\n运行申请书\n退役申请书\n转让申请书\n迁移申请书\n\n\n2\n选址安分报告\n初步安分报告\n最终安分报告\n安全分析报告\n&#x2F;\n新址选址安分\n\n\n\n\n调试大纲可后补\n维修检查换料大纲后补\n\n\n\n\n\n3\n环评文件\n环评文件\n&#x2F;\n环评文件\n&#x2F;\n新址环境影响报告书\n\n\n4\n&#x2F;\n&#x2F;\n应急预案\n&#x2F;\n受让单位应急预案\n新址应急预案\n\n\n5\n&#x2F;\n质量保证文件\n质量保证文件\n质量保证文件\n受让单位质量保证\n迁移质保文件\n\n\n6\n&#x2F;\n其他材料\n其他材料\n其他材料\n其他材料\n安分修订文件、其他材料\n\n\n审批单位\n国家核安全局\n国家核安全局\n国家核安全局\n国家核安全局\n国家核安全局\n国家核安全局\n\n\n取得证书\n审查意见书\n建造许可证\n运行许可证\n退役批准书\n重新颁发许可证，同时注销原证\n批准\n\n\n有效期延续\n\n十年\n设计寿期\n\n\n\n\n\n\n\n\n延寿：退役前五年，每次不超过二十年\n\n\n\n\n\n备注\n\n\n营运单位定期安全评价（每十年）\n\n\n\n\n\n3.001.1.1 民用核设施操作人员资格管理规定\n持有《操作员执照》的人员方可担任操作核设施控制系统的工作； 持有《高级操作员执照》的人员方可担任操作或者指导他人操作核设施控制系统的工作。\n\n国务院核安全监督管理部门负责批准颁发执照。\n\n国务院核安全监督管理部门组织研究堆和后处理设施操作人员执照培训和考核；\n\n国务院能源主管部门负责组织核动力厂操作人员执照培训和考核。\n\n申请核动力厂《高级操作员执照》的人员规定的成绩优秀应当包括担任操作员两年内参加运行值班至少一千六百小时的条件。\n\n申请研究堆和后处理设施执照的人员，由承担执照申请工作的单位组织向国务院核安全监督管理部门提交申请材料。\n\n申请核动力厂执照的人员，应当先参加国务院能源主管部门组织的执照培训和考核，并通过国务院能源主管部门审查后，由承担执照申请工作的单位组织向国务院核安全监督管理部门提交申请材料。\n\n执照有效期为五年，在执照有效期届满三个月前申请延续执照。申请变更、延续核动力厂执照的，还应当提交国务院能源主管部门的审查意见。\n\n申请延续执照的人员，执照有效期内工作成绩符合规定的，可以免予笔试，仅参加口试和操作考试；其中核动力厂操作人员的工作成绩中应当包括参加运行值班至少两干小时的条件。\n\n核动力厂培训大纲应当由国务院能源主管部门审定。研究堆和后处理设施培训大纲应当由国务院核安全监督管理部门审定。\n\n核动力厂操作人员考核标准由国务院能源主管部门制定，国务院核安全监督管理部门核准。研究堆、后处理设施考核标准由国务院核安全监督管理部门制定。\n\n操作人员岗位配置应当满足安全运行需要，并在核设施营运单位提交给国务院核安全监督管理部门的最终安全分析报告中予以明确。\n\n核动力厂、Ⅰ类和Ⅱ类研究堆、后处理设施的运行值班负责人应当具有两个以上操作人员岗位工作的经历，且持有《高级操作员执照》。\n\n核动力厂、Ⅰ类和Ⅱ类研究堆、后处理设施运行部门的主要负责人和分管运行的负责人立当具有担任运行值班负责人的经历，且至少一人持有所在核设施《高级操作员执照》。\n\n持有《高级操作员执照》的核动力厂运行部门负责人，运行值班应当同时满足下列条件：①每十二个月参加运行值班至少一百小时；②执照有效期内执行或者指导过启动、升降功率、换料运行等重要工作。\n\nⅢ类研究堆运行部门的负责人中应当至少有一人持有《操作员执照》或者《高级操作员执照》。\n\n核动力厂操作人员的运行值班应当同时满足下列条件：①每十二个月参加运行值班至少四百小时；②每六个月参加运行值班至少一百五十小时。\n\n国务院核安全监督管理部门对操作人员资格管理有关工作进行监督检查。监督检查主要通过文件审查、现场检查、记录确认或者谈话等方式进行，必要时可以抽查复验。\n\n\n3.001.2 核设施的安全监督\n安全监督目的：通过检查核安全管理要求和许可证件规定条件的履行情况，督促纠正不符合核安全管理要求和许可证件规定条件的事项，必要时可采取强制性措施，以保障核设施的安全。\n\n国家核安全部门的监督并不减轻核设施营运单位及有关单位对核设施所承担的核安全责任。\n\n核安全监督由国家核安全局及其地区监督站组织实施。\n\n国家核安全局在核安全监督工作中负领导责任，其部分主要职责为：①负责培训、考核核安全监督员及监督操纵人员资格的考核工作。②组织编制全国核设施的年度检查计划，批准地区监督站年度检查计划；③组织编制核设施监督项目表、监督检查大纲、检查程序等监督文件；④负责组织由局实施的例行核安全检查和非例行核安全检查；⑤负责组织对重大不符合项和核安全相关事件等进行评价；⑥监督操纵人员资格的考核工作；⑦负责建立核设施运行状态数据库、事件库。\n\n地区监督站负责派驻区核设施的核安全监督，主要职责为：①编制和实施辖区内核设施的年度检查计划；②负责向核设施现场派遣并管理核安全检查组和核安全监督员；③负责日常核安全检查，组织由站实施的或参加由局实施的例行核安全检查和非例行核安全检查；④检查与督促营运单位执行报告制度；⑤参与检查操纵人员资格的考核工作；⑥评价或参与评价不符合项、核安全相关事件及核设施的安全状况；⑦处理违反核安全管理要求和许可证件规定条件的事项。\n\n核安全检查可以分为日常的、例行的和非例行（特殊）的检查。非例行的检查可以是事先通知或事先不通知的。事先通知的检查一般在检查前一个月通知营运单位和&#x2F;或有关单位，以便做好准备和安排。\n\n核安全检查由核安全检查组、核安全监督员或受委托人员进行。核安全检查主要方法为：文件检查、现场观察、座谈和采访、测量或试验：\n\n日常核安全检查是由现场核安全监督员所作的检查。现场核安全监督员应对影响核安全的重要活动、物项和记录进行检查，并做好检查记录。\n\n例行核安全检查是核安全检查组或核安全监督员对营运单位在核设施选址、设计、建造、调试、运行、退役各阶段的安全重要活动所进行的有计划的核安全检查。程序如下：准备工作、检查前会议、检查的实施、检查后会议、检查报告、后续行动。\n\n非例行核安全检查是国家核安全局或地区监督站根据工作需要进行的检查，是对意外的、非计划的或异常的情况或事件的响应。非例行参照例行核安全检查的程序实施。\n\n国家核安全局根据工作需要，在核设施建造、调试和运行阶段选定控制点和见证试验项目。\n\n营运单位必须执行核设施营运单位报告制度。报告制度包括：定期报告；重要活动通知；建造阶段事件报告；运行阶段事件报告；核事故应急报告。\n\n国家核安全部门：国家核安全局及其地区监督站系统称国家核安全部门。\n\n\n3.001.2.1 核动力厂营运单位核安全报告规定\n核动力厂营运单位对核安全负有全面责任，应当执行核安全报告制度，按规定的要求向国家核安全局或者核动力厂所在地区核与辐射安全监督站提交：定期报告、重要活动报告、建造阶段事件报告、运行阶段事件报告和核事故应急报告。\n\n核动力厂营运单位定期报告包括：建造阶段月度报告、运行阶段月度报告、安全性能指标季度报告、建造阶段年度报告、运行阶段年度报告和设备可靠性数据年度报告。\n\n核动力厂营运单位应当从取得建造许可证之日起至取得运行许可证之日止，每个月第十个工作日前，向核动力厂所在地区核与辐射安全监督站提交上个月建造情况的月度报告。从取得运行许可证之日起，至取得退役批准书之日止，在每个月第十个工作日前，向核动力厂所在地区核与辐射安全监督站提交上个月运行情况的月度报告。\n\n核动力厂营运单位应当从取得运行许可证之日起，至取得退役批准书之日止，每个季度第一个月第十个工作日前，向国家核安全局提交前一季度核动力厂安全性能指标季度报告。\n\n核动力厂营运单位应当在每年4月1日前，向国家核安全局提交前一年度建造或者运行情况的年度报告。\n\n核动力厂营运单位应当从取得运行许可证并完成首次换料大修之日的次日起，至取得退役批准书之日止，在每年6月1日前，向国家核安全局提交前一年度的核动力厂设备可靠性数据年度报告。\n\n核动力厂营运单位应当在建造事件（运行事件）发生或者发现后二十四小时内，口头通告国家核安全局和核动力厂所在地区核与辐射安全监督站。\n\n核动力厂营运单位应当在建造事件（运行事件）发生或者发现后三日内，向国家核安全局和核动力厂所在地区核与辐射安全监督站提交书面通告。\n\n核动力厂营运单位应当在建造事件（运行事件）发生或者发现后三十日内，向国家核安全局提交建造事件极告。\n\n核动力厂进入应急状态、应急状态变更或者应急状态终止后15分钟内，向国家核安全局和核动力厂所在地区核与辐射安全监督站发出核事故应急通告。\n\n核动力厂进入厂房应急或者高于厂房应急状态后1小时内，向国家核安全局和核动力厂所在地区核与辐射安全监督站发出核事故应急报告。\n\n同一应急状态下，核动力厂言运单位连续两次发出核事故应急报告的时间间隔不应超过一小时；事故态势得到控制后，应急报告的时间间隔不得超过四小时。\n\n核动力厂应急状态终止后三十日内，核动力厂营运单位应当向国家核安全局提交核动力厂核事故最终评价报告，并在核事故最终评价报告中对核事件或者事故进行分级。\n\n事件或者事故分级，是指按照国际核事件分级标准（INES）对运行事件或者事故进行的分级。将核事件分为七级，分别为：\n\n1级：异常；\n2级：一般事件；\n3级：重要事件；\n4级：较高级别称为事故，分别为影响范围有限的事故；\n5级：影响范围较大的事故；\n6级：重要事故；\n7级：重大事故；\n较低级别称为事件（1-3级）；较高级别称为事故（4-7级）\n\n\n核事故应急状态分为：应急待命、厂房应急、场区应急和场外应急四级。\n\n\n3.001.2.2 研究堆营运单位报告制度\n&quot;研究堆&quot;是指主要用于产生和利用中子注量率和电离辐射作研究和其他目的用的核反应堆，包括临界装置。\n\n研究堆建造阶段季度报告：从领到建造许可证件之日起到首次装料止，营运单位必须以公函形式在每个季度的第一个月最后一天以前，向所在地区监督站递交前一季度的建造情况总结报告，同时抄送国家核安全局。\n\n研究堆运行阶段月度报告：即从首次装料开始到退役止，营运单位必须以公函形式在每月10日以前向所在地区监督站递交上个月运行情况的总结报告，同时抄送国家核安全局。\n\n研究堆年度报告：营运单位必须以公函形式在每年4月1日以前向所在地区监督站递交前一年的年度总结报告，同时抄送国家核安全局。\n\n在研究堆进行重要活动时，营运单位必须提前7天以有效方式通告到所在地区监督站或国家核安全局。\n\n建造阶段、运行阶段事件通告：分为口头通告和书面通告。①口头通告：营运单位必须在事件发现后24小时内口头通告国家核安全局和所在地区监督站。②书面通告：营运单位必须在事件发现后三天内向国家核安全局和所在地区监督站递交书面通告\n\n建造阶段、运行阶段事件报告：研究堆营运单位必须以公函形式在事件发现后30天内向国家核安全局和所在地区监督站递交事件报告。\n\n安全评定是对相应事件的分析结论，包括事件的性质、事件对安全的危害及潜在后果。\n\n在研究堆发生核事故时，营运单位必须在进入厂房应急状态后30分钟内向国家核安全局和所在地区监督站报告发出应急通告。进入厂房应急状态后1小时内向国家核安全局应急中心和所在地区监督站发出应急报告，在初始报告发出后，每隔2小时向国家核安全局应急中心和所在地区监督站发一次后续报告。\n\n在事故源项或应急状态级别变更时，应立即向国家核安全局应急中心和所在地区监督站发后续报告。然后，每隔2小时发一次后续报告。\n\n在核事故势态得到控制后，每隔6小时用电话传真方式向国家核安全局应急中心和所在地区监督站发一次后续报告。直至退出应急状态为止。\n\n营运单位必须在退出应急状态以后30天内向国家核安全局和所在地区监督站提交核事故最终评价报告。\n\n\n3.001.2.3 核燃料循环设施的报告制度\n核设施营运单位必须执行核设施营运单位报告制度。报告制度包括：定期报告；重要活动通知；建造阶段事件报告；运行阶段事件报告；核事故应急报告。\n\n核燃料循环设施的建造阶段季度报告，即从领到建造许可证之日起至冷调试结束止，营运单位必须以公函形式在每一季度的第一个月内向所在地区监督站递交前一季度的建造情况总结报告，同时抄送国家核安全局。\n\n核燃料循环设施的运行阶段月度报告，即从热调试之日起，营运单位必须以公函形式在每一个月的10日前向所在地区监督站递交上个月运行情况的总结报告。同时抄送国家核安全局。\n\n核燃料循环设施年度报告必须以公函形式在下一年度的4月1日前向所在地区监督站递交前一年的年度总结报告。同时抄送国家核安全局。\n\n在核燃料循环设施进行重要活动时，营运单位必需提前7天以有效方式通告到所在地区监督站或国家核安全局。\n\n事件通告：核燃料循环设施营运单位必须在事件发生后三天内向国家核安全局和所在地区监督站发出书面通告。\n\n事件报告：核燃料循环设施营运单位必须以公函形式在事件发生后30天内向国家核安全局和所在地区监督站递交事件报告。\n\n应急通告：核燃料循环设施发生核事故时，营运单位必须在发生核事故并进入应急状态1小时内，向国家核安全局应急中心和所在地区监督站发出应急通告。\n\n应急报告：核燃料循环设施发生核事故时，营运单位必须在核事故的势态得到控制后用传真向国家核安全局应急中心和所在地区监督站发出后续报告。\n\n\n核动力厂、研究堆、核燃料循环设施报告汇总\n\n\n\n报告类别\n适用阶段\n核动力厂\n研究堆\n核燃料循环设施\n\n\n\n一、定期报告\n1. 建造阶段月度&#x2F;季度报告\n适用区间：建造许可-运行许可频次：每月第10个工作日报送对象：监督站\n适用区间：建造许可-首次装料频次：每季度第一个月（季度报告）报送方式：公函报监督站、抄国家核安全局\n适用区间：建造许可-冷调试结束频次：每季度第一个月（季度报告）报送方式：公函报监督站、抄国家核安全局\n\n\n\n2. 运行阶段月度报告\n适用区间：运行许可-退役批准频次：每月第10个工作日报送对象：监督站\n适用区间：首次装料-退役频次：每月10日前报送方式：公函报监督站、抄国家核安全局\n适用区间：热调试开始起频次：每月10日前报送方式：公函报监督站、抄国家核安全局\n\n\n\n3. 安全性能指标季度报告\n适用区间：运行许可-退役批准频次：每季度第一月第10个工作日报送对象：国家核安全局\n不适用\n不适用\n\n\n\n4. 建造阶段年度报告\n适用区间：建造许可-运行许可报送时间：每年4月1日报送对象：国家核安全局\n适用区间：建造许可-首次装料报送时间：每年4月1日报送方式：公函报监督站、抄国家核安全局\n适用区间：建造阶段报送时间：每年4月1日报送方式：公函报监督站、抄国家核安全局\n\n\n\n5. 运行阶段年度报告\n适用区间：运行许可-退役批准报送时间：每年4月1日报送对象：国家核安全局\n适用区间：首次装料-退役报送时间：每年4月1日报送方式：公函报监督站、抄国家核安全局\n适用区间：运行阶段报送时间：每年4月1日报送方式：公函报监督站、抄国家核安全局\n\n\n\n6. 设备可靠性数据年度报告\n适用区间：运行许可且首次换料大修次日-退役批准报送时间：每年6月1日报送对象：国家核安全局\n不适用\n不适用\n\n\n二、重要活动报告\n适用区间：选址批复-退役批准覆盖范围：未纳入月度报告的重要活动报送方式：电子邮件报所在地监督站\n适用区间：全周期要求：提前7天以有效方式通告监督站或国家核安全局\n适用区间：全周期要求：提前7天以有效方式通告监督站或国家核安全局\n\n\n\n三、建造阶段事件报告\n触发条件：建造事件发生&#x2F;发现后\n1. 24h内：口头通告国家核安全局+所在地监督站2. 3d内：提交书面通告（同上）3. 30d内：向国家核安全局提交建造事件报告\n1. 24h内：口头通告国家核安全局+所在地监督站2. 3d内：提交书面通告（同上）3. 30d内：公函报国家核安全局+监督站\n1. 3d内：向国家核安全局+监督站提交书面通告2. 30d内：公函报国家核安全局+监督站提交建造事件报告\n\n\n四、运行阶段事件报告\n触发条件：运行事件发生&#x2F;发现后\n1. 24h内：口头通告国家核安全局+所在地监督站2. 3d内：提交书面通告（含初步分级，同上）3. 30d内：向国家核安全局提交运行事件报告（含分级）\n1. 24h内：口头通告国家核安全局+所在地监督站2. 3d内：提交书面通告（同上）3. 30d内：公函报国家核安全局+监督站提交运行事件报告\n向国家核安全局+所在地区监督站报告（无明确时限）\n\n\n五、应急报告\n触发条件：进入应急状态&#x2F;状态变更&#x2F;终止\n1. 15min内：电话+传真&#x2F;电子方式通告国家核安全局+监督站（应急状态初始&#x2F;变更&#x2F;终止）2. 厂房应急及以上：1h内提交应急报告3. 连续报告间隔：≤1h（控制后≤4h）4. 终止后30d内：向国家核安全局提交最终评价报告（含分级）\n1. 厂房应急：30min内电话+传真通告国家核安全局+监督站2. 厂房应急1h内：提交应急报告3. 后续报告间隔：每隔2h（事态控制后每隔6h）4. 状态变更：立即电话+传真通告5. 终止后30d内：向国家核安全局+监督站提交最终评价报告\n1. 核事故应急：1h内电话+传真通告国家核安全局+监督站2. 事态控制后：传真提交后续报告3. 应急终止：提交终止报告4. 终止后30d内：向国家核安全局+监督站提交评价报告\n\n\n3.002.1 核电厂营运单位的应急准备和应急响应\n国家核安全部门的监督并不减轻核电厂营运单位对核电厂应急准备、应急响应所承担的责任\n\n在核电厂不同阶段对核电厂营运单位及有关单位应急准备和应急响应的要求：\n\n\n\n\n\n阶段\n环节\n核心要求\n\n\n\n①\n可行性研究阶段\n分析推荐厂址区域的人口特点、地理特征及其他环境特征；分析在核电厂整个预计寿期内执行应急计划的能力。\n\n\n②\n设计阶段\n初步安分中：对核电厂事故状态（包括严重事故）及其后果作出分析；对厂内的应急设施、应急设备和应急撤离路线作出安排。\n\n\n③\n建造阶段\n新建核电厂营运单位应针对邻近正在运行的核电厂潜在事故编制相应的应急准备程序并进行适宜的应急准备。\n\n\n④\n装料前阶段\n营运单位的场内应急计划经其主管部门审查后应作为独立文件，与最终安全分析报告一并上报国家核安全部门审批，并按规定进行装料前的应急演习。在运行开始前核电厂营运单位必须作好全部应急准备。新建的核电厂只有在其场内和场外核事故应急计划被审查批准后，方可装料。\n\n\n⑤\n运行阶段\n整个核电厂应急准备应做到常备不懈；应急状态下需要使用的设施、设备和通信系统等须妥为维护，处于随时可用状态。应定期进行核事故应急演习和对应急计划进行复审和修订。\n\n\n⑥\n退役阶段\n在核电厂退役报告中应有应急计划的内容，说明在退役期间可能出现的应急状态及其对策，考虑待退役的核电厂可能产生的辐射危害，规定营运单位负责控制这些危害的组织和应急设施。\n\n\n\n核电厂营运单位应急计划应包括下列主要内容：①应急组织及其职责；②应急状态、干预水平和应急行动水平；③应急设施和设备；④应急响应行动和防护措施；⑤应急终止和恢复；⑥应急能力的维持；⑦场内、外应急计划的协调。\n\n应急组织及其职责：负责制定应急计划和进行应急准备，统一指挥在应急状态下的应急响应，并负责与国家核安全部门及场外应急机构联系。\n\n应根据核电厂的设计特征和厂址特征提出应急行动水平。在申请首次装料批准书时，提出初步制定的应急行动水平；在申请运行许可证时应提交修订后的应急行动水平供审评。\n\n为维持营运单位的应急响应能力，通过进行应急培训、应急演习和对应急准备的监查、检查等活动的内容。\n\n在首次装料前应对所有应急人员（包括应急指挥人员）进行一次和在运行寿期内每年至少进行一次与应急任务相适应的培训和考核。\n\n应急演习包括厂内应急组织的单项演习（练习）、综合演习和与厂外应急机构的联合演习。\n\n练习可以是演习的一个组成部分。综合演习至少每2年一次；联合演习按有关规定进行；练习至少每年一次，对通信和数据传输的练习要求更高的频度。\n\n演习计划中包括专门为演习或练习设计的合理的事故情景。综合演习计划及其事故情景设计应事先提交国家核安全部门。\n\n营运单位应至少每二年一次对应急计划进行修订，经修订后的应急计划必须报国家核安全部门备案。\n\n国家核安全部门对营运单位申请核安全许可证时提交的文件中关于应急准备、应急计划的有关内容进行的审评：①对可行性研究报告中厂址部分的评价；②对应急计划初步方案的审评；③对应急计划的审评；\n\n国家核安全部门对核电厂营运单位的应急准备状况和执行应急响应的能力进行监督。监督方式为日常的和例行的检查，检查的主要项目包括对应急组织、应急人员、程序、设施和物资以及对来自厂外的技术支援的检查，验证。\n\n核电厂营运单位根据国家核安全部门的要求提交应急准备工作的年度计划报告和上年度的总结报告。\n\n营运单位向国家核安全部门提交报告的时间为：每次综合演习和联合演习结束后一个月内；应急准备工作的年度计划和上年的总结报告在每年的第一季度末提交。\n\n核电厂营运单位根据国家核安全部门的要求提交应急准备工作的年度计划报告和上年度的总结报告。\n\n核电厂营运单位应在发生事故并进入应急待命或高于应急待命状态后15分钟内，向国家核安全部门发出应急通告，并在进入厂房应急或以上应急状态后15分钟内向所在省（自治区直辖市）应急指挥中心发出应急通告。\n\n核电厂营运单位应在核事故发生并进入厂房应急或高于厂房应急状态后的45分钟内向国家核安全部门以及所在省（自治区、直辖市）应急指挥中心发出应急报告；在应急初始报告发出后，每隔1小时向国家核安全部门和所在省（自治区、直辖市）应急指挥中心发一次后续报告；在事故源项或应急状态级别变更时，必须立即用电话传真方式向国家核安全部门报告。事故发生一段时间后若核电厂事故状态变化相对缓慢，可每隔2~3小时报告一次，直到应急状态终止。\n\n核电厂营运单位的应急指挥必须及时将终止应急状态的决定向国家核安全部门和终止厂房应急或高于厂房应急状态的决定向所在省（自治区、直辖市）应急指挥中心报告。\n\n营运单位对应急状态终止后的恢复措施所制定的详细计划和因事故使核电厂安全重要物项不能执行其规定的安全功能时的重新起动计划，必须上报国家核安全部门审批。实施恢复计划和重新起动计划期间应进行详细记录，并向国家核安全部门报告。\n\n\n3.003 核电厂质量保证安全规定\n为了保证核电厂的安全，必须制定和有效地实施核电厂质量保证总大纲和每一种工作（例如厂址选择、设计、制造、建造、调试、运行和退役）的质量保证分大纲。各种质量保证大纲所遵循的原则是相同的。\n\n在完成某一特定工作中（例如在厂址选择、设计、制造、建造、调试、运行和退役中），对要达到的质量负主要责任的是该工作的承担者，而不是那些验证质量的人员。\n\n质量保证大纲应包括为使物项或服务达到相应的质量所必需的活动，验证所要求的质量已达到所必需的活动，以及为产生上述活动的客观证据所必需的活动。\n\n质量保证是”有效管理“的一个实质性的方面。质量保证大纲核心要素：全面覆盖影响质量的所有活动；建立验证-纠正的闭环机制；形成可证明已达到质量要求的文件证据体系。\n\n对核电厂负有全面责任的营运单位必须负责制定和实施整个核电厂的质量保证总大纲。核电厂营运单位可以委托其他单位制定和实施大纲的全部或其中的一部分，但必须仍对总大纲的有效性负责，同时又不减轻承包者的义务或法律责任。总大纲必须对核电厂有关工作（例如厂址选择、设计、制造、建造、调试、运行和退役）的控制作出规定。\n\n所有大纲必须确定负责计划和执行质量保证活动的组织结构，必须明确规定各有关组织和人员的责任和权力。\n\n大纲的制定必须考虑要进行的各种活动的技术方面，以保证认可的工程规范、标准、技术规格书和实践经验经过核实并得到遵守。\n\n必须确定质量保证大纲所适用的物项、服务和工艺。\n\n所有大纲必须为完成影响质量的活动规定合适的控制条件。\n\n凡影响核电厂质量的活动（包括核电厂运行期间的活动）都必须按适用于该活动的书面程序、细则或图纸来完成。为确定各种重要的活动是否已满意地完成，程序、细则和图纸必须包括适当的定性和（或）定量的验收准则。\n\n参与实施大纲的单位的管理部门要对其负责的那部分质量保证大纲的状况和适用性定期进行审查。\n\n必须建立一个有明文规定的组织结构并明确规定其职责、权限等级及内外联络渠道。实施质量保证大纲的人员既包括活动的从事者也包括验证人员，而不是单一方面的责任范围。\n\n验证只能由不对该工作直接负责的人员进行。\n\n负责实施和验证质量保证的人员与部门，必须拥有足够的权力和组织独立性，以便鉴别质量问题，建议、推荐或提供解决办法。必要时，对不符合、有缺陷或不满足规定要求的物项采取行动，以制止进行下一步工序、交货、安装或使用，直到作出适当的安排。\n\n负责质量保证职能的人员和部门必须向级别足够高的管理部门上报，以保证上述必需的权力和足够的组织独立性，包括不受经费和进度约束的权力。\n\n文件控制：质量保证大纲明确要求规范文件编制、分发、修订及作废管理，确保文件有效性。\n\n必须制定设计控制措施并形成文件，以保证把规定的相应设计要求（例如国家核安全部门的要求、设计基准、规范和标准等）都正确地体现在技术规格书、图纸、程序或细则中。\n\n设计控制措施应用：辐射防护；人因；防火；物理和应力分析；热工、水力、地震和事故分析；材料相容性；在役检查、维护和修理的可达性以及检查和试验的验收准则等。\n\n设计接口控制规范：①接口责任划分：书面明确各设计单位&#x2F;部门的内外部接口关系；详细规定各单位在接口管理中的具体职责：文件编制、审核、批准、发布、分发和修订；②设计资料管理：强制要求所有接口资料（含设计变更）必须通过规定渠道传递；建立标准化的资料交流方法；资料交流必须用文件记载并予以控制。\n\n设计验证：①必须由独立于原设计团队的人员&#x2F;小组执行验证；验证方法选择权在设计单位；需形成书面验证结果文件。②当用一个试验大纲验证具体设计特性时，必须包含原型试验件的鉴定试验。原型试验件试验必须在受验证的具体设计特性的最苛刻设计工况下进行。③当不能在最苛刻设计工况下进行试验时，允许在其他工况下做试验的条件：把结果外推到最苛刻设计工况，并且试验结果能验证具体设计特性时，则允许在其他工况下做试验。\n\n设计变更：必须采用与原设计相同的设计控制措施。设计变更文件必须由审核和批准原设计文件的同一小组或单位审核和批准。如指定其他单位时：是否已掌握有关的背景材料，是已证明能胜任有关的具体设计领域的工作，是否足够了解原设计的要求及意图等条件来确定。\n\n采购控制：大纲要求对供方资质、采购文件及验收流程进行管控，确保采购物项质量。\n\n采购控制对供方的评价四个维度：①历史质量绩效审查：对供用能表明其以往类似采购活动质量的资料的评价；②近期质量保证记录验证：对供方新近的可供客观评价的、成文的、定性或定量的质量保证记录的评价；③源地技术能力与质量保证体系审计；④实物质量抽样验证：利用抽查产品进行评价。\n\n采购控制对所购物项和服务的控制：承包者提供质量客观证据、对供方进行源地检查和监查以及物项和服务的交货检验等措施。证明所购物项和服务符合采购文件要求的文字证据必须在安装或使用前送到核电厂现场。\n\n物项控制：大纲涵盖物项标识、储存和保护措施，以防止误用或损坏。\n\n物项控制必须最大可能地使用实体标识，在实际不可能或不满足要求的情况下，必须采用实体分隔、程序控制或其他适用的方法，以保证标识。\n\n工艺过程控制：大纲规定生产方法、设备维护及工艺参数监控，确保制造质量符合设计要求。\n\n检查和试验控制：大纲要求通过独立检验、试验及记录留存验证物项达标。\n\n在役检查大纲，必须对照基准数据评价其结果。\n\n检查大纲全覆盖原则：必须对保证质量所必需的每一个工作步骤都进行检查独立性原则：对安全重要的检查必须由未参加被检查活动的人员进行。\n\n停工待检点检查：文件中注明；未经指定的单位批准，不得进行停工待检点以后的工作。\n\n试验大纲必须包括鉴定试验（程序、设备、样机）、安装前的复核试验、调试试验、运行阶段的监测试验。\n\n试验结果必须以文件形式给出并加以评定，以保证满足规定的试验要求。试验数据管理需实现：可追溯性、可审查性、可验证性。\n\n对核安全相关检测设备的选择标准包括合适的量程、型号、准确度和精度。\n\n对不符合要求的物项的控制：在实际可行时必须用标记、标签或实体分隔的方法来：①标识不符合要求的物项；必须为不符合要求的物项或带有缺陷的物项；②制定控制下一步工序、交货或安装的措施；③形成文件并予以实施。\n\n对不符合项的审查和处理必须按文件规定的程序对不符合要求的物项进行审查，并确定是否不加修改地接受、拒收、修理或返工。\n\n验证质量保证大纲的实施及其有效性，必须根据需要执行内部及外部监查制度。监查必须根据书面程序和监查项目表（提问单）进行。参加监查的人员必须是对所监查的活动不负任何直接责任的。\n\n\n3.00x 核动力厂管理体系安全规定\n核动力厂管理体系，是指为确保核动力厂安全而建立的组织机构、管理制度、资源和工作过程等。\n\n国务院核安全监督管理部门应当加强对核动力厂管理体系建立和实施情况的监督检查。\n\n核动力厂营运单位对核动力厂的核安全负全面责任。应当坚持安全第一、预防为主、责任明确、严格管理、纵深防御、全面保障的原则，在核动力厂建立并保持对放射性危害的有效防御，保障核安全，预防和应对核事故，安全利用核能，保护从业人员、公众和环境免受不当危害。\n\n核动力厂营运单位可以通过合同约定的方式将核动力厂管理体系的具体工作委托给相关单位承担；委托行为不转移核动力厂营运单位承担的核安全全面责任。\n\n核动力厂营运单位主要负责人应当在以下方面作出承诺：制定核安全和生态环境保护安全决策机制和重大事项安全审议机制；明确权责义务及支持；监督与改进；沟通机制与报告制度。\n\n核动力厂营运单位应当制定和有效实施核安全和生态环境保护政策、目标和规划的行动计划，并定期开展适宜性和符合性审查，及时纠正偏差。\n\n核动力厂营运单位主要负责人应当履行下列职责：①指挥和调度管理体系的委大事项；②保证安全决策机制和安全审议机制有效运作；③协调解决工作过程之间的重大争议和冲突。\n\n核动力厂营运单位负责安全综合管理的部门，应当具有足够的资源、职权和组织独立性。\n\n核动力厂营运单位负责工作过程的责任部门：负责工作过程的管理大纲、规章制度和程序；负责的工作过程进行有效的管理控制；及时发现和纠正对安全不利的行为或者状态，实施经验反馈；向本单位安全综合管理部门报告安全状况和趋势，落实整改措施。\n\n核动力厂营运单位安全审议机构应当对重要安全事项进行审议，跟踪审议决议的落实情况，必要时开展风险分析和独立审查。\n\n核动力厂营运单位应当整合、实施、评价和持续改进管理体系。\n\n核动力厂营运单位管理体系文件应当报国务院核安全监督管理部门备案。\n\n核动力厂营运单位应当依据分类分级管理原则，确定核动力厂管理体系的各项要求，可以对管理体系的下列事项明确分级要求：①管理大纲、规章制度和程序的适用范围、详细程度和审批权限；②人员培训、资格考核、岗位授权的范围和要求；③采购文件的类型、详细程度和可追溯性要求；④对工作过程的管理控制、验证措施和要求；⑤需要形成和保存的记录及其保存期限。\n\n工作过程应当由合格的人员依据相关管理体系文件，使用合格的材料和设备，在适宜的环境条件下实施。\n\n核动力厂营运单位应当采取知识管理体系构建、开展信息化建设、软件验证相关要求，有效管理安全相关知识和信息，为工作实施、经验反馈和知识传承提供支持。\n\n核动力厂营运单位对安全重要物项管理应当通过采取物项标识与台账管理；设备可用性和可靠性保障；备件动态管理；检测设备管控；高风险物质管理，有效管理安全重要物项和其他对核安全有潜在影响的物项等措施：\n\n核动力厂营运单位应当确定实现安全目标、满足安全要求、交付合格物项或者服务所需要的工作过程，明确工作过程的控制要求，确保工作过程之间的一致性和连续性。\n\n核动力厂营运单位应当根据安全重要性、功能属性和应用范围等因素，对工作过程进行分类管理。\n\n特殊工艺过程应当在首次使用前进行验证。\n\n核动力厂营运单位应当对工作过程进行策划、实施、评价和持续改进，识别和提供所需要的资源，确定影响工作过程实施的条件和要求，明确验收准则。\n\n核动力厂营运单位应当将核安全文化融入生产、经营、科研和管理等各环节，在制定目标政策、设置机构、分配资源、制定计划、安排进度和控制成本时，始终坚持安全第一的原则，科学规范地开展各项工作。\n\n核动力厂营运单位的决策机构和管理部门应当通过承诺、决策和行为示范等，不断强化法治意识、责任意识、风险意识和诚信意识，持续培育和建设核安全文化。\n\n核动力厂营运单位应当开展管理体系日常监督检查，通过巡查、活动观察、会议、工作指导、意见征集等形式，检查管理体系各工作过程的执行情况和存在的问题，并及时整改。\n\n核动力厂营运单位应当持续监测核动力厂安全状态，定期分析评价安全性能指标的变化趋势，调查、分析异常和不良趋势的原因并加以改进。\n\n核动力厂营运单位应当定期组织开展管理体系内部监查，对重要的相关单位适时组织开展外部监查，必要时开展同行评估，系统评价管理体系各要素和工作过程的充分性、符合性和有效性，实施必要的管理改进。\n\n\n3.101 核动力厂厂址评价安全规定\n核动力厂的选址过程分为两个阶段：①厂址调查，对一个大地区进行调查普选并排除不适宜厂址后，确定候选厂址；②厂址选择，在安全和其他考虑因素的基础上通过筛选、评估、比较和排序来评价候选厂址，以选择一个或若干个优先候选厂址。\n\n厂址的适宜性应在厂址评价过程中确认。厂址评价从选址过程的第二阶段开始，在核动力厂整个寿期内持续进行，包括监测、定期安全审查和确认厂址特定设计参数的其他活动，以及基于定期安全审查结果的安全再评价。\n\n核动力厂厂址评价的主要目的是保护公众和环境免受放射性事故释放所引起的过量辐射影响，同时也应考虑核动力厂正常的放射性物质释放影响。\n\n必须在核动力厂寿期内的所有阶段贯彻基本安全原则，包括规划、选址、设计、建造、运行、退役，以及与之相关的放射性物质运输和放射性废物管理。\n\n厂址安全评价：①外部事件安全性审查：外部自然事件和人为事件发生频率和严重程度及其可能的组合对候选核动力厂厂址的安全性进行审查。②设计基准的确定：必须利用基于外部事件危险性分析得到的发生频率和严重程度的信息来确定核动力厂设计基准，并合理考虑其中的不确定性。③应急预案可行性评估：必须确定可能影响核事故应急预案可实施性的厂址特征。\n\n环境影响评价：①必须调查和评价核动力厂运行状态和事故工况下可能受到潜在放射性释放影响的区域的环境特征。②对于候选厂址，还必须考虑包括厂址所在区域的人口分布、饮食习惯、土地和水的利用情况，以评价核动力厂在运行状态及事故工况（包括那些会导致需要采取应急措施的事故工况）下对厂址所在区域居民的可能辐射影响。\n\n营运单位应当向国务院核安全监督管理部门提交选址安全分析报告。\n\n营运单位必须进行适当的质量保证和过程控制，以控制核动力厂厂址评价各阶段所进行的址调查、评价以及工程活动实施的有效性。质量保证控制必须覆盖选址过程中全部活动。\n\n厂址评价的范围必须根据核动力厂对公众和环境的潜在放射性风险确定。\n\n厂址的适宜性评价必须在厂址评价的早期阶段进行，目的是评价一个厂址是否适于建造核动力厂，并且必须针对所规划核动力厂的寿期进行确认。\n\n评价核动力厂厂址的适宜性时，必须考虑以下因素：①外部自然事件或人为事件对核动力厂的影响；②放射性物质迁移的厂址特征和环境特征；③应急措施可行性与风险评价相关的特征。\n\n厂址的适宜性是与拟建核动力厂的设计密切相关的。评价厂址适宜性，必须采用该厂址的特定资料；对厂址适宜性进行评价，还必须考虑对核动力厂连续安全运行有潜在影响的厂址特征评价厂址适宜性时，需要考虑外部危险和厂址特征随时间的变化。\n\n考虑到潜在变化预测中的不确定性，必须在确定相关厂址特定设计参数的过程中，留有适当的安全裕度。\n\n对于核动力厂来说，应尽可能在选址的最初阶段就确定厂址的总装机容量和堆型。\n\n对厂址适宜性进行评价时，还必须考虑对核动力厂连续安全运行有潜在影响的厂址特征，如冷却水的可用性、极端环境条件等。\n\n必须对区域内可诱发厂址灾害进而可能影响核动力厂安全的自然现象和人为活动进行识别和评价。评价的范围和详细程度应与核动力厂的潜在灾害性后果的严重程度相符。\n\n必须根据外部自然和人为事件的特征确定调查区域的范围。确定调查区域范围时，应考虑灾害的大小及灾害源与厂址的距离。\n\n筛选过程中外部事件的评价范围，必须覆盖核动力厂设计和安全评价的整个过程。若单个事件的后果可被某一事件组合所包络，则可以筛除该事件。对未被排除的事件，必须根据其对核动力厂安全影响的显著程度进行评价，用以确定厂址特定设计基准和厂址的再评价。\n\n外部危险评价必须根据灾害的性质、数据的可用性、安全评价的实际需要，确定采用确定论还是概率论灾害分析方法。\n\n外部危险评价采用概率安全分析时，必须根据厂址特定条件建立概率危险性曲线，作为外部事件概率安全分析的输入。\n\n灾害分析中必须说明外部事件组合的可能性，包括同时发生和短时间内前后相继发生两种情况。必须评价外部事件之间的相互作用和因果关系。同时还应考虑反应堆的运行状态。\n\n选址阶段，必须通过考虑假想事故场景（包括由此产生的源项）和在厂址所在区域实施核事故应急预案的可行性，来评估核动力厂对人员和环境的潜在影响。\n\n核电厂应急响应行动可行性评价（可实施性评价）必须考虑的四个核心维度：人口因素评价、地理特征评价、基础设施能力评价（运输和通讯网络）、社会经济与环境特征评价。\n\n厂址评价必须考虑外部自然和人为事件影响同一厂址和邻近厂址上多个核设施的可能性。\n\n厂址评价必须考虑可能影响最终热阱可用性和可靠性的特定外部自然和人为事件。\n\n对厂址进行评价时，必须统筹考虑新燃料、乏燃料及放射性废物的贮存和运输等问题。\n\n对于能动断层，必须评价地面运动和（或）断层位移危害对核动力厂安全的潜在威胁。\n\n厂址地表断层活动的可能性（即断层能动性）调查必须包括：①通过厂址附近地区的或走向指向厂址的断层；②评价断层可能影响的范围大小。\n\n判断断层为能动断层的三个独立条件：①晚更新世Q3以来的活动证据（约12万年）；②与已知能动断层的构造联系；③断层相关的最大潜在地震震级足够大，地震发生时将会产生地表或近地表处破裂。\n\n确定设计基准地震：基于区域地震构造评价；评定最大历史地震烈度；推定潜在地震。\n\n确定设计基准地震动：整合区域地震构造特征与厂址条件；设定双级地震动标准；参数化表示与计算方法（确定性法和概率法）。\n\n极端气象灾害必须根据现有记录对风、降水、冰和雪、气温和水温、湿度、风暴潮和沙尘暴等气象现象及其可信组合进行极值评价。\n\n必须评估由一种或多种自然原因导致厂址附近地区发生洪水的可能性，如：极端降雨、风暴潮、风浪、海啸或假潮或者上述具有共因（或相对发生频率较高）事件的组合。\n\n设计基准洪水的确定步骤：洪水可能性评估与数据收集；模型开发与洪水灾害评估；设计基准的输出与验证。\n\n设计基准洪水必须包括水位（包括波高）、洪水持续时间及其流态。\n\n沿海厂址的洪水基准需分析：高潮位、风驱水体、波浪叠加的综合作用，确定洪水泛滥的临界条件；\n\n地震或地质现象导致洪水波的评估需遵循以下流程：识别海啸与假潮风险；历史数据收集与可靠性验证；波浪特征模拟；确定设计基准海啸或假潮。\n\n海啸或假潮的设计基准应包括的物理参数：在厂址上引起波浪爬高和波浪下落的物理作用的可能性。\n\n挡水构筑物溃决导致的洪水和波浪核心流程：上游构筑物资料审查；核设施抗灾能力判定；次生灾害排查（堰塞湖风险、土地利用变化）。\n\n堆芯长期排热设计需评估的厂址参数：①气象条件：干球和湿球温度、湿度；②水质特征：浊度、悬浮固体、漂浮碎片以及化学和生物化学变化（自然和人为变化）；③水源可靠性：与安全有关的冷却水源的可用流量、最低水位及最低水位的持续时间，并应考虑挡水构筑物失效的可能性\n\n如果不能在所有情况下都能保证应急堆芯冷却和堆芯长期排热的最小供水量，则必须认为该厂址是不合适的。\n\n必须评价岩土工程灾害和地质灾害，包括边坡失稳、塌陷、沉降或隆起、基土液化等对核动力厂安全的影响；\n\n对边坡失稳的评价：①识别厂址及周边区域自然或人为因素引发的边坡失稳风险；②由于在评价岩土特性时存在的不确定性因素，评价边坡失稳时必须留有安全裕度；③如果存在边坡失稳的可能性，则必须使用厂址合适的地震危险性和土体及地下水特征参数来评价地震荷载引起的边坡失稳的可能性。\n\n对基土液化的评价：①厂址专属参数评价液化可能性：厂址特定的地震动和合适的岩土参数来评价；②多维度验证与安全冗余设计：使用公认的现场和实验室测试方法，并结合分析方法进行危害评价，同时留有安全裕度，以补偿在确定基土特性和计算方法上的不确定性；③如果存在不能接受的基土液化的可能性，而在工程技术上又无切实可行的解决方法，则必须认为该厂址是不合适的。\n\n有关化学品爆炸事件的设计基准，必须在考虑距离效应后以超压表示。\n\n放射性物质大气弥散评价的三层级技术框架：①区域气象特征：包括对基本气象参数、区域地形地貌和气象条件的描述，如风速和风向、气温、降水量、湿度、大气稳定度参数和持续逆温等；②气象观测计划实施规范：在厂址或厂址附近适当的标高与位置上，使用能够观测和记录主要气象参数的仪器完成观测，必须收集至少一整年的数据；③大气弥散模型构建准则：采用适宜的模型来评价放射性物质释放的大气弥散效应。这些模型必须包括所有可能影响大气弥散的重要的厂址和区域地形特征，以及核动力厂的特征。\n\n放射性物质地表水弥散评价：①地表水水文特征调查规范：包括天然水体和人工水体的主要特征、主要挡水构筑物、取水的位置以及区域内水资源利用的资料；②水文调查和测验计划：以确定必要范围内的水体稀释和弥散特征，沉积物和生物的再浓集能力，以及放射性核素在水域中的迁移机制与照射途径；③适宜的模型评价：必须基于实测数据构建预测模型，评价地表水污染对公众的潜在影响。\n\n放射性物质的地下水弥散评价：①厂址区域地下水特征调查：包括含水构造的主要特征、与地表水的相互作用以及地下水利用的资料；②水文地质调查与核素迁移评价：调查应包括核素在土壤中的迁移和滞留特征、含水层的稀释和弥散特征，以及地下物质的物理和化学性质，其中主要是放射性核素在地下水中的迁移机制与照射途径；③模型评价公众潜在影响：必须采用所收集的资料和数据，用适宜的模型评价地下水污染对公众的潜在影响。\n\n确定核动力厂寿期内厂址所在区域现有和预期的人口分布，并用于评价在运行状态和事故工况下放射性释放对公众的潜在影响。人口分布尽量利用该区域的最新人口调查数据，分析人口数据，应以核动力厂反应堆为中心按照不同距离和方位给出人口分布。\n\n辐射环境本底调查。为了能够确定核动力厂的放射性影响，在核动力厂厂址首台机组首次装料前，营运单位必须完成环境本底辐射水平的调查，所获得的数据将作为未来评价的基准。\n\n规划限制区。由省级人民政府确认的与非居住区直接相邻的区域。规划限制区内必须限制人口的机械增长，对该区域内的新建和扩建的项目应加以引导或限制，以考虑事故应急状态下采取适当防护措施的可能性。\n\n\n3.102 核动力厂设计安全规定\n本规定提出了进行全面安全评价的要求，以确定核动力厂在各种运行状态和事故工况下可能产生的潜在危险。安全评价过程涉及确定论安全分析和概率论安全分析这两种互为补充的技术，分析中必须考虑各种假设始发事件，这些事件有如下几种类型：①核动力厂运行本身：②由人员行为引起；③与核动力厂及厂址环境直接相关。\n\n基本安全目标：在核动力厂中建立并保持对放射性危害的有效防御，以保护人与环境免受放射性危害。\n\n为了实现基本安全目标，必须采取以下措施：①控制在运行状态下对人员的辐射照射和放射性物质向环境的释放；②限制导致核动力厂反应堆堆芯、乏燃料、放射性废物或任何其他辐射源失控事件发生的可能性；③如果上述事件发生，减轻这些事件产生的后果。\n\n为了实现基本安全目标，辐射防护设计必须保证在核动力厂内，①辐射照射低于规定限值，且可合理达到的尽量低。同时，②还应采取措施减轻任何事故的放射性后果。\n\n为了实现基本安全目标，辐射防护设计：辐射源管控，必须使得核动力厂所有辐射照射的来源都处在严格的技术控制和管理控制下。照射和排放，必须受到严格控制，并符合运行限值和辐射防护标准，且可合理达到的尽量低。\n\n为了证明在核动力厂的设计中实现了基本安全目标，必须对设计进行全面的安全评价，考虑以下内容：①核动力厂的正常运行；②预计运行事件时核动力厂的性能；③事故工况。\n\n\n\n\n\n运行状态\n事故工况\n\n\n\n\n\n\n正常运行\n预计运行事件\n设计基准事故\n设计扩展工况\n\n\n\n\n\n\n没有造成堆芯明显损伤\n堆芯熔化（严重事故）\n\n\n\n\n按确定的设计准则和保守的方法设计\n不在设计基准事故考虑范围，在设计过程中可按最佳估算方法加以考虑\n\n\n\n在运行限值和条件内\n偏离正常\n放射性释放在可接受限制内\n放射性释放在可接受限制内\n放射性释放在可接受限制内\n\n\n\n核动力厂需要采取措施以保证减轻放射性后果，这些措施包括：安全设施和安全系统，营运单位制定的核动力厂事故管理规程，以及国家和地方有关部门制定的场外干预措施。\n\n核安全设计（三项要求，目的层）必须：①事故预防与缓解的双重机制：防止由于反应堆堆芯或其他辐射源失控所引起有害后果的事故，并在一旦发生事故时减轻其后果；②事故后果的量化控制：保证在设计中考虑的所有事故的放射性后果都低于相关限值并保持在可合理达到的尽量低的水平；③严重事故的极低概率原则：保证有严重放射性后果的事故发生的可能性极低，并尽最大可能减轻这种事故的放射性后果。\n\n核动力厂的安全设计（实施层）必须：①必须采取实际措施，以减轻核与辐射事故对人的生命、健康以及环境造成的影响；②必须实际消除可能导致高辐射剂量或大量放射性释放的核动力厂事故序列；③必须保证发生频率高的核动力厂事故序列没有或仅有微小的潜在放射性后果。\n\n防止核动力厂发生事故和减轻事故后果的主要手段是应用纵深防御概念。\n\n纵深防御概念的应用主要是通过一系列连续和独立的防御层次的结合，防止事故对人员和环境造成危害。如果某一层次的防护失效，则由后一层次提供保护。每一层次防御的独立有效性都是纵深防御的必要组成部分。（设置五级防御层次）\n\n纵深防御概念应用的另一方面是在设计中设置一系列的实体屏障，并采用能动、非能动设施和固有安全特性的组合，以使实体屏障能够有效地将放射性物质包容在特定区域。所需实体屏障的数目取决于放射性核素总量和同位素成份表征的初始源项、单个屏障的有效性、可能的内部与外部危险以及各种失效的潜在后果。（压水堆标配四道屏障：燃料芯块、燃料包壳、一回路边界、安全壳）\n\n纵深防御五个层次：①第一层次防御的目的是防止偏离正常运行及防止安全重要物项的故障。②第二层次防御的目的是检测和控制偏离正常运行状态，以防止预计运行事件升级为事故工况。③第三层次防御是基于以下假定：尽管极不可能，某些预计运行事件或假设始发事件的升级仍有可能未被前一层次防御所制止，而演变成事故。④第四层次防御的目的是减轻第三层次纵深防御失效所导致的事故后果。⑤第五层次，即最后层次防御的目的是减轻可能由事故工况引起的潜在放射性释放造成的放射性后果。\n\n\n纵深防御五个层次\n\n\n\n层次\n核心目标\n关键措施与技术特征\n实施阶段与应用领域\n\n\n\n一\n预防偏离正常运行状态缺陷消除\n保守选址（地质稳定性评估）可靠性设计（选材）役前检查\n覆盖选址、设计、建造全过程预防性屏障（如反应堆压力容器完整）\n\n\n二\n检测并控制预计运行事件，防止预计运行事件升级为事故\n实时监测系统（温度&#x2F;压力传感器）自动保护系统（紧急停堆）\n聚焦动态响应控制（如主泵故障时）\n\n\n三\n防止未被前两层次拦截的事故导致堆芯损伤或放射性释放\n固有安全性设计（负反应性系数）专设安全设施（安全壳隔离系统）严重事故指南（堆芯熔毁应对策略）\n应对设计基准事故（如大破口失水事故）依赖冗余安全系统（应急柴油机组）\n\n\n四\n第三层次纵深防御失效，限制严重事故后果，避免大规模场外放射性污染\n堆芯熔融物滞留装置（堆坑冷却系统）氢气复合器（防止安全壳氢爆）过滤排放系统（放射性物质过滤释放）\n超设计基准事故（如全厂断电SBO）实现事故缓解（安全壳超压保护）\n\n\n五\n通过应急响应减轻放射性释放后果\n场内应急控制中心（辐射监测与指挥）场外应急救援（人员疏散路线规划）\n建立最后一道防线（应急通讯系统）监测与事故后期管理\n\n\n\n核动力厂设计，包括变更、修改或安全改进，①必须按照合适的工程规范和标准所确定的程序进行，②必须体现适用的要求和设计基准，③必须确定和控制设计接口。\n\n设计（包括设计段和设计输入与输出）的恰当与否，必须由原先从事此工作的人员以外的个人或团体进行验证和确认（独立性）。在设计和建造过程中应尽早完成验证、确认和批准，最迟不晚于核动力厂首次装料。\n\n全面负责设计过程的部门必须保证核动力厂设计满足安全性、可靠性和质量方面的验收准则。\n\n持续保证设计安全的方式包括设计验证、确定工程规范和标准及要求、采用经验证的工程实践、提供建造经验反馈、批准重要工程文件、开展安全评价和保持安全文化。\n\n核动力厂所有状态下实现以下基本安全功能：①控制反应性；②排出堆芯余热，导出乏燃料贮存设施所贮存燃料的热量；③包容放射性物质、屏蔽辐射、控制放射性的计划排放，以及限制事故的放射性释放。（停堆、冷却、包容）\n\n必须采用保守的设计和高质量的建造，以保证核动力厂的故障和偏离正常运行减至最少，保证尽实际可能地预防事故，保证核动力厂不存在陡边效应；\n\n必须利用固有特性和工程设施控制核动力厂的行为，尽可能减少或排除那些需要启动安全系统的故障和偏离正常运行；\n\n纵深防御的应用，设计：①必须设置多道实体屏障，阻止放射性物质向环境释放；②必须采用保守的设计和高质量的建造；③必须利用固有特性和工程设施控制核动力厂的行为；④必须对核动力厂提供附加控制，⑤必须提供构筑物、系统和部件以及规程，⑥必须提供多种手段来保证实现每项基本安全功能。\n\n为了贯彻纵深防御概念，设计必须尽实际可能地防止：①出现影响实体屏障完整性的情况；②一道或多道屏障失效；③一道屏障因另一道屏障的失效而失效；④运行和维修差错产生有害后果的可能性。\n\n在核动力厂运行寿期内，设计必须尽实际可能地使第一层次防御至多第二层次防御能够阻止可能发生的所有故障或偏离正常运行升级为事故工况。\n\n用于设计扩展工况的安全设施（如用于减轻燃料熔化事故后果的设施）应尽实际可能地与安全系统独立。\n\n实物保护应根据保护目标的重要程度和潜在风险确定核动力厂实物保护的等级，并按照确定的等级进行实物保护系统设计。应合理布置核动力厂的控制区、保护区和要害区，实现分区保护，并为各区配备相应的设施和设备。\n\n实物保护系统：①设置多重实体屏障。②应配备武警或守卫，③制定实物保护相关管理程序；实物保护④设计方案进行风险分析和有效性评估。⑤统筹兼顾的方式设计和实施核动力厂的核安全措施、核安保措施及国家核材料衡算和控制体系，以免其相互制约。\n\n当引入未经验证的设计或设施，或存在偏离已有工程实践的情况时，必须借助适当的支持性研究计划、特定验收准则的性能试验，或通过其他相关应用中获得的运行经验的检验来证明其（新的设计、设施或实践）安全性是合适的。\n\n必须在核动力厂的整个设计过程中进行全面的确定论安全评价和概率论安全评价，以保证在核动力厂寿期内的各个阶段满足全部设计安全要求。\n\n在设计阶段，必须专门考虑便于核动力厂放射性废物管理以及核动力厂退役和拆除的特性。\n\n放射性废物管理和退役，在设计中必须适当考虑：①材料的选取，以使放射性废物量尽实际可能地少，并便于去污；②必要的可达性和可操作性；③管理和贮存核动力厂在运行过程中产生的放射性废物所需的设施，以及管理核动力厂在退役时所产生的放射性废物的措施。\n\n核动力厂状态通常包括：①正常运行；②预计运行事件；③设计基准事故；④设计扩展工况，包括堆芯熔化事故。\n\n必须为每类核动力厂状态确定准则，使得发生频率高的核动力厂状态必须没有或仅有微小的放射性后果，而可能导致严重后果的核动力厂状态的发生频率必须很低。\n\n安全重要物项的设计基准，必须针对有关的运行状态、事故工况以及由内部和外部危险导致的工况，详细说明其必需的能力、可靠性和功能，以在核动力厂整个寿期内满足特定的验收准则\n\n假设始发事件：必须使用系统化的方法确定一套全面的假设始发事件，以在设计中考虑所有可预见的具有严重后果的事件和发生频率高的事件。\n\n确定假设始发事件：必须在工程判断、确定论和概率论评价相结合的基础上确定。必须论证确定论安全分析和概率论安全分析的应用范围，以表明已考虑所有可预见的事件。\n\n假设始发事件必须包括在各种功率及停堆状态下，所有可预见的核动力厂构筑物、系统和部件失效、人员差错，以及内部和外部危险可能引起的失效。\n\n核动力厂对任何假设始发事件的预期响应原则，按优先顺序：①依靠固有安全特性；②借助非能动安全设施；③可借助安全系统；④可借助执行专门规程。\n\n对于需要立即采取可靠响应行动的假设始发事件，设计必须有自动安全动作来启动所需的安全系统，以防止发展为更严重的工况。对于不需要立即采取响应行动的假设始发事件，可允许依靠手动启动系统或操纵员的其他动作。\n\n如果假设始发事件发生后，需要操纵员的行动来诊断核动力厂的状态并使核动力厂及时进入长期稳定停堆工况，则必须设置适当的仪表以有利于监测核动力厂的状态，同时设置适当的控制措施以便于设备的手动操作。\n\n在核动力厂布置的设计和确定有关的安全重要物项的设计中使用的假设始发事件及其产生的荷载时，必须考虑内部和外部危险的影响。\n\n核动力厂设计必须提供适当的裕量，在设计基准外部危险（由厂址危险性评价确定的）发生时保护安全重要物项，并避免产生陡边效应；在超设计基准自然灾害事件发生时，保护用于防止早期放射性释放或大量放射性释放所需的物项。\n\n在假定可能的危险时，必须考虑其发生的原因和可能性。在短期内，核动力厂的安全不能依赖于诸如电力供应和消防服务等厂外服务，设计必须适当考虑厂址的特定情况，以确定厂外服务就位需要的最大延迟时间。\n\n必须用保守的方法来分析设计基准事故。该方法包括在分析中假定安全系统的某些故障模式，规定设计准则，采用保守的假设、模型和输入参数等。\n\n设计扩展工况必须整合三种互补的分析方法：工程判断、确定论评价和概率论评价。\n\n设计扩展工况的核心目的：增强事故抵御能力、规避放射性后果、安全性深度优化。\n\n在核动力厂设计扩展工况分析中可采用最佳估算方法。\n\n开展的设计扩展工况分析必须包括确定用于或能够预防设计扩展工况并减轻其后果的设施。这些设施需满足如下要求：①设施独立性要求：必须尽实际可能与发生频率更高的事故中使用的设施保持独立；②环境适应性要求：必须能在设计扩展工况对应的环境条件中执行预期功能；③功能可靠性要求：必须有与要求其实现的功能相符的可靠性。\n\n对于设计扩展工况，保护公众所采取的防护行动在持续时间和范围上必须是有限的并必须有足够时间来采取这些防护行动。\n\n商用飞机的恶意撞击应合理选定用于评价撞击影响的商用飞机的机型，并根据这种机型起降机场与核动力厂的相对距离，来确定可能的飞机燃料装载量。\n\n可根据核动力厂所处的地形条件和厂房布置，确定可能的撞击角度和速度，并采用现实模型来评价和确定核动力厂抗商用飞机撞击的措施。\n\n安全系统的独立性：必须通过实体隔离、电气隔离、功能独立和通讯（数据传输）独立等适当手段，防止安全系统之间或一个系统的冗余组成部分之间发生相互干扰。\n\n核动力厂安全重要物项应根据其功能和安全重要性对其进行分级。\n\n划分安全重要物项的安全重要性的方法，必须主要基于确定论方法，并适当辅以概率论方法。使用概率论方法时，应考虑以下因素：①该物项要执行的安全功能；②未能执行其安全功能的后果；③需要该物项执行某一安全功能的可能性；④假设始发事件发生后，需该物项执行某一安全功能的时刻或持续时间。\n\n核动力厂安全重要物项的可靠性必须与其安全重要性相适应。\n\n核动力厂安全重要物项的设计，必须保证设备可鉴定、采购、安装、调试、操作及维修，使其能够承受该物项设计甚准中规定的所有工况，并具有足够的可靠性和有效性。\n\n选择设备时必须考虑到误动作与不安全的故障模式。必须优先选择具有可预见的和已揭示的故障模式的设备，且该设备便于修理或更换。\n\n设备的设计必须适当考虑安全重要物项发生共因故障的可能性，以确定应该如何应用多样性、多重性、独立性原则来实现所需可靠性。\n\n核动力厂设计中所包括的每个安全组合都应用单一故障准则。\n\n当把单一故障准则应用于一个安全组合或安全系统时，必须将误动作视为故障的一种模式。\n\n支持系统和辅助系统的可靠性、多重性、多样性和独立性，以及用于其隔离和功能试验的措施，必须与其所支持的系统的安全重要性相适应。\n\n如果某项安全重要物项的设计不能满足试验、检查或监测的要求，必须采取下列方法以说明其正当性：①指定其他经过验证的替代方法和（或）间接方法，如监视参考物项的试验，或使用经过验证和确认的计算方法；②采用保守的安全裕度或其他适当的预防措施，以应对可能预计不到的故障。\n\n安全重要物项鉴定程序必须考虑到安全重要物项预期寿期内由各种环境因素（如振动、辐照、湿度、温度）引起的老化效应。\n\n安全重要物项鉴定程序必须通过试验、分析或者两者的结合的方式，尽可能地复现安全重要物项所经受的工况。\n\n必须确定核动力厂安全重要物项的设计寿命。设计必须提供适当的裕度，以考虑有关老化、中子辐照脆化和磨损机理，以及与服役年限有关的性能劣化的可能性，从而保证安全重要物项在其整个设计寿期内执行所必需的安全功能的能力。\n\n在核动力厂设计过程初期就系统地考虑**人因（包括人机接口）**并贯彻于设计全过程\n\n人机接口的设计必须能按照决策所需时间和行动所需时间给操纵员提供全面且易于管理的信息。向操纵员提供的用于决策和行动需的信息必须简洁明了且无歧义。\n\n优化运行人员效能的设计，必须向操纵员提供能够进行下列工作的必要信息：①评估核动力厂在任何工况下的总体状态；②在系统和设备规定参数限值（运行限值和条件）内运行核动力厂；③确认启动安全系统所需的安全动作在需要时自动触发，且相关系统按预期要求执行功能；④确定手动启动特定安全动作的必要性和时间。\n\n在适当考虑可用时间、预期工况和操纵员心理压力的情况下，设计必须有利于操纵员动作的成功执行。\n\n核动力厂中所有可能含有易裂变或放射性物质的系统的设计，必须能够：防止可能导致放射性不受控制地向环境释放的事件发生；防止出现意外临界和过热；保证放射性释放量在正常运行工况下保持在允许的排放限值内，在事故工况下保持在可接受的限值内，并可合理达到的尽量低；便于减轻事故的放射性后果。\n\n核动力厂总体设计撤离路线必须符合辐射分区、防火、工业安全，以及核动力厂安保方面的有关要求。\n\n在安全重要系统可能的不利相互作用分析中，必须适当考虑实体的相互连接，以及一个系统的运行、误操作或故障对其他重要系统局部环境的影响，以保证环境条件的变化不会影响到系统或部件执行预定功能的可靠性。\n\n核动力厂的设计在安全分析的基础上，必须①确认安全重要物项的设计基准，②以及其与始发事件和事件序列的联系。必须③论证所设计的核动力厂能够满足各类运行状态下批准的排放限值和剂量限值，④并能够满足事故工况下的可接受限值。\n\n安全分析必须保证在核动力厂设计中适当考虑了不确定性，尤其是应有适当的裕量，以避免出现陡边效应以及早期放射性释放或大量放射性释放。\n\n概率论安全分析在核动力厂设计中的三重核心要义：①论证整个设计是平衡的，没有任何一个设施或假设始发事件对于总的风险会有过大的或明显不确定的贡献，且纵深防御的各层次应尽实际可能独立；②确认核动力厂不存在陡边效应；③将分析结果和已规定的风险准则进行比较。\n\n核动力厂系统设计必须使核动力厂燃料元件和燃料组件能够保持结构完整性，并在考虑运行状态下所有可能导致其性能劣化的因素后，能够承受预期的堆内辐照和环境条件。\n\n燃料设计限值必须包括预计运行事件中容许的燃料裂变产物泄漏量限值，从而使燃料仍能继续使用。\n\n燃料元件和燃料组件必须能够承受燃料吊装过程中的载荷和应力。\n\n在运行工况以及除严重事故外的其他事故工况下，设计必须使核动力厂燃料元件和燃料组件及其支撑件能够维持可冷却的几何形状且不妨碍控制棒插入。\n\n在核动力厂各种状态（包括停堆后、换料期间和换料后、预计运行事件和未导致堆芯严重损伤的事故工况）下，堆芯中子注量率分布必须具有固有稳定性。堆芯设计应尽量减少依赖控制系统使中子注量率分布、水平和稳定性在各种运行状态下保持在规定限值内。\n\n在运行状态和未导致反应堆堆芯严重损伤的事故工况下，必须对最大的正反应性引入量及其引入速率加以限制，以保证不致引起反应堆压力边界失效，维持堆芯冷却能力和防止反应堆堆芯严重损伤。\n\n反应堆停堆手段的有效性、停堆动作速度和停堆深度必须足以保证不超出规定的燃料设计限值。\n\n反应堆停堆手段必须至少由两个多样化的且独立的系统组成。即使在堆芯处于反应性最大的状态下，必须至少有一个系统能够独立地以足够的深度和高可靠性使反应堆保持次临界状态。\n\n核动力厂反应堆冷却剂系统部件的设计和制造，必须具有高质量的材料、恰当的设计标准、可检查性和高质量的加工，以尽量降低其发生故障的可能性。\n\n反应堆冷却剂压力边界的设计必须使产生裂纹的可能性极小；已产生的裂纹也极不易于按快速裂纹扩展方式发展成为失稳断裂，以便允许及时探测到裂纹。\n\n反应堆堆芯的应急冷却，冷却反应堆堆芯的手段必须能够保证：①不超过包壳或燃料完整性参数限值（如温度）；②可能出现的化学反应保持在可接受水平；③应急堆芯冷却手段可有效补偿燃料和堆内结构变形的影响；④反应堆堆芯冷却能保持足够长的时间。\n\n在核动力厂所有状态下，都必须保证具有将热量传输到最终热阱的能力。\n\n安全壳系统的重要作用：①在运行状态和事故工况下包容放射性物质；②保护反应堆使其免受外部自然事件和人为事件的影响；③在运行状态和事故工况下屏蔽辐射。\n\n必须采取措施控制核动力厂安全壳内的压力和温度，控制裂变产物或其他气态、液态或固态物质的任何积累。设计必须为安全壳内各独立隔间之间提供足够的气流通道，必须保证安全壳的排热能力。\n\n核动力厂仪器仪表的核心作用，具体体现在：确定关键变量的值以监控核电厂安全状态；提供安全和可靠运行所需的重要信息；确定事故工况下的状态并支持事故管理决策。\n\n核动力厂安全重要物项的仪表和控制系统，必须具有与所执行的安全功能相适应的高可靠性和定期可试验性。\n\n场内应急设施通常包括应急控制中心、技术支持中心和运行支持中心，其设计必须保证工作人员在事故（包括严重事故）和灾害情况下能够在此执行预期的应急任务。\n\n在同时丧失场外电源和应急动力源的情况下，替代动力源必须能够提供必要的动力，以保证反应堆冷却剂系统的完整性并防止堆芯和乏燃料出现严重损伤。\n\n为使气载放射性物质向环境的释放保持在规定的限值以内，净化设备必须具备必需的滞留因子。\n\n对于采用水池系统进行燃料贮存的反应堆，其设计必须防止在所有与乏燃料水池有关的核动力厂状态下发生燃料组件裸露，实际消除导致早期放射性释放或大量放射性释放工况发生的可能性，以避免在厂区形成高辐射区域。核动力厂的设计：①必须提供必要的燃料冷却能力；②在乏燃料水池泄漏或管道破口工况下，必须提供相应的手段防止燃料组件发生裸露；③必须提供恢复水装量的能力。（冷却、屏蔽）\n\n核动力厂辐射防护设计必须全面识别核动力厂的各种辐射源，将来自各种辐射源的照射和辐射风险保持在可合理达到的尽量低的水平，维持燃料元件包壳的完整性，控制腐蚀产物和活化产物的产生和迁移。\n\n\n3.103 核动力厂调试和运行安全规定\n营运单位对核安全负全面责任。\n\n营运单位应当建立并以文件确定运行组织机构，如有变动提交国家核安全局审查。\n\n营运单位运行组织机构应当具备如下管理职能：①决策职能；②运行职能；③支持职能；④审查职能。\n\n营运单位应当制定和执行核动力厂配置管理制度，确保设计要求、实际配置和核动力厂文件之间的一致性。\n\n营运单位在使用风险指引型综合决策技术方法对安全基准进行修改时，应当评价概率安全分析模型的技术适当性，应当确保所使用模型的详细程度和数据能够支持其决策和变更，并对不确定性进行评估和处理。\n\n营运单位应当制定和有效实施质量保证大纲。质量保证大纲应当覆盖可能影响核动力厂安全相关的所有活动。质量保证的原则和方法应当系统地用于管理过程、安全相关活动以及绩效的评价。\n\n营运单位应当收集和保存运行经验的数据，用作核动力厂老化管理、概率安全分析、核动力厂配置状态的风险管理、维修有效性评价和定期安全评价等的输入数据。\n\n营运单位应当定期开展实物保护系统有效性评估及突发事件处置演练，以确保实物保护措施有效。\n\n营运单位应当定期组织开展防火训练和演习，以评估防火响应能力的有效性。\n\n营运单位应当制定并落实场内核事故应急预案。场内核事故应急预案应当包括由营运单位实施或负责的各项活动，应当考虑到非核危害与核危害同时发生所形成的应急状态，诸如火灾与严重辐射危害或污染同时发生、有毒气体或室息性气体与辐射和污染并存等。\n\n营运单位应当使用有代表性的模拟装置来进行培训。\n\n营运单位应当制定和实施调试大纲，以验证建成的核动力厂满足设计要求和安全要求能够在运行限值和条件范围内运行。\n\n调试大纲应当包括验证工作所必需的全部安全相关试验。调试大纲应当规定调试工作主要原则、调试组织方式、调试主要阶段划分、调试各具体试验实施的阶段、试验目的和验收准则、装料后与正常运行的限值和条件不一致的特殊调试工作等内容。\n\n调试活动：①营运单位应当在调试阶段制定和实施管理程序，以确保调试试验的目标得以正确实现。②营运单位应当确保运行人员参与调试过程。运行人员和技术人员对调试过程的参与应当达到确保为运行阶段做好准备所需的程度。③当调试活动分阶段实施时，营运单位应当确保在完成对前阶段调试试验结果的评价和监查，并确认调试结果评价满足了全部核安全管理要求之后，才允许进行下一阶段的调试试验工作。④在核动力厂调试和运行阶段，营运单位应当对核动力厂进行监测和维护，以保护核动力厂设备和支持调试工作，并始终保持核动力厂与安全分析报告的一致性。⑤营运单位应当在安全分析报告和核安全管理要求的基础上明文规定首次装料前的系统、设备、文件和人员的先决条件，并在首次装料前予以确认。⑥营运单位应当在首次装料前完成必需的全部试验并认可试验结果。⑦营运单位应当在反应堆首次临界及初始功率提升前完成必需的全部试验并认可试验结果。\n\n运行限值和条件：①营运单位应当制定包括技术和管理两个方面的运行限值和条件。运行限值和条件应当基于安全分析报告中对特定核动力厂及其环境的安全分析和评价。②运行限值和条件应当反映最终设计。运行限值和条件应当包括：对各种运行状态的要求运行人员应当采取的行动和应当遵守的限制。③运行限值和条件可以分为五类：安全限值；安全系统整定值；正常运行的限值和条件；监督要求；偏离上述运行限值和条件时的行动。④运行限值和条件目标：防止发生可能导致事故工况的状态；发生事故，则减轻其后果。⑤营运单位应当根据调试试验结果或国家核安全局的要求对运行限值和条件进行修改。\n\n营运单位应当制定正常运行规程，以确保核动力厂运行在运行限值和条件之内。营运单位应当制定适用于预计运行事件和设计基准事故的规程，以及用于管理比设计基准事故更严重的事故的规程和指南。\n\n营运单位应当在换料实施前编制换料安全分析报告，报告至少应当包括预计的堆芯条件和堆芯的安全分析。\n\n营运单位应当在换料后首次临界前对换料报告的执行情况、换料报告的变更及其技术论证、换料期间发现的对启动有影响的问题和解决措施、以及试验、检查和维修情况等进行评价并形成文件。\n\n营运单位应当确保所有易裂变材料（包括未辐照和已辐照燃料）的贮存、辐照和转移按要求保存详细的可核查帐目。\n\n导致超过安全限值的停堆以及国家核安全局认为重要并提出管理要求的停堆，营运单位应当按照许可证的要求报经国家核安全局审查，并提交运行事件报告、处理计划和启动申请，经批准后方可再次启动运行。\n\n营运单位应当在维修、试验、监督和检查大纲中确定核动力厂所有的安全重要构筑物系统和设备的维修、试验、监督和检查的标准和频度，以确保构筑物、系统和设备的可靠性和有效性与核动力厂整个寿期内的设计要求始终保持一致。\n\n营运单位应当根据下述因素确定单个构筑物、系统和设备的预防性和预测性维修、试验、监督和检查的频度：①构筑物、系统和设备对安全的重要性；②其固有的可靠性；③运行时性能劣化的可能性和老化特性；④运行经验。\n\n营运单位实施基于性能、风险指引的维修有效性评价体系时，应包括：①确定管理范围；②确定风险重要类；③制定性能指标；④性能指标监测；⑤定期有效性评价；⑥维修活动的风险评价与管理。\n\n核动力厂的修改包括：构筑物、系统和设备的修改；运行限值和条件的修改；程序和文件的修改；上述各项的组合。\n\n按照修改的安全重要程度，核动力厂修改分为安全重要修改和一般修改。对于安全重要修改，营运单位应当在按照本单位的管理程序批准后，报国家核安全局批准，方可实施。\n\n营运单位应当基于对辐射防护的评价分析来编制辐射防护大纲，辐射防护大纲应当包括：①辐射分区和出入口控制；②预计工作时有放射性危害的运行规程和维修规程；③监测仪表和设备；④人员防护设备；⑤厂区放射性监测和巡测；⑥人员、设备和构筑物的去污；⑦对转运放射性物质的控制。\n\n营运单位的辐射防护部门应当具有足够的独立性和资源，以落实辐射防护法规、标准、规程以及安全操作实践的要求并提出建议。\n\n营运单位应当落实放射性废物最小化原则，按照国家有关标准进行放射性废物的处理和贮存，并确保其符合放射性废物处置前管理的相关要求。\n\n在运行许可证有效期内，营运单位应当采用定期安全评价的方式对核动力厂进行系统的安全评价。定期安全评价应当评价核动力厂与最新核安全法规和标准中适用部分的符合程度、以及运行经验和从所有相关来源得到的重要安全信息对核动力厂的适用性，以确保核动力厂在整个运行寿期内具有高的安全水平。（HAF001每十年一次）\n\n定期安全评价应当考虑核动力厂的实际状况、运行经验、可预期的寿期末状况、目前的分析方法、适用的规定、标准及科技水平，其范围应当覆盖运行核动力厂的所有安全方面。\n\n营运单位应当编制定期安全评价大纲、安全要素评价报告、总体评价报告、纠正行动和安全改进计划。\n\n营运单位应当根据**老化管理大纲，**建立老化经验、数据收集和记录保存系统以促进老化管理大纲的实施和优化，定期对老化管理大纲的有效性进行审查、检查和评价。\n\n老化管理大纲应当确定构筑物、系统和设备的老化效应和机理，以及维持其运行能力和可靠性所需开展的活动。老化管理大纲应当包含对构筑物、系统和设备受运行及环境条件长期影响的分析和评价。\n\n营运单位应当编制退役计划，并在核动力厂的整个寿期内维护该计划，以确保退役可以安全完成，并符合规定的最终状态。营运单位应当根据监管要求的变化、核动力厂的修改、技术进步、退役活动需求的变化以及国家政策的变化更新退役计划。\n\n营运单位应当建立文件控制体系和管理制度，对安全重要的记录和报告进行控制管理，确保所有使用的文件是最新版本。\n\n\n核安全所有法规首次装料前完成的活动与涉及首次装料活动统计\n\n\n\n法规\n首次装料前活动及涉及首次装料活动\n\n\n\n核电厂核事故应急管理条例\n在核电厂首次装料前，核电厂的核事故应急机构和省级人民政府指定的部门应当组织场内、场外核事故应急演习。\n\n\n核电厂营运单位的应急准备和应急响应\n在首次装料前应对所有应急人员（包括应急指挥人员）进行一次与他们预计要完成的应急任务相适应的培训和考核。\n\n\n核动力厂厂址评价安全规定\n核动力厂厂址首台机组首次装料前，营运单位必须完成环境本底辐射水平的调查。\n\n\n核动力厂设计安全规定\n在设计和建造过程中应尽早完成验证、确认和批准，最迟不晚于核动力厂首次装料。\n\n\n核动力厂调试和运行安全规定\n首次装料前的系统、设备、文件和人员的先决条件，并在首次装料前予以确认。\n\n\n核动力厂调试和运行安全规定\n营运单位应当在首次装料前完成必需的全部试验并认可试验结果。\n\n\n核动力厂调试和运行安全规定\n营运单位应当尽可能在首次装料前进行验证和确认工作。\n\n\n核动力厂调试和运行安全规定\n首次装料前实施安全重要构筑物、系统和设备的维修、试验、监督和检查大纲。\n\n\n研究堆营运单位报告制度\n建造季报从领到建造许可证日起首次装料止；运行月报从首次装料开始到退役止。\n\n\n研究堆运行安全规定\n编制和颁发反应堆安全运行和使用的运行规程。\n\n\n3.201 研究堆设计安全规定\n研究堆的安全总目标是建立并维持一套有效的防御措施，以保护工作人员、公众和环境免受过量的放射性危害。\n\n研究堆的具体辐射防护目标是：确保研究堆的运行和使用满足辐射防护的要求；确保在各种运行状态下，厂区工作人员及公众的辐射照射低于国家规定的限值，并保持在合理可行尽量低的水平；确保事故引起的辐射照射得到缓解。\n\n评价研究堆厂址的适宜性时，必须考虑下列因素：①在某特定厂址所在区域发生的外部事件的影响评估（这些事件可为自然事件或人为事件）；②可能影响所释放的放射性物质向人体迁移的厂址特征及其环境特征；③与实施应急措施的可能性（应急响应可行性评估）和评价个人和群体风险有关的人口密度和分布以及其他的外围地带的特征。\n\n研究堆设计纵深防御的通过下列措施满足：停堆、冷却和包容。①设计中包括固有安全性：②提供适当的安全系统及专设安全设施；③反应堆整个寿期内均贯彻管理性程序。\n\n必须对反应堆的安全进行分析和评价，以论证反应堆具有足够的安全性。①安全分析的进展和反应堆设计是相互关联的互补过程。\n\n反应堆的安全评价：②必须包括分析反应堆对一系列可能导致预计运行事件或事故工况的假设始发事件（例如设备的误动作或故障、运行人员误操作或外部事件）的响应，也应包括③实验装置本身的安全及其对反应堆的影响。\n\n假设始发事件必须包括影响反应堆安全的所有可信事故，特别是应确定设计基准事故。对超设计基准事故必须进行分析，以便制定应急计划及进行事故处理。\n\n反应堆的安全评价必须以下列方式分析假设始发事件及其后果：①事故按类型分组，以便只对每组中的极限事件进行定量分析；②说明极限事件的进程及其可能的后果；③论证与反应堆运行有关的风险及安全裕量是可接受的。\n\n反应堆设计安全分析对每一假设始发事件，在评定时必须考虑下列问题定性及定量资料：①输入参数、初始条件、边界条件、假设、模型和所使用的计算机程序；②事件序列和反应堆系统的性能；③对单一故障模式和共因故障的敏感性；④对人为因素的敏感性；⑤裂变产物释放及引起照射的可能性。\n\n反应堆的每一种运行状态及事故工况规定有关参数的设计限值，这些限值确保在运行状态及事故工况下，堆芯不会发生明显的损坏，并且放射性物质的释放将在所规定的辐射防护要求的范围内。\n\n为保证执行研究堆安全功能所需的可靠性，对某些安全系统或部件应确定其最大不可利用率限值，经国家核安全部门认可后，作为基准或用作验收准则。\n\n为达到和保持按系统和部件执行安全功能的重要性所要求的可靠性，应采用下列各项措施，必要时可组合使用：多重性和单一故障准则、多样性、独立性、故障安全设计、可试验性。\n\n多重性原则设计必须保证单一故障不会使系统丧失其执行预定安全功能的能力。\n\n多样性原则能减少共因故障的可能，从而可提高可靠性。\n\n故障安全原则，即系统或部件发生故障时，反应堆应能在毋需任何触发动作的情况下进入安全状态。\n\n研究堆必须设计成能在所有运行状态下按所设定的参数范围安全运行，并且反应堆及其相关系统对广泛的事件的响应必须能导致安全运行或在必要时使功率降低，而无需借助于安全系统。\n\n研究堆在设计初期和整个设计过程中，必须系统地考虑人为因素和人机接口问题。控制室的设计应贯彻人机工效学原则。\n\n设计必须采取措施，以提供适当的可达性、足够的屏蔽、远距离操作和去污，以便于维护翻修理。\n\n在设计阶段，为适应材料在其使用寿期末的预计特性，应留有适当的安全裕度。当无材料数据可取时，必须执行合适的材料监督计划，并用所得结果对设计的适宜性作定期评价。这可能要求采取设计措施，以监测那些在服役中会由于应力腐蚀或辐射等引起机械性能改变的材料。选用高强度或高熔点材料可提高其安全系数。\n\n对所有假设始发事件，反应堆保护系统必须能自动触发所需的保护动作以安全地终止事件。这种能力应考虑到系统部件的可能失效（单一故障准则）。在某些情况下，运行人员的手动可认为是充分可靠的，但要具备下列条件：①时间足够；②信息的处理和提供恰当；③诊断简单并且操作的规定明确；④对运行人员的要求不过分。\n\n保护系统必须独立于控制系统。\n\n最大设计剂量水平的确定必须留有足够裕量。\n\n在制订厂区人员和公众的辐射防护措施时必须考虑到反应堆工艺系统中由中子活化所产生的放射性核素（如16N、3H、41Ar、24Na、60Co）的影响。\n\n运行限值和条件必须经国家核安全局批准。\n\n燃料和燃料元件的设计必须全面考虑与反应堆有关的中子学、热工水力学、机械、材料化学和辐照等限制因素。\n\n反应堆堆芯（包括燃料元件或组件，反应性控制机构和实验装置等）的设计及建造必须使所有运行状态下规定的最大允许设计限值不会被超过。\n\n反应堆的设计必须使反应堆能在所有运行状态及事故工况下停堆并维持在次临界状态。\n\n反应堆堆芯设计应尽可能采用固有安全特性，以将事故后果减至最小。\n\n反应性控制机构必须有足够的负反应性，以便在实验布置具有最大的正反应性时，也能使反应堆在所有运行状态下进入次临界并维持在次临界状态。\n\n必须规定反应性控制系统或实验允许的最大正反应性引入速率，并将其值限制在安全分析报告所论证的范围内。\n\n反应堆冷却剂系统应能进行试验或监督，以防泄漏、快速增长的裂纹及脆裂的发生。可根据具体情况应用多层屏障原则。\n\n在堆芯高度的上水平面以下有贯穿件的水冷反应堆的设计中，必须特别注意防止堆芯裸露，应采取特殊措施（如破坏虹吸）和合适的隔离装置。\n\n反应堆冷却剂边界的设计必须便于所需的役前检查和在役检查及试验。\n\n反应堆冷却系统必须能长期可靠地把热量从燃料传导到最终热阱。\n\n反应堆停堆系统设计中必须至少采用一套停堆系统。根据反应堆的特征，必须考虑并可能需要第二套独立的停堆系统。\n\n停堆系统必须具有足够的停堆反应性，以便在所有运行状态及事故工况下，即使考虑到实验的反应性影响，也能使反应堆进入次临界，并维持在有足够停堆深度的次临界状态。\n\n反应堆停堆系统的有效性、动作速度及停堆深度必须使所规定的限值和条件不会被超过。\n\n停堆系统的单一故障不得阻碍该系统在需要时实现其安全功能。\n\n反应堆保护系统必须是自动的，并且独立于其他系统。此外，必须使手动停堆信号能输入到保护系统中去。\n\n保护系统的设计应贯彻多样性原则，如可能，对每一个假设始发事件都至少用两种不同的方法加以探测。所需的保护动作必须自动触发。\n\n保护系统必须至少有两套完全隔离的和独立的通道，以使单一故障不致于导致其功能的丧失。\n\n保护系统的设计必须确保在保护系统出现共因故障时使反应堆处于安全状态。\n\n保护系统设计必须保证整定值的触发点和安全限值之间有一定的裕量，即保护系统触发的动作能在达到安全限值前起到控制该过程的作用。此外，此裕量必须考虑下列因素：①仪表的不准确度；②刻度的不确定性；③仪器的飘移；④仪器和系统的响应时间。⑤为了增加安全性，可再增大裕量。\n\n应急堆芯冷却系统必须能在所有停堆工况（包括由反应堆冷却剂系统边界破裂造成的工况）下将堆芯温度保持在规定的安全限值内。\n\n反应堆厂房的设计：①必须考虑事故工况下的极端荷载和环境条件的影响；②必须有适当的裕量，以承受设计基准事故工况下算得的最高压力和温度；③必须能可靠地控制正常运行工况下放射性物质的释放；④必须确立事故工况下可接受的放射性物质的释放率。\n\n反应堆必须设置足够的指示和记录仪表，以监测反应堆在预期运行事件和事故工况期间及之后的重要参数。\n\n声光报警系统必须能早期指示可能导致反应堆安全性下降的运行工况的变化。\n\n燃料的操作和贮存设施的设计必须考虑防止发生燃料的丢失和损坏。必须考虑临界、冷却、定期检查和试验、腐蚀、包容、屏蔽和通风问题。\n\n必须在气载放射性物质浓度较高的反应堆区域设置足够的辐射监测系统和通风系统，包括相应的过滤装置。\n\n研究堆的设计应以产生最少的放射性废物为原则。放射性废物处理系统必须有足够的控制和监测装置，以使放射性物质的释放符合合理可行尽量低的原则，并低于所规定的限值。\n\n\n3.202 研究堆运行安全规定\n研究堆的主管部门对研究堆的安全运行负有领导责任。\n\n营运单位必须对研究堆的安全负全面责任。\n\n安全咨询机构：营运单位内部建立的机构，在反应堆运行安全和有关实验安全方面向营运单位提供咨询，该咨询机构的职能、权限、组成和受权调查的范围必须以书面形式加以陈述，并且必须提交给国家核安全部门。\n\n运行人员：人数和工种取决于反应堆的功率水平、工作循环及用途。\n\n反应堆操纵人员必须持有国家核安全部门颁发的反应堆操纵人员执照。任何一名反应堆操纵人员都必须拥有充分的职权使用紧急停堆按钮。\n\n营运单位须按要求编制安全分析报告，报告中用于证明设计合理性的资料还必须用于：①确定运行限值和条件。②编制运行规程、③编制应急计划④申请反应堆运行执照的主要资料。⑤了解该设旋的基本资料。\n\n运行限值和条件（国家核安全部门批准），包括：①安全限值、②安全系统整定值、③安全运行限制条件和④监督要求。还可以包括⑤行政管理和组织方面的内容。\n\n安全限值以某些参数或变量的最大值和（或）最小值来表示，而在各种运行状态下，这些变量或参数必须保持小于或大于此限值。\n\n安全系统整定值（紧急停堆整定值）必须包括适当的安全裕度，特别应考虑系统的瞬态行为、设备响应时间和测量装置的误差。如果某一安全限值不能直接测量（如燃料温度），那么必须规定其他相关变量的安全系统整定值，以防止违反该限值。\n\n安全运行限制条件是从管理上确定的对设备和运行的限制。这种限制在反应堆的各种运行状态下都必须遵守。确定这种限制条件是为了在正常运行值和所确立的安全系统整定值之间提供可接受的安全裕度。它们包括运行参数限值、最少可运行的设备和最少的人员配备的要求，以及规定需由运行人员采取的行动。\n\n正常运行值&lt;运行参数限值&lt;安全系统整定值&lt;（安全系统整定值+安全裕度）&lt;安全限值（仅帮助理解）\n\n安全限值、安全系统整定值、限制条件和监督要求的数值必须根据反应堆设计和反应堆安全分析的结果选取，并证明它与反映反应堆现状的安全分析报告相一致。\n\n安全运行限制条件得不到满足，运行人员必须采取适当行动，以确保安全。反应堆运行管理机构必须对原因和后果进行调查，并采取适当的行动。必须及时将这一事件通知国家核安全部门。\n\n营运单位必须在初始装料之前编制和颁发反应堆安全运行和使用的运行规程。\n\n营运单位、设计单位和制造单位必须参与调试大纲的编制。\n\n调试大纲必须在实施前提交给安全咨询机构和国家核安全部门进行审查和认可。\n\n调试试验必须按功能类别和逻辑序列安排。该序列包括：运行前试验，首次临界和低功率试验，以及功率试验。\n\n调试大纲文件必须按照质保大纲的要求编制，应包括：①试验目的和预期结果；②试验中需要采取的安全措施；③预防措施和失决条件；④试验程序；⑤试验报告。\n\n调试过程必须成为营运单位和供货商的合作过程，以保证其成为使营运单位熟悉反应堆持性的有效手段。\n\n维修、定期试验和检查，以确保：①遵守运行限值和条件；②反应堆处于安全状态。\n\n对安全重要部件可能需要给予特殊注意，以防止其老化引起意外故障。在这种情况下，应采取的方法之一是预防性维修。\n\n一切堆芯布置的确定必须符合运行限值和条件中规定的设计意图和假设。\n\n未辐照和已辐照燃料的贮存方案必须报送国家核安全部门批准。\n\n营运单位必须编写关于安全事项的扼要的定期报告，并将其提交给安全咨询机构和国家核安全部门。\n\n反应堆的修改必须根据标准程序分为具有安全意义的修改和不具安全意义的修改。某些实验装置的安装或为实验目的而重组堆芯应视为反应堆修改。具有重大安全意义的修改必须上报国家核安全部门审查和批准。\n\n反应堆及其实验装置的运行应尽量少地产生各种放射性废物，以减少放射性物质的释放，并便于废物处理。\n\n在所有运行状态下，辐射防护的主要目标是避免不必要的辐射照射，并将不可避免的照射保持在合理可行尽量低的水平。一方面要考虑剂量限值，另一方面要考虑社会和经济因素（合理可行尽量低）。\n\n必须通过适当的专设安全设施、事故处理规程和应急计划中规定的措施减轻事故工况下的辐射后果。\n\n在反应堆设计和运行方面具有辐射防护知识的合格的保健物理人员必须与反应堆运行组合作，但具有独立于反应堆运行组的报告渠道，以便提出有关安全问题。保健物理人员有权制止危及安全的操作。\n\n营运单位必须通过监督、检查和监查来验证辐射防护大纲的正确实施及其目标的实现，并在必要时采取纠正措施。\n\n营运单位必须根据厂址特征确定放射性释放限值（排放限值）并报国家核安全部门和其他有关部门。批准的排放限值应包括在运行限值和条件中，营运单位必须确立管理限值供自己使用。如果超过放射性释放的管理限值，营运单位必须进行调查，以采取纠正行动。如果超过人员照射限值或放射性释放限值（批准的排放限值），则必须向国家核安全部门和有关部门报告。\n\n应急计划应根据厂址条件制定，计划应包括应急状态下要开展的各项活动的安排，并必须报国家核安全部门审批。\n\n营运单位的应急计划必须根据安全分析报告中分析的事故以及为编制应急计划而附加的假设事故编制。\n\n应根据应急计划制定应急响应程序。该程序以文件和指令的形式详细规定达到应急计划目标所要求的实施行动和方法。\n\n研究堆设计和运行的质量保证必须是某一特定活动各个阶段的连续过程。应当明确质量控制（验证所要求的质量已达到）仅仅是质量保证的一部分。在完成一项具体工作时，实现质量要求的基本责任必须属于那些承担工作的人，而不属于那些通过验证而确信该质量要求已达到的人。\n\n退役计划必须在退役活动开始之前提交咨询机构审查，并报国家核安全部门审查和批准。\n\n退役计划包括导致最终完全退役的所有步骤。完全退役所达到的程度是：以最低限度的监督或不监督就能保证安全。这些步骤可包括：贮存和监督、厂址区域的有限制使用和无限制使用。\n\n\n3.301 民用核燃料循环设施安全规定\n营运单位必须对其核燃料循环设施的安全负全面责任，直至其核燃料循环设施退役终了或其责任已合法地转移为止。\n\n核燃料循环设施的主管部门对所属核燃料循环设施的安全负领导责任。主要部分职责：参与有关核燃料循环设施安全法规的起草和制订，组织制订有关的技术标准。\n\n国家核安全部门的主要职责是对核燃料循环设施的安全实施监督。主要部分职责：制定有关核燃料循环设施的安全法规和导则，审查认可有关安全标准。审评核燃料循环设施营运单位提交的安全分析报告和其他有关资料，批准颁发相应的安全许可证件。\n\n辐射防护目标：确保在正常运行状态下核燃料循环设施内及由核燃料循环设施释放出的放射性物质所引起的辐射照射保持在合理可行尽量低的水平，并低于国家规定限值；确保事故引起的辐射照射的程度得到缓解。\n\n技术安全目标：采取一切合理可行的措施预防事故；对设计中考虑的所有事故，要确保其辐射影响是可接受的，并确保那些会导致严重辐射后果的事故发生的可能性极低。\n\n核燃料循环设施的厂址、厂址所在区域及其周围环境必须满足下列要求：①在寿期内不会发生严重影响设施安全的外部自然事件和人为事件，或者能够采取合理可行的措施将可能发生的事件的影响减至可以接受的程度。②在正常运行状态下，对公众的辐射照射能保持在合理可行尽量低的水平，并符合国家的规定。③事故状态下，能够使公众免遭不可接受的辐射照射。\n\n核燃料循环设施厂址评价必须考虑的因素：①外部事件防御能力：需评估厂址区域在设施寿期内可能遭遇的自然事件（如地震、洪水、极端气象）和人为事件（如爆炸、飞机坠毁），确保其不会对设施安全造成不可控影响。②放射性物质迁移控制：重点分析厂址特征与环境特征对放射性物质扩散路径的影响。③应急响应可行性：与评价个人和群体可能受到的辐射危害及必要时采取应急措施有关的特征，如人口密度与分布、交通和通讯等。\n\n核燃料循环设施对外部事件破坏效应的防御：核燃料循环设施的设计必须与其厂址特征及环境条件相适应；其安全重要构筑物、系统和部件的设计基准和建造质量必须为防御可能的外部自然事件和人为事件的破坏效应提供合理的保障。\n\n核燃料循环设施放射性物质的包容与控制：必须设置适当的密封屏障系统，提供可靠的密封功能和足够的包容能力，将放射性物质限制在规定部位或场所，使运行状态和事故工况下规定部位或场所之外遭受放射性物质污染的可能性减至最小；并保证任何放射性物质外逸所造成的污染，在运行状态下低于规定限值，事故工况期间低于可接受限值。\n\n核燃料循环设施的设计应使放射性废物的产生量减至最小。必须设置相应的放射性废物管理系统，使设施运行所产生的放射性废物得到适当的分类、收集、处理、贮存或处置\n\n必须根据需要提供适当的事故应急措施与能力，包括设置事故报警、应急通讯、人员撤离和医疗救治等必要的应急设施与设备。\n\n单元的核临界安全：核燃料循环设施必须提供可靠的设计特性，使（并通过核临界安全分析证明）易裂变材料单元在任何运行状态和事故工况下均保持次临界状态。\n\n多单元阵列的核临界安全：必须考虑阵列中单元间的相互作用，提供可靠的设计特性使（并通过核临界安全分析证明）阵列在任何运行状态和事故工况下均保持次临界状态。\n\n核燃料循环设施许可建造前，其设计必须经过安全分析和评价，以确认安全重要构筑物、系统和部件（或设备）的设计基准，并证实整个核燃料循环设施的设计足以保证各种运行状态和事故工况下的辐射照射和放射性物质释放不超过国家规定的相应限值。\n\n运行限值和条件以及对运行限值和条件的修改必须经国家核安全部门审评和批准。\n\n核燃料循环设施单位安全管理机构必须保证核燃料循环设施以安全的方式运行，并严格遵守运行限值和条件。\n\n运行规程：须保证所有与安全有关的运行操作均按正式批准的、详细的、最新版本书面规程进行。运行规程必须符合所批准的运行限值与条件，并留有适当的安全裕量。\n\n必须根据对核燃料循环设施潜在事故后果严重程度的评价和厂址特征，制定相应的应急计划，并作好所规定的应急准备。\n\n核燃料循环设施许可运行前，必须在最终安全分析报告中对其运行安全进行分析与评价，以确认其设计、建造、运行规程及管理措施足以保证其运行符合设计要求，而不会对厂址内外人员的健康与安全造成危害。\n\n核燃料循环设施运行寿期终止后，营运单位必须负责使其安全退役，并确保退役工作人员和公众所受到的辐射照射保持在合理可行尽量低的水平。只有经国家核安全部门批准之后，营运单位才能终止其责任。退役的最终状态必须经国家核安全部门会同国家其他有关部门批准。\n\n质量保证大纲的应用必须与规定物项对安全的重要程度相适应，并必须覆盖设施全寿期过程中的所有安全重要活动。\n\n营运单位必须对其核燃料循环设施质量保证大纲的制定、实施和评价负责。\n\n\n3.401 放射性废物安全监督管理规定\n放射性废物管理目标：是保护现在和将来人类的健康与环境，不给后代造成过度的负担。\n\n放射性废物管理原则-为了达到上述目标，放射性废物管理应遵守下述原则：①保护环境和人类健康：必须确保对环境和人类健康的影响不超过可接受水平；②超越国界的保护：必须考虑超越国界可能对人类健康和环境的影响；③保护后代：必须确保不给后代造成过度的负担，必须考虑对后代健康影响不超过今天可接受的有关影响水平；④必须遵守国家法律、法规和标准，包括明确划分责任和规定独立的监督管理职能；⑤控制放射性废物的产生：放射性废物的产生必须保持在实际可行的最低限度；⑥必须适当考虑放射性废物产生和管理的各个步骤间的相互依赖关系；⑦放射性废物管理设施必须确保其使用寿期内的安全。\n\n国家核安全部门的职责：制定有关法规、导则和技术文件；评价安全分析报告、有关文件和运行计划等；对设计、建造、运行以及人员资格审批；评价放射性废物处理、处置设施是否符合有关规定和标准；对不符合法规和标准要求的事项，要求采取补救和纠正措施。\n\n核设施营运单位的主要职责：及时完成放射性废物处置前工作；进行安全和环境影响评价；确保对工作人员、公众和环境足够的防护；确保放射性废物安全管理的各步骤有合适的工作人员、设备、设施、培训和操作程序；建立和执行质保大纲；建立和保持有关放射性废物的产生、预处理、处理、整备、贮存和处置，包括放射性废物存量信息的记录等职责。\n\n营运单位必须通过对核设施合适的设计、运行、维修与退役，使放射性废物的产生处于实际可行的最低限度。必须适当考虑放射性废物产生和管理各步骤间的相互依赖关系。保证放射性废物的处理和整备工作符合计划的贮存方式，使之在规定的贮存期限可回取废物进行最终处置。\n\n放射性废物产生与管理的所有步骤间存在相互依赖关系，因此，为放射性废物管理活动制定计划时，应考虑：①放射性废物量（活度和体积）应保持在实际可行的最低限度；②放射性废物管理各步骤的安全要求：决定放射性废物管理中某个具体步骤时，不应孤立考虑。\n\n安全分析和环境影响评价（双报告制度）：①报告编制与提交：针对新建放射性废物管理设施、现有设施或实践的重大变更，需同步编制安全分析报告（提交国家核安全部门）和环境影响评价报告（提交环境保护部门）；②评价范围：分析正常运行工况下的辐射安全与非辐射安全；评价事件和事故的可能影响必要时这种评价根据放射性废物管理原则论证长期安全性。\n\n安全分析和环境影响评价：①正常运行工况评价：应当分析和论证放射性废物管理过程的全流程对工作人员、公众和环境的辐射安全和非辐射安全。这些评价应该以设施设计和工艺过程为基础。②非放射学影响评定：需评估设施可能给人类生存、环境（土壤、水、空气和非人类生物群）和自然资源造成的非放射学影响。③事故工况评价：利用实验数据支持的模型，预测内部（设备故障）和外部事件（自然灾害）的后果，明确对人员、公众及环境的潜在危害程度。④长期性能论证：考虑可能被容纳的放射性废物的放射性核素含量、物理和化学特性，以及处置系统所提供的屏障的有效性。天然屏障的有效性应通过现场调查来确定。这种评价只能利用预先确定模型来进行，这些模型应是建立在实验数据的基础上。\n\n安全文化要求从事放射性废物管理的个人和组织对安全具有献身精神和责任感。\n\n提高安全意识的责任，主要由各组织的高层管理人员承担。\n\n质量保证应采取适当的措施为保护人类健康和环境提供必要的信任。\n\n营运单位应给质量保证职能部门提供充分的独立性。\n\n质量保证大纲特别应当确保废物货包满足废物接收的要求。\n\n当一个体系（如处置系统）的长期性能不能通过直接观察予以证明的情况下，应该通过研究和开发工作去获得必要的信息，也可通过参加国际合作研究去取得。\n\n营运单位和有关部门应考虑本国和国际实践所获得的经验和教训，以确定是否需要改进设备和工艺、培训人员或改变安全要求。\n\n文件和记录应包括：放射性废物存量、来源、所在地、物理和化学特性。必要时，还应有一份从设施转移出放射性废物的记录；\n\n放射性废物处置库关闭后的有组织的控制目的是：①防止人们闯入处置库；②防止移出或扰动放射性废物；③对照设计准则监测处置库的效能；④执行必要的补救行动。\n\n处置库：用于处置放射性废物的核设施（例如地质处置库）,将来不打算再把放射性废物回取出来。\n\n放射性废物管理：包括废物的装卸、预处理、处理、整备、运输、贮存和处置在内所有行政和技术的活动。\n\n\n3.402 放射性固体废物贮存和处置许可管理办法\n在我国境内专门从事放射性固体废物贮存、处置活动的单位，应当依照法取得放射性固体废物贮存许可证或处置许可证，由国务院环境保护主管部门审批、颁发。\n\n申请从事放射性固体废物贮存活动的单位，应具备条件之一：有三名以上放射性废物管理、辐射防护、环境监测方面的专业技术人员，其中至少有一名注册核安全工程师；\n\n申请从事低、中水平放射性固体废物处置活动的单位，应当具备主要条件：①有国有或者国有控股的企业法人资格，有不少于三干万元的注册资金：②有十名以上放射性废物管理、辐射防护、环境监测方面的专业技术人员，其中注册核安全工程师不少于三名；\n\n申请从事高水平放射性固体废物处置和α放射性固体废物处置活动的单位，应当具备主要条件：①有国有或者国有控股的企业法人资格，有不低于一亿元的注册资金；②有二十名以上放射性废物管理、辐射防护、环境监测方面的专业技术人员，其中注册核安全工程师不少于五名。\n\n申请领取处置许可证的单位，应当向国务院环境保护主管部门提出书面申请，提交的放射性固体废物处置管理制度证明文件包括：处置操作规程、质量保证大纲及程序文件清单、处置设施运行监测计划、辐射监测计划、应急预案、记录档案管理文件、信息管理系统证明文件等；主管部门自受理许可证申请之日起20个工作日内完成审查。\n\n贮存许可证和处置许可证的有效期为十年，许可证有效期届满90日前，向国务院环境保护主管部门提出延续申请。并提交下列材料：①许可证延续申请文件；②许可证有效期内的贮存或者处置活动总结报告；③辐射监测报告；④国务院环境保护主管部门要求的其他材料。\n\n贮存许可证持证单位应当如实完整地记录所收贮放射性固体废物来源、数量、特征、贮存位置、清洁解控或者送交处置等相关信息。\n\n贮存许可证持证单位应当于每年3月31日前，向国务院环境保护主管部门提交上一年度贮存活动总结报告，包括废物贮存、清洁解控、送交处置、辐射监测等内容。\n\n处置许可证持证单位应当如实完整地记录所处置放射性固体废物来源、数量、特征、处置位置等与处置活动有关的信息。放射性固体废物处置档案记录应当永久保存。\n\n处置许可证持证单位应当于每年3月31日前，向国务院环境保护主管部门提交上一年度处置活动总结报告，包括废物接收、处置设施运行、辐射监测等内容。\n\n\n\n\n\n项目\n贮存\n低、中水平放射性固体废物处置\n高水平放射性固体废物处置和α放射性固体废物处置\n\n\n\n企业法人资格\n&#x2F;\n国有或国有控股企业法人\n国有或国有控股企业法人\n\n\n注册资金\n&#x2F;\n不少于3000万元\n不低于1亿元\n\n\n专业技术人员\n3名以上（含1名注册核安全工程师）\n10名以上（其中注册核安全工程师不少于3名）\n20名以上（其中注册核安全工程师不少于5名）\n\n\n必要设施设备\n贮存设施、放射性检测设备\n处置设施、放射性检测设备、防护器材\n处置设施、放射性检测设备、防护器材\n\n\n财务担保\n&#x2F;\n需提供财务担保\n需提供财务担保\n\n\n档案管理\n记录档案管理\n记录档案和信息管理系统\n记录档案和信息管理系统\n\n\n管理制度\n管理制度、质保大纲及程序文件\n管理制度、质保大纲及程序文件\n管理制度、质保大纲及程序文件\n\n\n许可证审批\n国务院环保主管部门20个工作日内完成审查；\n国务院环保主管部门20个工作日内完成审查；\n国务院环保主管部门20个工作日内完成审查；\n\n\n许可证有效期\n许可证有效期10年，到期90日前申请延续\n许可证有效期10年，到期90日前申请延续\n许可证有效期10年，到期90日前申请延续\n\n\n记录要求\n来源、数量、特征、贮存位置、清洁解控或送交处置等信息\n来源、数量、特征、处置位置等与处置活动有关的信息\n来源、数量、特征、处置位置等与处置活动有关的信息\n\n\n记录保存\n&#x2F;\n放射性固体废物处置档案永久保存\n放射性固体废物处置档案永久保存\n\n\n年度报告提交\n每年3月31日前提交上一年度贮存活动总结报告\n每年3月31日前提交上一年度处置活动总结报告\n每年3月31日前提交上一年度处置活动总结报告\n\n\n年度报告内容\n废物贮存、清洁解控、送交处置、辐射监测等\n废物接收、处置设施运行、辐射监测等\n废物接收、处置设施运行、辐射监测等\n\n\n3.501 核材料管制条例实施细则\n核材料许可证持有单位法人代表对所持有的核材料负有全面安全责任。\n\n核材料许可证持有单位在核材料发生被盗、破坏、丢失、非法转让和非法使用事件时，必须迅速采取措施，并立即报告当地公安部门以及上级领导部门，并写出事故报告。\n\n国家对核材料实行许可证管理制度，申请单位必须提前六个月提交核材料许可证申请报告。申请核材料许可证必须提交的文件：核材料许可证申请报告、核材料账目与衡算管理实施计划；核材料实物保护与保密实施计划；其他必要的支持性文件。\n\n铀矿石及其初级产品（即核纯铀化合物之前的产品）、已移交给军队的核制品、以及免于登记的核材料不属于核材料帐务系统。\n\n许可证持有单位必须建立核材料衡算制度，在持有核材料期间，进行衡算工作。属下列情况的核材料，经测量和入帐后，其衡算工作即可终止：①已经在反应堆中消耗的；②已经按规定手续转让到另一单位的；③已经作为废气、废液排放，或者作为废物进行了处置，不再回收的。\n\n许可证持有单位，根据各自的特点，把核设施划分成材料平衡区，按核材料分类进行衡算，每个平衡区要有完整的账目，实行独立的材料衡算。\n\n许可证持有单位应建立核材料的实物盘存制度，其基本要求是：①每年至少进行一次全面、严格的实物盘存。对钚-239、铀-233及铀-235丰度大于20%的浓缩铀等核材料，每年至少进行两次实物盘存；②规定记录和报告的截止日期，在规定时间内（一般在年底）进行盘存；③制定实物盘存计划和工作程序，对盘存过程进行监督。\n\n为保证盘存准确可靠，必须做到：①按核材料的种类及物理化学形态进行分类盘存；②盘存中所有项目的核材料数量必须是测量值；③对设备中核材料的实物盘存和待回收物料，必须制定严格的措施，保证盘存质量；④排放或处置废气、废液、废物时必须测量其中的核材料含量。\n\n核材料账目的原始记录要求清楚、正确、系统和完整，至少保存五年；\n\n核材料衡算的方法及评价①核材料衡算应采用闭合平衡方法，其基本公式如下：不平衡差MUF&#x3D;期初存量+调入量-期末存量-调出量-已知损失量；②当不衡差MUF大于其标准误差的2倍时，就认为材料未达到闭合平衡，有可能存在核材料的丢失、盗窃或非法转移。\n\n根据核材料的质量、数量及危害性程度，划分为三个保护等级，实行分级管理。\n\n核材料实物保护，固定场所的警卫和守护：①一级核材料部位设武装警卫，出入人员使用专门证件，严格控制非本单位工作人员进入，确因工作需要进入者，须经单位主管领导批准，履行登记手续，并由本单位人员陪同；库房实行&quot;双人双锁&quot;制度；②二级核材料部位设武装警卫，或固定专人昼夜看守。出入人员使用专门证件；③三级核材料部位设专人看守，或将核材料存入安全装置内；\n\n固定场所的实体屏障：①一级核材料的场所至少要建立两道完整、可靠的实体屏障，储存一级核材料必须有保险库或保险柜；②二级核材料的场所要建立两道实体屏障，其中必须有一道是完整可靠的。储存二级核材料必须有坚固的库房或柜；③三级核材料的场所必须建立一道完整、可靠的实体屏障。\n\n托运单位负责运输保卫，应会同运输、产品、安防和保卫等有关部门制定运输保卫方案，一级及二级核材料运输保卫措施必须向当地公安机关报告；\n\n一级核材料的运输必须派武装押运；\n\n途中发生破坏、偷盗、抢劫核材料的事故或案件，要妥善保护现场，并迅速向当地公安机关及上级领导部门报告，协助有关部门追查处理。\n\n\n\n\n\n等级\n警卫措施\n实体屏障\n报警监视系统\n运输保卫措施\n\n\n\n一级\n武装警卫；严格控制人员出入\n两道完整可靠的实体屏障；保险库保险柜\n报警和监视安防系统\n运输保卫措施向当地公安报告；武装押运\n\n\n二级\n武装警卫或固定专人昼夜看守\n两道实体屏障（一道完整可靠）；坚固的库房或柜\n报警或监视\n运输保卫措施向当地公安报告\n\n\n三级\n专人看守或存入安全装置\n一道完整可靠的实体屏障\n&#x2F;\n&#x2F;\n\n\n3.601 民用核安全设备设计制造安装和无损检验监督管理规定\n从事民用核安全设备设计、制造、安装和无损检验活动的单位，应当取得民用核安全设备设计、制造、安装和无损检验许可证。\n\n民用核设施营运单位，应当对民用核安全设备设计、制造、安装和无损检验活动进行质量管理和过程控制，做好监造和验收工作；对在役的民用核安全设备进行检查、试验、检验和维修并对民用核安全设备的使用和运行安全承担全面责任。\n\n国务院核安全监管部门对民用核安全设备设计、制造、安装和无损检验活动实施监督管理。\n\n申请领取民用核安全设备无损检验许可证的单位，应当按照无损检验方法向国务院核安全监管部门提出申请。**无损检验方法包括射线检验（RT）、超声检验（UT）、磁粉检验（MT）、涡流检验（ET）、渗透检验（PT）、泄漏检验（LT）、目视检验（VT）**等。\n\n申请领取民用核安全设备制造或者安装许可证的单位，应当根据其申请的设备类别、核安全级别、活动范围、制造和安装工艺、材料牌号、结构型式等制作具有代表性的模拟件。还应当提交模拟件制作方案和质量计划、完成相应的鉴定试验。自受理之日起45个工作日内完成审查。\n\n民用核安全设备设计、制造、安装和无损检验许可证有效期限为5年。有效期届满6个月前，向国务院核安全监管部门提出延续申请\n\n民用核安全设备设计、制造、安装和无损检验单位变更许可证规定的活动种类或者范围的，应当向国务院核安全监管部门重新提出申请。\n\n民用核安全设备设计、制造、安装和无损检验单位应当根据其质量保证大纲和民用核设施营运单位的要求，在民用核安全设备设计、制造、安装和无损检验活动开始前，编制项目质量保证分大纲。项目质量保证分大纲应当适用、完整、接口关系明确，并经民用核设施营运单位审查认可。应当根据具体活动编制相应的质量计划，并经民用核设施营运单位审查认可。民用核安全设备设计、制造、安装和无损检验单位应当按照项目质量保证分大纲的要求，对所有过程进行控制，并对发现的问题进行处理和纠正。\n\n民用核安全设备设计单位在设计活动开始前，明确；确定设计接口控制措施、设计验证方式和内容以及设计变更控制措施。\n\n设计单位设计验证人员应当具有一定的设计经验、校核能力以及相对独立性。\n\n无损检验工作应当由民用核安全设备无损检验Ⅱ级或者Ⅱ级以上无损检验人员为主操作；无损检验结果报告应当由Ⅱ级或者Ⅱ级以上无损检验人员编制、审核，并履行相关审批手续。\n\n民用核安全设备设计、制造、安装和无损检验单位，不得将国务院核安全监管部门确定的关键工艺环节分包给其他单位。关键工艺清单由国务院核安全监管部门制定。\n\n民用核设施营运单位对民用核安全设备的安全运行负全面责任。\n\n民用核安全设备设计、制造、安装单位，应当在每季度开始7个工作日内，向国务院核安全监管部门提交上一季度活动情况报告。\n\n民用核安全设备无损检验单位，应当在完成无损检验10个工作日内，向国务院核安全监管部门报告无损检验内容和检验结果。\n\n民用核安全设备设计、制造、安装和无损检验单位，应当按照下列规定向国务院核安全监管部门报告：①开展涉及核安全的重要会议、论证等活动的，提前7个工作日报告：②出现重大质量问题的，在24小时内报告；③因影响民用核安全设备质量和核安全而导致民用核设施营运单位发出停工指令的，在3个工作日内通报。\n\n民用核安全设备设计、制造、安装和无损检验单位，应当于每年4月1日前向国务院核安全监管部门提交上一年度的评估报告。\n\n民用核安全设备监督检查分为例行检查和非例行检查。非例行检查可以不预先通知。监督检查分为综合性检查、专项检查和检查点检查，主要通过现场检查、文件检查、记录确认或者对话等方式进行：\n\n国务院核安全监管部门及其派出机构可以进行独立验证，验证方式包括计算复核和检验验证。检查点一般分**记录确认点（R点）、现场见证点（W点）、停工待检点（H点）**等三类。\n\n\n3.602 民用核安全设备无损检验人员资格管理规定\n无损检验人员的资格等级分为Ⅰ级（初级）、Ⅱ级（中级）和Ⅲ级（高级）。\n\n国务院核安全监管部门负责无损检验人员的资格管理，统一组织资格考核，颁发资格证书，对无损检验人员资格及相关资格考核活动进行监督检查。\n\nⅠ级无损检验人员在Ⅱ级或者Ⅲ级无损检验人员的监督指导下方可承担下列工作：①安装和使用仪器设备；②按照无损检验规程进行无损检验操作：③记录检验数据。\n\nⅡ级无损检验人员承担下列工作：①根据确定的工艺，编制无损检验规程；②调整和校验仪器设备，实施无损检验活动；③依据标准、规范和无损检验规程，评价检验结果；④编制无损检验结果报告；⑤监督和指导Ⅰ级无损检验人员；⑥本规定第七条所列工作。\n\nⅢ级无损检验人员承担下列工作：①确定无损检验技术和工艺；②制定特殊的无损检验工艺；③对无损检验结果进行评定；④编制验收准则；⑤审核无损检验规程和结果报告；⑥本规定第八条所列工作。\n\nⅠ级和Ⅱ级的资格考核包括理论考试和操作考试。Ⅲ级的资格考核包括理论考试、操作考试和综合答辩。\n\n资格证书的有效期限为5年。\n\n鼓励聘用单位对Ⅱ级和Ⅲ级无损检验人员在职称评定、薪酬待遇、荣誉激励等方面给予政策倾斜。\n\n无损检验人员一般应当固定在一个单位执业，确需在两个单位执业的，应当报国务院核安全监管部门备案。变更聘用单位的，应当由其聘用单位向国务院核安全监管部门。\n\n\n3.603 民用核安全设备焊接人员资格 管理规定\n国务院核安全监管部门负责焊接人员的资格管理，统一组织资格考核，颁发资格证书，对焊接人员资格及相关资格考核活动进行监督检查。\n\n焊接人员是指从事民用核安全设备焊接操作的焊工、焊接操作工；焊接方法是指焊接活动中的电弧焊（包括焊条电弧焊、钨极惰性气体保护电弧焊、熔化极气体保护电弧焊、埋弧焊等）和高能束焊（包括电子束焊、激光焊等）。\n\n首次参加资格考核的申请人员应当通过理论考试和相应焊接方法的操作考试。参加增加焊接方法资格考核的申请人员只需要进行相应焊接方法的操作考试。\n\n民用核安全设备焊接人员资格证书的有效期限为5年。\n\n焊接人员一般应当固定在一个单位执业，确需在两个单位执业的，应当报国务院核安全监管部门备案。焊接人员变更聘用单位，经国务院核安全监管部门同意后变更。\n\n焊接人员应当按照焊接工艺规程开展焊接活动。\n\n\n3.604 进口民用核安全设备监督管理规定\n国务院核安全监管部门负责对境外单位进行注册登记管理，并对其从事的民用核安全设备设计、制造、安装和无损检验活动实施监督检查。\n\n国务院核安全监管部门应当在受理申请后45个工作日内完成审查。\n\n国务院核安全监管部门可以组织专家进行技术评审，必要时可以派员到境外申请单位进行现场核查。技术评审和现场核查所需时间不计算在前款规定的期限内。\n\n注册登记确认书有效期限为5年。有效期届满6个月前，重新向国务院核安全监管部门提出注册登记申请。\n\n民用核设施营运单位，应当自对外贸易合同生效之日起20个工作日内，向国务院核安全监管部门及其派出机构提交书面报告。\n\n\n3.701 放射性物品运输安全许可管理办法\n范围：从事放射性物品运输和放射性物品运输容器设计、制造等活动，应当依法办理有关许可和备案手续。\n\n分类管理：国家对放射性物品运输实施分类管理，根据放射性物品的特性及其对人体健康和环境的潜在危害程度，将放射性物品分为一类、二类和三类。\n\n放射性物品的具体分类和名录，由国务院核安全监管部门制定。\n\n设计基本要求：一类放射性物品运输容器的设计，应当在首次用于制造前报国务院核安全监管部门审查批准。二类放射性物品运输容器的设计，应当在首次用于制造前报国务院核安全监管部门备案。\n\n设计单位应当通过试验验证，采用可靠、保守的分析论证，或者采取两者相结合的方式对设计的放射性物品运输容器的安全性能进行评价。\n\n放射性物品运输容器的设计应当满足国家放射性物品运输安全标准。\n\n申请批准一类放射性物品运输容器的设计，设计单位应当向国务院核安全监管部门提出书面申请，并提交下列材料：设计总图及其设计说明书、设计安全评价报告书；质量保证大纲。\n\n二类放射性物品运输容器的设计单位应当按照国家放射性物品运输安全标准进行设计，并在首次用于制造30日前，将下列材料报国务院核安全监管部门备案：设计总图及其设计说明书；设计安全评价报告表。\n\n国务院核安全监管部门应当自受理一类放射性物品运输容器的设计批准申请之日起45个工作日内完成审查。在审查过程中，应当组织专家进行技术评审。技术评审方式包括文件审查、审评对话、现场见证（检查）等。\n\n一类放射性物品运输容器设计批准书有效期为5年。有效期届满6个月前，向国务院核安全监管部门提出书面延续申请，并提交下列材料：质量保证大纲实施效果的说明；设计依据标准如有变化，是否符合新标准的说明。\n\n为了控制放射性物品在运输过程中可能产生的弥散，放射性物品设计成特殊形式或者低弥散形式的，其防弥散的形式可视为放射性物品运输容器包容系统的组成部分。\n\n特殊形式放射性物品和低弥散放射性物品的设计方案，应当符合国家放射性物品运输安全标准的有关要求，并报国务院核安全监管部门审查批准。\n\n从事一类放射性物品运输容器制造活动的单位，应当向国务院核安全监管部门申请领取制造许可证，应当自受理申请之日起45个工作日内完成审查。许可证有效期为5年。有效期届满6个月前，向国务院核安全监管部门提出书面延续申请。\n\n从事二类放射性物品运输容器制造活动的单位，应当报国务院核安全监管部门备案。\n\n使用境外单位制造的一类放射性物品运输容器的，应当在首次使用前报国务院核安全监管部门审查批准。自受理申请之日起45个工作日内完成审查，批准书有效期为5年。届满6个月前向国务院核安全监管部门提出书面延续申请。\n\n使用境外单位制造的二类放射性物品运输容器的，应当在首次使用前报国务院核安全监管部门备案。\n\n申请使用境外单位制造的一类放射性物品运输容器的单位，应当向国务院核安全监管部门提出书面申请，并提交下列材料：①设计单位所在国核安全监管部门颁发的设计批准文件的复印件；②设计单位出具的设计安全评价报告书；③ 制造单位相关业绩的证明材料；④制造单位出具的质量合格证明；⑤符合中华人民共和国法律、行政法规规定，以及国家放射性物品运输安全标者经国务院核安全监管部门认可的标准的说明材料。\n\n使用境外单位制造的二类放射性物品运输容器的，应当在首次使用前将下列文件报国务院核安全监管部门备案：①制造单位出具的质量合格证明；②设计单位出具的设计安全评价报告表；③符合中华人民共和国法律、行政法规规定，以及国家放射性物品运输安全标准或者经国务院核安全监管部门认可的标准的说明材料。\n\n托运一类放射性物品的，托运人应当编制放射性物品运输的核与辐射安全分析报告书，报国务院核安全监管部门审查批准。一类放射性物品从境外运抵中华人民共和国境内，或者途经我国境内运输的，托运人应当编制放射性物品运输的核与辐射安全分析报告书，报国务院核安全监管部门审查批准。二类、三类放射性物品从境外运抵中华人民共和国境内，或者途经中华人民共和国境内运输的，托运人应当编制放射性物品运输的辐射监测报告，报国务院核安全监管部门备案。\n\n托运人可以自行或者委托技术单位编制放射性物品运输的核与辐射安全分析报告书，报告书的格式和内容，由国务院核安全监管部门规定，监管部门应当自受理放射性物品运输的核与辐射安全分析报告书之日起45个工作日内完成审查。\n\n在审查过程中，国务院核安全监管部门可以组织专家进行技术评审。技术评审所需时间不计算在前款规定的期限内。\n\n一类放射性物品运输的核与辐射安全分析报告批准书有效期为5年。核与辐射安全分析报告批准书有效期届满，需要延续的，托运人应当于核与辐射安全分析报告批准书有效期届满6个月前，向国务院核安全监管部门提出书面延续申请。\n\n一类放射性物品启运前，托运人应当将下列材料报启运地的省、自治区、直辖市人民政府生态环境主管部门备案：一类放射性物品运输辐射监测备案表；辐射监测报告。辐射监测报告，在托运人委托有资质的辐射监测机构对拟托运一类放射性物品的表面污染和辐射水平实施监测后，由辐射监测机构出具。\n\n[特殊安排]有下列情形之一，托运人应当编制放射性物品运输的核与辐射安全分析报告书，在运输前报经国务院核安全监管部门审查同意：①因形状特异不适直专门设计和制造运输容器的；②只是一次性运输，专门设计和制造符合国家放射性物品运输安全标准的运输容器经济上明显不合理的。\n\n[过境运输审批]一类放射性物品从境外运抵中华人民共和国境内，或者途经中华人民共和国境内运输的，托运人或者其委托代理人应当编制放射性物品运输的核与辐射安全分析报告书，报国务院核安全监管部门审查批准。二类、三类，托运人应当委托有资质的单位监测，编制放射性物品运输的辐射监测报告，报国务院核安全监管部门备案。国务院核安全监管部门应当出具相应的放射性物品运输的辐射监测报告备案证明。\n\n对于运输容器相同，放射性内容物相同，且半衰期小于60天的放射性物品，进口单位可以每半年办理一次辐射监测报告备案手续。\n\n\n3.702 放射性物品运输安全监督管理办法\n国务院核安全监管部门负责对全国放射性物品运输的核与辐射安全实施监督管理。\n\n省、自治区、直辖市环境保护主管部门负责对本行政区域内放射性物品运输的核与辐射安全实施监督管理。\n\n放射性物品运输容器设计单位应当具备与设计工作相适应的设计人员、工作场所和设计手段，按照放射性物品运输容器设计的相关规范和标准从事设计活动，并为其设计的放射性物品运输容器的制造和使用单位提供必要的技术支持。\n\n从事一类放射性物品运输容器设计的单位应当依法取得设计批准书。设计批准书应当在设计阶段明确首次使用前对运输容器的结构、包容、屏蔽、传热和核临界安全功能进行检查的方法和要求。\n\n放射性物品运输容器设计单位应当通过试验验证或者分析论证等方式，对其设计的放射性物品运输容器的安全性能进行评价。安全性能评价应当贯穿整个设计过程，保证放射性物品运输容器的设计满足所有的安全要求。\n\n放射性物品运输容器设计单位应当按照国务院核安全监管部门规定的格式和内容编制设计安全评价文件。\n\n设计安全评价文件应当包括结构评价、热评价、包容评价、屏蔽评价、临界评价，货包（放射性物品运输容器与其放射性内容物）操作规程、验收试验和维修大纲，以及运输容器的工程图纸等内容。\n\n放射性物品运输容器设计单位对其设计的放射性物品运输容器进行试验验证的，应当在验证开始前至少20个工作日提请国务院核安全监管部门进行试验见证，并提交下列文件：①初步设计说明书和计算报告；②试验验证方式和试验大纲；③试验验证计划。国务院核安全监管部门应当及时组织对设计单位的试验验证过程进行见证，并做好相应的记录。\n\n开展特殊形式和低弥散放射性物品设计试验验证的单位，应当提交初步设计说明书和计算报告提请试验见证。\n\n申请批准一类放射性物品运输容器的设计，国务院核安全监管部门原则上应当对该设计活动进行一次现场检查；对于二类、三类放射性物品运输容器的设计，国务院核安全监管部门应当结合试验见证情况进行现场抽查。\n\n国务院核安全监管部门对放射性物品运输容器设计单位进行监督检查时，应当检查质量保证大纲和试验验证的实施情况、人员配备、设计装备、设计文件、安全性能评价过程记录、以往监督检查发现问题的整改落实情况等。\n\n放射性物品运输容器制造单位应当在制造活动开始前，依据设计提出的技术要求编制制造过程工艺文件；采用特种工艺的，应当进行必要的工艺试验或者工艺评定。\n\n一类、二类放射性物品运输容器制造单位，应当运输容器进行统一编码。应当于每年1月31日前将上一年度制造的运输容器的编码清单报国务院核安全监管部门备案。三类放射性物品运输容器制造单位，应当于每年1月31日前将上一年度制造的运输容器的型号及其数量、设计总图报国务院核安全监管部门备案。\n\n一类放射性物品运输容器制造单位应当在每次制造活动开始前至少三十日，向国务院核安全监管部门提交制造质量计划。国务院核安全监管部门应当根据制造活动的特点选取检查点并通知制造单位。\n\n国务院核安全监管部门对一类放射性物品运输容器的制造活动应当至少组织一次现场检查；对二类放射性物品运输容器的制造，应当对制造过程进行不定期抽查；对三类放射性物品运输容器的制造，应当根据每年的备案情况进行不定期抽查。\n\n一类放射性物品运输容器的使用单位在采购境外单位制造的运输容器时，应当在对外贸易合同中明确运输容器的设计、制造符合我国放射性物品运输安全法律法规要求，以及境外单位配合国务院核安全监管部门监督检查的义务。\n\n托运人对放射性物品运输的核与辐射安全和应急工作负责，对拟托运物品的合法性负责，并依法履行各项行政审批手续。托运一类放射性物品的托运人应当依法取得核与辐射安全分析报告批复后方可从事运输活动。\n\n托运人与承运人应当对直接从事放射性物品运输的工作人员进行运输安全和应急响应知识的培训和考核，并建立职业健康档案。\n\n接收人应当对所接收的放射性物品进行核对验收，发现异常及时通报托运人和承运人\n\n托运人应当根据拟托运放射性物品的潜在危害建立健全应急响应体系，针对具体运输活动编制应急响应指南，并在托运前提交承运人。\n\n托运人应当会同承运人定期开展相应的应急演习。\n\n托运人应当对每个放射性物品运输容器在制造完成后、首次使用前进行详细检查，确保放射性物品运输容器的包容、屏蔽、传热、核临界安全功能符合设计要求。\n\n托运人应当按照运输容器的特点，制定每次启运前检查或者试验程序，并按照程序进行检查。检查时应当核实内容物符合性，并对运输容器的吊装设备、密封性能、温度、压力等进行检测和检查，确保货包的热和压力已达到平衡、稳定状态，密闭性能完好。\n\n对装有易裂变材料的放射性物品运输容器，应当检查吊装设备、密封性能、温度、压力、中子毒物和其他临界控制措施。\n\n托运一类放射性物品的，托运人应当委托有资质的辐射监测机构在启运前对其表面污染和辐射水平实施监测，辐射监测机构应当出具辐射监测报告。\n\n托运二类、三类放射性物品的，托运人应当对其表面污染和辐射水平实施监测，并编制辐射监测报告，存档备查。\n\n托运人应当根据放射性物品运输安全标准，限制单个运输工具上放射性物品货包的数量。承运人应当按照托运人的要求运输货包。放射性物品运输和中途贮存期间，承运人应当妥善堆放，采取必要的隔离措施，并严格执行辐射防护和监测要求。\n\n在运输途中货包受损、发生泄漏或者有泄漏可能的，托运人和承运人应当立即采取措施保护现场，限制非专业人员接近，并由具备辐射防护与安全防护知识的专业技术人员按放射性物品运输安全标准要求评定货包的污染程度和辐射水平，消除或者减轻货包泄漏、损坏造成的后果。经评定，货包泄漏量超过放射性物品运输安全标准要求的，托运人和承运人应当立即报告事故发生地的县级以上环境保护主管部门，并在环境保护主管部门监督下将货包移至临时场所。货包完成修理和去污之后，方可向外发送。\n\n放射性物品运输中发生核与辐射安全事故时，托运人和承运人应当根据核与辐射事故应急响应指南的要求，做好事故应急工作，并立即报告事故发生地的县级以上环境保护主管部门。\n\n一类放射性物品启运前，托运人应当将放射性物品运输的核与辐射安全分析报告批准书、辐射监测报告，报启运地的省、自治区、直辖市环境保护主管部门备案。\n\n对一类放射性物品的运输，启运地的省、自治区、直辖市环境保护主管部门应当在启运前对放射性物品运输托运人的运输准备情况进行监督检查。\n\n对一类放射性物品的运输，冶运地的省、自治区、直辖市环境保护主管部门对运输频次比较高、运输活动比较集中的，可以根据实际情况制定监督检查计划，原则上检查频次每月不少于一次；对二类放射性物品的运输，可以根据实际情况开展抽查，原则上检查频次每季度不少于一次；对三类放射性物品的运输，可以根据实际情况实施抽查，原则上检查频次每年不少于一次。\n\n省、自治区、直辖市环境保护主管部门应当根据运输货包的类别和数量，按照放射性物品运输安全标准对本行政区域内放射性物品运输货包的表面污染和辐射水平开展启运前的监督性监测。\n\n放射性物品运输容器使用单位应当按照放射性物品运输安全标准和设计要求制定容器的维修和维护程序，严格按照程序进行维修和维护，并建立维修、维护和保养档案。\n\n一类放射性物品运输容器使用单位应当对其使用的一类放射性物品运输容器每两年进行一次安全性能评价。安全性能评价应当在两年使用期届满前至少三个月进行，并在使用期届满前至少两个月编制定期安全性能评价报告。\n\n定期安全性能评价报告，应当包括运输容器的运行历史和现状、检查和检修及发现问题的处理情况、定期检查和试验等内容。\n\n一类放射性物品运输容器使用单位应当于两年使用期届满前至少三十日，将安全性能评价结果报国务院核安全监管部门备案。\n\n放射性物品启运前的监督检查包括以下内容：①运输容器及放射性内容物：检查运输容器的日常维修和维护记录、定期安全性能评价记录（限一类放射性物品运输容器）、编码（限一类、二类放射性物品运输容器）等，确保运输容器及内容物均符合设计的要求。②托运人启运前辐射监测情况，以及随车辐射监测设备的配备；③表面污染和辐射水平；④标记、标志和标牌是否符合要求；⑤运输说明书，包括特殊的装卸作业要求、安全防护指南、放射性物品的品名、数量、物理化学形态、危害风险以及必要的运输路线的指示等；⑥核与辐射事故应急响应指南；⑦核与辐射安全分析报告批准书、运输容器设计批准书等相关证书的持有情况；⑧直接从事放射性物品运输的工作人员的运输安全、辐射防护和应急响应知识的培训和考核情况；⑨直接从事放射性物品运输的工作人员的辐射防护管理情况。\n\n对一类、二类放射性物品运输的监督检查，还应当包括卫星定位系统的配备情况。\n\n\n4.1 研究堆安全分类\n\n\n分类\nI类研究堆\nII类研究堆\nIII类研究堆\n\n\n\n分类准则\n功率低、剩余反应性低、裂变产物总量少\n功率、剩余反应性和裂变产物总量属于中等\n功率、剩余反应性和裂变产物总量都较高\n\n\n功率等级\n小于500 kW\n500kW～10MW\n10MW\n\n\n冷却方式\n自然对流冷却\n自然对流冷却或强迫循环冷却\n强迫循环\n\n\n停堆与冷却\n可靠的停堆手段或较好的负反馈效应，不要求有专设堆芯冷却系统\n保证堆芯在要求时间内得到冷却\n必须设置应急冷却，以保证堆芯余热的有效排出\n\n\n安全要求\n即使厂房倒塌或由于堆水池或其他包容结构的正常密封丧失造成堆芯或乏燃料裸露于空气，以及堆芯燃料重大破裂\n只要厂房不倒塌、堆芯水池或容器不丧失正常的密封性、反应堆堆芯不裸露堆芯流道不堵塞\n只有在反应堆厂房或包容体、堆芯或容器或其他包容结构不丧失正常的完整性密封性\n\n\n安全要求\n即使厂房倒塌或由于堆水池或其他包容结构的正常密封丧失造成堆芯或乏燃料裸露于空气，以及堆芯燃料重大破裂\n只要厂房不倒塌、堆芯水池或容器不丧失正常的密封性、反应堆堆芯不裸露堆芯流道不堵塞\n只有在反应堆厂房或包容体、堆芯或容器或其他包容结构不丧失正常的完整性密封性\n\n\n4.2 民用核燃料循环设施分类原则与基本安全要求\n核燃料循环设施安全总目标是建立并保持对电离辐射的有效防御，以保护人和环境免于电离辐射的危害。\n\n辐射防护目标：任何辐射照射情况下，保持在低于国家规定限值并处于可合理达到的尽量低水平，确保减轻事故的辐射后果。\n\n技术安全目标：采取一切合理可行的措施预防事故的发生，并在一旦发生事故时减轻其辐射后果和化学危害后果；对于在设计中考虑过的所有可能事故，包括概率很低的事故，要以高可信度保证辐射后果和化学危害后果低于国家规定限值且尽可能小，并保证有严重辐射后果的事故发生的概率极低。\n\n纵深防御应贯彻于核燃料循环设施安全有关的全部活动，包括与组织人员行为或设计等有关方面，以保证这些活动均置于多重防御措施之下。即使有故障发生，它也将由适当措施予以探测、补偿或纠正。\n\n设计应采用纵深防御，以提高多层次防御（固有特性、设备及规程）能力\n\n纵深防御通常分为五个层次。每一独立有效层次的防御都是纵深防御的基本组成部分。应确保与安全相关的活动能够纳入独立的纵深防御层次。\n\n\n\n\n\n纵深防御层次\n防御目标\n\n\n\n第一层次防御\n防止偏离正常运行及防止系统失效\n\n\n第二层次防御\n探测和纠正偏离正常运行状态\n\n\n第三层次防御\n事故控制在设计基准范围内\n\n\n第四层次防御\n控制超设计基准事故，包括阻止事故的发展和缓解事故后果\n\n\n第五层次防御\n减轻放射性物质大量释放造成的放射性后果\n\n\n\n核燃料循环设施纵深防御层次及每一层纵深防御的程度（独立性、多样性和冗余性）应与设施的潜在危害相适应，具体措施可通过安全分析进行评价和确定。\n\n核燃料循环设施根据放射性物质总量、形态和潜在事故风险或后果进行分类。按照合理、简化方法，核燃料循环设施分为如下四类：\n\n\n\n   一类       厂外显著风险            后处理、高放废液集中处理&#x2F;贮存\n\n\n\n分类\n风险特征\n主要设施类型\n\n\n\n一类\n厂外显著风险\n后处理、高放废液集中处理&#x2F;贮存\n\n\n二类\n厂内显著风险并高临界\n离堆乏燃料贮存、MOX元件制造\n\n\n三类\n厂内显著风险或临界\n铀浓缩、铀元件制造、中低放集中处理&#x2F;贮存\n\n\n四类\n厂内风险或工业风险\n天然铀纯化&#x2F;转化、重水堆元件制造\n\n\n\n核燃料循环设施营运单位应落实故障安全理念和双偶然原则，在设计中尽可能通过工程措施提高设施的固有安全性，并在运行中高度重视临界安全的行政管理，确保易裂变物质的操作、加工、处理和贮存的临界安全。在可能发生临界事故的场所，应设置足够灵敏和可靠的临界事故探测与报警系统。\n\n核燃料循环设施营运单位应在设计和运行中采取工程措施和管理措施保证实现辐射防护目标和技术安全目标，确定合理的剂量约束和潜在照射危险约束，制定辐射防护大纲、流出物监测和辐射环境监测大纲，实施辐射防护最优化。\n\n核燃料循环设施的设计和运行应采取先进成熟的工艺和合理可行的措施，确保废物安全，实现放射性废物最小化。\n\n一类设施基本安全要求：设施中抗震|类物项的抗震设计基准按万年一遇考虑。设施防洪投计按可能最大洪水考虑。应急状态一般分为应急待命、厂房应急、场区应急和场外应急。\n\n二类设施基本安全要求：设施中抗震I类物项的抗震设计基准按万年一遇考虑，MOX元件制造设施中抗震类物项可按50年超越概率10%地震作用进行弹性设计。设施防洪设计按可能最大洪水考虑。应急状态原则上分力应急待命、厂房应急和场区应急。\n\n三类设施基本安全要求：重要建（构）筑物抗震设防类别应按特殊设防类执行，即50年超越概率63%地震作用的两倍进行弹性设计，50年超越概率2%~3%地震作用的两倍进行弹塑性验算设施防洪设计按不低于500年一遇洪水考虑。应急状态一般分为应急待命和厂房应急，也可能包括局部区域场区应急。\n\n四类设施基本安全要求：重要建（构）筑物抗震设计基准按不低于建筑工程重点设防类执行。设施防洪设计按不低于200年一遇洪水考虑。营运单位应根据事故评价结果制定有效的应急预案\n\n核燃料循环设施营运单位应通过辐射分区、辐射屏蔽、密封、通风过滤、出入口控制和辐射监测等措施，控制放射性物质对人体的辐射照射和沾污。\n\n\n\n\n\n类别\n设施单位\n抗震设计基准\n防洪设计\n应急状态\n\n\n\n一类设施\n后处理设施；高放废液集中处理\n抗震I类物项，万年一遇\n最大洪水\n应急待命、厂房应急、场区应急、场外应急\n\n\n二类设施\n离堆乏燃料贮存设施；MOX元件混合\n抗震I类物项，万年一遇；\n最大洪水\n应急待命、厂房应急、场区应急\n\n\n^\n\nMOX元件按50年超越概率10%地震进行弹性设计\n\n\n\n\n三类设施\n铀浓缩设施、铀燃料元件制造设施、\n特殊设防类执行:\n500年一遇\n应急待命、厂房应急、局部场区应急\n\n\n^\n中低放废液集中处理、贮存设施\n- 50年超越概率63%地震两倍进行弹性设计\n\n\n\n\n^\n\n- 50年超越概率2%~3%地震两倍进行弹塑性验算\n\n\n\n\n四类设施\n天然铀纯化&#x2F;转化设施；天然铀设\n不低于建筑工程重点设防类执行\n200年一遇\n根据事故评价结果制定\n\n\n\n在影响安全的因素发生重大变化时，应根据设施安全特性、运行现状（特别是放射性存量）结合具体的厂址特征，采用现实假设对核设施进行安全评估，采取一事一议的方式，确定整改和运行方案。\n\n4.3 放射性物品分类和名录\n按照国务院《放射性物品运输安全管理条例》中第三条的规定，根据放射性物品的特性及其对人体健康和环境的潜在危害程度，将放射性物品分为一类、二类和三类。\n\n\n\n\n放射性物品等级\n主要物品\n辐射影响程度\n\n\n\n一类放射性物品\nⅠ类放射源、高水平放射性废物、乏燃料\n重大辐射影响\n\n\n二类放射性物品\nⅡ类和Ⅲ类放射源、中等水平放射性废物\n一般辐射影响\n\n\n三类放射性物品\nIV类和V类放射源、低水平放射性废物、放射性药品\n较小辐射影响\n\n\n\n放射性物品分类不改变国标GB11806中关于放射性物品货包的分类及相应的设计要求。放射性物品分类和名录与GB12268中有关放射性物品运输分类和列名等内容协调一致。\n\n4.4 放射性废物分类\n放射性废物分类体系基本原则是，以实现放射性废物的最终安全处置为目标，根据各类废物的潜在危害以及处置时所需的包容和隔离程度进行分类，并使废物的类别与处置方式相关联，确保废物处置的长期安全。\n\n建立放射性废物分类体系的目的是，为国家放射性废物管理战略提供基础，为放射性废物的产生、处理、贮存、处置等全过程安全管理提供依据，确保以安全和经济的方式管理废物。\n\n放射性废物分为极短寿命放射性废物、极低水平放射性废物、低水平放射性废物、中水平放射性废物和高水平放射性废物等五类，其中极短寿命放射性废物和极低水平放射性废物属于低水平放射性废物范畴。\n\n放射性废物活度浓度越高，对废物包容和与生物圈隔离的要求就越高。豁免废物或解控废物不属于放射性废物。\n\n极短寿命放射性废物、极低水平放射性废物、低水平放射性废物、中水平放射性废物和高水平放射性废物对应的处置方式分别为贮存衰变后解控、填埋处置、近地表处置、中等深度处置和深地质处置。\n\n豁免或者解控的剂量准则：在合理预见的一切情况下，被豁免的实践或源（或者被解控的物质）使任何个人一年内所受到的有效剂量在10μSv量级或更小，而且即使在发生低概率的意外不利情况下，所受到的年有效剂量不超过1mSv。对于主要含天然放射性核素的大量物质，应当采用年附加有效剂量不超过1mSv作为豁免剂量准则。\n\n极短寿命放射性废物：废物中所含主要放射性核素的半衰期很短，长寿命放射性核素的活度浓度在解控水平以下极低水平，极短寿命放射性核素半衰期一般小于100天，通过最多几年时间的贮存衰变，放射性核素活度浓度即可达到解控水平，实施解控。常见的极短寿命放射性废物如医疗使用碘-131及其他极短寿命放射性核素时产生的废物\n\n极低水平放射性废物：废物中放射性核素活度浓度接近或者略高于豁免水平或解控水平长寿命放射性核素的活度浓度应当非常有限，仅需采取有限的包容和隔离措施，可以在地表填埋设施处置，或者按照国家固体废物管理规定，在工业固体废物填埋场中处置。极低水平放射性废物的活度浓度下限值为解控水平，上限值一般为解控水平的10~100倍常见极低水平放射性废物如核设施退役过程中产生的污染土壤和建筑垃圾。\n\n低水平放射性废物：废物中短寿命放射性核素活度浓度可以较高，长寿命放射性核素含量有限，需要长达几百年时间的有效包容和隔离，可以在具有工程屏障的近地表处置设施中处置。近地表处置设施深度一般为地表到地下30米。低水平放射性废物的活度浓度下限值为极低水平放射性废物活度浓度上限值。低水平放射性废物来源广泛，如核电正常运行产生的离子交换树脂和放射性浓缩液的固化物。\n\n中水平放射性废物：废物中含有相当数量的长寿命核素，特别是发射α粒子的放射性核素，不能依靠监护措施确保废物的处置安全，需要采取比近地表处置更高程度的包容和隔离措施，处置深度通常为地下几十到几百米。一般情况下，中水平放射性废物贮存和处置期间不需要提供散热措施。中水平放射性废物的活度浓度下限值为低水平放射性废物活度浓度上限值，中水平放射性废物的活度浓度上限值为4E11Bq&#x2F;kg，且释热率小于或等于2kW&#x2F;m³。中水平放射性废物一般来源于含放射性核素钚-239的物料操作过程、乏燃料后处理设施运行和退役过程等。\n\n高水平放射性废物：废物所含放射性核素活度浓度很高，使得衰变过程中产生大量的热，或者含有大量长寿命放射性核素，需要更高程度的包容和隔离，需要采取散热措施应采取深地质处置方式处置。高水平放射性废物的活度浓度下限值为4E11Bq&#x2F;kg，或释热率大于2kW&#x2F;m³。常见的高水平放射性废物如乏燃料后处理设施运行产生的高放玻璃固化体和不进行后处理的乏燃料。\n\n\n\n\n\n分类\n极短寿命放射性废物\n极低水平放射性废物\n低水平放射性废物\n中水平放射性废物\n高水平放射性废物\n\n\n\n处置方式\n贮存衰变后解控\n填埋处置\n近地表处置 0～-30m\n中等深度处置 几十～几百米\n深地质处置\n\n\n处置期限\n-\n-\n几百年\n-\n-\n\n\n半衰期特征\nT₁&#x2F;₂ &lt; 100d\n-\n-\n-\n-\n\n\n活度浓度特征\n-\n接近豁免&#x2F;解控水平，\n短寿命浓度可较高，长寿命有限\n相当数量的长寿命，特别含α的，\n活度浓度很高，大量释热，大量长寿命\n\n\n活度浓度max\n-\nmax为解控水平的10～100倍\n-\nmax为4E11Bq&#x2F;kg；释热率≤2kW&#x2F;m³\n-\n\n\n散热要求\n-\n-\n-\n不需要散热措施\n需要散热措施\n\n\n典型废物\n医用碘-131（8d）\n核退役中的土壤、建筑垃圾\n树脂、浓缩液的固化物\n钚-239工艺、后处理产生的废物\n高放废液玻璃固化体、不进行后处理的乏燃料\n\n\n4.10 注册核安全工程师执业资格关键岗位名录工程公司20；设计、审评16；营运（2机组）8；多堆4+n；单堆2；甲环7；铀燃后345；\n5.1 核材料实物保护公约及其修正案1989年对中国生效。\n5.2 核设施与核材料实物保护公约\n“核材料”系指钚，但钚-238同位素含量超过80%者除外；铀-233；同位素235或233浓缩的铀；非矿石或矿渣形式的含天然存在的同位素混合物的铀；任何含有上述一种或多种成分的材料；\n\n“同位素235或233浓缩的铀”系指含有铀同位素235或233或两者总含量对同位素238的丰度比大于天然存在的同位素235对同位素238的丰度比的铀；\n\n一缔约国建立、实施和维护实物保护制度的责任完全在于该国。\n\n每一缔约国应建立、实施和维护适用于在其管辖下核材料和核设施的适当的实物保护制度，目的是：①防止盗窃和其他非法获取在使用、贮存和运输中的核材料；②确保采取迅速和综合的措施，以查戏和在适当时追回失踪或被盗的核材料：当该材料在其领土之外时，该缔约国应依照第五条采取行动；③保护核材料和核设施免遭破坏；④减轻或尽量减少破坏所造成的放射性后果。\n\n防止盗窃和其他非法获取在使用、贮存和运输中的核材料，每一缔约国应：①建立和维护管理实物保护的法律和监管框架；②设立或指定一个或几个负责实施法律和监管框架的主管部门；③采取对核材料和核设施实物保护必要的其他适当措施。\n\n每一缔约国应在不妨碍本公约任何其他条款的情况下，在合理和切实可行的范围内适用以下”核材料和核设施实物保护的基本原则”。基本原则一：国家责任；基本原则二：国际运输中的责任；基本原则三：法律和监管框架；基本原则四：主管部门；基本原则五：许可正持有者的责任；基本原则六：安全保卫文化；基本原则七：威胁；基本原则八：分级方案；基本原则九：纵深防御；基本原则十：质量保证；基本原则十一：意外情况计划；基本原则十二：保密问题\n\n每一缔约国应在其国内法律范围内采取符合国际法的适当步骤，以便尽可能切实保证在进行国际核运输时，其国境内的核材料、或装载在往来该国从事运输活动并属其管辖的船舶或飞机上的核材料，均按照附件所列级别予以保护。\n\n有关缔约国应酌情相互并与国际原子能机构和其他相关国际组织交换信息，以便保护受到或胁的核材料，核查装运容器的完整性或追回被非法获取的核材料，并应①经由外交和其他商定途径协调其工作；②在接到请求时给予协助；③确保归还已追回的因上述事件被盗或丢失的核材料。\n\n两个或两个以上缔约国之间发生有关本公约的解释或应用的争端时，这些缔约国应进行协调以期用谈判方法或争端各方都可接受的任何其他和平解决争端方法来解决争端。\n\n\n5.3 核安全公约\n核安全公约的目的是：①通过加强本国措施与国际合作，包括适当情况下与安全有关的技术合作，以在世界范围内实现和维持高水平的核安全；②在核设施内建立和维持防止潜在辐射危害的有效防御措施，以保护个人、社会和环境免受来自此类设施的电离辐射的有害影响；③防止带有放射后果的事故发生和一旦发生事故时减轻此种后果。\n\n必要时该缔约方应确保作为紧急事项采取一切合理可行的改进措施，以提高核设施的安全性。如果此种提高无法实现，则应尽可能快地执行使这一核设施停止运行的计划。确定停止运行的日期时得考虑整个能源状况和可能的替代方案以及社会、环境和经济影响。\n\n每一缔约方应采取适当步骤确保将监管机构的职能与参与促进或利用核能的任何其他机构或组织的职能有效地分开。\n\n每一缔约方应确保核设施安全的首要责任由有关许可证的持有者承担，并应采取适当步骤确保此种许可证的每一持有者履行其责任。\n\n安全优先：每一约方应采取适当步骤确保从事与核设施直接有关活动的一切组织为核安全制定应有的优先政策。\n\n人的因素：每一缔约方应采取适当步骤，以确保在核设施的整个寿期内都要考虑到人的工作能力和局限性。\n\n在核设施建造和调试之前及在其整个寿期内进行全面而系统的安全评价，此类评价应形成文件并妥善归档，随后根据运行经验和新的重要安全资料不断更新，并在监管机构的主管下进行审查。\n\n利用分析、监视、试验和检查进行核实，以确保核设施的实际状况和运行始终符合其设计、可适用的本国安全要求以及运行限值和条件。\n\n对于任何新的核设施，厂内和厂外应急计划应在该核设施以监管机构同意的高于某个低功率水平开始运行前编制好并作过演习。\n\n核设施的设计考虑到运行可靠、稳定和容易管理，并特别注意人的因素和人机接口。\n\n缔约方会议的语文为阿拉伯文、中文、英文、法文、俄文和西班牙文。\n\n\n5.4 乏燃料管理安全和放射性废物管理安全联合公约\n目标：①通过加强本国措施和国际合作，包括情况合适时与安全有关的技术合作，以在世界范围内达到和维持乏燃料和放射性废物管理方面的高安全水平；②在满足当代人的需要和愿望而又无损于后代满足其需要和愿望的能力的前提下，确保在乏燃料和放射性废物管理的一切阶段都有防止潜在危害的有效防御措施，以便在目前和将来保护个人、社会和环境免受电离辐射的有害影响；③防止在乏燃料或放射性废物管理的任何阶段有放射后果的事故发生，和一旦发生事故时减轻事故后果。\n\n“处置”系指将乏燃料或放射性废物置于合适的设施内并且不打算回取；\n\n“贮存”系指为回取将乏燃料或放射性废物存放于起保护作用的设施；\n\n“密封源”系指永久密封在小盒内或受到严密约束并呈固态的放射性物质，不包括反应堆燃料元件；\n\n乏燃料、放射性废物管理一般安全要求：每一缔约方应采取以下适当步骤，以确保在乏然料管理的所有阶段充分保护个人、社会和环境免受放射危害。①确保乏燃料、放射性废物管理期间的临界问题和所产生余热的排除问题得到妥善解决；②确保与乏燃料管理有关的放射性废物的产生保持在与所采取的循环政策类型相一致的可实际达到的最低水平；确保放射性废物的产生保持在可实际达到的最低水平；③考虑乏燃料、放射性废物管理的不同步骤之间的相互依赖关系；④在充分尊重国际认可的准则和标准的本国的立法框架内，通过在国家一级应用监管机构核准的适当保护方法，对个人、社会和环境提供有效保护；⑤考虑可能与乏燃料管理、放射性废物管理有关的生物学、化学和其他危害；⑥努力避免那些对后代产生的能合理预计到的影响大于对当代人允许的影响的行动；⑦避免使后代承受过度的负担。\n\n放射性废物管理设施系指主要用于放射性废物管理的任何设施或装置，包括正在退役的核设施，条件是缔约方将其指定为放射性废物管理设施；\n\n拟议中乏燃料设施的选址，若邻近缔约方可能受影响，需跨境协商与数据共享提供设施总体数据，供其评估本国安全风险。\n\n设计和建造设计阶段就考虑乏燃料、放射性废物管理设施退役的概念性计划并在必要时考虑有关的技术准备措施；\n\n在乏燃料、放射性废物管理设施建造前进行系统的安全评价及环境评价，此类评价应与该设施可能有的危害相称，并涵盖其运行寿期；\n\n每一缔约方应在本国的法律框架内采取为履行本公约规定义务所必需的立法、监管和行政管理措施及其他步骤。\n\n任何个人在正常情况下受到的辐射剂量不超过充分考虑到国际认可的辐射防护标准后制定的本国剂量限制规定；\n\n每一缔约方应采取适当步骤，以确保排放受到限制，以便：①在考虑到经济和社会因素的条件下使辐射照射保持在可合理达到的尽量低的水平；②使任何个人在正常情况下受到的辐射剂量不超过充分考虑到国际认可的辐射防护标准后制定的本国剂量限制规定。\n\n在缔约方的领土可能受到附近的乏燃料或放射性废物管理设施一旦发生的辐射紧急情况的影响的情况下，该缔约方应采取适当步骤，编制和演习适用于其领土内的应急计划。\n\n参与超越国界运输的每一缔约方，作为启运国的缔约方应采取适当步骤，以确保超越国界运输系经批准并仅在事先通知抵达国和得到其同意的情况下进行；\n\n途经过境国的超越国界运输应受与所用具体运输方式有关的国际义务的制约；\n\n作为抵达国的缔约方，仅当其具有以符合本公约的方式管理乏燃料或放射性废物所需的监管体制及行政管理和技术能力时，才能同意超越国界运输；\n\n作为启运国的缔约方应采取适当步骤，以便在超越国界运输没有或不能遵照本条的规定完成且不能作出另外的安全安排时允许返回其领土。\n\n缔约方不允许将其乏燃料或放射性废物运至南纬60度以南的任一目的地进行贮存或处置。\n\n缔约方应允许废密封源返回其领土，条件是该缔约方已在本国的法律框架内同意将废密封源返回有资格接收和拥有废密封源的制造者。\n\n每一缔约方应向每次缔约方审议会议提交一份国家报告，国家报告包括以下内容：①乏燃料管理政策；②乏燃料管理实践；③放射性废物管理政策；④放射性废物管理实践；⑤放射性废物的定义和分类所用的准则。\n\n\n5.5 及早通报核事故公约\n《及早通报核事故公约》适用于缔约国的或其管辖或控制下的人或法律实体的设施或活动、由此而引起或可能引起放射性物质释放、并已经造成或可能造成对另一国具有辐射安全重要影响的超越国界的国际性释放的任何事故。\n\n缔约国在发生核事故时应立即直接或通过国际原子能机构，将该核事故及其性质、发生时间和在适当情况下确切地点通知实际受影响或可能会实际受影响的国家和机构；以及提供有关尽量减少对那些国家的辐射后果的情报。应提供的情报：①核事故的时间、在适当情况下确切地点及其性质；②涉及的设施或活动；③推测的或已确定的有关放射性物质超越国界释放的核事故的起因和可预见的发展；④放射性释放的一般特点，按实际可能和适当情况，包括放射性释放的性质、可能的物理和化学形态及数量、组成和有效高度；⑤预报放射性物质超越国界释放所需的当前和预测的气象和水文条件的情报；⑥有关放射性物质超越国界释放的环境监测结果；⑦已采取或计划采取的场外保护措施；⑧预测的放射性释放过程中的行为。\n\n为促进其共同利益，各缔约国可考虑酌情缔结有关本公约主题事项的双边或多边协定。\n\n若缔约国之间，或一缔约国与机构之间，对本公约的解释或适用发生争端，争端各方应进行磋商，以期通过谈判或以争端各方均能接受的任何其他和平方式解决争端。\n\n\n5.6 核事故或辐射紧急援助公约\n缔约国在发生核事故或辐射紧急情况时需要援助，不论是否起始于其领土、管辖或控制范围内，可以直接或通过机构向任何其他缔约国和向机构或其他政府间国际组织请求援助。\n\n请求援助的缔约国应详细说明所需援助的范围和种类，并按实际可能向援助方提供必要的情报，以便援助方确定其能满足请求的程度。\n\n各缔约国应在其力所能及的范围内确定并通知机构，在核事故或辐射紧急情况下向其他缔约国提供援助可动用的专家、设备和物资以及据以能够提供这种援助的条件，尤其是财务条件。\n\n任何缔约国可以请求对受到核事故或辐射紧急情况影响的人们进行医疗或暂时安置到另一缔约国领土内的援助。\n\n对援助的全面指导、管理、协调和监督应是请求国在其领土范围内的责任。\n\n在援助涉及到人员的情况下，援助方应与请求国协商指定人员负责并对所提供的人员和设备保持直接的业务监督。\n\n请求国应尽其所能为援助的妥善和有效管理提供当地的设施和劳务。\n\n请求国应保证对援助方或代表该方为此目的而进入其领土的人员、设备和物资予以保护。\n\n援助期间任一方提供的设备和物资的所有权不得变动，并应确保这类设备和物资的归还；\n\n援助方在向公众公布有关核事故或辐射紧急情况下所提供的援助情况之前，应尽一切努力与请求国协调一致。\n\n任一援助方可向请求国免费提供援助。在研究是否在这种基础上提供援助时，援助方应考虑到：①核事故或辐射紧急情况的性质；②核事故或辐射紧急情况的起源地；③发展中国家的需要；④无核设施国家的特殊需要；以及⑤任何其他有关因素。\n\n请求国应给予援助方的人员和代表其行事的人员必要的特权、豁免和便利，以便履行其援助职务。\n\n请求国应：对援助方为援助目的而运入请求国境内的设备和财物免除征税、关税或其他课征。对此类设备和财物免予没收、扣押或征用。\n\n在不妨碍特权和豁免的情况下，凡享有本条所列特权和豁免的受益人，均有义务遵守请求国的法律和规章。他们还有义务不得干涉请求国的内政。\n\n\n","categories":["NSE"],"tags":["NSE"]},{"title":"导出 autocad 中的表格数据","url":"/2025/08/22/mechatronic/autocad-table/","content":"# %%# 提取 cad 中的表格# pip install pyautocad# https://github.com/reclosedev/pyautocad/blob/master/examples/cable_tables_to_csv.pyfrom pyautocad import Autocadfrom rich.pretty import pprintfrom tqdm import tqdm# 获取当前打开的 cad 文件acad = Autocad()layout = acad.doc.ActiveLayout# %%# 搜索第一个表格table = acad.find_one(&#x27;table&#x27;, layout.Block)# 逐行逐列获取文本row_texts = []for row in range(table.Rows):    columns = []    for col in range(table.Columns):        columns.append(table.GetText(row, col))    row_texts.append(columns)pprint(row_texts)json_data = table.to_csv(&#x27;csv&#x27;)pprint(json_data)# %%\n\n\n\n\n# %%# 搜索所有表格tables = []i = 0for table in tqdm(acad.iter_objects(&#x27;table&#x27;, layout.Block)):    row_texts = []    for row in range(table.Rows):        columns = []        for col in range(table.Columns):            columns.append(table.GetText(row, col))        row_texts.append(columns)        # 只提取包含 BOM 的表格    if &#x27;BOM&#x27; in row_texts[0][0]:        pprint(row_texts)        tables.append(row_texts)        i += 1# %%pprint(tables)rrr = []for i, ttt in enumerate(tables):    for r in ttt:        ir = [i+1] + r  # Add table index to each row        rrr.append(ir)    rrr.append([])  # Add an empty row to separate tablespprint(rrr)# %%import pandas as pddf = pd.DataFrame(rrr)df.to_csv(&#x27;bom.csv&#x27;, index=False, header=False, encoding=&#x27;utf-8-sig&#x27;)\n","categories":["mechatronics"],"tags":["pyautocad"]},{"title":"小米wifi-AX3600电流声","url":"/2025/06/21/network/%E5%B0%8F%E7%B1%B3wifi3600%E7%94%B5%E6%B5%81%E5%A3%B0/","content":"小米 AX3600 使用过程中很大电流声，声音是在主板上发出来的。\n客服一问三不知；\n网上有说换电源可以解决，原装电源不行。\n额定电压为12V， 空载的实测电压只有10.38V。。。 简直离谱\n\n\n\n\n找了一个旧的12V电源，接上去就好了！\n\n\n","categories":["wifi"],"tags":["network"]},{"title":"pdf文档文字识别-MinerU-pdf-ocr-to-markdown","url":"/2025/06/18/office/pdf%E6%96%87%E6%A1%A3%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB-MinerU/","content":"\nMinerU https://github.com/opendatalab/MinerU/\n\n官网有详细的说明，需要 gpu cuda 支持。\n实测笔记本 cpu 模式也能使用，如下。\n1. pip 安装 mineru (CPU模式)# 创建虚拟环境python -m venv .venv_mnu.venv_mnu\\Scripts\\activate# 安装pip install -U &quot;mineru[core]&quot; -i https://mirrors.aliyun.com/pypi/simple \n\n2. 预训练模型下载# cmdmineru-models-download# [huggingface|modelscope] 选择 modelscope 源# [pipeline|vlm|all]       选择 pipeline 模型# 或mineru-models-download -s modelscope -m pipeline\n模型默认会被下载到 ~\\.cache\\modelscope\\hub\\models 同时创建一个配置文件 ~\\mineru.json\n默认下载到当前用户目录下。\n运行帮助：\nmineru --helpUsage: mineru [OPTIONS]Options:  -v, --version                   显示版本并退出  -p, --path PATH                 输入文件路径或目录（必填）  -o, --output PATH               输出目录（必填）  -m, --method [auto|txt|ocr]     解析方法：auto（默认）、txt、ocr（仅用于 pipeline 后端）  -b, --backend [pipeline|vlm-transformers|vlm-sglang-engine|vlm-sglang-client]                                  解析后端（默认为 pipeline）  -l, --lang [ch|ch_server|... ]  指定文档语言（可提升 OCR 准确率，仅用于 pipeline 后端）  -u, --url TEXT                  当使用 sglang-client 时，需指定服务地址  -s, --start INTEGER             开始解析的页码（从 0 开始）  -e, --end INTEGER               结束解析的页码（从 0 开始）  -f, --formula BOOLEAN           是否启用公式解析（默认开启，仅 pipeline 后端）  -t, --table BOOLEAN             是否启用表格解析（默认开启，仅 pipeline 后端）  -d, --device TEXT               推理设备（如 cpu/cuda/cuda:0/npu/mps，仅 pipeline 后端）  --vram INTEGER                  单进程最大 GPU 显存占用（仅 pipeline 后端）  --source [huggingface|modelscope|local]                                  模型来源，默认 huggingface  --help                          显示帮助信息\n\n\n\n例：\nmineru -d cpu --source local -o . -p 123.pdf mineru -d cpu --source local -o . -l ch_lite -p 123.pdf \n\n耗时使用 cpu (笔记本 intel ultra 7 155h)， 检测一个 10 页的pdf，内容主要是中文文字。\n\n\n\n步骤\n说明\n数量\n耗时\n\n\n\nLayout Predict\npdf 页面解析\n10&#x2F;10\n00:18&lt;00:00,  1.82s&#x2F;it\n\n\nMFD Predict\n数学公式检测\n10&#x2F;10\n00:52&lt;00:00,  5.27s&#x2F;it\n\n\nMFR Predict\n数学公式识别\n1&#x2F;1\n00:01&lt;00:00,  1.40s&#x2F;it\n\n\nOCR-det ch\nOCR检测中文\n51&#x2F;51\n00:23&lt;00:00,  2.14it&#x2F;s\n\n\nTable Predict\n表格识别\n1&#x2F;1\n00:04&lt;00:00,  4.47s&#x2F;it\n\n\nOCR-rec Predict\nOCR识别\n319&#x2F;319\n00:52&lt;00:00,  6.12it&#x2F;s\n\n\nProcessing pages\n处理页面\n10&#x2F;10\n00:02&lt;00:00,  3.49it&#x2F;s\n\n\n","categories":["office"],"tags":["pdf"]},{"title":"PDF文档翻译 pdf2zh","url":"/2025/06/11/office/PDF%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91-pdf2zh/","content":"PDFMathTranslate（pdf2zh）支持科学论文翻译和双语对照。\n支持全文翻译，并且还能保持原来的 pdf 文档中文字、公式、图表的排版形式。\n现在已经发布了 V2.0版。\n\nhttps://pdf2zh-next.com/zh/index.html \n\nhttps://github.com/PDFMathTranslate/PDFMathTranslate-next\n\nhttps://github.com/Byaidu/PDFMathTranslate\n\n\n1. 使用方法https://pdf2zh-next.com/zh/index.html\n2. 使用方法-加入 scoop 和右键菜单。2.1 scoop 安装\nhttps://github.com/shenbo/portablesoft/blob/master/bucket/pdf2zh.json\n\n\n&#123;    &quot;version&quot;: &quot;2.0.10&quot;,    &quot;description&quot;: &quot;PDF scientific paper translation with preserved formats&quot;,    &quot;homepage&quot;: &quot;https://github.com/PDFMathTranslate/PDFMathTranslate-next/&quot;,    &quot;url&quot;: &quot;https://github.com/PDFMathTranslate/PDFMathTranslate-next/releases/download/v2.0.10/pdf2zh-v2.0.10-BabelDOC-v0.3.69-win64.zip&quot;,    &quot;notes&quot;: [        &quot;The version without assets:  pdf2zh without assets(font, model, etc.)&quot;,        &quot;It will also dynamically download resources when running, but the download may fail due to network issues.&quot;,        &quot;&quot;,        &quot;Add context menu option: &quot;,        &quot;    reg add \\&quot;HKEY_CLASSES_ROOT\\\\SystemFileAssociations\\\\.pdf\\\\shell\\\\pdf2zh\\\\command\\&quot; /ve /d &#x27;$dir\\\\pdf2zh.exe --bing --no-mono \\\\\\&quot;%1\\\\\\&quot;&#x27; /f&quot;,        &quot;&quot;    ],    &quot;bin&quot;: &quot;pdf2zh.exe&quot;,    &quot;shortcuts&quot;: [        [            &quot;pdf2zh.exe&quot;,            &quot;pdf2zh&quot;        ]    ],    &quot;hash&quot;: &quot;25f5301db637b106f5de1249408ded5f106d0ea2b0b8434839c4d278933da146&quot;,    &quot;extract_dir&quot;: &quot;pdf2zh&quot;,    &quot;checkver&quot;: &quot;github&quot;,    &quot;autoupdate&quot;: &#123;        &quot;url&quot;: &quot;https://github.com/PDFMathTranslate/PDFMathTranslate-next/releases/download/v$version/pdf2zh-v$version-BabelDOC-v0.3.69-win64.zip&quot;    &#125;&#125;\n\n2.2 安装使用\nscoop install pdf2zh# 右键菜单，管理员模式运行reg add &quot;HKEY_CLASSES_ROOT\\SystemFileAssociations\\.pdf\\shell\\pdf2zh\\command&quot; /ve /d &#x27;pdf2zh.exe --bing --no-mono \\&quot;%1\\&quot;&#x27; /f# 常用命令说明pdf2zh ~/local.pdf   --bing    --debug     --pages 1-5   --no-mono      #   pdf路径    翻译服务    调试模式    页码范围     不输出仅中文版","categories":["office"],"tags":["pdf2zh"]},{"title":"PDF论文文献重命名","url":"/2025/06/11/office/PDF%E6%96%87%E6%A1%A3-%E8%AE%BA%E6%96%87%E6%96%87%E7%8C%AE%E9%87%8D%E5%91%BD%E5%90%8D/","content":"pdf-renamer 可以对已下载的论文 PDF 文件 进行重命名。\n\nhttps://github.com/MicheleCotrufo/pdf-renamer\n\n调用 pdf2bib 以及 pdf2doi 查找论文的 DOI、并获得 BibTeX 数据。\n\nhttps://github.com/MicheleCotrufo/pdf2bib\n\n1. 安装pip install pdf-renamerpip install pdf2bib\n\n\n2. pdfrenamer 使用方法$ pdfrenamer --husage: pdfrenamer [-h] [-s] [-ro] [-f FORMAT] [-sf] [-max_length_authors MAX_LENGTH_AUTHORS]                  [-max_length_filename MAX_LENGTH_FILENAME] [-max_words_title MAX_WORDS_TITLE]                   [-case CASE]                  [-add_abbreviation_file PATH_ABBREVIATION_FILE] [-fr] [-sd]                   [-install--right--click] [-uninstall--right--click]                  [path ...]\n\n\n\n\n\nargs\nargs\ndescription\n\n\n\npath\n\npdf文件或文件夹的路径\n\n\n\n\n\n\n\n-h\n–help\n帮助\n\n\n-s\n–decrease_verbose\n默认输出全部搜索记录使用此选项，设为不输出\n\n\n-ro\n–readonly\n默认将doi信息写入pdf的metadata信息中使用此选项，设为不写入\n\n\n-f\nFORMAT\n设定新文件名的格式，默认为 “{YYYY} - {Jabbr} - {A3etal} - {T}”\n\n\n\n{YYYY}\n出版年Year of publication\n\n\n\n{MM}\n出版月 (数字 digits)\n\n\n\n{DD}\n出版日 (数字 digits)\n\n\n\n{J}\n期刊全名Journal\n\n\n\n{Jabbr}\n期刊缩写（如有）\n\n\n\n{Aall}\n全部作者姓氏 (逗号分隔)\n\n\n\n{Aetal}\n第一作者姓氏 ‘et al.’\n\n\n\n{A3etal}\n前三作者姓氏 ‘et al.’\n\n\n\n{aAall}\n全部作者姓名 (逗号分隔)\n\n\n\n{aAetal}\n第一作者姓名 ‘et al.’\n\n\n\n{aA3etal}\n前三作者姓名 ‘et al.’\n\n\n\n{T}\n论文标题\n\n\n-sf\n–sub_folders\n是否重命名子文件夹，默认：False\n\n\n-max_length_authors\nMAX_LENGTH_AUTHORS\n设定作者的最大字符长度，默认：80\n\n\n-max_length_filename\nMAX_LENGTH_FILENAME\n设定文件名最大字符长度，默认：250\n\n\n-max_words_title\nMAX_WORDS_TITLE\n设定标题的最大字符长度，默认：20\n\n\n-case\nCASE\n连接符：驼峰、下划线、减号、空格\n\n\n\n\nCASE：[‘camel’, ‘snake’, ‘kebab’, ‘none’ (default)]\n\n\n-add_abbreviation_file\nPATH_ABBREVIATION_FILE\n期刊缩写\n\n\n-fr\n–force_rename\n默认跳过相同文件使用此选项，设为重命名每一个文件\n\n\n-sd\n–set_default\n将现有参数设置为默认值\n\n\n-install–right–click\n\n加入 Windows 右键菜单\n\n\n-uninstall–right–click\n\n删除 Windows 右键菜单\n\n\n3. pdf2bib 使用方法pdf2bib --husage: pdf2bib [-h] [-v] [-nostore] [-s FILENAME_BIBTEX] [-clip]                [-install--right--click] [-uninstall--right--click]               [path ...]\n\n\n\n\nargs\nargs\ndescription\n\n\n\npath\n\npdf文件或文件夹的路径\n\n\n\n\n\n\n\n-h\n–help\n帮助\n\n\n-v\n–verbose\n默认仅输出搜索结果使用此选项，设为输出搜索过程记录\n\n\n-nostore\n–no_store_identifier_metadata\n默认将doi信息写入pdf的metadata信息中使用此选项，设为不写入\n\n\n-s\nFILENAME_BIBTEX\n将 bibtex 信息写入 FILENAME_BIBTEX 文本文件.\n\n\n–make_bibtex_file\nFILENAME_BIBTEX\n将 bibtex 信息写入 FILENAME_BIBTEX 文本文件\n\n\n-clip\n–save_bibtex_clipboard\n将 bibtex 写入粘贴板\n\n\n-install–right–click\n\n加入 Windows 右键菜单\n\n\n-uninstall–right–click\n\n删除 Windows 右键菜单\n\n\n4. 加入右键菜单。Windows 操作系统下，可以将 pdf-renamer 添加到右键菜单作为快捷方式。\npdfrenamer --install-right-click# pdfrenamer --uninstall-right-clickpdf2bib -install--right--click# pdf2bib -uninstall--right--click","categories":["office"],"tags":["pdf"]},{"title":"caj2pdf：将知网caj文件转换为pdf(2)","url":"/2025/06/06/office/caj2pdf%EF%BC%9A%E5%B0%86%E7%9F%A5%E7%BD%91caj%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E4%B8%BApdf(2)/","content":"caj2pdf: 将知网caj文件转换为pdf\nhttps://github.com/shenbo/caj2pdf/\n\n\n在原来基础上使用 pystand 简单封装，并增加右键菜单快捷命令\n\n1. 克隆仓库git clone https://github.com/shenbo/caj2pdf.git# 或git clone https://github.com/caj2pdf/caj2pdf.git\n\n2. 创建 python 虚拟环境\n只需要安装一个库第三方库：pypdf2\npystand 需要 Python embed\n原来的 dll 文件路径是相对路径，需要调整一下\n\nWrite-Host &quot;==== 0. Create folders ====&quot;New-Item -Path &quot;./build&quot; -ItemType Directory -ForceNew-Item -Path &quot;./.cache&quot; -ItemType Directory -ForceWrite-Host &quot;==== 1. Setup Python venv ====&quot;if (-not (Test-Path &quot;.venv_caj&quot;)) &#123;    python -m venv .venv_caj&#125;.venv_caj/Scripts/activate.ps1python -Vpip install pypdf2Write-Host &quot;==== 1.1 Download Python embed version====&quot;$pythonUrl = &quot;https://www.python.org/ftp/python/3.13.4/python-3.13.4-embed-amd64.zip&quot;if (-not (Test-Path &quot;./.cache/python.zip&quot;)) &#123;    Invoke-WebRequest -Uri $pythonUrl -OutFile &quot;./.cache/python.zip&quot;&#125;Expand-Archive -Path &quot;./.cache/python.zip&quot; -DestinationPath &quot;./build/runtime&quot; -ForceWrite-Host &quot;==== 2. Copy files to ./build/* ====&quot;Get-ChildItem -Path &quot;./*.py&quot; | Copy-Item -Destination &quot;./build&quot; -Recurse -ForceGet-ChildItem -Path &quot;./lib&quot; | Copy-Item -Destination &quot;./build/lib&quot; -Recurse -ForceCopy-Item -Path &quot;./caj2pdf&quot; -Destination &quot;./build/caj2pdf.int&quot; -Recurse -ForceWrite-Host &quot;==== 2.1  change .dll path ====&quot;$jbigdec_file = &#x27;./build/jbigdec.py&#x27;$old_cmd = &#x27;&quot;./lib/bin/libjbigdec-w64.dll&quot;&#x27;$new_cmd = &#x27;os.path.join(os.path.dirname(__file__), &quot;lib/libjbigdec-w64.dll&quot;)&#x27;(Get-Content $jbigdec_file).replace($old_cmd, $new_cmd) | Set-Content $jbigdec_file\n\n\n\n3. 下载 PyStand、 简单配置ref: \n\nhttps://github.com/skywind3000/PyStand/\nhttps://skywind.me/blog/archives/3002\n\nWrite-Host &quot;==== 3. Download PyStand ====&quot;$pystandUrl = &quot;https://github.com/skywind3000/PyStand/releases/download/1.1.5/PyStand-v1.1.5-exe.zip&quot;if (-not (Test-Path &quot;./.cache/pystand.zip&quot;)) &#123;    Invoke-WebRequest -Uri $pystandUrl -OutFile &quot;./.cache/pystand.zip&quot;&#125;Expand-Archive -Path &quot;./.cache/pystand.zip&quot; -DestinationPath &quot;./.cache/pystand&quot; -ForceCopy-Item -Path &quot;./.cache/pystand/PyStand-x64-CLI/PyStand.exe&quot; -Destination &quot;./build/caj2pdf.exe&quot; -Force\n\n\n4. PyPDF2Write-Host &quot;==== 4. Copy venv/Lib/site-packages to build/ ====&quot;Copy-Item -Path &quot;.venv_caj/Lib/site-packages/PyPDF2&quot; -Destination &quot;./build/site-packages/PyPDF2&quot; -Recurse -Force# Remove-Item -Path &quot;./.cache&quot; -Recurse -Force\n\n5. 加入右键菜单\n需要管理员权限\n\nWrite-Host &quot;==== 5. Add to context ====&quot;$caj2pdf = Get-Location | Join-Path -ChildPath &quot;build/caj2pdf.exe&quot;$regKey = &quot;HKEY_CLASSES_ROOT\\SystemFileAssociations\\.caj\\shell\\caj2pdf\\command&quot;$regCommand = $caj2pdf + &#x27; convert \\&quot;%1\\&quot;&#x27;Write-Host (&#x27;reg add &quot;&#x27; + $regKey + &#x27;&quot; /ve /d &quot;&#x27; + $regCommand + &#x27;&quot; /f&#x27;)reg add $regKey /ve /d $regCommand /f\n\n详见 https://github.com/shenbo/caj2pdf/blob/master/build.ps1\n","categories":["office"],"tags":["caj2pdf"]},{"title":"PDF文档-电子发票信息提取","url":"/2025/05/22/office/PDF%E6%96%87%E6%A1%A3-%E7%94%B5%E5%AD%90%E5%8F%91%E7%A5%A8%E4%BF%A1%E6%81%AF%E6%8F%90%E5%8F%96/","content":"\npymupdf \n\npip install pymupdf\nhttps://pymupdf.readthedocs.io/en/latest/index.html\n\n\npyzbar \n\npip install pyzbar\nhttps://github.com/NaturalHistoryMuseum/pyzbar/\n\n\n\n用 pymupdf 提取电子发票中的信息\nhttps://pymupdf.readthedocs.io/en/latest/page.html#Page.get_text\n\nhttps://pymupdf.readthedocs.io/en/latest/page.html#Page.find_tables\n\n\n\n\n# %%import reimport fitz  # pip install PyMuPDFfrom rich.pretty import pprintdef fapiao_txt_reg(text=&quot;&quot;):    # 正则规则    regs = dict(        type=r&quot;(电子发票.*[普通发票|增值税专用发票].*)&quot;,        numb=r&quot;发票号码\\s*[:：]\\s*(\\d&#123;20&#125;)&quot;,        date=r&quot;开票日期\\s*[:：]\\s*(\\d&#123;4&#125;年\\d&#123;2&#125;月\\d&#123;2&#125;日)&quot;,        item=r&quot;(\\*[\\u4e00-\\u9fff]+\\*[\\u4e00-\\u9fff|\\w]+)&quot;,        totl=r&quot;价税合计[\\s\\S]*[¥￥](\\d+\\.\\d+)&quot;,    )    result = &#123;&#125;    for key, reg in regs.items():        match = re.search(reg, text)        if match:            result[key] = match.group(1)    return result# 1. 获取页面中的文字，从文字中正则提取fapiao = &quot;digital_12345678901234567890.pdf&quot;print(f&quot;filename: &#123;fapiao&#125;&quot;)src_pdf = fitz.open(fapiao)for p, page in enumerate(src_pdf):    blks = page.get_text(&quot;words&quot;, sort=True)    text = &quot;\\n&quot;.join(blk[4] for blk in blks)    print(f&quot;- page &#123;p&#125;&quot;)    pprint(text.split(&#x27;\\n&#x27;))src_pdf.close()fapiao_infos = fapiao_txt_reg(text)pprint(fapiao_infos)# %%from PIL import Imagefrom io import BytesIOfrom pyzbar import pyzbar# 2. 获取页面中的二维码图片-解析二维码src_pdf = fitz.open(fapiao)print(f&quot;filename: &#123;fapiao&#125;&quot;)for p, page in enumerate(src_pdf):    img_list = page.get_images()    for img in img_list:        print(f&quot;- page &#123;p&#125;, &quot;, img)                # 跳过长宽不等的图片        if img[2] != img[3]:            continue                # 转为 pillow 图片        pixmap = src_pdf.extract_image(img[0])        pprint(pixmap)        qr_img = Image.open(BytesIO(pixmap[&quot;image&quot;]))        # qr_img.show()        qr_decoded = pyzbar.decode(qr_img)        pprint(qr_decoded)        if qr_decoded:            qr_data = qr_decoded[0].data.decode(&quot;utf-8&quot;)            pprint(qr_data)src_pdf.close()# 二维码的字段定义不太确定 ？keys = [&quot;type&quot;, &quot;aera&quot;, &quot;x&quot;, &quot;numb&quot;, &quot;totl&quot;, &quot;date&quot;, &quot;y&quot;, &quot;code&quot;]fapiao_infos = dict(zip(keys, qr_data.split(&quot;,&quot;)))pprint(fapiao_infos)# %%# 3. 获取页面中的表格src_pdf = fitz.open(fapiao)page = src_pdf[0]tabs = page.find_tables().tablestable  = tabs[0].extract()for row in table:    pprint(row)for row in table:    for col in row:        if col:            print(col.replace(&quot;\\n&quot;, &quot;&quot;), end=&#x27;\\n&#x27;)    print()# %%\n\n","categories":["office"],"tags":["pdf"]},{"title":"xlwings 在 excel 中使用自定义 python 函数","url":"/2025/05/12/office/python-in-excel-xlwings/","content":"\n\nref: https://www.xlwings.org/\nref: https://docs.xlwings.org/en/latest/installation.html#installation\nref: https://docs.xlwings.org/en/latest/udfs.html#udfs\n\n\n0. xlwings 简介xlwings 提供了四种用法:\n\nxlwings (Open Source)， 本地 python模块、excel插件，代码在本地，运行在本地\nxlwings PRO， 商业版，收费\nxlwings Lite， 代码内置在excel文件中、运行在云端（代码公开）\nxlwings Server， 商业版，收费\n\n1. xlwings (Open Source) 本地版，在 excel 中使用自定义 python 函数1.1 excel 启用宏文件 -&gt; 选项 -&gt; 信任中心 -&gt; 信任中心设置 -&gt;宏设置 -&gt; 勾选 启用VBA宏 和 信任对VBA工程对象模型的访问\n1.2 安装 xlwings (Open Source)pip install xlwingsxlwings addin install# xlwings addin remove# pip uninstall xlwings\n\n1.3 快速使用xlwings config create --force# .xlwings\\xlwings.conf xlwings quickstart xlwings_test\nxlwings quickstart 命令会自动建立一个文件夹,内部有两个文件：\n\nxlwings_test.xlsm\nxlwings_test.py\n\n\n\n简单看一下 xlwings_test.py 的代码：\nimport xlwings as xwdef main():    wb = xw.Book.caller()    sheet = wb.sheets[0]    if sheet[&quot;A1&quot;].value == &quot;Hello xlwings!&quot;:        sheet[&quot;A1&quot;].value = &quot;Bye xlwings!&quot;    else:        sheet[&quot;A1&quot;].value = &quot;Hello xlwings!&quot;# 可以看出 main 函数的功能是：用于直接操作指定的单元格@xw.funcdef hello(name):    return f&quot;Hello &#123;name&#125;!&quot;# hello 函数则是一个方法函数，有输入输出：# 输入是 name， # 输出是 返回一个拼接的字符串if __name__ == &quot;__main__&quot;:    xw.Book(&quot;openmc_xlwings.xlsm&quot;).set_mock_caller()    main()\n\n1.4 测试 main 函数打开 xlwings_test.xlsm, 菜单栏切换到 xlwings 标签：\n\n\n点击 Run main: A1 表格 应该会出现 Hello xlwings!\n再次点击 Run main: A1 表格 应该会出现 Bye xlwings!\n1.5 测试 hello 函数打开 xlwings_test.xlsm, 菜单栏切换到 xlwings 标签：\n第一次导入 py 文件或有改动时, 点击 Import Functions （或 Restart UDF Server）。\n在任单元格中输入 =hello , 应该能弹出函数提示。\n假设 D1 单元格内容为： xlwings for excel, 在 D2 中填入： =hello(D1),  \nD2 最终返回 Hello xlwings for excel!\n2. 自定义函数： 调用 numpy、pandas 插值函数2.1 xlwings_test.py自定义一个插值函数：xl_interp\n\n\nref： https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html\n\n\nimport xlwings as xwimport pandas as pdfrom numpy import log, exp, interpfrom scipy.interpolate import interp1d@xw.funcdef xl_interp(x_val: float, y_str: str):    xy_cols = [&quot;xx&quot;, &quot;y1&quot;, &quot;y2&quot;, &quot;y3&quot;, &quot;y4&quot;],    xy_data = [            [0.1, 0.1509, 0.1674, 0.3425, 5.355],            [0.15, 0.1341, 0.149, 0.1829, 1.921],            [0.2, 0.1225, 0.1361, 0.1383, 0.9432],            [0.3, 0.1063, 0.1183, 0.1064, 0.3772],            [0.4, 0.09525, 0.1059, 0.092, 0.2172],            [0.5, 0.08694, 0.09667, 0.08282, 0.1514],            [0.6, 0.08041, 0.08943, 0.07611, 0.1178],            [0.8, 0.07065, 0.07856, 0.06644, 0.08472],            [1.0, 0.06349, 0.07062, 0.05957, 0.06844],            [1.5, 0.05168, 0.05747, 0.04862, 0.05102],            [2.0, 0.0444, 0.04932, 0.0425, 0.04536],            [3.0, 0.03573, 0.03961, 0.03611, 0.04199],            [4.0, 0.03072, 0.03395, 0.03303, 0.04175],            [5.0, 0.02745, 0.03024, 0.03139, 0.04257],            [6.0, 0.02516, 0.02763, 0.0305, 0.04379],            [8.0, 0.0222, 0.02423, 0.02985, 0.04667],            [10.0, 0.0204, 0.02214, 0.02989, 0.04965],            [15.0, 0.01805, 0.01936, 0.03088, 0.05653],            [20.0, 0.01702, 0.01808, 0.0322, 0.06202],        ]    df = pd.DataFrame(xy_data, columns=xy_cols)        # 1. 线性插值    y_interp = interp(x_val, df[&quot;xx&quot;], df[y_str])     # 2. 指数插值    y_interp_log = exp(interp(log(x_val), log(df[&quot;xx&quot;]), log(df[y_str])))    # 3. 样条插值：    # &#x27;zero&#x27;, &#x27;slinear&#x27;, &#x27;quadratic&#x27;, &#x27;cubic&#x27; : 零阶、一阶、二阶或三阶样条插值    y_interp_quad = scipy.interpolate.interp1d(df[&quot;xx&quot;], df[y_str], kind=&quot;quadratic&quot;)(x_val)    return y_interp\n\n2.2 xlwings_test.xlsm假设 G1 单元格内容为：2.5;  G2 单元格内容为：y1, \n在 G3 中填入： =xl_interp(G1, G2),\nG3 最终返回：0.040065\n3. xlwings Lite\n\nref: https://lite.xlwings.org/\n\n\n\n\nxlwings Lite 也挺好用的\n\n不需要本地有 python 环境。（基于 Pyodide）\n代码内置在 excel 文档中。\n库管理功能挺完善，numpy pandas scipy等基本库都没问题\n第一次运行应该是要联网的\n速度比本地慢一点，刷新计算时能感觉到，但也基本不影响正常使用\n\n使用时直接在侧边栏中编写 python 代码，有一些基本的功能\n\n配置安装 python 第三方库\n代码格式化： alt + shift + F\n简单的终端窗口\n\n","categories":["office"],"tags":["excel"]},{"title":"python-pyproject.toml打包","url":"/2025/04/29/python/python-%E6%89%93%E5%8C%85/","content":"1. pyproject.toml 说明pyproject.toml 是目前官方推荐的打包方式。\n\n官网 https://packaging.python.org/en/latest/guides/writing-pyproject-toml/\nhttps://setuptools.pypa.io/en/latest/userguide/datafiles.html\n\n官网写的比较抽象。这里记录下一个简单的使用方法。\n2. 包的文件夹结构建议的包文件结构如下，假设要创建一个名为snake的包：\nsnake_proj├──src/   └──snake/      ├──__init__.py      ├──AA.py      ├──BB.py      └──snake_data/         ├──xx.txt         └──yy.txt├──tests/   └──snake/├──.gitignore├──LICENSE├──pyproject.toml└──README.md\n\n3. 编写 pyproject.toml\n\n[project]name = &#x27;snake&#x27;version = &#x27;0.0.1&#x27;description = &quot;snake package&quot;authors = [&#123; name = &quot;123&quot;, email = &quot;abc@xyz.com&quot; &#125;][build-system]requires = [&quot;setuptools &gt;= 61.0&quot;]build-backend = &quot;setuptools.build_meta&quot;[tool.setuptools.package-data]&quot;snake_data&quot; = [&quot;*.txt&quot;]\n\n4. 打包# 安装 build 工具python -m pip install build# 打包python -m build -w -v# 安装 whlpython -m pip install dist\\snake-0.0.1-py3-none-any.whl --force-reinstall\n","categories":["python"],"tags":["python"]},{"title":"Win11-WSL-Ubuntu22.04-openmc 从源码编译安装","url":"/2025/03/27/wsl/wsl-ubuntu-openmc-build/","content":"一、WSL 安装 Ubuntu22.04\n启用 WSL\n\n打开 Microsoft Store，安装 Ubuntu22.04\n\n设置源，更新ref： https://linuxmirrors.cn/use/\n\n\n# 用户权限sudo -i# 安装 LinuxMirrors：bash &lt;(curl -sSL https://linuxmirrors.cn/main.sh)# 恢复原始设置：# bash &lt;(curl -sSL https://linuxmirrors.cn/main.sh) --use-official-source true# Docker 源：# bash &lt;(curl -sSL https://linuxmirrors.cn/docker.sh)sudo apt updatesudo apt upgrade\n\n\n安装 ZSH、oh-my-zsh\n\n参考 zsh &amp; oh-my-zsh 安装配置 \nsudo apt install zshsh -c &quot;$(wget https://gitee.com/mirrors/oh-my-zsh/raw/master/tools/install.sh -O -)&quot;# sh -c &quot;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)&quot;git clone https://github.com/zsh-users/zsh-autosuggestions $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-autosuggestionsgit clone https://github.com/zsh-users/zsh-syntax-highlighting $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlightingsource ~/.zshrc\n\n二、编译安装 openmcref： https://docs.openmc.org/en/stable/quickinstall.html\n\n参照 Manually Installing from Source, 安装编译所需的基础库\n\nsudo apt install g++ cmake libhdf5-dev libpng-dev\n\n\n编译 build\n\ngit clone --recurse-submodules https://github.com/openmc-dev/openmc.gitcd openmcmkdir build &amp;&amp; cd buildcmake ..makesudo make install\n\n\n创建虚拟环境，安装 openmc 库\n\n\n\npython3 -Vsudo apt install python3-pippip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple# 创建虚拟环境sudo apt install python3-venvpython3 -m venv ~/openmc-venvsource ~/openmc-venv/bin/activate# 安装 openmcpython3 -m pip install .\n\n\n下载材料数据集\n\ngit clone https://github.com/openmc-dev/data openmc-dev_datacd openmc-dev_datapython3 convert_nndc71.py\n\n把 cross_sections.xml 的路径加入环境变量，或直接在openmc程序中设置：\n# code /home/xxxx/.local/lib/python3.10/site-packages/openmc/config.pyconfig[&#x27;cross_sections&#x27;] = &quot;/home/xxxx/openmc-dev_data/nndc-b7.1-hdf5/cross_sections.xml&quot;# 或者 直接加在程序前面import openmcopenmc.config[&quot;cross_sections&quot;] = &quot;/home/bo/openmc_data/nndc-b7.1-hdf5/cross_sections.xml&quot;\n","categories":["WSL"],"tags":["Ubuntu","WSL","openmc"]},{"title":"openmc.model 复合面命令","url":"/2025/02/22/wsl/wsl-ubuntu-openmc-model/","content":"一、openmc 面命令https://docs.openmc.org/en/stable/pythonapi/generated/openmc.XPlane.html\n\n\n\nmethod\n面\nmcnp\nparas\n参数说明\ngeometry\n\n\n\nopenmc.Plane\n任意无限平面\n\na&#x3D;1, b&#x3D;0, c&#x3D;0, d&#x3D;0\n系数\n$Ax+By+Cz&#x3D;D$\n\n\nopenmc.XPlane\nX无限平面\n\nx0&#x3D;0\n与原点的距离\n$x−x_0&#x3D;0$\n\n\nopenmc.YPlane\nY无限平面\n\ny0&#x3D;0\n与原点的距离\n$y−y_0&#x3D;0$\n\n\nopenmc.ZPlane\nZ无限平面\n\nz0&#x3D;0\n与原点的距离\n$z−z_0​&#x3D;0$\n\n\nopenmc.XCylinder\nX无限圆柱\n\ny0&#x3D;0, z0&#x3D;0, r&#x3D;1\n圆柱中心y0,z0  圆柱半径r\n$(y−y_0​)^2+(z−z_0​)^2&#x3D;r^2$\n\n\nopenmc.YCylinder\nY无限圆柱\n\nx0&#x3D;0, z0&#x3D;0, r&#x3D;1\n圆柱中心x0,z0  圆柱半径r\n$(x−x_0​)^2+(z−z_0​)^2&#x3D;r^2$\n\n\nopenmc.ZCylinder\nZ无限圆柱\n\nx0&#x3D;0, y0&#x3D;0, r&#x3D;1\n圆柱中心x0,y0  圆柱半径r\n$(x−x_0​)^2+(y−y_0​)^2&#x3D;r^2$\n\n\nopenmc.Sphere\n球面\n\nx0&#x3D;0, y0&#x3D;0, z0&#x3D;0, r&#x3D;1\n球心 x0,y0,z0  球半径r\n$(x−x_0)^2+(y−y_0)^2+(z−z_0)^2&#x3D;r^2$\n\n\nopenmc.Cone\n圆锥面\n\n\n\n\n\n\nopenmc.XCone\nx方向圆锥面\n\n\n\n$(y−y_0)^2+(z−z_0)^2&#x3D;r^2(x−x_0)^2$\n\n\nopenmc.YCone\ny方向圆锥面\n\n\n\n\n\n\nopenmc.ZCone\nz方向圆锥面\n\n\n\n\n\n\nopenmc.Quadric\n二次曲面\n\n\n\n\n\n\nopenmc.XTorus\nx环面\n\n\n\n\n\n\nopenmc.YTorus\ny环面\n\n\n\n\n\n\nopenmc.ZTorus\nz环面\n\n\n\n\n\n\n二、openmc 复合面命令 （mcnp macrobody）https://docs.openmc.org/en/stable/pythonapi/model.html#composite-surfaces\n\n\n\nmethod\n复合面\nmcnp\nparas\n\n\n\nConicalFrustum\n圆锥台\nTRC\ncenter_base 底面中心  axis 轴线方向  r1 底面半径  r2 顶面半径\n\n\nCruciformPrism\n多边形棱柱体\n\ndistances 距离  center&#x3D;(0, 0) 中心  axis&#x3D;”z” 轴线\n\n\nCylinderSector\n无限扇形柱体\n\nr1 扇内半径 r2 扇外半径\n\n\n\n\n\ntheta1 起始角度  theta2 结束角度\n\n\n\n\n\ncenter 中心轴坐标  axis 中心轴\n\n\nHexagonalPrism\n六边形柱体\n\nedge_length&#x3D;1 边长  orientation 方向  origin 原点\n\n\nIsogonalOctagon\n八边形柱体题\n\ncenter 中心轴坐标  r1 半宽 r2 半宽  axis&#x3D;”z” 轴线\n\n\nOrthogonalBox\n任意正交体\nBOX\nv 顶点坐标  a1 边1向量  a2 边2向量  a3 边3向量\n\n\nPolygon\n闭合点路径形成的多边形\n\npoints 点集 basis 基\n\n\nRectangularParallelepiped\n平行于轴的长方体\nRPP\nxmin xmax ymin ymax zmin zmax 坐标范围\n\n\nRectangularPrism\n四面围成的无限长方体\n\nwidth 宽  height 高  axis 轴向  origin 原点\n\n\nRightCircularCylinder\n圆柱体\nRCC\ncenter_base 底面中心  height 高度  radius 半径  axis 中心轴\n\n\nVessel\n圆柱容器及椭圆封头\n\nr 半径  p1 坐标  p2 坐标 \n\n\n\n\n\nh1 下封头高度  h2 上封头高度  center 中心轴坐标  axis 中心轴\n\n\nXConeOneSided\nx方向圆锥\n\n\n\n\nYConeOneSided\ny方向圆锥\n\n\n\n\nZConeOneSided\nz方向圆锥\n\n\n\n\n","categories":["WSL"],"tags":["Ubuntu","WSL","openmc"]},{"title":"pandas-numpy压缩保存数据","url":"/2025/02/06/sci-pandas/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-pandas-numpy%E5%8E%8B%E7%BC%A9%E4%BF%9D%E5%AD%98%E6%95%B0%E6%8D%AE/","content":"numpy的保存\nhttps://numpy.org/doc/stable/reference/generated/numpy.save.html\n\nnumpy保存数组比较简单。\n# 1. 保存单个数组numpy.save(file, arr, allow_pickle=True)# 2. 保存多个数组numpy.savez(file, *args, allow_pickle=True, **kwds)# 保存时如果不指定数组名字， 默认按照 arr_0, arr_1 编号numpy.savez(file, a1, a2) #  Arrays will be named: arr_0, arr_1 ...# 保存时指定数组名字numpy.savez(file, a1=a1, a2=a2) #  Arrays will be named: a1, a2 ...# 读取 npznpzfile = np.load(&#x27;file.npz&#x27;)print(npzfile.files)a1, a2 = [npzfile[key] for key in npzfile.files]# 3. 保存多个数组, 保存时进行数据压缩，用法与 numpy.savez() 一样# 压缩率一般在 10 倍以上，相应牺牲的是读取、保存时间，时间消耗大概是同样的倍率。numpy.savez_compressed(file, *args, allow_pickle=True, **kwds)\n\npandas的保存\nhttps://pandas.pydata.org/docs/user_guide/io.html\n\npandas保存复杂得多，提供了非常多的格式，常见的：csv，xlsx，h5等。\n\n\n\nType\nData Description\nFormat\nReader\nWriter\n\n\n\ntext\nCSV\n.csv\nread_csv\nto_csv\n\n\ntext\nFixed-Width Text File\n.csv\nread_fwf\nNA\n\n\ntext\nJSON\n.json\nread_json\nto_json\n\n\ntext\nHTML\n.html\nread_html\nto_html\n\n\ntext\nLaTeX\n.tex\nStyler.to_latex\nNA\n\n\ntext\nXML\n.xml\nread_xml\nto_xml\n\n\ntext\nLocal clipboard\n&#x2F;\nread_clipboard\nto_clipboard\n\n\nbinary\nMS Excel\n.xlsx\nread_excel\nto_excel\n\n\nbinary\nOpenDocument\n.ods\nread_excel\nNA\n\n\nbinary\nHDF5 Format\n.hdf\nread_hdf\nto_hdf\n\n\nbinary\nFeather Format\n.feather\nread_feather\nto_feather\n\n\nbinary\nParquet Format\n.parquet\nread_parquet\nto_parquet\n\n\nbinary\nORC Format\n.orc\nread_orc\nto_orc\n\n\nbinary\nStata\n.dta\nread_stata\nto_stata\n\n\nbinary\nSAS\n.sas7bdat\nread_sas\nNA\n\n\nbinary\nSPSS\n.sav\nread_spss\nNA\n\n\nbinary\nPython Pickle Format\n.pkl\nread_pickle\nto_pickle\n\n\nSQL\nSQL\n&#x2F;\nread_sql\nto_sql\n\n\n对比读写速度和文件体积\n\n# %%import numpy as npimport pandas as pdimport hashlibimport osfrom rich.pretty import pprint  np.random.seed(42)#%%size = 10000df = pd.DataFrame()df[&quot;A&quot;] = np.random.rand(size)df[&quot;B&quot;] = np.random.randint(0, 10000, size)df[&quot;sin&quot;] = df[&quot;A&quot;].apply(lambda x: np.sin(x))df[&quot;datetime&quot;] = pd.date_range(&quot;20240101&quot;, periods=size, freq=&quot;s&quot;)df[&quot;array&quot;] = df[&quot;B&quot;].apply(lambda x: np.sin(x) * np.array([1, 2, 3]))df[&quot;string&quot;] = df[&quot;array&quot;].apply(lambda x: hashlib.md5(str(x).encode(&quot;utf8&quot;)).hexdigest())print(df)print(df.dtypes)# %%import timeitXLSX = &quot;test.xlsx&quot;CSV = &quot;test.csv&quot;PKL = &quot;test.pkl&quot;PKLZ = &quot;test.pklz&quot;HDF = &quot;test.hdf&quot;HDFZ = &quot;test.hdfz&quot;FTH = &quot;test.feather&quot;PQT = &quot;test.parquet&quot;funcs = [    # xls    lambda x: df.to_excel(XLSX),    lambda x: pd.read_excel(XLSX, index_col=0),    # csv    lambda x: df.to_csv(CSV, mode=&quot;w&quot;),    lambda x: pd.read_csv(CSV, index_col=0),    # pkl    lambda x: df.to_pickle(PKL),    lambda x: pd.read_pickle(PKL),    lambda x: df.to_pickle(PKLZ, compression=&quot;xz&quot;),    lambda x: pd.read_pickle(PKLZ, compression=&quot;xz&quot;),    # hdf    lambda x: df.to_hdf(HDF, key=&quot;test&quot;, mode=&quot;w&quot;),    lambda x: pd.read_hdf(HDF, &quot;test&quot;),    lambda x: df.to_hdf(HDFZ, key=&quot;test&quot;, mode=&quot;w&quot;, complib=&quot;blosc&quot;),    lambda x: pd.read_hdf(HDFZ, &quot;test&quot;),    # feather    lambda x: df.to_feather(FTH),    lambda x: pd.read_feather(FTH),    # parquet    lambda x: df.to_parquet(PQT),    lambda x: pd.read_parquet(PQT)]# %%# 定义测试参数runs_number = 1runs_result = []for i, name in enumerate([XLSX, CSV, PKL, PKLZ, HDF, HDFZ, FTH, PQT]):    func = name.replace(&quot;test.&quot;, &quot;&quot;)    w_speed = timeit.timeit(lambda: funcs[2 * i](df), number=runs_number)    r_speed = timeit.timeit(lambda: funcs[2 * i + 1](df), number=runs_number)    filesize = os.path.getsize(name) / 1024 / 1024    runs_result.append([func, w_speed, r_speed, filesize])pprint(runs_result)# %%# 打印结果df_rst = pd.DataFrame(runs_result, columns=[&quot;func&quot;, &quot;write [s]&quot;, &quot;read [s]&quot;, &quot;filesize [M]&quot;])pprint(df_rst)# %%df_rst.plot(x=&#x27;func&#x27;, y=[&#x27;write [s]&#x27;, &#x27;read [s]&#x27;, &#x27;filesize [M]&#x27;], kind=&#x27;bar&#x27;, title=f&#x27;datasize = &#123;size&#125;&#x27;)# %%\n\n\n\n\n经过对比发现 feather 、 parquet 格式的压缩率、读写速度通常比其他格式更好一些。\nfeather、parquet 在vscode中的预览这两种格式可以直接在VSCode中预览：\n\nfeather ：安装 Feather Viewer 插件；\nparquet ：安装 Python Data Science (包含 Data Wrangler) 插件。\n\n","categories":["sci"],"tags":["pandas","numpy"]},{"title":"windows创建文件链接mklink","url":"/2025/02/04/apps/windows%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E9%93%BE%E6%8E%A5mklink/","content":"cmd命令：mklink&gt; mklink创建符号链接。MKLINK [[/D] | [/H] | [/J]] Link Target        /D      创建目录符号链接。默认为文件符号链接。        /H      创建硬链接而非符号链接。        /J      创建目录联接。        Link    指定新的符号链接名称。        Target  指定新链接引用的路径 (相对或绝对)。\n\n例：创建wechat文件夹目录链接将微信默认的接收文件夹 设置到 指定位置。\n\n注意：命令执行需要左边文件夹不存在，可先将微信退出、默认文件夹重命名为 file1、然后执行命令，再将 file1 中全部文件移至 file 里。\n\n# mklink /J [微信默认文件夹路径] [自定义的文件夹路径]mklink /J xxxx\\wechat\\xwechat_files\\wxid_123456789_1234\\msg\\file yyyy\\weixin_file# output# 为 xxxx\\wechat\\xwechat_files\\wxid_123456789_1234\\msg\\file &lt;&lt;===&gt;&gt; yyyy\\weixin_file 创建的联接\n","categories":["apps"],"tags":["mklink"]},{"title":"红杏楼","url":"/2025/01/01/yoyo/20250101-%E7%BA%A2%E6%9D%8F%E6%A5%BC/","content":"烟波金陵 缥缈江湖车走马急 你追我逐尽己所能 敬我弗如梦遥路远 终有归途\n二零二五元旦于红杏楼\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"python将png图片转换为gif、mp4","url":"/2024/12/24/python/python%E5%B0%86png%E5%9B%BE%E7%89%87%E8%BD%AC%E6%8D%A2%E4%B8%BAgif%E3%80%81mp4/","content":"gifpillow\nfrom PIL import Imageimport globpngs = glob.glob(&#x27;temp_png/*.png&#x27;)# print(pngs)frames = [Image.open(png) for png in pngs]frames[0].save(&#x27;z.gif&#x27;, format=&#x27;GIF&#x27;, append_images=frames[1:], save_all=True, duration=100, loop=0)\n\nmp4opencv-python\nimport globimport cv2pngs = glob.glob(&#x27;temp_png/*.png&#x27;)# print(pngs)frames = [cv2.imread(png) for png in pngs]h, w, l = frames[0].shapefourcc = cv2.VideoWriter_fourcc(*&#x27;mp4v&#x27;)video = cv2.VideoWriter(f&#x27;&#123;pl&#125;.mp4&#x27;, fourcc, 15, (w, h))for f in frames:    video.write(f) cv2.destroyAllWindows()video.release()\n","categories":["python"],"tags":["python"]},{"title":"用 pandoc 将 latex 转换为 word 文档","url":"/2024/12/08/sci/%E8%AE%BA%E6%96%87-latex2word-by-pandoc/","content":"用 pandoc 将 latex 转换为 word 文档\nref: https://www.cnblogs.com/jiankychen/p/pandoc.html\n\npandoc paper.tex |    --number-sections |    --filter pandoc-crossref |    -t docx+native_numbering |    -M tableEqns -M autoEqnLabels |    --bibliography ref.bib |    --citeproc --csl ieee-wireless-communications-letters.csl |    -M reference-section-title=Reference |    --reference-doc template.docx |    -o output.docx\n\n\n\n--number-sections 用于章节自动编号 【可选】\n\n--resource-path=.;Figures 指定源图片的存放文件夹；源图片与 tex 文件同一文件夹时可缺省\n\n. 表示当前工作目录，\n; 是 Windows 系统的分隔符; Linux、Unix、macOs 用 : \nFigures 是存放 tex 源图片的子文件夹的名称\neps、pdf 等格式无法正常转化进 Word 文件，需提前将图片转为 png、 jpg 等格式\n\n\n-filter pandoc-crossref 用于公式、图片、表格等的交叉引用【可选】\n\n需要从 Github 下载 pandoc-crossref, https://github.com/lierdakil/pandoc-crossref/releases\n并将 pandoc-crossref.exe 放到 Pandoc 的安装目录中\n\n\n-t docx+native_numbering 用于表格和图片的编号\n\n-M tableEqns -M autoEqnLabels\n\ntableEqns 以表格形式显示公式编号，即：创建一个两列表，将公式放在左边列，将公式编号放在右边列\nautoEqnLabels 为公式编号 \n具体可查看 pandoc-crossref 文档, http://lierdakil.github.io/pandoc-crossref\n\n\n--bibliography ref.bib 参考文献 bib 文件 【可选】\n\n--citeproc --csl references_style.csl 用于参考文献的引用、和参考文件的样式文件【可选】\n\n样式文件可从 Zotero Style Repository https://www.zotero.org/styles 下载 【可选】\n\n\n- M reference-section-title=Reference 添加参考文献的章节名 【可选】\n\n--toc 生成目录 【可选】\n\n--reference-doc template.docx  参考模板 Docx 文件 【可选】\n\n可从 IEEE article template 下载  https://template-selector.ieee.org/secure/templateSelector/publicationType\n或 https://github.com/Achuan-2/pandoc_word_template\n\n\n-o output.docx  输出 Word 文件名\n\n\n","categories":["sci"],"tags":["latex"]},{"title":"数据处理-scipy 三维插值 RegularGridInterpolator","url":"/2024/11/21/sci/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-scipy%E6%8F%92%E5%80%BC-%E4%B8%89%E7%BB%B4%E6%8F%92%E5%80%BC/","content":"scipy 三维插值现有一组 mesh datagrid 数据，主要包括坐标及该坐标对应的value。\ndata = &quot;&quot;&quot;│   │   x    y   z   val     0       1    1   1   0.00e+00 1       2    1   1   9.46e-072       3    1   1   8.44e-073       4    1   1   0.00e+004       5    1   1   2.05e-07...     ...  ... ... ...     249995  96   50  50  8.07e-07249996  97   50  50  1.35e-06249997  98   50  50  1.03e-06249998  99   50  50  5.56e-07249999  100  50  50  1.40e-06[250000 rows x 5 columns]&quot;&quot;&quot;\n\n插值获取其中任意一点 value。对这种规则的 mesh datagrid 可以直接使用 RegularGridInterpolator\nref https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.RegularGridInterpolator.html\nscipy.interpolate.RegularGridInterpolator(points, values, method=&#39;linear&#39;, bounds_error=True, fill_value=nan, *, solver=None, solver_args=None)\n\n\n\n参数\n定义\n说明\n\n\n\npoints\nn维规则网格\n数据格式举例：三维数据 (x,y,z)\n\n\n\n\nx,y,z 的shape分别为 m1,m2,m3 , 必须严格为升序或者降序\n\n\nvalues\n数据\n数据格式举例：values\n\n\n\n\nvalues.shape 应该为 (m1,m2,m3)\n\n\nmethod\n插值算法\n默认’linear’\n\n\n\n\n可选’nearest’、’slinear’、’cubic’、’quintic’和’pchip’\n\n\nbounds_error\n界内判定\n默认True, 越界报错；如果False，则使用fill_value\n\n\nfill_value\n界外填充值\n默认np.nan；如果None，则外推插值\n\n\nsolver\n求解器\n插值算法为 ‘slinear’、’cubic’和’quintic’时可用\n\n\nsolver_args\n求解器参数\n\n\n\n\n\nimport numpy as npimport pandas as pdfrom scipy.interpolate import RegularGridInterpolatordf = pd.read_csv(&#x27;data.csv&#x27;)x = np.sort(df[&#x27;x&#x27;].unique())y = np.sort(df[&#x27;y&#x27;].unique())z = np.sort(df[&#x27;z&#x27;].unique())# 将数据值转为三维数组values = df[&#x27;val&#x27;].values.reshape(len(x), len(y), len(z))print(values)mesh_intp = RegularGridInterpolator((x, y, z), values, bounds_error=False, fill_value=None)pos = (50.5, 45.5, 3.2)res = mesh_intp(pos)","categories":["sci"],"tags":["scipy"]},{"title":"blender-运动基础","url":"/2024/11/16/blender/blender-%E8%BF%90%E5%8A%A8%E5%9F%BA%E7%A1%80/","content":"1. blender 运动基础: 平移、旋转创建一个立方体，按照动作设定坐标后新建关键帧，就可以了。\n\n\n# give Python access to Blender&#x27;s functionalityimport bpy# extend Python&#x27;s math functionalityimport math# add a cube into the scenebpy.ops.mesh.primitive_cube_add()# get a reference to the currently active objectcube = bpy.context.active_object# insert keyframe at frame onecube.keyframe_insert(&quot;rotation_euler&quot;, frame=1)# change the rotation of the cube around z-axiscube.rotation_euler.z = math.radians(360)# insert keyframe at the last framecube.keyframe_insert(&quot;rotation_euler&quot;, frame=90)# change the location of the cube on the z-axiscube.location.z = 0cube.keyframe_insert(&quot;location&quot;, frame=100)cube.location.z = 5cube.keyframe_insert(&quot;location&quot;, frame=150)\n\n\n\n\nref:Beginner Python Exercise in Blender: Simple cube location animationhttps://www.youtube.com/watch?v=nmJqIaSZlRs\nFinal Code:https://gist.github.com/CGArtPython/83a324c9938216c91df746c15179e992\nBeginner Blender Python Exercise: Easy cube rotation animationhttps://www.youtube.com/watch?v=tBPuEWh88Lo\nFinal Code:https://gist.github.com/CGArtPython/11927dffa39a378fa00f7ab514e76f07\nhttps://twitter.com/cgpython\n\n2. blender 阵列实体旋转运动\n创建立方体阵列，沿Z轴堆叠，并旋转（每隔3°）；\n运动动画：逐个从下到上旋转一圈。\n\n\n\n\n# give Python access to Blender&#x27;s functionalityimport bpy# extend Python&#x27;s math functionalityimport math# extend Python functionality to generate random numbersimport randomdef animate_rotation(obj, current_frame, rotation_frame_count):    # remove the animation data from the duplicated object    obj.animation_data_clear()    # insert key frame    obj.keyframe_insert(&quot;rotation_euler&quot;, frame=current_frame)    # rotate object    obj.rotation_euler.z += math.radians(360)    # calculate the end frame    frame = current_frame + rotation_frame_count    # insert key frame    obj.keyframe_insert(&quot;rotation_euler&quot;, frame=frame)# add first cube mesh into the scenebpy.ops.mesh.primitive_cube_add(scale=(0.5, 2, 0.1))obj = bpy.context.active_objectobj.rotation_euler.z = math.radians(random.uniform(0, 360))bpy.ops.object.transform_apply()# create variables for stacking and rotatingangle_step = 3current_angle = 3# create variables for animating the rotationcurrent_frame = 1frame_step = 1rotation_frame_count = 90# animate the original meshanimate_rotation(obj, current_frame, rotation_frame_count)# stack and rotate the meshwhile current_angle &lt; 360:    # duplicate the mesh    bpy.ops.object.duplicate(linked=True)    # set location and rotation    obj = bpy.context.active_object    obj.location.z += obj.dimensions.z    obj.rotation_euler.z = math.radians(current_angle)    animate_rotation(obj, current_frame, rotation_frame_count)    # update the angle for the next iteration    current_angle += angle_step    # update the current_frame    current_frame += frame_step# update the end frame for the whole animationbpy.context.scene.frame_end = current_frame + rotation_frame_count\n\n\n\nref:Beginner Blender Python Tutorial: for loop practice \nhttps://www.youtube.com/watch?v=AcoYA4T2ErUhttps://www.youtube.com/watch?v=tC_Bu-VO8p0\nStart code:https://gist.github.com/CGArtPython/004d414871f04bfb2c7605a88ea1e7a7\nFinal code:https://gist.github.com/CGArtPython/cf74ed708ff8c7fc76d2aeda1710e034\n\n","categories":["blender"],"tags":["blender"]},{"title":"blender-mesh基础","url":"/2024/11/13/blender/blender-mesh%E5%9F%BA%E7%A1%80/","content":"Blender mesh 创建点线面  uOQ-CPcaqMo AxazJi3x6js任务：创建一个半径为2圆环，圆环上均布32个点，显示为点或者线。\n1. 点# give Python access to Blender&#x27;s functionalityimport bpy# extend Python&#x27;s math functionalityimport math# extend Python&#x27;s print functionalityimport pprint# initialize paramatersvert_count = 32  # show with 16 and 64angle_step = math.tau / vert_countradius = 2# create a list of vert coordinatesvert_coordinates = list()# repeat code in a loopfor i in range(vert_count):    # calculate current current_angle    current_angle = angle_step * i    # calculate coordinate    x = radius * math.cos(current_angle)    y = radius * math.sin(current_angle)    # visualize what we are doing    bpy.ops.mesh.primitive_ico_sphere_add(radius=0.05, location=(x, y, 0))    # add current coordinate to list    vert_coordinates.append((x, y, 0))pprint.pprint(vert_coordinates)\n\n\n\n\n2. 线# give Python access to Blender&#x27;s functionalityimport bpy# extend Python&#x27;s math functionalityimport mathimport pprintdef get_circle_verts(vert_count, radius):    # initialize paramaters    angle_step = math.tau / vert_count    # create a list of vert coordinates    vert_coordinates = list()    # repeat code in a loop    for i in range(vert_count):        # calculate current current_angle        current_angle = angle_step * i        # calculate coordinate        x = radius * math.cos(current_angle)        y = radius * math.sin(current_angle)        # visualize what we are doing        # bpy.ops.mesh.primitive_ico_sphere_add(radius=0.05, location=(x, y, 0))        # add current coordinate to list        vert_coordinates.append((x, y, 0))    return vert_coordinatesdef create_circle_mesh(coordinates, vert_count):    verts = coordinates    faces = []    edges = []    for i in range(vert_count - 1):        current_vert_index = i        next_vert_index = i + 1        edges.append((current_vert_index, next_vert_index))    edges.append((vert_count - 1, 0))    # create a mesh from the vert, edge, and face data    mesh_data = bpy.data.meshes.new(&quot;circle_data&quot;)    mesh_data.from_pydata(verts, edges, faces)    # create a object using the mesh data    mesh_obj = bpy.data.objects.new(&quot;circle_object&quot;, mesh_data)    bpy.context.collection.objects.link(mesh_obj)# initialize paramatersvert_count = 32radius = 2coordinates = get_circle_verts(vert_count, radius)mesh_obj = create_circle_mesh(coordinates, vert_count)\n\n\n\n\n\nref:Beginner Blender Python Exercise: Circle mesh from scratchhttps://www.youtube.com/watch?v=uOQ-CPcaqMohttps://www.youtube.com/watch?v=AxazJi3x6js\nFinal Code:circle_mesh_part_1 https://gist.github.com/CGArtPython/6e98beb424b6c58bbda0469b2c0434a9circle_mesh_part_2 https://gist.github.com/CGArtPython/a4dff81d8c233601759dffd48917f296\n\n","categories":["blender"],"tags":["blender"]},{"title":"blender-安装、vscode配置","url":"/2024/11/13/blender/blender-%E5%AE%89%E8%A3%85-vscode%E9%85%8D%E7%BD%AE/","content":"Blender Python 配置 (on Windows) YUytEtaVrrc1. 安装 vscode、 blenderscoop install vscodescoop install blender# blender 和内置的 python 路径如下：# blender path : C:\\Users\\xxxx\\scoop\\apps\\blender\\4.2.3\\blender.exe# blender build-in python path : C:\\Users\\shenb\\scoop\\apps\\blender\\4.2.3\\4.2\\python\\bin\\python.exe\n在 vscode 中选择 python 解释器，注意选择 blender 内置的 python 路径。\n2. 安装自动补全 fake-bpy-module安装时注意要选用 blender 内置的 python -m pip 安装。\n\nref: https://github.com/nutti/fake-bpy-module\n\nC:\\Users\\shenb\\scoop\\apps\\blender\\4.2.3\\4.2\\python\\bin\\python.exe -m pip install fake-bpy-module# 安装常用的其他包：# C:\\Users\\shenb\\scoop\\apps\\blender\\4.2.3\\4.2\\python\\bin\\python.exe -m pip install pandas# C:\\Users\\shenb\\scoop\\apps\\blender\\4.2.3\\4.2\\python\\bin\\python.exe -m pip install matplotlib\n\n\n3. 安装 vscode 插件： Blender Development\nref: https://marketplace.visualstudio.com/items?itemName=JacquesLucke.blender-development\n\n使用时打开命令面板 Ctrl+Shift+P:\n\nBlender: Start command 启动一个 Blender 程序实例。\nBlender: Run Script command 执行当前的 python 脚本。\n\n\n\nref:5 Steps to setup VSCode for Blender Python (on Windows)https://www.youtube.com/watch?v=YUytEtaVrrc\n\n","categories":["blender"],"tags":["blender"]},{"title":"视频字幕提取(2)-基于opencv和paddleocr","url":"/2024/11/11/sci-opencv/%E8%A7%86%E9%A2%91%E5%AD%97%E5%B9%95%E6%8F%90%E5%8F%96-opencv-paddleocr/","content":"视频内字幕提取\nvideo-subtitles-ocr视频字幕提取，基于 opencv 和 paddleocr\n视频内字幕提取这里是针对内封了硬字幕的视频，字幕已经成为了画面的一部分。\n思路：简单用 opencv 提取视频内的所有帧，现在可以使用 paddleocr，更加方便一点对图片进行 ocr 识别。\n0. 首先需要配置一下0.1 安装 python 库\nopencv-python\nscikit-image\npaddleocr\n\n\nref: https://paddlepaddle.github.io/PaddleOCR/latest/quick_start.html#1-paddlepaddle\n\n\n\n1. 读取视频使用 opencv 读取视频\nimport cv2video_path = &#x27;d7.mp4&#x27;v = cv2.VideoCapture(video_path)num_frames = int(v.get(cv2.CAP_PROP_FRAME_COUNT))fps = v.get(cv2.CAP_PROP_FPS)height = int(v.get(cv2.CAP_PROP_FRAME_HEIGHT))width = int(v.get(cv2.CAP_PROP_FRAME_WIDTH))print(f&#x27;video      :  &#123;video_path&#125;\\n&#x27;      f&#x27;num_frames :  &#123;num_frames&#125;\\n&#x27;      f&#x27;fps        :  &#123;fps&#125;\\n&#x27;      f&#x27;resolution :  &#123;width&#125; x &#123;height&#125;&#x27;)\n\n2. 提取所有帧import datetimedef get_frame_index(time_str: str, fps: float):    t = time_str.split(&#x27;:&#x27;)    t = list(map(float, t))    if len(t) == 3:        td = datetime.timedelta(hours=t[0], minutes=t[1], seconds=t[2])    elif len(t) == 2:        td = datetime.timedelta(minutes=t[0], seconds=t[1])    else:        raise ValueError(            &#x27;Time data &quot;&#123;&#125;&quot; does not match format &quot;%H:%M:%S&quot;&#x27;.format(time_str))    index = int(td.total_seconds() * fps)    return index# 起始时间、结束时间time_start = &#x27;0:00&#x27;time_end = &#x27;0:10&#x27;ocr_start = get_frame_index(time_start, fps) if time_start else 0ocr_end = get_frame_index(time_end, fps) if time_end else num_framesnum_ocr_frames = ocr_end - ocr_startprint(f&#x27;ocr_start       :  &#123;ocr_start&#125;\\n&#x27;      f&#x27;ocr_end         :  &#123;ocr_end&#125;\\n&#x27;      f&#x27;num_ocr_frames  :  &#123;num_ocr_frames&#125;&#x27;)\n\n3. 只保留画面中有字幕的区域# *** 调整字幕区域的高度，按比例 ***h1, h2 = 0.86, 0.94h1, h2 = int(height * h1), int(height * h2)v.set(cv2.CAP_PROP_POS_FRAMES, ocr_start)frames = [v.read()[1] for _ in range(num_ocr_frames)]z_frames = [frame[h1:h2, :] for frame in frames]# 预览一下title = &#x27;preview&#x27;cv2.startWindowThread()cv2.namedWindow(title)for idx, img in enumerate(z_frames):    tmp_img = img.copy()    cv2.putText(tmp_img, f&#x27;idx:&#123;idx&#125;&#x27;, (5, 25),                 cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 255, 255), 2)    cv2.imshow(title, tmp_img)    cv2.imshow(title, img)    cv2.waitKey(50)cv2.destroyWindow(title)cv2.destroyAllWindows()\n\n4. 去除相似度较高的帧，保留关键帧为了减少识别量，先去除一部分相似度较高的图片。\n\n计算两个图片的均方差（即 MSE）， 采用 skimage.metrics.mean_squared_error 函数\n\n# 设置阈值mse_threshold = 100from skimage.metrics import mean_squared_errork_frames = [&#123;&#x27;start&#x27;: 0,             &#x27;end&#x27;: 0,             &#x27;frame&#x27;: z_frames[0],             &#x27;text&#x27;: &#x27;&#x27;&#125;]for idx in range(1, num_ocr_frames):    img1 = z_frames[idx - 1]    img2 = z_frames[idx]    mse = mean_squared_error(img1, img2)    # print(idx, mse)    if mse &lt; mse_threshold:        k_frames[-1][&#x27;end&#x27;] = idx    else:        k_frames.append(&#123;&#x27;start&#x27;: idx,                         &#x27;end&#x27;: idx,                         &#x27;frame&#x27;: z_frames[idx],                         &#x27;text&#x27;: &#x27;&#x27;&#125;)for kf in k_frames:    print(f&quot;&#123;kf[&#x27;start&#x27;]&#125; --&gt; &#123;kf[&#x27;end&#x27;]&#125; : &#123;kf[&#x27;text&#x27;]&#125;&quot;)\n\n5.1 识别字幕 pytesseractimport pytesseractconfig = f&#x27;--tessdata-dir &quot;&#123;tessdata_dir&#125;&quot; --psm 7&#x27;for idx, kf in enumerate(k_frames):    # 识别为字符串    ocr_str = pytesseract.image_to_string(kf[&#x27;frame&#x27;], lang=lang, config=config)    ocr_str = ocr_str.strip().replace(&#x27; &#x27;, &#x27;&#x27;)    if ocr_str:        k_frames[idx][&#x27;text&#x27;] = ocr_str        print(f&quot;&#123;kf[&#x27;start&#x27;]&#125; --&gt; &#123;kf[&#x27;end&#x27;]&#125; : &#123;kf[&#x27;text&#x27;]&#125;&quot;)print([k_frames.remove(kf) for kf in k_frames if not kf[&#x27;text&#x27;]])\n\n5.2 识别字幕 paddleocrfrom paddleocr import PaddleOCRocr = PaddleOCR(lang=&#x27;ch&#x27;)for idx, kf in enumerate(k_frames):    # 识别字符串        result = ocr.ocr(kf[&#x27;frame&#x27;])    print(result)    for line in result:        if line == None: break                words = &#x27;&#x27;        for rect, word in line:            words += word[0]        print(idx, words)        k_frames[idx][&#x27;text&#x27;] = wordsprint([k_frames.remove(kf) for kf in k_frames if not kf[&#x27;text&#x27;]])\n\n6. 格式化字幕for kf in k_frames:    print(f&quot;&#123;kf[&#x27;start&#x27;]&#125; --&gt; &#123;kf[&#x27;end&#x27;]&#125; : &#123;kf[&#x27;text&#x27;]&#125;&quot;)def get_srt_timestamp(frame_index: int, fps: float):    td = datetime.timedelta(seconds=frame_index / fps)    ms = td.microseconds // 1000    m, s = divmod(td.seconds, 60)    h, m = divmod(m, 60)    return &#x27;&#123;:02d&#125;:&#123;:02d&#125;:&#123;:02d&#125;,&#123;:03d&#125;&#x27;.format(h, m, s, ms)for kf in k_frames:    time1 = get_srt_timestamp(kf[&#x27;start&#x27;], fps)    time2 = get_srt_timestamp(kf[&#x27;end&#x27;], fps)    print(f&quot;&#123;time1&#125; --&gt; &#123;time2&#125;\\n&#123;kf[&#x27;text&#x27;]&#125;\\n&quot;)\n","categories":["opencv"],"tags":["opencv","paddleocr"]},{"title":"latex eps图片转PNG","url":"/2024/11/08/sci/%E8%AE%BA%E6%96%87-latex-eps%E5%9B%BE%E7%89%87%E8%BD%ACpng/","content":"word 不能直接导入 eps 格式的图片，所以先将 eps 图片转换成 png 格式。\n这里使用 python 调用 PIL 读取 eps 图片，直接保存为 png 图片\n# pip install pillow# scoop install ghostscriptfrom PIL import Imageimport osfor parent, dirnames, filenames in os.walk(os.getcwd()):    for filename in filenames:        ext = os.path.splitext(filename)[1]        if ext != &#x27;.eps&#x27;:          continue        eps_image = Image.open(filename)        size = eps_image.size                print(filename, size)        eps_image.load(scale=10)    # 分辨率增大到10倍        eps_image.save(filename+&#x27;.png&#x27;, quality=100)\n\n\nPIL 默认采用 Ghostscript 处理 eps 图片， 所以先确保安装了 Ghostscript。 scoop install ghostscript\neps 为矢量图，默认情况下其尺寸较小，导致保存成图片式分辨率较低，eps_image.load(scale=10) 将分辨率增大到10倍后保存。\n\n","categories":["sci"],"tags":["latex"]},{"title":"音频转文字 openai whisper","url":"/2024/11/04/apps/%E9%9F%B3%E9%A2%91%E8%BD%AC%E6%96%87%E5%AD%97-openai-whisper/","content":"下载 bili 视频pip install you-get# you-get https://www.bilibili.com/video/BV1234567890pip install yt-dlp# yt-dlp https://www.bilibili.com/video/BV1234567890# yt-dlp &quot;https://www.youtube.com/watch?v=GGGGGGGGGGGG&quot; --proxy http://127.0.0.1:7890\n\n视频转音频scoop install ffmpegffmpeg -i xxx.mp4# checkout the audio video formatffmpeg -i xxx.mp4 -acodec copy xxx.aacffmpeg -i xxx.mp4 -acodec copy xxx.mp3ffmpeg -i xxx.mkv -acodec copy xxx.opus\n\n音频转文字 📘\nhttps://github.com/openai/whisper\n\n\n** whisper **：\n\npip install -U openai-whisperwhisper audio.flac audio.mp3 audio.wav --model small --device cpu --language zh\n\n\n** python **：使用 Python 运行 main.py 脚本。\n\nimport whispermodel = whisper.load_model(&quot;small&quot;, device=&quot;cpu&quot;)result = model.transcribe(f&quot;123.mp3&quot;)print(result[&quot;text&quot;]))\n","categories":["apps"],"tags":["openai whisper ffmpeg"]},{"title":"数据处理-scipy插值","url":"/2024/09/30/sci/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-scipy%E6%8F%92%E5%80%BC/","content":"numpy: 线性插值、 对数插值\nscipy: 样条插值 interp1d 等\nhttps://docs.scipy.org/doc/scipy/reference/interpolate.html\n# %%import numpy as npfrom numpy import log, exp, interpimport matplotlib.pyplot as pltfrom scipy.interpolate import interp1d as sciInterfrom scipy.interpolate import Akima1DInterpolator as sciAkimafrom scipy.interpolate import PchipInterpolator as sciPchipfrom scipy.interpolate import CubicSpline as sciCubicimport pandas as pdfrom rich.pretty import pprintpd.set_option(&quot;display.width&quot;, 1000)pd.set_option(&quot;display.max_rows&quot;, 500)pd.set_option(&quot;display.max_columns&quot;, 500)# %%df = pd.read_csv(&quot;datas.csv&quot;)pprint(df)\n\n\n\n# %%# === 对比插值方法 取值范围 = [0.1, 10]df_it = pd.DataFrame(np.logspace(-1, 1, num=1000), columns=[&quot;x&quot;])pprint(df_it)X, Y = df[&quot;xxx&quot;], df[&quot;val&quot;]df_it[&quot;linear&quot;] = df_it[&quot;x&quot;].apply(lambda x: interp(x, X, Y))df_it[&quot;np_log&quot;] = df_it[&quot;x&quot;].apply(lambda x: exp(interp(log(x), log(X), log(Y))))df_it[&quot;Inter1&quot;] = df_it[&quot;x&quot;].apply(lambda x: sciInter(X, Y, kind=&quot;slinear&quot;)(x))df_it[&quot;Inter2&quot;] = df_it[&quot;x&quot;].apply(lambda x: sciInter(X, Y, kind=&quot;quadratic&quot;)(x))df_it[&quot;Inter3&quot;] = df_it[&quot;x&quot;].apply(lambda x: sciInter(X, Y, kind=&quot;cubic&quot;)(x))df_it[&quot;Akima1&quot;] = df_it[&quot;x&quot;].apply(lambda x: sciAkima(X, Y, method=&quot;akima&quot;)(x))df_it[&quot;PchipI&quot;] = df_it[&quot;x&quot;].apply(lambda x: sciPchip(X, Y)(x))df_it[&quot;CubicS&quot;] = df_it[&quot;x&quot;].apply(lambda x: sciCubic(X, Y)(x))pprint(df_it)\n\n# %%# === 3. plotplt.figure(figsize=(16, 9))plt.scatter(X, Y, color=&quot;r&quot;, marker=&quot;*&quot;, label=&quot;data&quot;)for col in df_it.columns[1:]:    plt.plot(df_it[&quot;x&quot;], df_it[col], linestyle=&quot;-.&quot;, lw=1, label=f&quot;&#123;col&#125;&quot;)plt.xscale(&quot;log&quot;)plt.yscale(&quot;log&quot;)# plt.xlim(0.1, 10)# plt.ylim(0.0, 10)plt.legend()plt.grid(&quot;:&quot;)plt.show()","categories":["sci"],"tags":["scipy pandas"]},{"title":"注册核安全工程师-综合知识","url":"/2024/09/04/NSE/zonghe/","content":"一、原子核物理基础\n了解原子和原子核的基本性质、原子核的放射性、射线及其与物质相互作用、原子核反应。\n熟悉放射性活度的含义及三大天然放射性系列中的主要核素、常用的核辐射类型及其特征、核裂变及核能的利用。\n掌握放射性核素的衰变规律及放射性核素的衰变常数、半衰期及寿命的概念，γ射线与物质的相互作用，介质对γ、X射线的衰减规律；中子诱发裂变与裂变能。\n\n1.1原子和原子核的基本性质1.原子的核式模型是1911年卢瑟福根据α粒子散射实验而提出的：原子由原子核和核外电子组成。\n2.电子由汤姆逊于1987年发现，电子电荷值 $e \\approx 1.6 \\times 10^{-19}$ C（库伦）；电子的质量 $m_e \\approx 9.1 \\times 10^{-31}$ kg。\n1.1.1 原子的壳层结构3.原子半径约为 $10^{-8}$ cm（或 $10^{-10}$ m），原子核的尺度大小量级为 fm（$10^{-15}$ cm，飞米），几十飞米，原子核半径 $R$ 与质量数 $A^{1&#x2F;3}$ 成正比关系；原子核的密度高达 $10^8$ t&#x2F;cm$^3$ 量级。\n4.物质的许多物理化学性质、光谱特性基本上只与核外电子有关，而放射性现象主要归因于原子核。\n5.原子的壳层结构：\n（1）原子的核外电子称为轨道电子。原子的轨道电子离核的距离是不能取任意值的，按照一定的规律形成彼此分离的壳层。\n（2）最靠近核的一个壳层称为K层，在它的外面依次为L、M、N、O壳层等，以此类推。\n\n通常用量子数 $n(n&#x3D;1,2,3\\ldots)$ 代表壳层，并分别对应K、L、M、N、O壳层。\n每个壳层可容纳 $2n^2$ 个电子（即：K:2，L:8，M:18，N:32）。\n除K层以外的其他壳层又可分成 $2l+1$（$l&#x3D;n-1$）个支壳层，$l$ 是描述电子轨道的量子数。\n（即：K, $L_I \\sim L_{III}$, $M_I \\sim M_V$, $N_I \\sim N_{VII}$, …）\n\n（3）处于不同壳层的电子具有不同的位能，当电子从无穷远处移动到靠近原子核的位置时是电场力作功，K层的能级最低。能级的能量大小就等于该壳层电子的结合能，即要使该壳层电子脱离核的束缚成为自由电子所需做的功。结合能是负值，通常以KeV为单位，K壳层电子的结合能的绝对值最大。\n1.1.2 原子核的组成及其稳定性6.原子核由质子和中子组成：$^A_ZX_N$\n\n$A$ 表示质量数，$Z$ 表示质子数，$N$ 表示中子数。\n$A$ 为核子数，$A &#x3D; Z + N$。\n\n7.核素是指具有一定数目质子和一定数目中子的一种原子；具有一定核电荷数和质量数，并且具有同一能态的一种原子核或原子，称为一种核素。\n8.多核素元素中各核素互称同位素，因为它们处于周期表中同一位置上，化学性质基本相同，但核性质不同；单核素元素没有同位素。\n9.同质异能素（nuclear isomer），处于较长寿命激发态的核素。通常在核素符号的右上角加写m或*标记它。例如 $^{60}\\text{Co}^m$（或 $^{60}\\text{Co}^{*}$）是 $^{60}\\text{Co}$ 的一种同质异能素，它的能量为59 keV，半衰期为10.5 min。大多数同质异能素要发生γ跃迁，少数发生β衰变，个别的可以发生α衰变。\n10.原子核的稳定性：根据原子核的稳定性，可以把核素分为稳定的核素和不稳定的放射性核素，原子核的稳定性与核内质子数和中子数之间的比例存在密切的关系，\n\n$Z &lt; 20$ 时核素的 $N&#x2F;Z \\approx 1$；$Z$ 为中等数值时 $N&#x2F;Z \\approx 1.4$；$Z \\approx 90$ 时 $N&#x2F;Z \\approx 1.6$\n丰中子核素易发生β-衰变，缺中子核素易发生β+衰变；\n原子核的稳定性还与核内质子数和中子数的奇偶性有关。\n\n1.1.3 原子核的大小11.原子的线度约为 $10^{-8}$ cm（或 $10^{-10}$ m），原子核的尺度大小量级为 fm（$10^{-15}$ m，飞米），原子核半径 $R \\approx 1.2A^{1&#x2F;3}$ fm，取一个核子的质量为 $1 \\text{ u} &#x3D; 1.66 \\times 10^{-27}$ kg，核物质密度 $\\rho &#x3D; n \\times m &#x3D; 1.66 \\times 10^{14}$ g·cm$^{-3}$。\n1.1.4 原子核的结合能12.核子结合成原子核时释放出的能量称为结合能，$B(Z,A) &#x3D; \\Delta m(Z,A)c^2$\n13.原子核的结合能除以质量数称为平均结合能或比结合能，$\\varepsilon(Z,A) &#x3D; \\frac{B(Z,A)}{A}$，单位 MeV&#x2F;Nu（Nu 为核子）。比结合能的物理意义为原子核拆散为自由核子时，外界对每个核子所做的最小的平均功；或表示核子结合为原子核时，平均每个核子所释放的能量。ε越大，核结合紧，稳定性高。\n\n1.2 原子核的放射性1.核素总共约为2600个，其中天然核素约为332个（其中270多个是稳定核素），其余为人造核素。\n1.2.1 放射性衰变的基本规律2.任何物质在单独存在时，都服从指数衰减规律（$N_t &#x3D; N_0 e^{-\\lambda t}$），放射性衰变是原子核内部规律决定的，采用加压、加热等物理或化学手段都不能改变其衰减规律。\n3.衰变常数 $\\lambda$，代表单位时间内一个原子核发生衰变的概率，表示该放射性核素衰变的快慢，$\\lambda$ 越大，衰变越快，$\\lambda$ 越小，衰变越慢。\n4.半衰期 $T_{1&#x2F;2}$ 表示该放射性核素衰变掉一半所需要的时间，$T_{1&#x2F;2}$ 越大，衰变越慢，$T_{1&#x2F;2}$ 越小，衰变越快。$T_{1&#x2F;2} &#x3D; \\frac{\\ln 2}{\\lambda} \\approx \\frac{0.693}{\\lambda}$\n5.放射性核素的平均寿命 $\\tau$ 为衰变常数 $\\lambda$ 的倒数，$\\tau &#x3D; 1.44 T_{1&#x2F;2}$，表示经过时间 $\\tau$ 后剩下的核素约为原来的 $1&#x2F;e \\approx 37%$。\n6.放射性活度 $A$ 表示一个放射源在单位时间内发生衰变的原子核数，曾用单位 Ci（居里），国际单位为 Bq（贝克），$1 \\text{ Bq} &#x3D; 1&#x2F;\\text{s}$，$1 \\text{ Ci} &#x3D; 3.7 \\times 10^{10}$ Bq。\n7.比放射性活度 $\\alpha$ 表示单位质量放射源的放射性活度，$\\alpha &#x3D; A&#x2F;m$，单位为 Bq&#x2F;g。\n8.衰变率 $J(t)$ 表示该放射源在单位时间内发生衰变的原子核数，$J(t) &#x3D; A \\cdot \\lambda$。\n1.2.2 放射系9.天然放射系：\n\n钍系 $^{232}_{90}\\text{Th}$（4n系），半衰期141亿年；\n铀系 $^{238}_{92}\\text{U}$（4n+2系），半衰期44.7亿年；\n锕-铀系 $^{235}_{92}\\text{U}$（4n+3系），半衰期7.04亿年；\n天然放射系中缺少4n+1系，后来由人工发现：镎系 $^{237}_{93}\\text{Np}$（4n+1系），半衰期214万年。\n\n1.2.3 放射性衰变规律的一些应用（略）1.3射线及其与物质相互作用1.3.1 常用的核辐射类型及其特征1.辐射又称射线，我们只关注能量在10eV量级以上的辐射，这个能量下限是辐射或辐射与物质作用后的次级产物能使空气等典型材料发生电离所需的最低能量。能量大于这个最低值的辐射称为电离辐射。\n2.常用核辐射类型：α辐射、β辐射、γ辐射和中子辐射。\n（1）α射线：衰变释放α粒子，即 $^4_2\\text{He}^{2+}$，质量数4和原子序数2；\n（2）β射线：衰变有三种类型：$\\beta^-$ 衰变、$\\beta^+$ 衰变和轨道电子俘获（轨道电子俘获是放射性核俘获一个核外轨道电子而使核内的一个质子转化为中子并放出中微子的过程）；质量数不变；\n（3）X射线和γ射线：是一定能量范围的电磁波，又称光子；质量和电荷数不变。\n\nγ射线是原子核退激（高激发态向低激发态的跃迁或者粒子的湮灭辐射）时发射的电磁波；\nX射线是原子的核外电子跃迁发射的电磁波。\n光子的静止质量为0，单个光子的质量与辐射的频率 $\\nu$ 成正比，$E &#x3D; h\\nu$，$h$ 为普朗克常数。\n\n（4）中子：自由中子是不稳定的，它会自发发生 $\\beta^-$ 衰变，生成质子、电子和反中微子，中子的半衰期是10.6 min。常用的中子源：同位素中子源、加速器中子源、反应堆中子源。\n3.能够直接或间接引起介质原子电离或激发的核辐射叫电离辐射。\n1.3.2 射线与物质的相互作用4.带电粒子与物质相互作用能量损失有：电离损失和辐射损失。\n（1）电离能量损失率Se，是入射粒子在在物质中穿过单位长度的路程时由于电离、激发过程损失的能量。Se随入射粒子速度增加而减小，呈平方比关系；电离能量损失率与入射粒子电荷平方数成正比。\n（2）轫致辐射：高速运动的带电粒子受到突然加速或减速会发射出具有连续能量的电磁辐射。\n（3）射程：一定能量的带电粒子它入射方向所能穿透的最大距离；实际轨迹的长度称作路程。\n（4）穿透能力：α粒子&lt;β粒子&lt;中子。所以，α粒子防止内照射，β粒子、中子要防止外照射。\n5.γ射线与物质相互作用能量损失有：光电效应、康普顿效应、电子对效应。\n（1）光电效应：γ光子把全部能量传递给原子核的核外电子，电子摆脱原子核束缚并发射出去，γ光子消失。\n（2）康普顿效应：γ光子把一部分能量传递给核外电子，电子摆脱原子核束缚并发射出去，γ光子能量降低变成一个新的光子。\n（5）电子对效应：γ光子在原子核库仑力作用下转化为一对正负电子，γ光子消失。只有当入射γ光子能量 $E &#x3D; h\\nu \\geq 1.02$ MeV 时才有可能发生电子对效应。\n6.介质对 X、γ 射线的衰减规律：$I &#x3D; I_0 e^{-\\mu x}$，即射线穿过物质时其注量率随穿过的厚度 $x$ 的增加而指数衰减。其中，$I$ 为射线注量率，$I_0$ 为入射时射线注量率，$\\mu$ 叫做线性吸收系数，单位是 cm$^{-1}$，表示射线穿过单位厚度物质时发生相互作用的概率（或者被吸收的概率）。\n7.中子与物质的相互作用：中子与原子核作用产生的次级产物能使物质原子发生电离和激发，因此中子与物质相互作用也可以称为电离辐射。\n（1）中子的散射：中子与原子核发生弹性散射与非弹性散射，并产生反冲核；\n（2）中子的俘获：中子与原子核形成复合核，处于激发态的复合核可能发射一个或多个光子，这一过程叫“辐射俘获”；也可能发射一个或多个粒子而回到基态，这一过程称为中子核反应。\n1.4 原子核反应1.核反应是产生不稳定核的最重要的手段，当入射粒子与核的距离接近到$10^{-15}m$时，两者之间的相互作用就会引起原子核的各种变化。\n1.4.1 核反应的一般描述2.核反应分类：\n（1）按出射粒子分类：\n\n①对出射粒子和入射粒子相同的核反应称为散射，又可以分为弹性散射与非弹性散射。\n②对出射粒子和入射粒子不相同的核反应，当出射粒子为γ射线时称为辐射俘获。\n\n（2）按入射粒子分类：\n\n①中子核反应：最重要的是热中子辐射俘获(n,γ)，很多人工放射性核素由此反应制备，如60Co源。\n②带电粒子核反应：质子引起的核反应；氘核引起的核反应；α粒子引起的核反应；重离子引起的核反应。\n③光核反应：γ光子引起的核反应，常见的是(γ,n)；\n④电子也能引起核反应。\n\n（3）按照入射粒子能量分类：①入射粒子100MeV以下，称低能核反应；②100MeV～1GeV，称中能核反应；③1GeV以上，称高能核反应。\n1.4.2 核反应能及其阈能3.核反应及其阈能\n\n反应能$Q&#x3D;（B_b+B_B）-（B_a+B_A）$\n核反应阈能$T_{th}$：对吸能反应而言，能发生核反应的最小入射粒子动能$T_α$称为核反应阈能$T_{th}$。\n阈能$T_{th}$与反应能Q的关系：$T_{th}&#x3D;(m_α+m_A)&#x2F;m_A×|Q|$\n\n1.4.3 核反应截面和产额4.核反应截面和产额\n\n①核反应截面：一个入射粒子入射到单位面积内只含有一个靶核的靶子上所发生反应的概率。其量纲为面积，常用单位为”巴”，$1b&#x3D;10^{-28}m^2&#x3D;10^{-24}cm^2$\n②核反应中各种截面均与入射粒子的能量有关。\n③已知截面即可求核反应的产额，入射粒子在靶体引起的核反应数与入射粒子数之比称为核反应的产额。$Y&#x3D;N&#x2F;I_0$，Y与反应截面、靶的厚度、组成有关。\n\n1. 5核裂变及核能的利用1.5.1 自发裂变与诱发裂变1.自发裂变：在没有外来粒子轰击下原子核自行发生裂变的现象；自发裂变：$Q_{f,s} &#x3D; B(Z_1,A_1) + B(Z_2,A_2) - B(Z,A)$\n\n自发裂变发生的条件：$Q_{f,s}&gt;0$，即两裂变碎片的结合能大于裂变核的结合能。\n自发裂变核是一种很强的中子源。有 $^{244}\\text{Cm}$、$^{249}\\text{Bk}$、$^{252}\\text{Cf}$、$^{255}\\text{Fm}$ 元素。\n\n2.诱发裂变：在外来粒子轰击下原子核才发生裂变的现象。\n\n热中子核裂变：易裂变核 $^{235}\\text{U}$、$^{233}\\text{U}$、$^{239}\\text{Pu}$\n阈能核裂变：不易裂变核 $^{238}\\text{U}$、$^{232}\\text{Th}$\n\n1.5.2 裂变后现象3.裂变中子包含瞬发中子和缓发中子两部分，缓发中子约占总数的1%（为0.65%），瞬发中子的能谱 $N(E)$ 和每次裂变放出的平均中子数 $\\bar{\\nu}$，是重要的物理量。以$^{235}\\text{U}$ 诱发裂变为例，释放能量约208 MeV。 \n二、核反应堆工程基础\n熟悉核裂变及核能的利用、核反应堆的基本工作原理、反应性与反应性的控制、堆内的释热与传热。\n\n2.1 核反应堆的基本工作原理1.1942年12月1日，美国科学家费米，石墨堆，首次实现原子核链式反应。\n2.1.1 中子与原子核的相互作用2.中子与原子核的相互作用：中子与原子核反应有散射（无新核素生成）和吸收（有新核素生成）两种。\n\n散射-分弹性散射（慢化）和非弹性散射（非弹性散射具有阈能的特点）。\n吸收（n,a）又包括辐射俘获（n,c）、裂变反应（n,f）。常见的中子俘获（n,c）反应是辐射俘获（n,γ）反应。\n铀238→铀239（n,γ），对核燃料增殖和原子能的利用具有重大意义。$^{238}{92}\\text{U} + ^1_0\\text{n} \\to ^{239}{92}\\text{U} + \\gamma$$^{239}{92}\\text{U} \\xrightarrow {\\beta^-} ^{239}{93}\\text{Np} \\xrightarrow{\\beta^-} ^{239}_{94}\\text{Pu}$\n硼10→锂7(n,α)，硼作为反应性控制材料，用来制作中子探测器。$^{10}_5\\text{B} + ^1_0\\text{n} \\to ^7_3\\text{Li} + ^4_2\\text{He}$\n氧16→氮16(n,p)，$^{16}_7\\text{N}$ 衰变产生3种高能γ射线，是水中放射性主要来源。$^{16}_8\\text{O} + ^1_0\\text{n} \\to ^{16}_7\\text{N} + ^1_1\\text{H}$\n铀235核裂变反应(n,f)，产生两个裂变碎片，平均2.5个中子，约200 MeV能量。$^{235}{92}\\text{U} + ^1_0\\text{n} \\to (^{236}{92}\\text{U})^* \\to ^{A_1}{Z_1}\\text{X} + ^{A_2}{Z_2}\\text{X} + 2.5 ^1_0\\text{n} + 200 \\text{ MeV}$\n\n3.易裂变核素：$^{233}\\text{U}$、$^{235}\\text{U}$、$^{239}\\text{Pu}$、$^{241}\\text{Pu}$。可裂变核素：$^{232}\\text{Th}$、$^{238}\\text{U}$。\n2.1.2 核反应截面和核反应率密度4.微观截面 $\\sigma$：一个原子核与入射的一个中子发生核反应的概率（与核素种类、中子能量有关），b &#x3D; 10$^{-24}$ cm$^2$。\n5.宏观截面 $\\Sigma$：一个中子与单位体积内所有原子核发生核反应的概率，也表示一个中子在介质中穿过单位距离与靶核发生核反应的概率大小（与核素种类、中子能量、燃料富集度有关）。其单位是长度的倒数，常用 1&#x2F;cm。如：宏观吸收截面 $\\Sigma_a &#x3D; 0.25$&#x2F;cm 表示一个中子在介质中穿过1 cm被吸收的概率是25%。\n6.平均自由程：粒子在靶物质中连续两次相互作用之间穿行的平均距离，是散射宏观截面的倒数。\n7.中子通量（也叫中子注量率）$\\Phi$：单位体积内中子数与中子速度 $V$（常采用中子的平均速度）之积，表示在单位时间内穿过与其速度矢量方向垂直的单位面积的中子总数。\n8.中子密度 $n$：任一时刻在1 cm$^3$ 的物质中所包含的中子数。\n9.中子通量密度：这些中子在每秒钟所穿行的总距离。\n10.中子核反应率 $R$：在单位时间、单位体积靶核内 $n$ 个中子与原子核发生核反应的总次数。$R &#x3D; \\Sigma \\cdot \\Phi &#x3D; \\Sigma \\cdot n \\cdot V$\n11.核截面随中子能量变化的规律：\n\n低能区（$E &lt; 1$ eV），吸收截面 $\\sigma_a$ 随中子能量减小而增大，大致与中子速度成反比，也称 1&#x2F;V 区；\n中能区（$1$ eV $&lt; E &lt; 10^4$ eV），重元素出现很多共振峰值；\n高能区（$E &gt; 10^4$ eV），也称快中子区，吸收截面小于10靶，且截面随能量的变化也趋于平滑。\n\n2.1.3 中子的慢化12.中子的慢化：核燃料原子核裂变时放出的中子都是高能中子，平均能量达到2MeV，最大达到10MeV。为提高中子与235U核发生裂变的几率，必须把快中子减速到热中子能量的过程。\n13.慢化剂：使中子慢化的物质。\n14.慢化比是评价慢化剂优劣的一个重要参数，慢化能力（能降ξ与散射截面Σs的乘积）越小，堆要求越大；慢化比（慢化能力除以吸收截面）越低，富集度要求越高。\n15.热中子：介质原子核处于热平衡状态的中子为热中子，在20℃时热中子的最可几速率是2200m&#x2F;s，相应的能量是0.0253eV。\n2.1.4 核反应堆临界条件16.有效增值系数：$K_{eff} &#x3D; \\frac{\\text{新一代中子数}}{\\text{老一代裂变中子数}} &#x3D; \\frac{\\text{中子产生率}}{\\text{中子消失率}}$，必须 $K_{eff} &gt; 1$ 裂变反应才能继续下去。\n17.核反应堆临界条件：$K_{eff} &#x3D; 1$\n18.无限介质增值系数：K∞\n19.裂变机率&#x3D;宏观裂变截面&#x2F;宏观吸收截面\n2.1.5 核燃料的消耗、转化与增殖20.燃耗深度：表示核燃料燃烧的充分程度，在动力堆中定义为每吨初始装载的铀放出的能量，即单位质量的铀所发出的能量，单位是MWd&#x2F;tU。需注意的是，这里指的铀，包括$^{235}\\text{U}$ 和$^{238}\\text{U}$，并非只是$^{235}\\text{U}$。\n21.卸料燃耗深度：堆芯卸料时所达到的燃耗深度。它受反应堆核特性（剩余反应性）和燃料元件本身的性能（元件的机械性能）两方面影响。\n22.转化比$CR &#x3D; \\frac{\\text{易裂变核的平均生成率}}{\\text{易裂变核的平均消耗率}}$；\n23.增值比BR，即CR大于1，目前主流的增值堆是钠冷快堆，$^{239}\\text{Pu}$ 作为燃料（CR~1.2）。\n2.1.6 堆内中子注量率分布与功率展平24.反应堆的中子注量分布的形状只取决于反应堆的几何形状，而与反应堆的功率大小无关。\n25.同等体积的堆，球形的中子泄漏最小，圆柱次之，长方体泄漏最大。\n26.目前大部分采用圆柱形堆芯，其热中子注量率分布在高度方向上为余弦函数分布，在半径方向上为零阶贝塞尔函数分布。\n27.带反射层的反应堆中子分布：①堆芯外围加上反射层，把泄漏到堆芯外面的中子通过散射再返回堆芯，以减少堆内中子的泄漏，使得同样成分的反应堆堆芯的尺寸可以减小。②原来在堆芯边缘地区的中子通量密度将会增加，使得中子通量密度分布更为平坦。\n28.控制棒分为三类：（1）用于紧急停堆控制的停堆棒；（2）用于功率调节和温度调节的调节棒；（3）用于补偿反应性缓慢变化的补偿棒。\n29.功率密度分布展平的重要性：（1）提高堆功率水平的有效措施应是在保证最高热负荷不变的情况下，提高整个堆的平均功率水平；（2）要提高堆的平均功率水平，就必须采取措施改善堆内功率密度的分布使之更为均匀平坦，即功率密度分布的展平，如果是单一燃料情况，功率密度分布的展平实际上就是中子通量的展平。\n30.功率密度分布的展平方法：（1）堆芯径向分区装载；（2）合理布置控制棒；（3）引入合理分布的可燃毒物。\n2.2 反应性与反应性的控制2.2.1 反应性的概述1.反应性 $\\rho$：是指上一代与下一代中子数的相对变化，表示系统偏离临界的程度。$\\rho &#x3D; \\frac{k_{eff}-1}{k_{eff}}$，三种状态：超临界、临界、次临界状态。反应性以 pcm（percent mille）作为单位，$1 \\text{ pcm} &#x3D; 10^{-5}$。\n2.反应堆中重要的反应性值有：剩余反应性、控制毒物的价值、停堆深度等。\n3.剩余反应性：在反应堆中没有任何毒物（如控制棒、可燃毒物、化学补偿毒物等）的条件下，反应堆的反应性称为剩余反应性。也可理解为在任何时刻通过对控制元件和其它用于控制反应性的毒物的调节所能获得的最大反应性。剩余反应性的大小与反应堆的运行时间和工况有关。\n4.停堆深度：是指反应堆处于次临界状态下，堆芯所达到的负反应性，就是次临界度。\n5.停堆裕度：安全分析中使用的一种概念，当所有的控制棒都投入堆芯（假设价值最大的一束控制棒卡在堆外），反应堆所达到的负反应性。停堆裕度与反应堆运行时间（燃耗）和工况（硼浓度）有关，与反应堆的功率水平和控制棒的位置无关。\n6.在任何时候，反应堆都有停堆裕度，而在反应堆临界状态下，没有停堆深度可言。\n7.紧急停堆后反应堆的停堆深度（次临界度）必须大于所规定的停堆裕度。对于换料堆芯，寿期末、热态零功率状态的停堆裕度不得低于2300pcm。\n2.2.2 反应性系数8.反应性系数：\n（1）温度系数 $\\alpha_T$：温度变化1℃或1 K引起的反应性的变化。包括：\n\n燃料温度系数 $\\alpha_{T_f}$：燃料温度变化1℃或1 K引起的反应性的变化。（瞬时效应，一般 $\\alpha_{T_f}$ 必须为负）\n慢化剂温度系数 $\\alpha_{T_m}$：慢化剂温度变化1℃或1 K引起的反应性的变化。（滞后效应，欠慢化时，$\\alpha_{T_m}$ 为负）\n\n（2）压力系数 $\\alpha_p$：冷却剂压力变化引起的反应性变化，主要是因为压力会引起慢化剂密度变化。（欠慢化时，$\\alpha_p$ 为正，对于压水堆而言 $\\alpha_p$ 很小，可以忽略）\n（3）空泡系数 $\\alpha_V$：冷却剂内的空泡份额变化百分之一所引起的反应性变化。一般来说，会导致慢化能力下降，对压水堆是负效应，对快堆可能是正效应。\n（4）功率系数 $\\alpha_p$：反应性功率系数是单位功率变化引起的反应性变化，也称反应性微分功率系数。主要是因为反应堆功率变化时，堆内燃料温度、慢化剂温度、空泡份额都会变化，所以：$\\alpha_p &#x3D; \\alpha_T + \\alpha_V$整个堆芯寿期中，要求αp为负，通常它在寿期末的负值的绝对值更大。\n9.水铀比：慢化剂和燃料的核密度之比，在水堆中为水铀比，这个值对于分析慢化剂的温度效应十分重要；增大水铀比，中子的泄露会降低，但是慢化剂里中子的吸收会增加；降低水铀比，中子的慢化时间增大，使得快中子的共振吸收增加，同时也会引起中子泄漏；水铀比过小称为欠慢化，水铀比过大称为过慢化，轻水堆一般设计成欠慢化的，以保证慢化剂的负的温度效应。\n2.2.3 影响反应性变化的因素10.影响反应性变化的因素：（1）燃料和重同位素成分的变化；（2）氙毒、碘坑和结渣。\n11.毒物效应：毒物对反应性的作用称为毒物效应。以氙效应最为重要，一是其引入的负反应性大（约2900 pcm），二是其变化快，不易控制。平衡钐约引入600 pcm的负反应性，其变化相对氙慢得多。\n12.氙效应：\n\n生成：（1）裂变直接产生（可忽略）；（2）$^{135}\\text{I}$ 衰变形成（$^{135}\\text{Te}$ 半衰期极短）。\n消失：（1）形成 $^{136}\\text{Xe}$（俘获中子）；（2）放射性衰变生成 $^{135}\\text{Cs}$；\n功率的影响：功率越大（中子通量密度越高），其平衡氙浓度越大（正相关）。\n升功率：功率↑—→中子通量↑—→氙吸收中子↑—→氙浓度↓—→碘浓度↑—→（碘衰变生成氙&gt;消失的氙）—→氙浓度↑—→平衡。\n停堆：来自裂变直接产生的氙和由于吸收中子而消耗的氙都几乎停止，氙主要来自于碘衰变，通过自身衰变消失。氙浓度最初将增加。峰值大约在停堆后8-9h出现（停堆死区、死时间），最大值约为停堆前功率运行的平衡氙浓度的2倍，大约3天后氙几乎完全消失。\n碘坑：反应堆在某一功率下运行较长时间后停堆或降功率，此时$^{135}\\text{Xe}$ 的生成量大于消耗量，由此引起 $^{135}\\text{Xe}$ 的浓度逐步增大，达到最大值后又逐步衰减，直至浓度降到零。$^{135}\\text{Xe}$ 浓度达到最大值时所对应的负反应性，我们称之为”碘坑”。\n变化规律：稳态随功，升谷降峰，停堆三日、难觅其踪。\n氙振荡的周期大约是15-30小时，是可以被控制的，如可利用控制棒进行抑制。\n\n13.钐效应：\n\n生成：由$^{149}\\text{Pm}$（钷）衰变而成\n消失：俘获中子消失\n在长期稳定功率运行时，$^{149}\\text{Sm}$ 的平衡浓度与通量无关，是一个恒定值。$^{149}\\text{Pm}$ 与中子通量有关。当反应堆停堆后，所有的 $^{149}\\text{Pm}$ 将转变为 $^{149}\\text{Sm}$，所以 $^{149}\\text{Sm}$ 浓度变成了 $^{149}\\text{Pm} + ^{149}\\text{Sm}$。故停堆后 $^{149}\\text{Sm}$ 的平衡浓度与停堆前的功率（停堆前功率越高，Pm越多）有关。\n变化规律：稳态不随功（600pcm），升谷降峰，停堆累积。\n\n14.结渣：除了氙毒、钐毒之外的其他裂变产物。\n2.2.4 反应性的控制15.根据控制毒物在调节过程中的作用和要求，可把反应性控制分为三种类型：（1）紧急停堆控制。当反应堆出现异常工况需要紧急停堆时，要求控制系统能迅速引入一个大的负反应性，快速停堆，并达到一定深度。（2）功率调节控制。当外界负荷或堆芯温度发生变化时，要求控制系统必须引入一个适当反应性，以满足反应堆功率调节的需要。在操作上要求既简单又灵活。（3）补偿控制。用于补偿燃耗、裂变产物积累所需的剩余反应性，所要控制的反应性当量是大的，但由于这些反应性的变化是很缓慢的，所以相应的控制毒物的过程也是十分缓慢的。\n16.向堆芯加入或提出控制毒物有三种方式：（1）控制棒：在堆芯内插入可移动的含有中子吸收材料的控制棒；（2）可燃毒物：堆芯寿期的长短通常取决于反应堆初始燃料装载量，用以补偿堆芯寿命初期的剩余反应性的物质叫可燃毒物。（3）可溶毒物：可溶毒物是一种吸收中子能力很强的可以溶解在冷却剂中的物质。\n17.反应性控制手段：化学补偿、控制棒、可燃毒物控制。\n\n\n\n控制方式\n控制的反应性变化\n优点\n缺点\n\n\n\n控制棒控制\n燃料的多普勒效应，慢化剂的温度和空泡效工况变化时的瞬态氙效应，硼稀释效应，热态停堆深度\n调节速度快方便、可靠。\n引起轴向中子畸变\n\n\n可燃毒物控制\n补偿初期的剩余反应性\n展平堆芯的径向功率\n寿期末的残渣(放射性)\n\n\n化学补偿控制\n反应堆从冷态到热态(零功率)时慢化剂的温度效应，易裂变核素燃耗和长寿期裂变产物积累的反应性变化，平衡氙和平衡钐效应\n调节均匀，不产生畸变\n调节作用慢，对温度系数有影响\n\n\n2.3 核反应堆内的释热与传热2.3.1 核反应堆热源及其分布1.一般认为每一个235U，233U或239Pu的原子核，裂变时大约要释放出200 MeV的能量。不包括裂变过程释放出由中微子带走无法利用的约12MeV能量。\n2.在压水动力堆工程设计中，通常取燃料元件的释热量占堆芯总释热量的97.4%。\n2.3.2 传热的基本方式3.三种基本的热传递方式：热传导、对流和热辐射。\n4.热传导：热量从物体中温度较高的部分传递到温度较低的部分，或者从温度较高的物体传递到与之接触的温度较低的另一物体的过程称为热传导。\n4.傅里叶定律：$Q &#x3D; -kF\\frac{dt}{dx}$其中，$Q$ 为热量，单位是焦耳（J）；$k$ 为导热系数（也称热导率），单位 W&#x2F;(m·℃)；$t$ 为温度；$x$ 为厚度；负号表示热量传递的方向同温度升高的方向相反；$F$ 为传热面积。\n5.对流和对流换热：对流是指流体各部分之间发生相对位移，从而把热量从一处带到另一处的热传递现象。对流仅能发生在流体中，而且必然伴随有载热现象。工程上常遇到的不是单纯的对流方式，而是流体流过另一固体表面时对流和导热联合起作用的热量传递，称为对流换热。\n\n对流换热的基本计算式为牛顿冷却公式：$q &#x3D; h(T_w - T_b)$\n其中，$F$ 为与流体接触的壁面面积，m$^2$；$T_w$ 是固体的壁面温度；\n$T_b$ 是流体的平均温度；$h$ 是对流换热系数，单位为 W&#x2F;(m$^2$·℃)\n\n6.影响对流换热的因素有五个方面：（1）流体流动的原因:强迫、自然；（2）流体的流态：层流、紊流；（3）流体有无相变发生：沸腾、凝结、两相流；（4）流体的物理性质：流体工质；（5）换热面的几何因素：尺寸、形状、换热表面。\n7.热辐射：一切物体都有辐射粒子（光子）的能力，辐射粒子具有的能量称为辐射能。物体通过电磁波来传递能量的方式称为辐射。物体会因各种原因发出辐射能，其中因热的原因而发出辐射能的现象就是热辐射。\n8.热辐射可以在真空中传播，而热传导和对流传热这两种热传递方式只能在有介质的条件下才会发生。\n9.在压水堆稳态工况，堆内温度不高，辐射换热相对于导热和对流小得多，一般不考虑。但是在事故工况下，堆内温度可达到相当高的温度，就要考虑热辐射。\n2.3.3 沸腾传热10.沸腾传热：通常是最有效的传热机理，在压水堆中它存在于蒸汽发生器、稳压器的电加热器表面等传热设备之中。\n11.沸腾可以分为池式沸腾和流动沸腾。池式沸腾就是流体在一个大容积的容器内被加热实现的沸腾。流动沸腾是液体流过传热面时产生的沸腾。在沸水堆的堆芯和蒸汽发生器传热管二次侧出现的都是流动沸腾，稳压器中则是池式沸腾。\n12.沸腾危机：由于沸腾机理的变化引起传热系数陡降，导致传热壁面湿度骤然升高的现象称为沸腾危机，发生沸腾危机时的热流密度称为临界热流密度。\n13.两种沸腾危机:(1)偏离泡核沸腾（DNB），其机理是泡核沸腾在热流密度足够大时突然转变成膜态沸腾，它发生在含汽率很低或者欠热的液体中；(2)干涸（Dryout），其机理是环状流的液膜由于不断蒸发而破裂甚至蒸干，传热面由于失去液膜覆盖而传热性能变差，这种沸腾危机发生在含汽率很高的环状两相流中。\n2.3.4 临界热流密度和偏离炮和沸腾比14.在堆芯中传热恶化的危险主要来自偏离泡核沸腾，但在一回路大破口失水事故中的堆芯裸露阶段，也有可能出现干涸。\n15.由于下列两种原因，堆芯中发生偏离泡核沸腾的后果比发生干涸时严重很多：（1）发生偏离泡核沸腾的时热流密度特别大。（2）在从泡核沸腾转变成膜态沸腾时，传热系数降低的幅度很大。\n16.根据W-3公式，压水堆稳态额定工况时一般可取DNBR限值为1.8～2.2，对于可预见的事故工况，要求DNBR的双95%限值为1.3。\n17.发生偏离泡核沸腾时热流密度的成为临界热流密度记作qDNB。qDNB的大小主要受下列因素影响：（1）质量流速。流速大，流体的扰动强，加热面上难以形成稳定的汽膜，因而使qDNB增大；（2）通道进口处水的欠热度。欠热度越大qDNB越大；（3）工作压力。压力增加会使饱和温度上升，因而两相流中的含汽率减小，这使qDNB增加；（4）发生DNB处冷却剂的焓。冷却剂的焓越大，越易产生气泡，故qDNB越小；（5）加热表面的粗糙度。粗糙度大，流体搅动加强，使气泡容易脱离壁面，qDNB有所增大。\n \n三、核反应堆与核动力厂\n了解核反应堆的主要类型以及核动力厂使用的其他核反应堆堆型；国内外新型压水反应堆（AP1000、CAP1400、EPR、华龙一号等）；研究堆的基本概念、应用领域以及国内外典型研究堆；反应堆及核动力装置的功率控制、核反应堆保护系统。\n熟悉压水堆核电厂的基本特点、系统及设备组成。\n\n3.0 引言1.民用核设施包括：（1）核电厂、核热电厂、核供汽供热厂等核动力厂；（2）核动力厂以外的研究堆、实验堆、临界装置等其他反应堆；（3）核燃料生产、加工、贮存和后处理设施等核燃料循环设施；（4）放射性废物的处理、贮存、处置设施；（5）其他需要严格监督管理的核设施。\n2.核设施主要存在临界安全和辐射安全问题。\n3.1 核反应堆的主要类型1.按照功能分类：（1）研究堆，用来研究中子特性；（2）生产堆，主要是生产新的易裂变核素233U，239Pu和各种不同用途的同位素；（3）动力堆，包括军用动力堆和民用动力堆。\n2.按照中子能谱分类（1）快中子堆中，裂变是由快中子（平均能量达0.1MeV左右）引起的，因此堆内不能存有中子慢化剂材料。（2）中能中子堆，存有一定数量的慢化剂，裂变主要是由中能中子引起的。在快中子堆或中能中子堆中，堆内都必须使用高富集度的核燃料。（3）热中子堆，裂变是由热中子引起的，因此堆内必须有足够的慢化剂。天然铀、低富集铀燃料、$^{233}\\text{U}$、$^{239}\\text{Pu}$ 都可用作热中子堆的核燃料。世界上已建的堆绝大多数属于这种类型。\n3.按照慢化剂分类：轻水堆、重水堆、石墨慢化反应堆、铍或铍化合物堆。\n4.按照冷却剂分类：（1）气冷反应堆：包括CO$_2$冷却和He气冷却反应堆；（2）液体冷却反应堆：主要包括轻水冷却的压水堆和沸水堆，以及重水冷却的重水反应堆，还可以用有机化合物冷却的液体冷却堆；（3）液态金属冷却的反应堆：主要有钠、钠-钾合金、铋冷、锂冷、铅铋合金等冷却的反应堆。\n5.按照核燃料分类：天然铀燃料堆、低富集铀燃料堆、高富集铀燃料堆、钍增殖堆。\n6.按照核燃料的形态划分：固体燃料堆、流态燃料堆、半流态燃料堆等。\n7.在以发电为目的的核能动力领域：主要有压水堆（PWR）、沸水堆（BWR）、重水堆（PHWR）、高温气冷堆（HTGR）、快中子堆（LMFBR）这5种堆型。\n3.2 压水堆核电厂1.压水堆核电厂采用低富集铀作核燃料，燃料芯块中$^{235}\\text{U}$ 的富集度约3%～5%左右。核燃料是高温烧结的圆柱形二氧化铀陶瓷燃料芯块；\n2.压水堆的冷却剂是轻水。轻水不仅价格便宜，而且具有优良的热传输性能。所以在压水堆中，轻水不仅作为中子的慢化剂，同时也用作冷却剂。\n3.轻水有一个明显的缺点，就是沸点低。\n4.压水堆是一种使冷却剂处于高压状态的轻水堆。压水堆冷却剂入口水温一般在290℃左右，出口水温330℃左右，堆内压力15.5MPa。二回路的水280℃、6-7Mpa。\n5.压水堆核电厂最显著的特点是：（1）结构紧凑；（2）堆芯的功率密度大；（3）基建费用低；（4）建设周期短。\n6.压水堆核电厂的主要缺点有两个：（1）必须采用高压的压力容器；（2）必须采用有一定富集度的核燃料。\n7.压水堆反应堆本体：（1）压水堆核电厂主要由核岛和常规岛组成。（2）核岛中的四大部件是反应堆本体、蒸汽发生器（简称蒸发器）、稳压器和主泵。在核岛中的设备系统主要有压水堆本体、一回路系统，以及为支持一回路系统正常运行和保证反应堆安全而设置的辅助系统。（3）常规岛主要包括汽轮机组及二回路等系统，其形式与常规火电厂类似。（4）压水堆本体包括堆芯、压力容器与堆内构件。\n8.压水堆核电厂使用的反应堆本体由堆芯、压力容器、上部堆内构件和下部堆内构件等部分组成。\n9.燃料组件由燃料元件(也称燃料棒)、定位格架和组件骨架等部件组成。大亚湾核电厂压水堆的燃料组件通常17×17正方形排列的燃料元件组成。其燃料元件活性区部分的高度目前主要有3.66 m（12英尺），每根燃料元件中装有271块二氧化铀燃料芯块，每个燃料芯块直径约8.2 mm，高13.5 mm。燃料芯块的区域称为活性区。燃料芯块叠放在壁厚0.57 mm的Zr-4合金包壳中。\n10.Zr作燃料包壳的优点：（1）中子吸收截面小；（2）在高温下有较高的机械强度和抗腐蚀性能；（3）只有少量氚穿过Zr管；（4）正常运行时，与水不发生反应；（5）熔点高（1800℃）。\n11.Zr作燃料包壳的主要缺点是在820℃下锆与水开始发生锆水反应产生氢气，会带来安全问题。\n12.反应堆压力容器：是压水堆核电厂中最关键的设备之一，工作在高压（15.5MPa左右）、高温含硼酸水环境和放射性辐照的条件下，寿命不少于40年。反应堆压力容器由筒体和顶盖两部分组成。反应堆压力容器本体材料属低碳钢，Mn-Ni-Mo低合金钢。与冷却剂接触表面堆焊一层5mm厚的不锈钢。在核动力厂整个寿期，它是不可更换的。\n13.压水堆堆内构件构件包括：（1）下部支承构件；（2）上部支承构件；（3）堆芯仪表支承结构。\n14.堆内构件构件的功能是：（1）支承和固定燃料组件，承受堆芯重量；（2）确保控制棒的对中和导向；（3）引导冷却剂流入和流出燃料组件，合理分配流量；（4）为压力容器提供热屏蔽，减少中子和γ射线的照射；（5）为堆芯内仪表提供导向和支承。\n15.反应堆换料：压水堆初次装料后，大约经过一两年要进行一次更换燃料组件的操作，我们称之为首次换料。这以后，就每隔一段时间换料一次。每次换料只需卸下三分之一的燃料组件。\n16.冷却剂在压力容器流动时，有一部分没有用来冷却燃料元件，此称为旁路流量。应该尽可能减少旁路流量。\n17.一座100万kW电功率的压水堆，堆芯冷却剂流量约为6万t&#x2F;h。\n18.反应堆冷却剂系统可分为冷却系统、压力调节系统和超压保护系统几个部分，包括压力容器、蒸汽发生器、主循环泵、稳压器等设备，由这些设备及相关管路组成整个一回路冷却剂系统，有其特定的压力边界，通常称为一回路压力边界。\n19.控制棒驱动机构的压力外壳也属于一回路压力边界。该压力边界构成了包容放射性物质的一道安全屏障。\n20.一回路压力边界内所有的设备是安全等级、质量等级和抗震等级最高的设备，即安全等级一级、质量保证等级一级和抗震一类的设备。\n21.压力容器、蒸汽发生器、主循环泵和稳压器等一回路系统和设备都被安置在安全壳内，称之为核岛。\n22.蒸汽发生器是压水堆核电厂一、二回路的枢纽，将反应堆产生的热量传递给蒸汽发生器二次侧，产生蒸汽推动汽轮机作功。又是分隔一、二次侧介质的屏障。管板和倒置U形管是冷却剂压力边界的组成部分。但传热管断裂事故在核动力厂设备事故中居首要地位。约占非计划停堆事故的四分之一，可靠性比较低。\n23.压水堆核电厂中的蒸汽发生器主要有下列三种：（1）立式U形管蒸汽发生器；（2）卧式蒸汽发生器；（3）立式直流蒸汽发生器。\n24.田湾核电厂蒸汽发生器是卧式U形管自然循环蒸汽发生器。\n\n优点是：（1）没有水平管板，取而代之的是立式圆柱形联箱。传热管根部具有一定的流速，杂质不会在这里沉积和浓缩，可避免传热管与联箱结合部位的腐蚀破裂。（2）具有较大的蒸汽空间，单位蒸发面的负荷较立式蒸汽发生器的小，因而，采用较简单的汽水分离装置（百叶窗式）就能保证蒸汽质量满足标准。\n缺点是：（1）出口蒸汽的湿度对水位波动比较敏感，对水位控制要求较高。（2）卧式安放，不便于在安全壳内布置。\n\n25.反应堆冷却剂泵可分为两大类：（1）全密封泵；（优点是密封性能好，运行安全可靠；缺点是效率相对较低，转动惯量小，维修不便；主要用于核动力舰艇上）（2）轴封泵。（优点是效率较高，转动惯量大，维修方便，适用于大容量机组，目前核动力厂主要采用轴封泵）\n26.主循环泵，对核动力厂主泵有下列要求：（1）长期无人维护下安全可靠运行；（2）结构简单，方便维修；（3）能提供足够大的转动惯量；（4）过流部件表面材料耐腐蚀；（5）带放射性的冷却剂泄漏小。\n27.稳压器：在反应堆压力容器出口和蒸汽发生器之间的热管段安装有稳压器，只要在一条热管段上安装一台稳压器就可以满足稳定堆内压力的需要。基本功能是建立并维持一回路系统的压力，避免冷却剂在反应堆内发生容积沸腾或超压。具体是：（1）压力控制：稳态运行时，维持一回路恒定压力（15.5MPa），防止堆冷却剂汽化；（2）系统瞬态时，将压力变化限制在允许值以内，避免紧急停堆；（3）事故时，防止一回路系统超压，维护一回路的完整性，即在压力超过安全阀阈值时，安全阀开启，蒸汽排放到卸压箱。（4）作为一回路冷却剂的缓冲箱，补偿反应堆冷却剂系统容积变化。（5）在启动时使反应堆冷却剂系统升压，停堆时使反应堆冷却剂系统降压。\n28.安全壳：是包容反应堆冷却剂系统的气密承压构筑物，既承受内压又承受外压的坚固建筑物。安全壳用于保证：（1）在发生失水事故和主蒸汽管道破裂事故时承受内压，容纳喷射出的汽水混合物，防止或减少放射性物质向环境的释放；（2）承受外压以防安全壳外各种可能的冲击，对外部事件（如飞机撞击、龙卷风）进行防护；（3）在正常运行期间，对反应堆冷却剂系统的放射性提供生物屏蔽，并限制污染气体的泄漏。安全作为放射性物质与环境之间的第三道屏障。\n29.安全壳可以是混凝土壳也可以是钢壳。混凝土安全壳也有多种形式，主要有：（1）带密封钢衬的预应力混凝土安全壳；（2）双层安全壳；（3）负压安全壳。从几何形状上有圆柱形的和球形的。\n30.我国秦山和大亚湾核电厂所采用的是带密封钢衬里的单层预应力混凝土安全壳。安全壳底部用钢筋混凝土底板封闭，顶部用准球形的预应力混凝土穹顶封闭，其内表面由一层6mm厚，由焊接钢板组件制成的金属衬里覆盖。\n31.大亚湾压水堆核电厂安全壳整体尺寸如下：筒体混凝土壁厚0.9m，衬里内径37m，高为56.68m。内部有效空间约49000m3。安全壳的设计（绝对）压力为0.52MPa，设计温度为145℃，允许每24小时的（质量）泄漏量为0.1%。\n32.核动力厂一回路辅助系统，按其作用，大致可分为以下几类：（1）保证反应堆和一回路系统正常运行的系统有：化学和容积控制系统，硼和水补给系统，主循环泵轴密封水系统。（2）为核动力厂一回路系统在运行和停堆时提供必要冷却的系统有：设备冷却水系统，重要厂用水系统，余热排出系统（也称为停堆冷却系统），通风系统。（3）在发生重大失水事故时保证核动力厂反应堆及主厂房安全的系统有：安全注入系统，安全壳喷淋系统。（4）控制和处理放射性物质，减少对自然环境放射性排放的系统有：疏排水系统，放射性废液处理系统，废气净化处理系统，废物处理系统，硼回收系统，取样分析系统。（5）一回路其他辅助系统：补给水系统，乏燃料池冷却及净化去污清洗系统等。\n33.化学和容积控制系统，主要功能是：容积控制，化学控制，反应性控制；辅助功能：（1）向反应堆冷却剂泵提供轴封水；（2）为稳压器提供辅助喷淋水，当主喷淋管线不可用时，化容积控制系统提供的稳压器辅助喷淋管线代替主喷淋管线功能。（3）在一回路满水时，稳压器不起作用时，可由化容系统的下泄阀进行压力控制。（4）对于上充泵兼作高压安注泵的化容系统，事故时用上充泵向堆芯注入应急冷却水，从而具有核安全功能。\n34.设备冷却水系统：是一个闭式的冷却水回路，用以防止放射性物质在设备和热交换器发生泄漏时被直接排放到江水和海水中而污染环境。\n35.设备冷却水系统的功能是：（1）冷却功能：为核动力厂一回路主、辅系统接触放射性介质的设备和热交换器提供冷却水，并将其热负荷通过重要厂用水系统传到海水中。（2）隔离作用：该系统是核岛各热交换器与海水之间的一道屏障。它既可以避免放射性流体不可控地释放到海水中而污染环境，又可以防止海水对核岛各热交换器的腐蚀。（3）在事故工况下作为专设安全设施的支持系统，将热量经重要厂用水系统排入环境。\n36.余热排出系统的主要功能是：（1）在停堆后第二阶段，即在一回路温度降到180℃以下、绝对压力降到3.0MPa以下时，排出堆芯余热、一回路水和设备的显热以及运行的主泵在一回路中产生的热量，使反应堆进入冷停堆状态；（2）反应堆在冷停期间，进行换料或维修操作时，排出堆内余热，维持一回路温度低于60℃；（3）除了失水事故（LOCA）引起安全注入系统投入运行的情况以外，在其他事故引起的停堆事故中，余热排出系统也被用来排出热量。\n37.余热排出系统还可能有一些辅助功能，在反应堆从冷停堆开始加热过程中，控制一回路平均温度，保证升温速率在28℃&#x2F;h之内。\n38.安全注入系统的功能是：（1）在一回路小破口失水事故时或在二回路蒸汽管道破裂造成一回路平均温度降低而引起冷却剂收缩时，安全注入系统用来向一回路补水，以重新建立稳压器水位；（2）在一回路大破口失水事故时，安全注入系统向堆芯注水，以重新淹没并冷却堆芯，限制燃料元件温度的上升；（3）在二回路蒸汽管道破裂时，向一回路注入高浓度硼酸溶液，以补偿由于一回路冷却剂连续过冷而引起的正反应性，防止堆芯重返临界。\n39.安全注入系统通常分三个子系统：\n\n高压安全注入系统；（能动系统，有时间延迟和流量限制）\n中压安全注入系统，即蓄压箱注入系统；（非能动系统，最先启动）\n低压安全注入系统。（能动系统，有时间延迟和流量限制）安注过程包括：直接注入阶段（换料水箱吸水注入）和再循环注入阶段（安全壳地坑吸水注入）。\n\n40.安全壳喷淋系统主要功能是：从安全壳顶部喷洒冷却水，为安全壳气空间降温降压，限制事故后安全壳内的峰值压力，保证安全壳完整性。安全壳喷淋系统的辅助功能是：（1）喷淋水中加入NaOH，有除碘功能。（2）在再循环安注模式下，安全壳地坑的水需要冷却时，由安全壳喷淋系统的热交换器冷却后再注入堆芯，安全壳喷淋系统是在设计基准事故下可排除安全壳内热量的唯一系统。（3）当反应堆厂房发生火灾时，可手动喷淋灭火；（4）在LOCA后15天，安全壳喷淋泵可作为低压安注泵的备用。\n41.其它一些核岛辅助系统（1）主循环泵轴密封水系统；（2）硼回收系统；（3）补给水系统：补给水系统是为一回路主、辅系统提供所需的除盐水、除氧水及硼回收再生水。（4）取样系统及分析室；（5）去污清洗系统；\n42.二回路系统：（1）核电厂常规岛可分为汽轮机回路、循环冷却水系统和电气系统三部分。（2）压水堆核电厂汽轮机回路，也称为二回路系统，主要功能是将蒸汽发生器产生的饱和蒸汽供汽轮发电机组做功发电和供电站其他辅助设备使用。（3）二回路系统主要由饱和蒸汽汽轮机、发电机、汽水分离再热器，冷凝器、凝结水泵、低压加热器、除氧器、给水泵、高压加热器、循环水泵、中间汽水分离再热器和相应的阀门、管道等组成。（4）循环冷却水系统，亦称三回路。向凝汽器提供冷却水，确保汽轮机凝汽器的有效冷却。（5）电气系统，主要设备为发电机、励磁机、主变压器、厂用变压器、辅助变压器、高压开关站和柴油发电机组等组成。将核动力厂发出的电能向电网输送，同时保证核动力厂内部设备的可靠供电。\n43.饱和蒸汽汽轮机组：大亚湾核电厂的汽轮机为饱和蒸汽、中间再热、多缸单轴系冲动式汽轮机。\n44.发电机组：核动力厂主发电机与火电站发电机不同点在于采用半速四级机组，是核动力厂饱和蒸汽汽轮机所要求的。\n45.根据反应堆事故停堆时安全冷却的需要，希望主发电机及其励磁系统应能带动冷却剂主循环泵进行不低于20～30s的运转。\n46.二回路的辅助系统包括：主蒸汽排放系统、循环冷却水系统、汽轮机再热与抽气系统、凝结水给水系统、化学水处理系统、事故(辅助)给水系统、蒸汽发生器排污系统、控制保护系统和润滑油系统等。\n3.3 核动力厂使用的其他核反应堆堆型1.沸水堆：以沸腾水为中子慢化剂和冷却剂，并在反应堆压力容器内直接产生饱和蒸汽的动力堆。堆芯工作压力下降到7MPa左右。\n2.与压水堆相比，沸水堆有以下特点：（1）直接循环，核反应堆产生的蒸汽被直接引入蒸汽轮机。（2）工作压力可以降低，堆芯工作压力下降到沸水堆的7MPa左右。（3）堆芯出现空泡，堆芯处于两相流动状态。（4）沸水堆中采用十字形控制棒在燃料组件盒之间，从底部插入，水力驱动的控制棒传动机构较压水堆复杂。（5）总反应性控制量比压水堆小，控制棒占15～17％Δk&#x2F;k，停堆深度4％Δk&#x2F;k。正常反应性控制由控制棒（为主）、可燃毒物和慢化剂空泡效应共同完成。（6）在一回路水总量和压力控制方面，沸水堆是控制给水流量和通过卸压阀实现。（7）在功率调节方面，在沸水堆可以利用空泡的负反应性效应，即可以通过控制冷却剂流量来改变反应堆功率。\n3.沸水堆主要缺点：（1）辐射防护和废物处理较复杂。（2）功率密度比压水堆小（水沸腾后慢化能力减弱）。\n4.重水堆是指用重水作慢化剂的反应堆，是核动力厂中发展较早的反应堆堆型之一。重水具有良好的中子物理特性，可直接利用天然铀作核燃料。\n5.重水堆与轻水堆核电站的区别：（1）中子经济性好，可以采用天然铀作为核燃料；（2）比轻水堆更节约天然铀，不但能使用天然铀实现链式反应，而且比轻水堆节约天然铀20%。（3）可以不停堆更换核燃料。（4）重水堆的功率密度低。（5）重水费用占基建投资比重大。（6）当发生失水事故时，轻水堆失水事故的后果可能会比重水堆严重。\n6.高温气冷堆：石墨为慢化剂，用气体作为冷却剂（CO2气体或者氦气）为冷却剂，金属天然铀为燃料。高温气冷堆主要优点是不会发生相变，但是气体的密度低，导热能力差，循环时消耗的功率大，为了提高气体的密度及导热能力，也需要加压。\n\n第一代高温气冷堆：以石墨为慢化剂，CO2气体为冷却剂，金属天然铀为燃料，镁诺克斯合金为燃料棒包壳材料。\n第二代高温气冷堆：以石墨为慢化剂，CO2气体为冷却剂，2%富集度的二氧化铀陶瓷燃料，不锈钢为燃料棒包壳材料。\n第三代高温气冷堆：以石墨为慢化剂，氦气为冷却剂（化学惰性和热工性能好），全陶瓷型包覆颗粒为燃料元件。高温气冷堆的燃料元件有两种：一种是与压水堆类似的棱柱形的（棱柱形高温气冷堆），另一种是球形的（球床高温气冷堆）。\n\n7.我国高温气冷堆：山东石岛湾20万千万模块式高温气冷堆示范工程（HTR-PM），是第三代高温气冷堆，它以石墨为慢化剂，氦气为冷却剂，全陶瓷型包覆颗粒球形燃料元件。电站由两座反应堆和相应的两个蒸汽发生器系统组成，两个反应堆设置在同一反应堆厂房内，采用的是两堆带一机的蒸汽透平循环方案，以一个堆配一个蒸汽发生器为一个标准模块，两个模块配一个汽轮机，共享电站辅助设施。\n8.模块式高温气冷堆采用纵深防御的安全原则，设置4道安全屏障：第一道：全陶瓷型包覆颗粒燃料的热解碳和碳化硅包覆层；第二道：燃料元件外层的石墨包壳；第三道：反应堆压力壳、蒸汽发生器压力壳和连接这两个压力壳的热气导管压力壳；第四道：一回路舱室（没有像压水堆安全壳那么高的气密性和承压要求，但它可以与排风系统配合保持一回路舱室的负压，防止放射性物质向反应堆建筑物内扩散）。\n9.快中子堆：简称快堆，是堆芯中核燃料裂变反应主要由平均能量为0.1MeV以上的快中子引起的反应堆。快堆堆芯与一般的热中子堆芯不同，它分为燃料区和增殖再生区两部分，燃料区由几百个六角形燃料组件盒组成，每个燃料盒的中部是混合物核燃料芯块制成的燃料棒，两端是由非裂变物质天然（或贫化）二氧化铀束棒组成的增殖再生区，核燃料区的四周是由二氧化铀棒束组成的增殖再生区。\n10.快堆是唯一较容易实现燃料增殖的堆型。主要优点是：（1）可充分利用核燃料。快堆可以使铀资源的利用率从单发展轻水堆的1%左右提高到60%～70%。（2）可实现核燃料的增值。在快堆中，增殖比可达1.2-1.3，在重水堆和轻水堆中，相应的值（称之为转化比）仅分别接近0.8-0.6。（3）快堆的燃料区有几百个六角形燃料组件盒组成，快堆不需要慢化剂，冷却剂只能用液态金属或气体，例如液态钠或氦气，液态钠是一致的选择，早期的小实验堆曾用过汞和钠钾合金。\n11.钠冷快堆分为池式和回路式。\n12.快堆的主要优点：（1）可充分利用核燃料。（2）可实现核燃料的增殖。（3）低压堆芯下的高热效率。\n13.快中子堆核电厂的安全性问题：（1）在钠作冷却剂的快堆中，液态金属钠与水（或蒸汽）相遇就会产生剧烈的化学反应，并可能引起爆炸；（2）钠与空气接触就会燃烧；（3）钠中含氧量超过一定数量会造成系统内结构等材料的严重的腐蚀；（4）堆内的液态钠由于沸腾所产生的气泡空腔可能会引入正的反应性；（5）很高的温度、很深的燃耗以及数量很大的快中子的强烈轰击，使快堆内的燃料芯块及包壳碰到的问题比热堆复杂得多。\n3.4 新型压水反应堆1.第三代是指以满足美国核电用户要求文件（URD）和欧洲核电用户要求文件（EUR）为设计要求的，具有预防和缓解严重事故措施，经济上能与天然气机组相竞争的核电机组，如ABWR、AP1000、EPR、APER、APR1400等。\n2.核电用户要求文件（URD）与（EUR）规定先进反应堆应该有下列基本特征：（1）抗事故能力：所有工况下都具有负的功率反应性系数、改进的人机界面系统、采用成熟的诊断监测技术、须留给操纵员足够的时间（30min或更长时间)。（2）防止堆芯损坏：专设安全系统应满足执照申请的设计基准要求，有大的安全裕量，堆芯损坏频率小于1×10-5&#x2F;堆·年。（3）缓解事故能力：坚固而大容积的安全壳和相应的专设安全系统，采用现实源项分析，控制可燃氢气的浓度，在累积发生频率大于10-6／堆年的严重事故条件下，在厂址边界处(离开反应堆大约0.5英里)，公众个人的全身剂量小于25rem（1Sv&#x3D;100rem）等要求。\n3.AP1000的设计是一个两回路、百万级压水堆核电厂，采用非能动安全设施以及简化的电厂设计，从而使核电厂具有良好的可建造性、可运行性和可维修性。\n4.AP1000安全系统包括：（1）非能动堆芯冷却系统(PXS，PassiveCoreCoolingSystem)；包括非能动余热排出系统和非能动安全注入系统；（2）非能动安全壳冷却系统(PCS，PassiveContainmentCoolingSystem)；（3）主控室应急可居留性系统(MCRHS，MainControlRoomHabitabilitySystem)；（4）安全壳隔离系统(ContainmentIsolationSystem)；（5）安全壳氢气控制系统（HydrogenControlSystem）。\n5.欧洲压水反应堆EPR（1）EPR在堆芯的物理设计上，采用大堆芯，有241组燃料组件，降低了线功率密度，提供了大的裕度。堆芯尺寸的增加减少了中子的径向泄漏（2%～3%），适合采用低泄漏的燃料管理方式。核燃料利用率高，同等发电量下EPR比一般轻水堆节省17％的铀燃料，锕系元素的产生量降低了15％，减少了长寿命高放废物的产生量。（2）在事故工况下当反应堆冷却剂温度低于180℃、压力小于3MPa时进行安注。安注&#x2F;余热导出系统有四列，按4×100％设计，每个安全系统有相互独立的厂房，每个安全系统都可以独立完成安全功能。每列包括：中压安注泵，低压安注泵、低压注入热交换器和安注箱。（3）为了对付堆芯熔化的严重事故，EPR设计了堆芯捕集器，冷却堆芯熔融物，使用了耐特高温保护材料，保证混凝底板的密封性。\n6.华龙一号主要特征：（1）以177组燃料组件堆芯和三个安全系列为基础，采用能动与非能动相结合的设计力量，具有完善的严重事故预防和缓解措施，具有很高的安全性和技术先进性，设计寿命60年，采用18个月换料方案，设计可用率大于90%，安全停堆地震0.3g。（2）机组采用双层安全壳设计，内外层安全壳之间的环形空间通过通风系统使其保持负压。内层安全壳为预应力钢筋混泥土结构，由筒壁和穹顶组成；外层安全壳为钢筋混泥土结构，由筒体和穹顶组成，筒体上部绕安全壳一周设置有外挂水箱。（3）堆芯采用177个燃料组件，每个燃料组件含有呈17*17方形排列的264根燃料组件，24个可放置控制棒、可燃毒物棒或中子源的导向管和1个仪表管。堆芯设置一次中子源组件和二次中子源组件各2个，一次中子源为锎源，二次中子源为锑-铍源。\n3.5 研究堆1.研究堆是主要用来作为中子源的反应堆，也叫非动力堆。\n2.研究堆的类型：（1）按中子通量密度的大小分为零功率堆、普通中子辐照反应堆和高通量堆。（2）按中子产生的方式分为次临界装置、临界堆和脉冲堆。（3）按慢化剂的不同分为重水堆、轻水堆、石墨堆等。（4）按中子能谱分为热中子堆和快中子堆。（5）按燃料的形状分为棒状燃料堆、板状燃料堆、圆环型燃料元件堆、各种形状的弥散体燃料堆和液体燃料堆。（6）按堆的布置分为池式研究堆、罐式或壳式研究堆。（7）按燃料的富集度分为高富集度铀（HEU）堆和低富集度铀（LEU）堆等。（8）按燃料的不同分为固体燃料堆、溶液堆和熔盐堆等。\n3.研究堆的基本特点和应用领域，通常根据不同的需要，利用研究堆提供的中子源可以开展许多技术研究工作，主要包括：（1）热中子散射实验；（2）材料分析和辐照研究；（3）同位素生产；（4）堆中子活化分析；（5）通过辐照改变材料特性；（6）培训工作。\n4.我国建造的典型研究堆：（1）中国先进研究堆CARR：为轻水冷却慢化、重水反射层的反中子阱池式反应堆，设计核功率为60MW。（2）脉冲堆：铀氢锆脉冲堆在科学技术研究方面具有广泛的应用价值，是一种具有固有安全特性的中子源辐照反应堆。铀氢锆脉冲堆是一种小型均匀研究堆,采用氢化锆与铀均匀弥散混合作为固体燃料-慢化剂元件，采用轻水做冷却剂，构成一种池式反应堆，简称TRIGA堆。由于它结构简单，安全性和经济性好，能获得较强的功率脉冲和中子脉冲，因此在科学研究和应用技术上获得了较为广泛的重视。（3）中国高通量工程试验堆（HFETR）：是一座压力壳反应堆，采用高浓铀多层套管型燃料元件，水作慢化剂和冷却剂，铍作反射层。（4）游泳池式轻水反应堆是游泳池式、轻水慢化和冷却、铍和石墨作反射层的多用途试验堆。\n3.6 反应堆及核动力装置的功率控制1.缓发中子的作用：考虑缓发中子后，代中子平均寿命约为0.085s，与不考虑缓发中子时的中子平均寿命0.0001s相比约大850倍。反应堆控制成为可能，缓发中子在反应堆控制中起着很重要的作用。\n2.从安全运行角度考虑，反应堆设计中保证了反应堆有负的反应性温度系数（至少在额定温度工况下），以提高反应堆的自调自稳特性和安全性。\n3.核反应堆功率控制原理：（1）启动，停堆以及改变反应堆的功率；（2）抵消过剩反应性，补偿燃耗；（3）维持功率水平；（4）保证堆的安全。\n4.核动力厂功率控制系统：（1）反应性控制和功率分布控制系统，或简称为反应堆功率控制系统；（2）反应堆功率调节系统；（3）反应堆冷却剂平均温度调节系统；（4）一回路压力即稳压器压力控制系统；（5）稳压器水位调节系统；（6）蒸汽发生器水位调节系统；（7）蒸汽排放控制系统。\n5.核动力厂稳态运行方式大体上可以分为两大类型：（1）一种是一回路冷却剂平均温度不变，而二回路蒸汽压力随负荷而变化。（核动力厂用）（2）另一种是保持二回路蒸汽温度（即压力）不变。（船用核设施）\n6.核仪表系统的功能是：（1）提供信号（显示）：通过连续监测反应堆功率，功率变化及功率分布，并对测得的各种信号加以显示记录，从而向操纵员提供反应堆装料、停堆、启动及功率运行时反应堆状态的信息。（2）提供控制信号（控制）：向反应堆控制系统提供堆功率信号，移动控制棒。（3）监测功能（监测）：通过功率通道信号的计算值，来监测反应堆径向功率倾斜和轴向功率偏差。此外，在主控制室和反应堆厂房内设计有视听计数通道，在停堆和启堆期间给出中子的视听计数。（4）安全功能（保护）：防止反应堆发生超功率，向反应堆保护系统提供中子通量密度高和中子通量密度变化率高信号，触发反应堆紧急停堆。\n7.堆芯测量系统：包括堆芯温度测量、堆芯中子通量密度测量和压力容器内水位测量三部分，其总的功能是：提供反应堆燃料组件冷却剂出口温度信息、堆芯中子通量密度分布信息及压力容器内水位信息。\n3.7 核反应堆保护系统1.保护系统的功能：保护系统必须及时发出保护动作，目标是保持安全屏障（燃料包壳、一回路冷却剂压力边界和安全壳）的完整性，防止放射性物质释放，并且还必须能减轻这些屏障中的任何一个或更多个破坏所造成的后果。\n2.保护系统主要由下列两个触发系统组成：（1）核反应堆停堆触发系统；（2）专设安全设施（应急堆芯冷却、蒸汽和给水管道隔离、辅助给水、安全壳隔离、安全壳喷淋和氢气复合等）触发系统。\n3.保护系统必须与其所执行的安全功能相适应，因此其设计必须遵循下列安全准则：（1）单一故障准则；（2）冗余性和独立性；（3）多样性；（4）故障安全；（5）逻辑符合；（6）可试验性和可维修性。\n4.核反应堆停堆触发系统组成：（1）启动保护；（2）核功率保护；（3）堆芯保护；（4）冷却剂压力和液位保护；（5）冷却剂低流量保护；（6）蒸汽发生器保护；（7）高能管道破裂保护。\n5.专设安全设施触发系统组成：（1）应急堆芯冷却触发系统；（2）安全壳喷淋触发系统；（3）蒸汽和给水管道隔离触发系统；（4）安全壳隔离触发系统；（5）辅助给水触发系统；（6）氢气复合触发系统。 \n四、民用核安全设备基础知识\n了解民用核安全设备标准规范、民用核安全设备常用金属结构材料、主要民用核安全设备。\n熟悉民用核安全设备的特殊性、民用核安全设备的核安全分级要求。\n民用核安全设备是指在民用核设施中使用的执行核安全功能的设备，包括核安全机械设备和核安全电气设备。民用核安全设备是民用核设施安全防护实体屏障的核心，其质量和可靠性直接关系到核设施的安全稳定运行。\n\n4.1 民用核安全设备的特殊性1.设计基准的确定原则不同。必须考虑在设计基准事故工况下仍能可靠地执行其规定的安全功能。\n2.所有应用于设计和验证的计算分析软件和验证设施（试验台架、回路等）需通过国家核安全监管部门的认可。\n3.设备必须根据相关要求进行设备鉴定。在事故工况下，设备的可运行性和功能能够满足预定的要求。\n4.设备的设计、制造、安装、焊接和无损检验等,必须采用成熟的且经过验证的技术或工艺。\n5.设备的设计、制造、安装和无损检验的单位，必须通过HAF601或HAF604资格审查。\n6.设备的设计、制造、安装和无损检验的单位，必须建立满足HAF003的要求的质量保证体系，并在有效控制之下。\n7.设备的相关活动，包括设计、制造、安装、试验、运行、在役检查、维修和退役等，必须在国家核安全监管部门的监督下，处于严格受控状态。\n8.涉及核安全基本原则和技术要求的民用核安全设备国家标准，由国务院核安全监管部门组织拟定，由国务院标准化主管部门和国务院核安全监管部门联合发布；其他的民用核安全设备国家标准，由国务院核行业主管部门组织拟定，经国务院核安全监管部门认可，由国务院标准化主管部门发布。\n9.民用核安全设备行业标准由国务院核行业主管部门组织拟定，经国务院核安全监管部门认可，由国务院核行业主管部门发布，并报国务院标准化主管部门备案。\n4.2 民用核安全设备的核安全分级要求1.《核动力厂设计安全规定》（HAF102）中明确规定了：必须识别所有安全重要物项，并根据其功能和安全重要性进行分级。划分安全重要物项的安全重要性的方法，必须主要基于确定论方法，并适当辅以概率论方法。\n2.核电厂营运单位必须根据核安全设备在民用核设施中所负担的核安全功能，确定相应的核安全级别。\n3.核电厂的机械设备分为核安全1级、核安全2级、核安全3级和非核安全级。（1）核安全1级：主要包括组成反应堆冷却剂系统压力边界的所有设备（反应堆压力容器、反应堆冷却剂泵、稳压器、蒸汽发生器的一次侧、控制棒驱动机构的壳体、主管道等）。理解：一回路主设备、主管道。（2）核安全2级：主要指反应堆冷却剂系统承压边界内不属于核安全1级的各种设备（冷却剂压力边界的小直径(DN&lt;10.4mm)的高能管道和阀门、安全壳隔离阀门、余热排出系统部件、喷淋系统的主要部件、安全注射系统部件、安全壳贯穿件、氢气控制和监测系统等）。理解：主要是专设安全设施。（3）核安全3级：主要是指下述一些系统的设备（提供硼酸的部件；给水系统处于安全壳外的部分；乏燃料贮存池冷却水系统中的重要部件；重要厂用水系统和设备冷却水系统的管道、阀门、泵等；为控制室可居留性服务的冷冻水系统）。理解：主要是核辅助系统。\n4.核安全电气设备根据支持功能的安全重要性将电气设备分为1E级（安全级）和非1E级（非安全级）。（1）1E级（安全级）：凡是在事故处理过程中（包括事故工况后）参与公众保护的电气系统的设备和部件均定义为安全级，即1E级。比如：反应堆保护系统、应急供电系统、紧急停堆执行机构、专设安全设施、专设安全设施支持系统等。（2）非1E级（非安全级）：凡是不执行上述安全功能的电气设备，均分类为非1E级。\n4.3 民用核安全设备标准1.国内核安全设备标准我国秦山和在建的山东海阳等核电厂执行的是美国ASME规范；大亚湾、岭澳和辽宁红沿河、广东阳江等核电厂执行的是法国《压水堆核岛机械设计建造规则》（RCC-M规则），连云港田湾核电厂执行俄罗斯的ΠΗΑЭΓ标准。\n2.美国ASME规范体系机械工程师协会（ASME三年修订一次）、材料与试验协会（ASTM）、电气和电子工程师协会（IEEE）、核学会（ANS）等。\n3.法国RCC规范体系法国核电厂RCC规范系列包括RCC-P、RCC-G、RCC-M、RSEM、RCC-E、RCC-I和RCC-C等，覆盖了核电厂系统、构筑物、机械设备、在役检查、电气设备、防火、燃料组件等几乎全部的核电厂领域。\n4.俄罗斯核电厂标准法规包括三个级别：法律法令、核安全法规及导则、专业技术标准。\n4.4 民用核安全设备常用金属结构材料1.金属材料：（1）黑色金属是指铁和铁的合金。如钢、生铁、铁合金、铸铁等。（2）有色金属又称非铁金属，是指除黑色金属外的金属和合金，如铜、锡、铅、锌、铝等。\n2.金属结构材料：指符合特定强度和可成型性等级的钢或合金等结构用材。其力学性能包括：强度、塑性、硬度、冲击韧度和疲劳强度等。力学性能是选择、使用、评价金属结构材料的重要依据。\n3.钢材的主要化学成分是铁和少量的碳，另外还有一些非铁元素。其中，碳元素对钢材的强度、塑性、韧性和焊接性能有决定性的影响。\n4.结构钢分为分为碳素结构钢和合金结构钢：（1）碳素结构钢中往往添加碳、硅、锰、硫、磷。（2）合金结构钢中添加一定量的合金元素，如硅、锰、钼、镍、硌、矾、钛、铌、硼、铅、稀土等其中的一种或几种。（3）碳元素对钢材的强度、塑性、韧性和焊接性能有决定性的影响，随着碳含量的增加，钢材的抗拉强度和屈服强度增加，但塑性、冷弯性能和冲击韧性特别是低温冲击韧性降低，焊接性能降低，所以钢材中碳含量不能过高。（4）硫元素（热脆）、氧元素、磷元素（冷脆）：降低钢材的韧性，使钢材的塑性变差。（5）硅元素：适量的硅可以提高钢的强度，而对钢材的塑性、冷弯性能和冲击韧性无显著影响，但是过量的硅会降低钢材的塑性和冲击韧性，恶化钢材的抗腐蚀性和焊接性。（6）在结构钢中，铬元素能显著提高钢材的强度、硬度和耐磨性，但同时降低塑性和韧性。铬又能提高钢的抗氧化性和耐腐蚀性，因而是不锈钢和耐热钢的重要合金元素。（7）镍元素能提高钢的强度，而又保持良好的塑性和韧性，对酸碱有较高的耐腐蚀能力，在高温下有防锈和耐热能力。（8）钼元素能使钢的晶粒细化，提高钢的淬透性和热强性能，在高温时保持足够的强度和抗蠕变能力。结构钢中加入钼，能提高机械能能，还可以抑制合金钢由于淬火而引起的脆性。（9）钛元素是钢中强脱氧剂，在奥氏体不锈钢中加入适量的钛，可避免晶间腐蚀。\n5.辐照对金属材料的影响：（1）辐照生长：能在一定晶面上聚集，从而造成某些材料沿一定方向的尺寸随辐照而显著变化。辐照生长对各向异性的核燃料(如铀、钚)和结构材料（如石墨、锆）是一个很重要的问题。（2）辐照肿胀：空位和惰性气体原子的聚集可以造成辐照肿胀。它表现为材料的体积和密度随辐照发生变化。核燃料在较高温度时以及快中子堆中的不锈钢都有肿胀问题。（3）辐照蠕变：可以导致蠕变或加速热蠕变。辐照蠕变和辐照剂量或辐照通量有关。（4）辐照硬化和辐照脆化:使金属硬化屈服强度提高等，对反应堆压力壳体钢有重要威胁\n4.5主要民用核安全设备举例1.核反应堆主要由反应堆压力容器、燃料组件、堆内构件和控制棒驱动机构等构成。\n2.反应堆压力容器既属于反应堆又属于一回路主设备。一回路主设备还包括蒸汽发生器、稳压器、主泵和主管道等。\n3.反应堆压力容器：（1）长期工作在高温（320℃左右）、高压（15.5MPa左右）、含硼酸水介质和高放射性辐照的条件下，属于在核电厂整个寿期内（一般40年至60年）不可更换的设备。压力容器材料要求有较高的机械性能、抗辐照性能和热稳定性，常用材料一般为低碳低合金高强度Mn-Ni-Mo合金钢。（2）反应堆压力容器一般由上封头、下封头、筒体、接管和贯穿件等部件组成，上封头为用法兰螺栓连接的可拆卸半球形封头，封头和法兰一般为焊接而成，反应堆压力容器上封头和本体主螺栓及上下法兰间的两道镍制“O”形环紧固密封。（3）反应堆压力容器筒体由4-5个筒节拼焊而成，并于下封头焊接构成压力容器本体。筒节为整体锻件，无焊缝，4-8个冷却剂出入口管道一般是通过马鞍形焊缝连接到相应的筒节。\n4.反应堆堆内构件：由不锈钢型的高合金钢制成，包括上部堆内构件和下部堆内构件两大部分。\n5.控制棒驱动机构：包括钩爪组件、驱动轴组件、耐压壳组件、磁轭线圈组件和位置指示组件。其中，耐压壳组件是驱动轴和销爪组件的包壳，由圆长管密封承压壳及其上部位置传送器套管组成，圆长管密封承压壳由分段壳体通过Ω密封环焊接而成。耐压壳安装在反应堆压力容器管座上，它与管座采用梯形螺纹连接和小Ω密封环焊接密封。耐压壳是承压边界，该承压边界的破损将产生放射性冷却剂外溢，因此，该组件的3道Ω密封环焊接工艺和质量非常关键，一般在安装现场进行焊接。\n6.蒸汽发生器（SG）是压水堆核电站一回路和二回路之间的枢纽，它将反应堆产生的热量传递给二回路，将二回路的给水变成蒸汽，推动汽轮机做功。主要是：立式U形管自然循环蒸汽发生器和卧式自然循环蒸汽发生器。\n7.稳压器是对一回路冷却剂系统压力进行控制和超压保护的重要设备，基本功能是建立并维持一回路系统的压力，避免冷却剂在反应堆内发生容积沸腾。稳压器分为气罐式和电加热式两种。\n8.反应堆冷却剂泵（简称主泵）是压水堆冷却剂回路系统中唯一高速运转的机械设备，又是十分精密功率强大的设备，属于压水堆电站的关键设备之一。主泵多是立式、单级轴密封泵：立式冷却剂泵从底部到顶部可分为三个部分，即水力机械部分、轴密封组件部分和电动机部分。\n9.每条环路包括一台蒸汽发生器、一台主泵和将这些设备与反应堆压力容器连接起来的反应堆冷却剂管道，也称主管道。主管道属于厚壁大口径奥氏体不锈钢管道，对焊接过程要求极为严格，焊缝内不得存在任何宏观或微观焊接缺陷。\n10.安全壳附件：（1）安全壳钢衬里：在预应力混凝土安全壳内，一般有一层起密封作用钢衬里。安全壳钢衬里一般由底板、截锥体、圆柱形筒体和穹顶组成，形成整体压力“容器”。（2）钢制安全壳：是安全壳容器式反应堆厂房的一道重要安全屏障，也是非能动安全系统中的重要设备之一。（3）人员闸门：是供工作人员经与辅助厂房连接的专用通道以出入安全壳。设有一个应急用人员闸门，供工作人员在应急情况通过更衣室厂房出入安全壳。（4）设备闸门：贯穿筒节预埋在安全壳混凝土内，并与安全壳钢衬里焊接。（5）安全壳贯穿件：包括机械贯穿件和电气贯穿件两类。贯穿件是由一个穿过安全壳混凝土壁面并锚固在混凝土上的钢套管及两个接头构成。\n11.硼注箱：位于高压安注泵出口，高压安注水经硼注箱进入一回路冷段。\n12.安注箱：安全壳内每个环路的冷管段上都接着一个安注箱。安注箱是一直立式筒体结构，总容积约50m3，内充2000ppm的含硼水，用加压40～60公斤的氮气覆盖。中压安注为非能动安全系统，不用安注信号启动。当RCP系统压力降到安注箱内压力以下时，由氮气将含硼水压入RCP系统冷段。\n13.核2、3级泵：（1）上充泵（高压安注泵）：是化学与容积控制系统的一个重要设备。（2）辅助给水泵属于专设安全设施，作为主给水系统的后备，当主给水丧失时，一直处于热备用状态的辅助给水泵立即启动向蒸汽发生器二次侧提供给水。\n14.核级热交换器：核2级的主要有余热排出热交换器、安全壳喷淋热交换器、化容热交换器，核3级的主要有再生热交换器、下泄热交换器、设冷水热交换器等。（主要是专设安全设施、一回路辅助系统的热交换器）\n15.余热排出热交换器为立式U型管壳式热交换器。\n16.再生热交换器：以管内的上充流为冷源进行热量回收，完成下泄流降压前首次冷却降温。\n17.板式换热器结构紧凑、单位体积设备提供的传热面积大，传热系数高、检修和清洗方便。\n \n五、核燃料循环设施\n了解铀矿开采和加工、铀化合物转化、铀浓缩、燃料组件制造、乏燃料及其后处理。\n\n5.0 引言1.核燃料是指含有易裂变核素，在反应堆内使自持核裂变链式反应得以实现的材料。它主要有易裂变核素和可转换核素两种成分组成。所谓易裂变核素是指能与慢中子作用而产生裂变的核素，主要是$^{233}\\text{U}$、$^{235}\\text{U}$、$^{239}\\text{Pu}$、$^{241}\\text{Pu}$（质量数相差2、4、2）。可转换核素是指俘获中子后能直接或间接地转变为易裂变核素的核素，主要是$^{232}\\text{Th}$、$^{234}\\text{U}$、$^{238}\\text{U}$、$^{240}\\text{Pu}$（质量数相差2、4、2）。\n2.核燃料循环以反应堆为中心，包括前段、反应堆段、后段。\n3.核燃料进入核反应堆前的加工过程称为核燃料循环的前段，包括铀矿勘探、开采、提取、精制（纯化）、转化、浓缩、燃料元（组）件制造等过程。\n4.核燃料循环分为闭路式和开路式两大模式（两大技术路线）。区别在于：闭路式循环回收利用乏燃料和新产生的燃料且可以获取武器级别的钚装料，而开路式不可以。\n5.1 铀矿地质勘探1.铀矿勘探根据铀矿成矿理论及已知成矿规律，根据工作地区地质特点，采用地质学、地球化学、放射性测量等方法进行找矿。铀矿找矿程序分为三个阶段：地质调查阶段（查明成矿条件、矿点等，比如航空γ测量和步行γ测量）、地质详查阶段（探矿）、地质揭露勘探阶段（探明储量等）。\n5.2 铀矿开采1.根据矿床地质构造、形态、埋藏深度和赋存状况，矿山地质和水文地质条件，合理选择开拓方案、采矿方法。矿山开采一般采用地下开采、露天开采，或是原地爆破浸出、原地浸出采矿工艺。\n2.开采方式选择的目的是安全、环保、合理、经济、最大限度地将铀矿资源从地下回采出来。\n3.选择开采方法的具体要求：（1）技术方面：适应矿床赋存的具体条件、勘探程度、开采技术条件和设备条件。（2）经济方面。（3）安全和环境保护方面。\n4.铀矿的常规开采方法有地下开采和露天开采。\n5.地下开采一般在矿床离地表较深，采掘比极大的条件下采用。这种方法的工艺过程比较复杂。\n6.地下开采的缺点是：采矿劳动强度大，井下防护条件差，通风要求高，生产效率低，损失、贫化率比较高，同时存在较大的安全风险。\n7.露天开采：通常认为适用于矿体大、埋藏较浅、覆盖层不厚的矿床。（1）露天开采与地下开采相比具有如下优点：机械化程度高，生产能力大，劳动生产效率高，生产成本低，劳动条件好，矿石损失小。（2）露天开采的缺点是：需要剥离排弃大量废石，压占土地较多，受天气影响大，生态环境问题较多。\n8.化学采矿：包括原地浸出和原地爆破浸出。两种技术是向矿体注入化学溶浸剂，通过化学反应选择性地溶解矿石中的铀，并将浸出液抽至地表水冶厂进行铀的提出。主要区别是前者是地表钻孔注入，后者是原地爆破后向松动的矿体注入化学溶浸剂。\n\n（1）化学采矿与常规采矿相比的优点：①投资和经营费用低；②劳动强度小；③生产劳动环境较好，矿工的职业受照剂量较低；④对地表环境的污染少：生产工艺过程产生的废水、废渣量较少，对地表影响较小。\n（2）化学采矿的缺点是：①应用有一定的局限性：只适用于具有一定地质、水文地质条件的矿床：矿床需大致呈水平状，底板不渗漏，矿层位于静止水位之上，且具有较好的渗透性。②存在对地下环境造成污染的问题：可使地下水中某些化学元素增高，因此，必须加强对地下水污染控制措施及退役后地下水修复。\n（3）原地浸出采铀具有明显的优点：①建设投资少、周期短，生产能耗和成本低。②劳动强度小、劳动条件好。③能最大限度的回收铀资源，大大的提高了劳动生产效率，与常规采矿相比，生产效率提高5～10倍。④对地表环境的污染少，基本上不破坏农田、土地和山林。\n（4）原地浸出采铀具有明显的缺点：①受地质条件限制。②地下水受到一定污染，修复难度大。\n（5）原地爆破浸出采铀优点：省去或减少了采场管理、采空区处理、矿石运输、破碎等多道工序。其工艺简单、效率高、成本低，放射性固体废物排放量少，综合经济效益及地表环境效益好。\n（6）原地爆破浸出缺点：资源回收率较低。②爆破后井下存留70～80％的铀矿，会产生高浓度氡和氡的衰变子体，对矿井大气污染较高。③井下布液浸出及终采后堆积废渣对地下水可能产生影响。\n\n5.3 铀的提取和精制（纯化）1.天然铀产品：铀的提取是用化学试剂从矿石中得到铀的化学浓缩物——重铀酸盐（俗称黄饼）的过程。主要的重铀酸盐：重铀酸铵［$(NH_4)_2U_2O_7$］、重铀酸钠［$Na_2U_2O_7$］，也可由重铀酸盐煅烧生产得到八氧化三铀［$U_3O_8$］统称“黄饼”。八氧化三铀［$U_3O_8$］是最稳定的铀的氧化物，最易长期保存，是当今世界铀交易的主要形式。\n2.常规铀水冶过程铀的浸出率大约在98%以上，铀的总回收率大约在95%以上。 \n3.铀精制（纯化）流程图如下，铀精制（纯化）是对铀水冶产品铀化学浓缩物或八氧化三铀进一步加工提纯的工艺过程。（铀化学浓缩物的铀品位达60%，八氧化三铀的铀品位达85%）\n\n轴化学浓缩物&#x2F;八氧化三轴 → 硝酸溶解→过滤→萃取→反萃取→浓缩及脱硝→沉淀→固液分离→转化结晶→过滤→煅烧(800~900℃)→冷却(40℃)→包装→二氧化铀\n\n4.核产品二氧化铀国家质量标准：严格控制产品中吸收中子能力较强的镉、钼、钛、钨、钽、矾等元素含量不超过 $10^{-3}% －10^{-4}%$ ；控制产品中吸收中子能力较弱的锂、硅、铁、铝、碳等元素含量不超过 $10^{-2}%－10^{-3}%$ 。\n5.4 铀化合物的转化1.这里所指的铀转化是指由天然铀精炼制得的铀氧化物制备成四氟化铀（UF4），再转化成六氟化铀（UF6）及其还原的主要工艺过程。\n2.铀转化过程大多属于气-固相反应。\n3.四氟化铀（UF4）的生产：（1）湿法工艺：UF4是制备UF6和金属铀的原料，湿法工艺（氢氟酸沉淀法）以核纯级的UO2为原料，先将其溶解制备四价铀料液，然后加入氢氟酸溶液，生成的沉淀经过滤、干燥和煅烧，得到无水UF4产品。湿法工艺的突出优点是沉淀过程铀纯化作用，但是所需工序较多，产生的废液量大，生产成本高。（2）干法工艺：高温下用气态无水氟化氢（HF）与UO2发生气-固相反应直接制得几乎不含水的UF4。该方法在工业领域占首要地位。\n4.干法工艺与湿法工艺相比：\n\n主要优点：（1）铀的直接回收率高；（2）所产生的工艺废液量仅为湿法的1&#x2F;10；（3）工艺过程简化，设备数约减少一半；（4）基建和生产成本较低。\n主要缺点：（1）对原料的要求严格，适应性较差；（2）生产中无水HF的过剩量较大；（3）由于设备磨损和腐蚀会给产品带来杂质，而且纯化作用较差。（4）UO2生产UF4所使用的设备主要有卧式搅拌床反应器、流化床反应器、移动床反应器。（5）工业上采用的流化床反应器是两级串联系统，可以得到高质量的UF4产品，同时将FH的过剩率由单级反应器的10%降低至5%左右。\n\n5.六氟化铀（UF6）是唯一一种既稳定又具有高度挥发性的铀化合物，一直被用于铀同位素浓缩厂的供料。\n6.生产六氟化铀（UF6）的工业方法几乎都是用核纯级的UF4在高温下与F2发生作用生产。为了最大限度地提高UF6的转化率和氟气的利用率，要使用过量的氟气，以确保铀的直接回收率大于98%。而过量的氟气需要再循环，使其总利用率不低于99%。\n7.六氟化铀（UF6）生产过程主要由氟化、六氟化铀（UF6）冷凝收集、氟气回收、尾气处理四部分组成。（1）UF4氟化反应器：火焰炉反应器、流化床反应器、立式氟化器、卧式搅拌炉。（2）六氟化铀（UF6）冷凝收集：方法是凝华法（两级冷凝器串联间歇操作）、液化法（将含UF6的混合气体压缩至151.7kPa以上导入水冷却的冷凝器中，UF6被液化）。（3）氟气回收。（4）尾气处理：回收铀并防止铀和氟对环境的污染。包括①固体化学阱法，主要用有活性的AL2O3、CASO4、活性炭和碱石灰等；②UF4吸收法，经济上最合理；③碱液洗涤法，这是尾气排放前的最终处理步骤。\n8.六氟化铀（UF6）的还原（1）氢气还原法：用氢气还原UF6制备UF4是目前应用最广的方法，其特点是堆密度大、生产能力大而且操作特性好。工业上有两种提供初始反应所需能量的方法，一种是热壁法（经约650℃高温反应器壁提供），另一种是冷壁法（由引入F2与H2燃烧释放的反应热提供），冷壁法有明显优势。（2）四氯化碳还原法：①还原小批量的高富集度UF6时，控制温度在150℃以上并且让CCL4大量过剩，UF6即可氟化CCL4，被还原成UF4；②转化大批量的低富集度或贫化的UF6时，可在350-400℃下用回转炉处理。与氢气还原法相比，此方法操作裕度小、工艺条件严格、CCL4消耗量大、尾气处理困难。（3）氨还原法：UF6与NH3在300-400℃发生反应，生成NH4UF5，再在大于450℃的温度下，于惰性气体中分解可得UF4。\n5.5 铀浓缩1.铀浓缩：用人工方法使$^{235}\\text{U}$ 丰度增加的过程。\n2.$^{235}\\text{U}$ 是唯一天然存在的易裂变核素，它在天然铀中的丰度为0.710%，而$^{238}\\text{U}$ 占99.285%，$^{234}\\text{U}$ 占0.005%。轻水堆需要使用$^{235}\\text{U}$ 的富集度为2%-5%。\n3.分离功：一种仅用于浓缩铀的度量单位，是指把一定的铀富集到一定的铀-235丰度所需投入的工作量叫分离功（SWU）。生产1 t丰度为3%的浓缩铀约4.3 t SWU以及5.5 t天然铀原料。浓缩过程中剩下4.5 t贫化铀。其铀-235丰度下降到0.2%左右，一般无工业应用价值。\n4.分离系数：表示分离效果，是在分离级前后所需同位素（$^{235}\\text{U}$）的相对丰度比（分离后丰度&#x2F;分离前丰度），理论上扩散分离系数最大值等于两种组分的分子量比的平方根。\n5.浓缩铀生产法：（1）气体扩散法：利用不同分子量的气体混合物在热运动平衡时的速度不相同，工作介质是六氟化铀。扩散分离级的主要组成包括：压缩机、热交换器、分离器。缺点：气体扩散法比电耗大，缺乏经济性。（2）气体离心法：高速旋转的离心机中，较重的分子靠近外周富集，较轻的分子靠近轴线富集。与气体扩散法相比，其主要优点是：\n\n比能耗低，为气体扩散法的4%-10%。\n单机浓缩系数（分离系数与1之差）大，气体离心机单机离心系数约0.2，而气体扩散法仅0.002。要得到丰度为3%的低浓缩铀，气体离心法只需要十几级级联，而气体扩散法需要近千级的级联。\n技术发展潜力大。（3）激光法：激光化学法、分子激光法、原子蒸汽激光法。激光法的突出优点是分离系数大，一次分离即可获得适于制造核武器级别的高浓缩铀，但技术难度较大，目前离工业应用尚有较大距离。（4）分离喷嘴法（气体动力学法）。\n\n6.分离级是级联的组成单位，而级联是分离级之间串联形成的组合，分离级可以是一个分离单元，也可以是并联的数个分离单元。\n7.浓缩铀生产工艺流程：原料UF6——压热罐加热——UF6气体进入级联进行分离浓缩达到所需丰度——冷冻的产品容器——液化均匀——取样合格后存入成品库房。此外，贫化料UF6装入冷冻的贫料容器，固化后送往贫料场暂存。\n8.浓缩铀生产工艺系统：级联系统、供取料系统、产品液化倒料系统、物料贮存运输系统、沾污设备清洗系统、废液处理系统、主要沾污设备检修系统等。\n9.铀浓缩工厂的基本特点：（1）工作介质为六氟化铀：化学性质活泼，腐蚀性强，需要在设备和材料选型、人员健康防护、工艺过程管控方面特别关注。（2）工艺系统的高度密封性和清洁度：主要工艺回路在负压下工作，因此应严格保证真空密封。（3）长期运行的安全性与可靠性：级联装置一旦启动，就要求常年连续运行，所以必须有可靠供电，必须配置备用电源。\n5.6 燃料组件制造1.核燃料组件主要由上下管座、格架、控制棒导向管、燃料元件棒组成。\n2.燃料元件通常考虑以下技术要求：（1）燃料芯块和包壳的温度：任何情况下绝不允许超过其熔点，并且要留有足够的安全裕度。（2）包壳的应力和应变范围：应有足够的机械强度和刚度，包壳的最大容许应变量不超过1%。（3）包壳的腐蚀：组件寿期终了时，包壳的最大腐蚀深度应低于壁厚的10%。（4）壳内的气体压力：在组件寿期终了时，包壳内部的气体压力值应和外部压力值相近。（5）包壳的吸氢：过量的氢会使锆合金包壳脆化破损，在寿期终了时包壳含氢量一般不允许超过 $2.5 \\times 10^{-2}%$ 至 $3 \\times 10^{-2}%$。\n3.核燃料组件的制造工艺：（1）UF6化工转化制备可烧结UO2粉末；（2）UO2芯块制备；（3）组件零部件制造（元件棒端塞、上下管座、定位格架、控制棒导向管等）；（4）燃料元件棒制备（合金管准备、端塞焊接、装入芯块、弹簧和隔离块、充氦气和堵孔焊接）；（5）组件组装（主要包括骨架组装、拉棒或推棒；一般压水堆燃料组件全长4至5米，重量550至670kg）。\n5.7乏燃料及其后处理1.后处理的意义：\n（1）是充分利用铀资源的重要途径；（2）可以减少放射性废物量；（3）可以降低长寿命核素的危害；（4）是增强综合国力的需要。\n2.后处理的特点：\n（1）产品回收率高（大于99%）（2）产品纯度极高（3）远距离操作与控制（因为有极强的γ放射性）（4）免维修与少维修；（5）十分严格的安全要求（具体做法：几何控制、质量控制、溶液浓度或体积控制、毒物控制，确保不发生临界事故或者超过次临界限值）；（6）安全风险（核风险、非核风险）；（7）物项安全分级管理。\n3.乏燃料：在核反应堆内使用（辐照）达到计划的卸料比燃耗后，自反应堆内卸出不再在该堆中使用的核燃料称为“乏燃料”。\n4.乏燃料本身会发出各种极强的射线和中子，并由此伴随放出热量。\n5.乏燃料贮存：技术路线分为湿法和干法贮存，目前绝大多数采用湿法贮存，即将乏燃料存放于水池内的格架或吊篮内。池水既可起到放射性屏蔽隔离作用，又可带走乏燃料的热量。\n6.湿法贮存时间长达20-30年，干法贮存时间更长为50-100年。\n7.干法贮存基本上有三种：贮存室、容器贮存、干井贮存。干法贮存的关键是乏燃料衰变热导出的问题，许多干法贮存系统都使用高纯度的惰性气体，如氩气、氮气等进行冷却。\n8.乏燃料贮存的安全主要考虑：\n（1）水池结构的完整性；（2）确保乏燃料处于次临界状态；（3）卸出的乏燃料必须先冷却；（4）除此之外，还要兼顾贮存装置的容量、经济性影响、适宜的时机。\n9.乏燃料运输方式：（1）公路运输：具有门到门的优点，适用于不太长的距离和车站码头接驳时采用，对沿途影响大、效率低、成本高。（2）铁路运输：适于中长距离，对沿途影响小、费用适中，需要汽车接驳。（3）水路运输：适用于中长距离，一次也可运多个容器，成本低，效率高。常需要以上三种方式联合使用。\n10.后处理工艺分为湿法（又称水法）和干法两大类；湿法主要是溶剂萃取法，干法的优点是强辐照条件对其影响不大。\n11.当今世界主要是采取以溶剂萃取法为核心的水冶后处理工艺，分为三段：（1）首端过程：将乏燃料制备成可供溶剂萃取分离用的合格进料液的全过程，分为机械首端和化学首端。（2）溶剂萃取过程：最普遍最成功的是以30%磷酸三丁酯（TBP）为萃取剂、以硝酸为盐析剂的（PUREX）流程，经过去污、分离循环（第一循环）、铀&#x2F;钚纯化第二循环、铀&#x2F;钚第三纯化循环，得到铀和钚的硝酸盐溶液$\\text{UO}_2(\\text{NO}_3)_2$ 溶液、$\\text{Pu}(\\text{NO}_3)_4$ 溶液。（3）尾端处理：将铀和钚的硝酸盐溶液浓缩并转形为固体产品，此过程通常还具有补充净化作用。\n12.放射性废物处理：（1）高放废液：其放射性占核燃料循环废物量的95%；高放废液经过6年和10年的衰变后，其热功率仍能分别保持在20W&#x2F;L和3.5W&#x2F;L，通常采用玻璃固化处理。（2）中放废物（分为非α废物和低放α废物）；（3）低放废物（分为非α废物和低放α废物）。\n13.根据放射性废物的物理性质分为废气、废液和固体废物。\n七、辐射防护基础\n了解辐射防护限值、外照射防护与内照射防护的基本方法和技术；辐射防护监测、辐射防护大纲。\n熟悉辐射防护的目的与任务；熟悉辐射源种类、来源与水平；熟悉辐射照射的分类、电离辐射的生物效应；熟悉辐射防护中使用的量及其单位；熟悉实践与干预、辐射防护的基本原则。\n\n7.1 辐射防护的目的与任务1.辐射防护的目的：是防止有害的确定性效应，并限制随机性效应的发生概率，使它们达到被认为可以接受的水平。\n2.辐射防护的任务：既要保护从事放射工作者本人和后代以及广大公众乃至全人类的安全；保护好环境；又要允许进行那些可能会产生辐射的必要实践以造福于人类。\n7.2 辐射源种类、来源与水平1.人体受到照射的辐照源分为两大类：天然辐射源、人工辐射源。天然本底照射是迄今人类受到电离辐射照射的最主要来源。\n2.天然辐射源按其起因分为三类：（1） 宇宙射线（宇宙空间的高能粒子，包括质子、α粒子、中子、电子、介子、光子等）；（2） 宇生核素（宇宙射线与大气中的原子核相互作用产生，如3H、14C、7Be等）；（3） 原生核素（存在于地壳中的天然放射性核素）。\n3.当前世界范围平均年有效剂量约为2.4mSv，引起内照射的各种辐射源中，222Rn的短寿命子体最为重要，由它们造成的有效剂量约为所有内照射辐射源贡献的70%。\n4.外照射中宇宙射线的贡献略低于原生核素。在年有效剂量中238U系起着重要作用，约占全部天然本底照射水平的48%。\n5.天然辐射源所引起的全球居民的年集体有效剂量的近似值为$10^7人·SV$。\n6.当今世界使人类收到照射的主要人工辐射源是：医疗照射、核动力生产、核爆炸（核试验）。\n7.3 辐射照射的分类1.照射可以分外照射和内照射；可以分为正常照射或潜在照射；也可以分为职业照射、医疗照射和公众照射；在干预情况下，还可以分为应急照射或持续照射。\n2.职业照射：工作人员在其工作过程中所受的所有照射。两种情况排除在外：一是国家有关法规和标准所排除的照射，二是根据国家有关法规和标准予以豁免的实践或辐射源所产生的照射。\n3.通常情况下将天然源照射视为一种持续照射，但是喷气式飞机飞行过程中机组人员所受到的天然源照射，列入工作人员的职业照射。\n4.公众照射：是指公众成员所受到的辐射源的照射。包括获准的辐射源和实践产生的照射和在干预情况下受到的照射，但是不包括职业照射、医疗照射、当地正常的天然本底辐射照射。所以，也有两类照射是被排除在外的：被排除的照射、被豁免的实践或辐射源引起的照射。\n5.医疗照射：是指患者（包括不一定患病的受检者）因自身医学诊断或治疗所受的照射、知情但自愿帮助和安慰患者的人员（不包括施行诊断或治疗的医护人员）所受的照射，以及生物医学研究计划中的志愿者所受到的照射。\n6.医疗照射的辐射防护体系基本原则：（1） 医疗照射的正当性判断（收益大于危害）；（2） 医疗照射的防护和安全最优化；（3） 医疗照射的指导水平与剂量约束。\n7.潜在照射：是指有一定把握预期不会受到照射，但可能会因为辐射源的事故或偶然性事件（包括设备故障和误操作）所引起的照射。实质上，对潜在照射的控制，就是对辐射源的安全性的控制。\n7.4 电离辐射的生物效应1.辐射损伤的机理是各种射线通过电离作用引起组织细胞中原子及由原子构成的分子的变化，这些变化也是原子激发的结果。细胞的脱氧核糖核酸（DNA）是主要靶。\n2.影响辐射效应的主要因素有两个方面：物理因素（与辐射有关）、生物因素（与机体有关）。\n3.物理因素（与辐射有关）：（1） 辐射类型：外照射危害γ＞β＞α，内照射危害γ＜β＜α。（2） 剂量率及分次照射：剂量率越大生物效应越显著；分次越多，每次间隔时间越长，生物效应越小。（3） 照射部位和面积：照射剂量相同，受照面积越大，产生的效应也越严重。（4） 照射的几何条件：与入射辐射的角分布、空间分布和辐射能谱等，人体受照时的姿势及其在辐射场内的取向有关。（5） 在内照射情况下，生物效应还取决于放射性核素的种类、数量等。\n4.生物因素（与机体有关）：（1） 不同生物种系的辐射敏感性；（2） 个体不同发育阶段的辐射敏感性；（3） 不同细胞、组织或器官的辐射敏感性：①高度敏感：淋巴组织、胸腺、骨髓、胃肠上皮、性腺、胚胎组织；②中度敏感：感觉器官、内皮细胞、皮肤上皮、唾液腺、肾、肝、肺组织的上皮细胞；③轻度敏感：中枢神经系统、内分泌腺、心脏；④不敏感：肌肉组织、软骨和骨组织、结缔组织。\n5.根据辐射效应的发生与剂量之间的关系，可以把辐射对人体的危害分为随机性效应和确定性效应两类。\n6.随机性效应：是指效应的发生概率（不是严重程度）与剂量大小有关的那些效应。在辐射防护中把随机性效应与剂量的关系简化地假设为“线性”、“无阈”。线性是指随机性效应的发生概率与所受剂量之间呈线性关系，无阈是指任何微小的剂量都可能诱发随机性效应。随机性效应发生概率P与剂量D的关系为P&#x3D;aD，其中a为常数。\n7.确定性效应是一种有“阈值”的效应，受到的剂量大于阈值，这种效应就会发生，而且其严重程度与所受的剂量大小有关，剂量越大后果越严重。\n8.根据辐射效应发生的时间分为躯体效应和遗传效应。（1） 急性躯体效应：短时间内发生在受照者本人身上，属于确定性效应。（2） 遗传效应和远期效应：表现为受照者后代的身体缺陷，属于随机性效应。（3） 突变倍增剂量：使突变几率增加一倍的剂量，大约0.1-1Gy，代表值0.7 Gy。（4） 辐射的远期效应：是一种需要经过很长时间潜伏期才显现在受照者身上的效应，主要表现为白血病和癌症，属于随机性效应。\n7.5 辐射防护中使用的量及其单位1.照射量X：是个历史悠久，变化较大的一个辐射量。$X&#x3D;dQ&#x2F;dm$，单位：C&#x2F;kg，过去照射量的单位是伦琴，符号为R，$1R&#x3D;2.58×10^{-4}C&#x2F;kg$。现有的技术条件下，能被精确测量照射量的光子的能量限于10kev-3MeV范围以内。在辐射防护中上限可扩大到8MeV。\n2.比释动能$K$：$K&#x3D;dε_{tr}&#x2F;dm$。$dε_{tr}$是不带电粒子在质量为dm的物质中释放出的全部带电粒子的初始动能总和的平均值，它既包括这些带电粒子在韧致辐射过程中辐射出来的能量，也包括在该体积元内发生的次级过程所产生的任何带电粒子的能量。单位是J&#x2F;kg，专门名称是Gray，1Gy&#x3D;1J&#x2F;kg。比释动能K只适用于不带电粒子，适用于任何物质。\n3.吸收剂量$D$：单位质量受照物质中所吸收的平均辐射能量。$D&#x3D;dε&#x2F;dm$，dε是电离辐射授予质量为dm物质的平均能量。\n4.器官剂量$D_T$：某一器官或组织的平均吸收剂量。$D_T&#x3D;dε_T&#x2F;dm$，dεT是电离辐射授予质量为dm组织或器官的平均能量。\n5.当量剂量{H_t}：相同的吸收剂量未必产生同等程度的生物效应。为了用同一尺度表示不同类型和能量的辐射照射对人体造成的生物效应的严重程度或发生几率的大小，辐射防护中用了当量剂量这个词。$H_t&#x3D;∑W_r×D_{t,r}$\n\n$W_r$是辐射权重因子\n$D_{t,r}$是辐射R在器官或组织T内产生的平均吸收量。\n\n6.有效剂量$E&#x3D;ΣW_t×H_t$，Ht是器官或组织T的当量剂量，$W_t$是器官或组织T的组织权重因子$W_t&#x3D;T$器官或组织接受1Sv照射时危险度除以全身接受1Sv均匀照射时总危险度。\n7.待积当量剂量$H_t(τ)$：某一特定器官或组织接受当量剂量率在时间t内的积分。\n8.待积有效剂量$E(τ)$：待积当量剂量经Wt加权处理后的总和。\n9.集体当量剂量：表示一组人群指定的器官或组织所受的总辐射照射的量，单位是人·希，即为人·Sv。10.集体有效剂量：表示一组人群所受的总的有效量，单位是人·希，即为人·Sv。\n7.6实践与干预1.实践：它是指任何引入新的照射源或照射途径、或扩大受照人员范围、或改变现在照射源的照射途径网络，从而使人们受到的照射或受到照射可能性或受到照射的人数增加的人类活动。\n2.干预：是指任何旨在减少或避免不属于受控实践的或因事故而失控的照射源所致的照射或照射可能性的行动。\n3.实践的主要要求：（1） 凡是没有被排除及豁免的实践全部受审管部门管理，按有关管理要求接受管理；（2） 对实践的辐射防护要求，应全面而完整地、严格地执行辐射防护基本原则；（3） 全面的科学管理。\n4.干预的适用范围：（1） 要求采取防护行动的应急照射；（2） 要求采取补救行动的持续照射。\n5.干预的基本原则：（1） 尽可能防止严重的确定性健康效应；（2） 干预应是正当的，即收益大于危害；（3） 应对引入干预和撤销干预所依据的水平进行最优化，以使防护措施产生最大的净利益。\n6.从事干预的工作人员所受到的照射不得超过GB 18871所规定的职业照射的最大单一年份的剂量限值，以下三种情况除外：（1） 为抢救生命或避免严重损伤；（2） 为避免大的集体剂量；（3） 为防止演变成灾难性情况。\n7.辐射照射分为三类：（1） 计划照射：计划引入或操作辐射源的照射，包括正常照射和潜在照射。对工作人员的潜在照射，ICRP推荐的危险约束值为$2×10^{-4}&#x2F;a$，对公众的推荐约束值为$1×10^{-5}&#x2F;a$。（2） 应急照射：指需要采取应急措施的照射，包括应急准备和应急响应。（3） 现存照射：在采取应急决策前就已经存在的照射，包括天然照射和来自过去事件和事故的遗留照射，比如住宅和工作场所的氡及天然本地辐射等。对现存照射的参考水平通常设在1-20mSv，个人剂量参考水平的上限为10 mSv。\n","categories":["NSE"],"tags":["NSE"]},{"title":"注册核安全工程师-专业实务","url":"/2024/08/04/NSE/shiwu/","content":"一、核安全监管概述\n了解核安全监督管理的范围和组织机构，其他一些核与辐射安全监管工作。\n熟悉核安全许可制度与核安全监督管理体系。\n\n1.1 核安全监督管理的范围和组织机构1.1984年，国家核安全局成立。\n2.2003年6月28日，通过《放射性污染防治法》，该法从保护环境出发，重点关注环境安全，主要规范核技术应用、放射性废物和伴生放射性矿涉及的放射性污染防治，也对核设施安全提出了基本要求。\n3.2017年9月1日，通过《核安全法》，该法是有关核领域安全问题的专门法，重点以核设施、核材料安全为主要规范内容，同时也对放射性废物和乏燃料的安全作出规定，规范了放射性废物处置的要求。\n4.国家建立了安全许可、监督检查执法、事故应急与调查处理、环境影响评价、辐射环境监测、人员资质管理等核安全监管制度。\n5.国家核安全局下设核设施安全监管司、核电安全监管司、辐射源安全监管司三个业务司。\n6.国家核安全局主要业务职责：（1）组织拟定核与辐射安全政策、规划、法规等。（2）负责核设施的行政许可、监督检查以及事件与事故的调查处理。（3）负责核活动的行政许可、监督检查以及事件与事故的调查处理。（4）负责核安全设备设计、制造、安装和无检验活动的行政许可和监督检查。（5）组织辐射环境监测。（6）组织核与辐射事故应急准备和响应,参与核与辐射恐怖事件的防范和处置。（7）负责核材料管制核安全监管。（8）负责核与辐射安全从业人员资质管理和相关培训。（9）负责放射性污染治理的监督。（10）负责电磁辐射装置设施的行政许可和监督检查。\n7.环境保护部地区核与辐射安全监督站主要职责为:（1）负责核设施核与辐射安全的日常监督；（2）负责核设施辐射环境管理的日常监督；（3）负责由环境保护部直接监管的核技术利用项目辐射安全和辐射环境管理的日常监督；（4）负责由环境保护部直接监管的核设施和核技术利用单位核与辐射事故(含核与辐射恐怖袭击事件)应急准备工作的日常监督,以及事故现场应急响应的监督；（5）负责由环境保护部直接监管的核设施和核技术利用项目辐射监测工作的监督及必要的现场监督性监测、取样与分析；（6）负责对地方环境保护部门辐射安全和辐射环境管理工作的督查；（7）负责核设施现场民用核安全设备安装活动的日常监督和民用核设施进口核安全设备检查、试验的现场监督；（8）负责民用核设施内放射性物品运输活动的监督；（9）承办环境保护部交办的其他事项。\n8.地方辐射环境保护部门（1）辐射环境管理实行国家和省（区、市）两级管理；（2）国家核安全局监督管理部门对全国辐射环境保护工作实施统一监督管理；省级人民政府对本辖区内的辐射环境保护工作实施统一监督管理。（3）地方辐射环境保护部门受地方政府领导，接受国家核安全局的业务指导。\n9.受委托的技术支持单位应当对其技术评价结论的真实性、准确性负责。\n10.核安全与环境专家委员会：是国家核安全局非常设的审议咨询机构，其职能是协助制订核安全法规和核安全技术发展规划，参与核安全的审评、监督等工作，为国家核与辐射安全重大决策提供科学依据。\n11.核与辐射安全法规标准审查委员会：是国家核安全局非常设的审议咨询机构，对核与辐射安全政策、规划、法规和标准、以及法规标准体系进行技术审查，提出核与辐射安全法规标准建设的建议。下设4个专业组：①核安全；②辐射安全；③核安全设备；④电磁辐射。\n\n1.2 核设施许可证制度1.国家核安全局是法定国务院核安全监督管理主体；核安全许可制度，是独立执行国家核安全监督执法的基石。\n2.核设施营运单位进行核设施选址、建造、运行、退役等活动，应当向国务院核安全监管部门申请许可。核设施操纵人员以及核安全设备焊接人员、无损检验人员等特种工艺人员应当按照国家规定取得相应资格证书。\n3.核设施选址应当向国家核安全监督管理部门提交核设施选址安全分析报告，经审查同意后取得核设施场址选择审查意见书。\n4.核设施建造、运行、退役审批手续：核设施建造许可证: 1）建造申请书;2）初步安全分析报告;3）环境影响评价文件;4）质量保证文件;5）法律行政法规规定的其他材料核设施运行许可证: 1）运行申请书;2）最终安全分析报告;3）应急预案;4）质量保证文件;5）法律行政法规规定的其他材料核设施退役许可证: 1）退役申请书;2）安全分析报告;3）环境影响评价文件;4）质量保证文件;5）法律行政法规规定的其他材料\n5.核设施延续运行审批：应当于运行许可证有效期届满前5年提出延续申请，经审批批准后，方可继续运行。\n6.核设施的进出口管理：国家核安全监管部门对进口核设施进行审查批准，对进口核安全设备进行安全检验。\n7.在进行监督检查时，监督组或监督人员有权采取以下措施：【看阅聊改】（1）进入现场进行监测、检查或者核查；（2）调阅相关文件、资料和记录；（3）向有关人员调查、了解情况；（4）发现问题的，现场要求整改。\n8.地区监督站在监督检查工作中的职责：（1）负责编制站年度监督检查计划，并报环境保护部备案；（2）负责起草站核电厂监督检查大纲，由环境保护部组织审查、发布；（3）负责编制和发布站监督检查程序；（4）负责向核电厂派驻现场监督员，实施日常监督检查；（5）负责组织对核电厂的例行和非例行检查活动。\n9.生产、销售、使用放射性同位素和射线装置的单位按规定程序申请领取辐射安全许可证。\n10.放射源生产单位、使用I类放射源和I类放射源装置的单位由国务院环境保护主管部门统一监管；其他核技术利用单位由省级环境保护行政主管部门监管，对放射源生产、销售、使用、送贮等活动实行全过程的动态监管。\n1.3 其他一些核与辐射安全监管工作1.我国的核设施分阶段环境影响评价制度，分为选址、建造、运行和退役等几个主要阶段。\n2.与核设施相配套的放射性污染防治设施，应当与主体工程同时设计、同时施工、同时投入使用。放射性污染设施应当与主体工程同时验收，验收合格的，主体工程方可投入生产或者使用。\n3.环境影响评价主要围绕：源项、途径、剂量、效应四个方面。\n4.国家对从事放射性污染防治专业人员实行资格管理制度；对从事放射性污染监测工作的机构实行资质管理制度。\n5.2002年发布的《注册核安全工程师执业资格制度暂行规定》（人发〔2002〕106号）明确了注册核安全工程师制度。\n二、核设施质量保证要求• 了解我国核设施质量保证导则简介、核设施质量保证体系的建立、质量保证文件的编制、质量保证大纲的管理和实施。• 熟悉与质量保证有关的专业术语、质量管理和核电厂质量保证的形成与发展、我国核安全质量保证法规的基本结构；熟悉对质量保证的核安全审评、对质量保证实施的核安全检查。\n2.1 质量管理和核电厂质量保证的形成与发展2.1959年，美国军方颁布了世界上第一个质量保证标准《质量大纲要求》（MIL-Q-9858A），要求军品的承制企业在实现合同的所有领域和过程中充分保证质量，随后又制定了《质量保证术语和定义》（MIL-STD-1098）等标准，首次采用了“质量保证”这个词。\n3.1969年美国原子能委员会(AEC)根据ASME《锅炉压力容器规范》(68版)条款内容及核电需要,在联邦法规10CFR50中编入了附录B《核电厂和燃料后处理厂质量保证准则》,1970年正式生效,它是世界上第一部民用核设施国家级质量保证法规文件。此后,国际原子能机构(IAEA)在其基础上,结合其他成员国质量保证活动的经验,于1978年颁布了《核电厂安全的质量保证》(50-C-QA),推荐各成员国使用。\n4.国家核安全局以国际原子能机构78版的《核电厂安全的质量保证》（50-C-QA）为蓝本，于1986年7月7日颁布了《核电厂质量保证规定》（HAF0400），1991年根据IAEA的修改版规范进行了升版，1998年将HAF0400编号修订为HAF003,沿用至今。\n5.HAF003与ISO9001的主要区别可概括如下:(1)适用范围不同：HAF003适用于核设施、核活动；ISO9001适用于非核的设施、企业、组织。(2)属性不属：HAF003的属性是法规,必须遵守；ISO9001是非核的标准不是强制执行的；(3)目的不同:核质保旨在通过对质量的管理来确保核安全；ISO9001目的是市场、效益、信誉；(4)概念、定义不同：例如，质量管理体系的概念不同（HAF003中质量管理体系就是质量保证大纲,或质量体系,质量保证包括质量控制；而ISO9001定义的质量管理体系包括质量保证、质量控制两者是相对独立的）；核质保强调验证人员的独立性,而ISO901无此要求等。\n2.2 我国核质保法规的基本结构和基本要求1.我国的核质保法规为《核电厂质量保证安全规定》（HAF003，91版）、导则为HAD003系列。其中HAF003为部门规章，是必须遵守的；HAD003系列导则对HAF003中的相关规定进行了说明和补充，是实施HAF003的方法和程序的指导性文件。\n2.《核电厂质量保证安全规定》（HAF003）共13章，包括引言（第1章）和12个质保活动的原则要求。\n3.《核电厂质量保证安全规定》（HAF003）的13章分别是：1.引言；2.质量保证大纲；3.组织；4.文件控制；5.设计控制；6.采购控制；7.物项控制；8.工艺过程控制；9.检查和试验控制；10.对不符合项的控制；11.纠正措施；12.记录；13.监查。\n4.《核电厂质量保证安全规定》（HAF003）各章节主要内容：\n\n（1）引言：由概述、范围和责任三节组成。《规定》对核电厂选址、设计、建造、调试、运行和退役期间质量保证大纲的制定和实施提出了原则和目标，适用于参与影响核电厂质量的活动的人员和组织。核电厂营运单位对整个寿期内的核电厂质量保证大纲的制定和实施负全面责任。\n（2）质量保证大纲：由概述；程序、细则及图纸；管理部门审查三节组成。凡是影响核电厂质量的活动必须按使用的书面程序、细则或图纸完成，质量保证大纲的程序必须形成文件，并便于使用。\n（3）组织：由责任、权限和联络；单位间的工作接口；人员配备与培训三节组成。符合性验证只能由不对该项工作直接负责的人员进行。\n（4）文件控制：由文件的编制、审核和批准；文件的发布和分发；文件变更的控制三节组成。必须对文件的编制、审核、批准和发放进行控制，明确负责编制、审核、批准这些文件的人员或组织。文件的变更必须按书面程序进行审核和批准，变更的文件必须由审批原文件的责任者或其他专门指定的组织或个人审批，并迅速将修订情况及其实际情况及时通知有关人员和组织，防止使用过时的或不合适的文件。\n（5）设计控制：由概述、设计接口控制、设计验证、设计变更四节组成。①设计验证必须由未参加原设计的人员或小组进行；②必须由设计单位确定验证方法，必须按规定的范围用文件给出设计验证结果；③当用一个试验大纲代替其他验证或校验方法来验证具体设计特性是否适当时，必须包括适当的原型试验件的鉴定试验，这个试验必须在待验证的具体设计特性的最苛刻设计工况下进行，当不能在最苛刻设计工况下进行试验时,如果能把结果外推到试验最苛刻工况，且试验结果能验证具体设计特性时,则允许在其他工况下做试验。④设计变更必须采用与原设计相同的设计控制措施。除非专门指定，设计变更文件必须由审核和批准原设计文件的同一小组或单位审核和批准。\n（6）采购控制：该章由概述、对供方的评价和选择、对所购物项和服务的控制三节组成。①必须制定措施以确保有关的管理要求和技术性要求都体现在采购文件中。②采购活动主要包括：编制采购计划和采购文件；对供方评价和选择；签订采购合同；对供方履行合同情况的验证；物项或服务的验收。③必须将评价的供方按照采购文件的要求提供物项或服务的能力作为选择供方的基本依据。④证明所购物项和服务（包括用于核电厂运行、换料和维修的备件和更换件）符合采购文件要求的文字证据必须在安装或使用前送达核电厂现场。\n（7）物项控制：由材料、零件和部件的标识；装卸、贮存和运输；维护三节组成。①标识的目的是为了防止使用不正确或有缺陷的物项。②必须尽最大可能地使用实体标识，如不可能或不满足要求时，采用实体分隔、程序控制或其他方法保持标识。\n（8）工艺过程控制：必须按照规定的要求，对加工、制造、土建施工、安装和维修中所使用的影响质量的工艺过程予以控制。\n（9）检查和试验控制：本章包括检查大纲；试验大纲；测量和试验设备的鉴定；检查、试验和运行状态的显示四节组成。①对安全重要的检查必须由未参加被检查活动的人员进行。如果检查和工艺监视缺一不可，则必须同时进行。②未经指定的单位批准，不得进行停工待检点以后的工作；如果进行规定的停工待检点以后的工作，则必须在开始工作之前以文件形式批准。③当发现偏差超出规定限值时，必须对之前执行的测量和试验的有效性进行评价，并对试验验收的物项重新进行评定。\n（10）对不符合项的控制：本章由概述；对不符合项的审查和处理两节组成。①控制不满足要求的物项是为了防止误用和误装；在实际可行时，必须用标记、标签或实体分隔等方法来标识不符合要求的物项。\n（11）纠正措施：质量保证大纲必须规定采取适当的措施，以保证鉴别和纠正有损于质量的情况。对于严重有损于质量的情况，大纲必须对查明起因和采取纠正措施作出规定，以防止其再次发生。\n（12）记录：本章由记录的产生；记录的收集、贮存和保管两节组成。①质量保证记录是为物项的质量以及影响质量的各种活动提供证据的成文资料，在法规中简称记录。②必须在质量保证大纲实施中产生足够使用的记录，记录中必须有质量的客观证据，所有记录都必须字迹清晰、完成，并与所记述的物项或服务相对应。③必须对记录、有关试验材料和样品的保存时间做出规定，必须根据书面程序处置记录。\n（13）检查：本章由概述和监查的计划安排两节组成。①必须根据需要执行有计划的、有文件规定的内部及外部监查制度,以验证是否符合质大纲的各个方面，并确定质量保证大纲实施的有效性。监查必须根据书面程序和核查单进行。②参加监查的人员必须是对所监查的活动不负任何直接责任的。\n\n2.3 我国核电厂质量保证系列导则简介1.《核电厂质量保证安全规定》（HAF003）对质量保证工作中各方面提出的基本要求，是强制执行的法规；在它下面有10个推荐性导则，是指导性文件。\n2.《核电厂质量保证大纲的制定》（HAD003&#x2F;01），该导则对如何制定核电厂质量保证大纲提出了要求、建议和范例,也对制定大纲和行动的计划并使之形成文件提供了指导。\n3.《核电厂质量保证组织》(HAD003&#x2F;02)，该导则为从事对核电厂的质量有影响的工作的单位,在建立组织、配备人员和编写文件方面提出了要求、建议和说明性的例子,也对如何管理各单位间的接口和建立指导、联络和协调工作的渠道提供了指导。\n4.《核电厂物项和服务采购中的质量保证》(HAD003&#x2F;03)，该导则对各种采购活动的组织、实施和管理提出了要求和建议。①“采购”的定义是:由买方或买方指定的代表为得到物项或服务所进行的各种活动,它从提出规定要求开始,到买方验收该物项或服务为止。②物项或服务的验收：包括源地验证、合格证明文件、收货检查、安装后试验以及服务的验收。\n5.《核电厂质量保证记录制度》(HAD003&#x2F;04)，该导则对有关核电厂设计、制造、建造、调试和运行等方面的记录的标识收集、编索、归档、贮存、保管和处理提出了要求和建议，但本导则不包括记录编写的细节。①“记录”的定义是:为物项的质量以及影响质量的各种活动提据的成文资料。载有记录的媒体可以是纸质的、电子的(磁或光学的)或其他特殊处理的等媒体(例如射线照片、相片底片、缩微胶片等)。\n6.《核电厂质量保证监查》(HAD003&#x2F;05)，该导则为在核电厂的设计、制造、建造、调试和运行期间如何组织和执行内部和外部监查提出了要求和建议。①“监查”的定义是:通过对客观证据的调查、检验和评价,为确定所制定的程序、细则、技术规格书、规范、标准、行政管理计划或运作大纲以及其他适用文件是否齐全适用,是否得到切实遵守,实施效果如何并要记载成文的活动。\n7.《核电厂设计中的质量保证》(HAD003&#x2F;06)，该导则对核电厂物项的设计的质量保证提出了要求和建议。①“设计”的定义是:制定核电厂及其组成部分的方案和详细图纸，进行支持性计算并制定技术规格书的过程及其成果。②当这些要求和建议涉及制造物项的设计活动时要由参与该活动的设计单位、工程公司或制造厂来实施；涉及现场的工程活动时,要由现施工单位来实施；涉及电厂交付使用后，有关修改或备件选择、零件更换的设计活动时，由电厂运行人员或其他单位来实施。③设计验证，包括设计审查、其他计算方法和鉴定试验。\n8.《核电厂建造期间的质量保证》(HAD00307)，该导则对制定和执行核电厂现场建造活动的质量保证大纲提出了要求和建议。\n9.《核电厂物项制造中的质量保证》(HAD003&#x2F;08)，该导则为承担对核电厂安全有影响的物项的制造单位制定和实施质量保证大纲提出了要求和建议。制造厂与质量保证有关的工作包括：设计、采购、加工、装卸、运输、贮存、清洗、试验、改进、维修和维护等。\n10.《核电厂调试和运行期间的质量保证》(HAD003&#x2F;09)，该导则对核电厂调试、运行和退役阶段中，用于安全重要工作的质量保证大纲的制定和实施提出了要求和建议，适用于核电厂的调试、检査、试验、运行、换料、维修、修改、和退役等工作，也适用于与安全有关的工作,如辐射防护、环境监测、放射性废物管理急和安全保卫等。\n11.《核燃料组件采购、设计和制造中质量保证》(HAD003&#x2F;10)，该导则对有关核电厂燃料组件在采购、设计、制造、检查、试验、包装、运输、贮存和收货检查中质量保证大纲独有特点提出了要求和建议。\n12.HAD003系列的10个导则可以按照核电厂寿期阶段以及质量保证活动进行分类：（1）HAD003&#x2F;06《核电厂设计中的质量保证》、HAD003&#x2F;07《建造期间的质量保证》以及HAD003&#x2F;09《调试和运行期间质量保证》归为核电厂寿期阶段类；（2）HAD003&#x2F;01～05、HAD003&#x2F;08以及HAD003&#x2F;11可归为质量保证活动类。另外，HAD003&#x2F;06《核电厂设计中的质量保证》也可以归为质量保证活动类。\n13.法规规定的质保要求，是通过质量保证体系文件来具体实现的。在编制质量保证大纲时，编制者应按照自身的工作范围，明确适用的、需开展的质保活动，按照HAD003系列导则的要求和建议，编写符合自身工作范围、与自己的任务相适应的程序文件。\n2.4 质量保证体系文件1.质量保证的文件体系通常划分为三个层次的文件：质量保证大纲概述（质量保证政策声明）、管理性程序、详细的工作用文件。\n2.质量保证大纲概述&#x2F;描述是质量保证大纲的文字性描述，有些国家称之为“质保手册”；拟申请或持有核安全相关资格许可证的单位，应编制满足核质保法规规范要求的质量保证大纲概述，并提交国务院核安全监管部门审查。\n3.质量保证大纲概述应包括最高管理者的质量保证政策声明，质量保证大纲概述必须由该文件中指定的、单位的最高管理者批准，以确认资料的准确性和该单位承担义务的有效性。\n4.对核电厂质量有影响的工作必须遵循适当的书面程序。这些程序是管理性的，它们必须对质量保证大纲概述中所提出的指导方针和计划的工作作进一步的阐述，并列有如何完成这些工作的细节。细节的详细程度视完成该工作人员的经验和训练水平而定。\n5.详细的工作用文件是由专业部门或人员制定的范围很广的文件组成的，用来规定个人或职能小组执行任务的具体细节。在运行的核电厂中，工作用文件包括工作细则和技术细则。\n6.工作用文件可以包括设计标准、图纸、制造工艺卡、检查核对清单等。\n7.工作细则用来描述具体工作过程，并向从事工作的人员转达行政和技术的信息，工作细则包括技术细则和图纸。\n2.5 质量保证大纲的制定和实施2.5.1 概述1.质量保证大纲也称作质量体系或质保体系，为保证质量而规定的和要完成的全部工作综合在一起构成质量保证大纲，这些工作包括两种基本类型：管理性的和技术性的。\n2.质量保证大纲的制定时间与完成某阶段有关活动的进度相一致。\n3.一个单位质量保证大纲的成功与否取决于管理者的支持和行动,所以关键是单位管理者要用签发质量保证政策声明来表达他们对质量和安全的承诺、对履行质量保证大纲作为实现业绩方法的承诺。\n4.在质量保证大纲的制定和实施过程中,应做到凡事有章可循、凡事有据可查、凡事有人负责、凡事有人监督。\n5.在规定质量保证大纲要求的过程中,应把物项和服务按其特性划分成不同的等级并对其规定相应的质量保证工作。物项和服务的分级应以物项的失灵或服务中的差错对安全所造成的影响为依据。\n6.应制定一套分级的质量保证要求,规定对每一级物项和服务应进行的大纲活动,选择用于每一级的大纲活动应考虑：(1)程序、细则的详细程度和格式；(2)验证方法：对物项和服务的验收所进行的验证可包括:供方的合格证书；收货检查加工、组装和安装(或它们的任何组合)期间或之后的就地检查或试验等；（3）验证深广度；(4)监查要求；(5)质量保证记录。\n2.5.2 组织7.为了管理、指导和执行质量保证大纲，每一个参与对核电厂质量有影响的工作的单位，都必须建立一个由文件明确规定了职责、权限等级及内外联络渠道的组织机构。\n8.必须根据对工作任务的分析、确定所需的大纲活动的基础上，设置必要的机构，即因事设岗，做到凡事有人负责,职责不重叠、不遗漏。\n9.质量保证职能部门必须拥有足够的权力和组织独立性，它必须向授予其所要求的权利和组织独立性的管理者报告工作。最低限度，质量保证职能部门的级别应处于直接向最高管理者报告工作的位置。\n10.在有多个组织共同工作的情况下，必须明确所有接口并制定协调措施，使管理和验证的实践能有效确保达到质量要求。\n11.所有负责对质量有影响的工作人员（包括质保职能人员）必须根据其特定任务所要求的学历、经验和业务熟练程度等方面进行资格考核。为确保在工作中有足够数量的合格人员可供使用，必须制定人员配备计划。\n12.必须对从事对质量有影响的工作人员进行质量教育。必须以学历、经验和培训为基础，并根据在职能力的证据来决定人员的资格。必要时，必须定期重新评价资格，以确保保持业务熟练程度。\n2.5.3 文件控制13.文件对各种影响质量的活动规定了要求、措施和行动步骤，是质量保证大纲有效实施的依据。\n14.文件的定义：对质量保证有关活动、要求、程序或结果进行描述、定义、说明、报告或证实的图表或文字材料。按资料载体的不同，文件可分为纸质文件、电子文件等。\n15.文件包括程序、细则、技术规格书、计算书、图纸等。\n16.文件的变更必须经审核和批准原文件的同一组织（或由专门指定的有资格的组织或个人）审核和批准，审核和批准的组织和个人有权审查作为批准依据的有关背景材料，并对原文件的要求和意图有足够的了解。\n2.5.4 设计中的质量保证17.设计的定义：是从确定设计输入开始，直到发布设计输出文件为止的技术和管理成果。\n18.设计输入的定义：是指设计所依据的准则、参数、基准或其他要求。\n19.对设计的目的、方法、假设、设计输入、参考资料和计量单位，必须有足够的分析，以便于该技术领域内的合格人员进行审查，并验证其结果是否恰当。设计分析和计算中如使用计算机软件，则必须在使用在按已批准的方式对这些计算机软件进行验证和确认。\n20.设计验证是审查、确认或证实设计的过程。设计验证的目的是确保设计满足所有的设计要求，包括输入要求，设计过程的计划和实施以及接口的管理。\n21.设计验证（包括校核）必须由能胜任的、未参与原设计的人员或小组来完成，但他们可以来自同一单位。\n22.设计验证方法包括三种：设计审查、其他计算方法、鉴定试验。责任设计单位至少应确定和使用三种验证方法中的一种方法。①设计审查：是对设计文件和设计活动所进行的关键性审查，以确保输出文件是正确的、令人满意的。②其他计算方法：对于某几种计算方法或分析结果的验证，可通过将它们与其他计算或分析方法所得结果进行对比而实现。当使用其他计算方法验证原计算的正确性时，必须对所使用的假设、设计输入数据、计算机程序或该计算方法的适用性进行审查。③鉴定试验：对于某些设计或某些设计特征的验证，可通过适当的样机鉴定试验完成。鉴定试验必须在受验证的特定设计特性的最恶劣设计工况下进行，当不能在最恶劣设计工况下进行试验时,如果能把结果外推到试验最恶劣工况，并足以证实该设计特性的适用性,则该试验可在其他工况下完成。23.设计输出的定义：是指为构筑物、系统和部件的采购、制造、安装和运行以及其他设计规定必要的技术要求的文件，例如图纸和技术规格书等。\n24.对设计单位的监查深度与被监查单位所承担的设计责任相一致。\n2.5.5 物项和服务采购中的质量保证25.对采购的各项活动必须按其对安全的重要程度进行相应管理。\n26.对供方的评价：选择合格的供方必须以评定供方按照采购文件的要求提供物项和（或）服务的能力为基础。供方所能达到的质量在很大程度上取决于其管理者对质量的态度、其人员的能力及其制造设施和装备的实际条件。\n27.买方对供方工作的评价：买方必须监督和评价供方对采购文件的履行情况。买方通知点，包括控制点和见证点。\n28.买方的验证活动：验证方式包括源地验证、收货检查、对服务的验证等。负责履行验证活动的人员，必须按照执行特定任务所需要的学历、经验和业务熟练程度进行资格评定。\n29.物项或服务的验收方法：包括源地验证、收货检查、查看供方的合格证、在核设施现场安装后的试验或这些方法的组合。（1）通过源地验证验收待验收物项或服务有下列情况应考虑采取源地验证:①对安全极其重要；②交货后难以验证其质量特性；③设计、制造或试验复杂。验收采取源地验证的方式时,必须以收货检查来保障易损物项在发往收货点的运输中不受损伤。（2）通过收货检查验收当物项具备下列属性时,仅采用收货检查进行验收就可达到满意结果:①其设计、制造和试验均比较简单且是标准化的；②最终产品的质量特性,可在交货后采取标准或自动化检查和(或)试验的方式进行验证；③收货检査中并不要求进行可能有损于物项完整性、功能或清洁度的操作。采购文件要求供方的文件资料以适当方式随同物项或在收货检查前提供时，进行收货检查必须与供方文件的审查相配合。（3）按供方合格证验收在买方不参与直接检査的某些采购活动中,买方可以仅根据供方阐明己满足规定要求合格证验收物项或服务。当物项或服务较简单,仅涉及标准材料、工艺和试验时,使这种方法验收是符合要求的。（4）通过核电厂安装后的试验验收在至少执行了上述的方法之一,且属于下列情况时,通过安装后的试验来验收是求的：①安装和使用前,难以验证该物项的质量特性；②为验证此物项的质量特性需进行全系统的校验或与其他物项一并进行试验；③物项执行其预定功能的能力只有在使用中方能证实。在采购文件中必须规定安装后的试验要求和验收文件。（5）服务的验收\n2.5.6 物项制造的质量保证1.必须对从事物项制造的人员，负责进行检查、验证的人员，以及监查的人员进行资格评定。对重要工艺领域内（如焊接、热处理、无损探伤）工作的人员必须进行有关产品特性、专用设备、质量保证大纲的要求和程序的培训。\n2.对所制造部件和产品的质量有影响的活动必须编写程序和工作细则；对控制制造工艺有辅助作用的专用设备，诸如工具、模具、夹具或专用检查量规，在使用前必须经过鉴定。\n3.物项处于加工、处理和组装时必须进行标识,并从收货之时起贯彻在整个制造过程中。为此可对物项作出标记或使用可追查到物项的记录。随贮存时间增长会迅速劣化的材料和物项，必须作出标记，注明其可使用寿期。\n4.整个制造过程中,必须按照书面程序和工作细则循序进行检查和试验。程序和工作细则必须根据情况确定：从事检查和试验的单位,检查和试验的先决条件,需要检查或试验的特性,所用的仪器或量规,检查或试验顺序,所要求的特殊环境条件以及验收和报废准则。\n5.测量和试验设备的控制：必须制定和实施用于测量和试验设备的选择、检定和使用的程序。这些程序包括检定要求和重新检定的频度。检定必须与规定的标准度限值和准确度限值相符。\n6.“检查”的定义:确定物项和活动是否符合规定要求的检验、观察或测量活动。其中“检验”是检查的方法之一,包括对材料、部件、供应品或服务进行调查,在只靠这种调查就能判断的范围内确定它们是否符合规定的要求。\n7.“试验”的定义:为确定或验证物项的性能是否符合规定要求,使之置于一组物理、化学、环境或运行条件考验之下的活动。\n8.制造厂必须在不符合项程序中对不符合项的即时记录、技术审查和最终处理作出规定，程序还应该包括对不符合项的标识（实体隔离、挂上标签等），以防误用。\n9.对于严重有损于质量的情况，质量保证大纲必须规定查明其起因并采取防止其再次发生的纠正措施。\n2.5.7 建造期间的质量保证10.核电厂的建造包括核电厂的部件制造和组装、土建施工、部件和设备的安装及有关的试验在内的过程。\n11.计划制订：必须制订现场建造(包括验证工作)计划并形成文件。制定计划必须考虑到构筑物、系统和部件的现场制造、安装、检查和试验的要求。\n12.负责制订这些活动计划的单位必须检验构筑物、系统和部件设计的技术条件、采购文件和图纸,以及建造工作计划和进度。对制定计划期间暴露出来的问题必须通报营运单位或其指定的人员。\n13.必须按适用于该项活动的书面程序、工作指令、说明书及图纸来规定和完成本节所规定的活动。\n14.必须制定用于场地管理的清洁度要求，这些清洁度要求应考虑对环境条件和对工作人员出入的管理。\n15.测量和试验设备的管理：必须编写用于规定所有测量和试验设备的选择、标识、使用、检定要求和检定频度的程序。当发现某一测量和试验的设备不符合检定时，必须对其鉴别并做出标记或隔离，以防止继续使用，直到交付重新检定为止。\n2.5.8 调试期间的质量保证16.调试文件必须对调试要求、意图、试验目标、限制准则、试验条件和程序、特殊设备、人力要求、特殊预防措施和验收准则作出明确规定。\n17.调试试验程序和细则,在使用前应按要求由合格人员来审査其适用性，审查人员中必须有设计单位的代表。\n18.设备管理：除非通过无损于核电厂安全的功能试验,能证明所涉及的所有设备、阀门和开关都处于其正确的调准状态,否则必须根据安全重要程度,由另一合格人员对设备是否恢复到具正常调准状态进行独立验证。\n19.调试期间必须使用根据供方建议、使用条件和类似设备的经验而编制的维修大纲。\n20.必须采取措施确保调试期间所使用的测量和试验设备都具有合适的类型、量程、准确度和精度。必须根据设备类型、稳定性和可靠性特性，要求的准确度和其他因素，规定检定的方法和间隔时间。\n21.对调试记录和调试结果进行审查，以验证试验的完整性，这种审查必须有设计单位的代表参加。\n22.必须使用适当的管理方法，如标签或标识牌，以标明物项的调试状态。\n2.5.9 运行期间的质量保证23.核电厂及其部件和系统，必须按其设计意图和规定的运行限值和条件安全运行。\n24.每个程序和细则在首次使用前都必须经营运单位适当级别的管理者审查和批准,并根据情况,还经设计单位适当级别的管理者审查和批准。必须对以后的审查频度作出规定。审频度取决于所涉及工作的类型和复杂性,核电厂已运行的时间和所取得的经验。\n25.出现下列一情况后,必须对适用的程序和细则进行审查：（1）核电厂的异常事件；（2）其他核电厂的异常事件；（3）对系统任何修改；（4）在实施程序或细则中遇到困难。\n26.对运行质量保证大纲有效实施的验证,必须由不直接负责运行工作的人员来进行。在由非质量保证职能部门的人员行使验证职能的情况下,质量保证职能部门必须进行审查,并进行监查,以保证验证工作已被正确地完成。\n27.应采取措施,以保证运行期间所使用的测量和试验设备都具有合适的类型、量程、准度和精度,并处于满足规定要求的状态。\n28.必须通过对影响核电厂运行的重大因素的分析来评定核电厂运行有效性。应根据不符合项报告的结果、例行检查和验证的结果以及从在役检查和监查所发现的问题,进行趋势分析。为了及时地了解核电厂总的情况,验证每天的运行工作是在安全进行且符合有关的行政管理的要求,核电厂运行管理者应保证:核电厂监管人员的正常职责中包括对运行工作进行及时和持续的监控。\n29.对授予独立审查责任的人员须在数量和技术培训两个方面作出规定。\n30.监查频度必须与被监查事项的安全重要性相适应。应在两年内完成对各安全功能所重要方面的监查。应以较大频度对下列各项进行监查:（1）为纠正对核安全有影响的缺陷以及在核电厂设备、构筑物、系统或运行方法上出的缺陷而采取的措施的结果(至少每6个月一次)；（2）核电厂运行是否符合运行限值和条件以及审批条件中所列的规定(至少每12月一次)；（3）核电厂工作人员的工作、培训和资格(至少每12月一次)。\n2.5.10 质量保证记录31.记录分类必须建立两类记录:永久性记录和非永久性记录。\n32.永久性记录是对下列一项或几项具有重要价值的记录：（1）证明安全运行能力；（2）使物项的维修、返工、修理、更换或修改得以进行；（3）确定物项发生事故或动作失常的原因；（4）为在役检查提供所需要的基准数据（5）便于退役。\n33.记录的类型包括：设计记录、采购记录、制造记录、安装-土建施工记录、运行阶段活动记录等。\n34.记录的检查包括：定期抽样检查（以前的记录是否完成等）；定期检查贮存设施（温湿度等）；定期收养检查（是否变质）；定期检查记录的变更和修正（变更记录是否已列入）。\n2.5.11 质量保证大纲履行情况的评定35.对质量保证大纲履行情况的评定,评定活动分为两大类：管理者自我评定、独立评定。\n36.管理者们应作出安排,确保所有从事评定活动的人员,包括他们自己,具有相当的资格培训和经验。从事评定活动的人员应接受质量保证原理和评定方法方面的培训。评定人员应通过如下途径保持其熟练程度和技术知识水平：（1）定期参与评定；（2）学习规范、标准、程序、实践和其他有关的文件；（3）参与培训班和研讨会；（4）在该领域倾注相当的时间。\n37.评定活动可包括审查、核对、检查、试验、监督和监查。评定应集中于观察正在进行中的活动。\n38.独立评定，包括内部监查、外部监查、监督、同行专家评价和技术审查,应集中在安全方面和已发现问题的领域。\n39.监查人员必须根据其学历、经验和专业能力进行资格考核。监查单位必须对监查人的资格条件做出规定。人员资格(考核)必须考虑下列方面:（1）被监查领域的专门知识和经验；（2）监查技术的知识和经验；（3）对适用规范、程序和生产过程的了解。\n40.当处于下列一种或几种情况时,必须安排监查：（1）有必要对质量保证大纲的有效性进行系统的和部分的评价时（2）在签订合同或定购单前,有必要确定承包者的质量保证大纲的能力时；（3）签订合同之后,质量保证大纲已执行了足够长的一段时间,并认为有必要确定承包单位是否正在按要求执行质量保证大纲、适用规范、标准和其他合同文件所规定的职责；（4）对质量保证大纲的职能范围做了重大变更(重大的机构改组或程序的重大变更)时；（5）怀疑因质量保证大纲的要求或执行方面的缺陷已危及了物项或服务的质量时；（6）有必要验证所要求的纠正措施的执行情况时。（7）必须对质量保证大纲的每一组成部分进行定期的内部监查。\n41.监查的频度必须与大纲中所规定的工作的重要性相一致。必须根据承担工作的范围、重要性和复杂性,按商定的时间间隔进行外部监查。\n42.质保监督比监查更灵活、正规性稍差，可以在相对较短的时间内经有限的准备就可以进行，通常应事先通知。最适宜质保监督的场合：（1）希望在时间、方法、人员和报告上有灵活性时；（2）为作出以前评定的有关结论而需要补充信息时；（3）有必要对临时出现的机会作出响应时。\n三、核设施厂址安全评价\n了解核设施厂址的环境特征及其评价方法，包括与确定厂址适宜性和设计基准相关的外部自然事件（地质、地震、水文、气象等）与外部人为事件（飞机坠毁、爆炸等）影响的评价；\n与辐射环境影响和实施应急计划可行性相关的厂址环境特征的评价，如大气和水体的弥散与人口分布特征等；与放射性废物处置相关的场址评价要求。\n\n3.0 引言1.国家核安全局于1991年发布的《核电厂厂址选址安全规定》（HAF101）提出了陆上固定式反应堆核动力厂在厂址选择中在核安全方面应遵循的准则和程序。\n2.根据《中华人民共和国核安全法》第一章第二条的规定，核设施是指：（1）核电厂、核热电厂、核供气供热厂等核动力厂及装置；（2）核动力厂以外的研究堆、实验堆、临界装置等其他反应堆；（3）核燃料生产、加工、贮存和后处理设施等核燃料循环设施；（4）放射性废物的处理、贮存、处置设施。\n3.1 核电厂厂址安全评价综述3.按核电厂的立地方式，世界各国核电厂厂址大致分为三种类型，这三种类型均属于陆上固定式核电厂厂址：（1）在一定深度的海上建造固定的漂浮式核电厂；（2）地下式核电厂；（3）地上式核电厂：世界上大型商用核电厂绝大多数建在地上，地上的核电厂分为滨海核电厂、滨河核电厂和滨湖核电厂等。\n4.根据《中华人民共和国核安全法》规定：国家对核设施的选址、建设进行统筹规划，科学论证，合理布局。\n5.核电厂厂址选择按初步可行性研究和可行性研究两阶段进行。\n6.核电厂厂址选择是指为核电厂选择适合厂址的过程，包括针对有关设计基准和评定。\n7.《中华人民共和国核安全法》第二章第二十三条规定:核设施营运单位应当对地质、地震、气象、水文、环境和人口分布等因素进行科学评估,在满足核安全技术评价要求的前提下,向国务院核安全监督管理部门提交核设施选址安全分析报告，经审查符合核安全要求后,取得核设施场址选择审查意见书。\n8.核电厂厂址安全评价从核安全观点考虑，核电厂厂址评价的主要目的是保护公众和环境免受放射性事故释放所引起的危害，同时对于核设施正常运行状态下的放射性物质释放也应加以考虑。\n9.在核电厂址适宜性评价中,必须考虑以下几方面的因素：（1）在特定厂址所在区域内所发生外部事件(包括外部自然事件和外部人为事件)对核电厂的影响；（安全影响评价）（2）可能影响释放出的放射性物质向人体和环境转移的厂址特征及其环境特征；（环境影响评价）（3）与实施应急措施的能力及个人和群体风险评价有关的外围地带的人口密度、人口分布及其他特征。（应急计划）    如果上述三个方面的厂址评价表明，厂址通过设计措施、防护措施或管理程序仍不能补偿这些厂址缺欠，则该厂址被认为是不适宜的。上述三个层次的评价目标，体现了纵深防御的核安全理念。\n10.核电厂选址过程通常从大区域调查开始,选择出几个候选厂址,然后鉴别出优先候选厂址作为推荐厂址(厂址选择),进而对推荐厂址进行详细评价：（1）核电厂厂址选择所包括的内容很广,核电厂厂址选择的工作主要体现在可行性研究阶段；（2）在可行性研究阶段的厂址安全评价仅是核电厂址选择的部分内容,但往往在筛选厂址中对厂址的可接受性起决定性作用；（3）核电厂厂址安全评价贯穿于核电厂厂址选择、建造、运行和退役整个过程之中。\n11.核电厂厂址安全评价的阶段划分为4个阶段：（1）厂址选择阶段：该阶段是对一个大的区域勘察后，剔除不适合的厂址，筛选和比较保留厂址，最后选出一个或多个优选候选厂址，评价内容包括在核电厂可行性研究报告中。（2）厂址评定阶段：该阶段进一步划分为：①验证：在这一阶段主要根据预先明确的厂址排除准则来验证核电厂厂址的适宜性；②确认：在这一阶段为分析和详细设计确定所需要的厂址特性。（3）运行前阶段：获得的厂址数据用于最终安全设计中所用的假设模型的最终评价。（4）运行阶段：在核电厂整个运行期间,应按设计的厂址监测项目,定期并规范地对项目进行监测，定期进行厂址安全评价。\n12.核电厂厂址安全评价中必须考虑如下主要问题：（1）核电厂厂址必须满足《核电厂厂址选择安全规定》中所规定的基本准则、与外部自然事件和外部人为事件有关的危险性评价准则、确定核设施对区域潜在影响的准则和考虑人口与应急计划的准则；（2）所评价的外部事件包括外部自然事件和外部人为事件。外部自然事件包括地震和地表断裂、气象、洪水、土工及其他重要事件；外部人为事件包括飞机坠落、化学品爆炸及其他重要事件；（3）必须考虑和评价核电厂对区域的潜在影响及相关的厂址特征,包括放射性物质的大气弥散、放射性物质的地表水弥散、放射性物质的地下水弥散、人口分布、厂址所在地区内土地和水体的利用、环境的放射性本底；（4）危险性监测：必须在核电厂寿期内,对可能危害设施的外部自然事件和外部人为事件,以及与核设施有关的人口统计、气象和水文条件进行监测。该监测必须在建造开始前着手实施并一直持续到退役；（5）质量保证：为保证工作所要求的质量,必须制定适用的质量保证大纲,以控制核设施厂址评价各不同阶段中所进行的厂址调查、评价以及工程活动实施的有效性。\n13.日本福岛核事故后，国家核安全局组织编写了《福岛核事故后核电厂改进行动通用技术要求》，其中涉及厂址方面的要求有：核电厂防洪能力改进、应急控制中心的可居留性、辐射环境监测及应急改进、外部灾害的应对等。\n3.2 核电厂厂址地质危险性评价1.地质、地震是影响核电厂安全的最重要外部事件之一。\n2.评价的目的：为某一特定厂址的核电厂如何确定地震动危险性，如何评价可能影响该厂址可接受性的潜在地表断层活动提供建议。\n3.评价的基本要求：(1)对每个核电厂厂址,都必须进行与地震和地质构造活动相关的地震动与断层活动危险性调查；(2)调查区域范围的大小、收集资料的类型以及调查的内容与详细程度,应根据地震构造环境的特征和复杂程度确定；(3)地震动危险性的下限值应根据不同区域地震活动的背景水平确定,无论评价的地震危险性水平如何低,当采用某一加速度值标定SL&#x3D;2级地震反应谱时,所采用的水平峰值地面加速度不得低于0.15g(原规定为0.1g,后在核电厂抗震规范中定为0.15g)；(4)在进行地震危险性评价过程的各阶段都应尽可能地减少不确定性；(5)在地震震源的识别和描述以及地震动危险性估计的诸多方面,应充分利用所有的资料、假定和模型,给出基于认知和不确定性分析的综合评价。\n4.地质、地震调查时按4种级别进行：区域范围、近区域范围、厂址附近范围和厂址地区范围。\n5.不同级别调查范围及主要调查要求：（1）区域范围调查区域范围半径≥150km，目的是了解区域地震地质背景。区域资料以收集现有成果为主（出版物和非公开出版的资料），并将这些资料反映在比例尺不小于1:100万的图上。（2）近区域范围调查近区域范围调查半径为25km，调查方法除了出版物和非公开出版的资料外，还包括遥感、地质、地球物理、大地测量及地震研究成果等。这些资料反映在比例尺不小于1:10万的图上。（3）厂址附近范围调查厂址附近范围调查半径为5km，目的了解地表断裂在内的潜在永久性地面形变的相关特征。需开展钻孔、槽探、物探等调查手段，地质填图的测距小于250m，实测穿越构造体和厂址的地址剖面，上述资料应表示在1:2.5万的图上。（4）厂址地区范围调查调查半径不小于500m，为详细了解潜在永久性地面形变和提供地基材料的土工特征，需采用多种勘探手段查清地层展布、岩性特征并开展大量原位试验和实验室试验；成图比例尺应不小于1:1000。\n6.区域地震构造模型是将基础资料与地震危险性计算模型连接在一起的环节,它是在区域基础资料综合分析的基础上建立的。\n7.任何地震构造模型都包括两种类型的震源:发震构造和弥散地震。（1）发震构造是指显示出具有地震活动性、或者是证明历史上具有地表破裂或古地震迹象的构造。发震构造被认为在所关心的时期内可能发生宏观地震。结合我国地震研究成果及工程地震安全性评价中积累的调查经验，发震构造主要为与地震活动关系密切的活动断裂构造。（2）弥散地震是指那些通过利用可使用的资料无法鉴定出确定构造标志的弥散地震活动（通常由中小地震构成）。实际应用中通常采用地震构造区来评价弥散地震活动。每个地震构造区被假定具有相同的地震潜势。\n8.地震危险性分析是为核动力厂提供有关地震危险性级别与表征的方法。\n9.地震危险性级别：对于每个核电厂,典型的做法是评价两个地震动危险性级别,即:SL-1、SL-2。（1）SL-2这一级别的地震动在核电寿期内具有非常低的超越概率,并且是假定的最大地震动。不论地震危险性分析的结果SL-2怎样低,所采用的设计反应谱零周期的水平峰值加速度SL-2不应小于0.15g。与SL-2对应的超越平均概率的水平为1×10-4&#x2F;年。sL-2与美国法规中的安全停堆地震(SSE)相当,与日本核安全法规中的设计用极限地震相当。注：极限安全要求是指当发生地震动达到SL-2的地震时或地震后，与安全停堆及维持其安全停堆状态有关的所有构筑物、系统及部件要设计成能满足维持其功能。这些构筑物、系统及部件应能保证：（a）反应堆冷却剂压力边界的完整性；（b）在安全停堆条件下停堆，并具有维持安全停堆状态的能力；（c）防止可能造成放射性对环境的照射事故或减轻事故后果的能力。（2）SL-1对应于严重性较低和可能性较大的地震荷载条件。在实际工作中取SL-2的1&#x2F;2。SL-1水平的地震在核电厂寿期内可能发生,且发生必须停堆对构筑物、设备、系统和部件进行全面检查和维修,然后才能恢复运行。SL-1相当于美国法规中的运行基准地震(OBE),相当于日本的设计用最强地震。\n10.确定地震动的方法：在确定SL-1和SL-2时,采用确定论方法和概率分析方法。取两者之中的大值作为设计基准地震动。\n11.地震动的特征：地震动反应谱的特征、时程特征、水平运动和垂直运动特征等：地震动持续时间主要取决于断层破裂的长度和速度。对于加速度的持续时间可通过以下方法确认：（1）从地震动开始至加速度下降到其峰值5%时的时间间隔；（2）全部加速度均方值计分的95至5分位数的时间间隔；（3）加速度超过0.05g时的时间间隔。垂直向地震动取水平向地震动的2&#x2F;3。\n12.能动断层是指在地表或接近地表处有可能引起明显位移的断层。鉴于能动断层调查所关注的是断层在地表或近地表发生断错运动的可能性问题，所以这种调查主要集中在厂址附近范围及其厂址地区范围。\n13.如果厂址5公里范围内有能动断层，这个是属于一票否决的厂址条件。\n14.能动断层判别标准：（1）调查表明在晚更新世Q3（约10万年）以来有过运动证据，以致可合理地推论在地表或接近地表处能够再次发生运动。（2）已经证明一个断层与另一个已知能动断层有构造联系，以致于另一个能动断层的运动可能引起这一断层在地表或接近地表处能够发生运动。（3）在某一震源深度条件下，与发震构造有关的最大潜在地震的震级足够大，以致可合理地推论在地表或接近地表处能够发生运动。15.对能动断层调查时，要特别关注隐伏断层的存在，大型水库荷载、流体注入、流体抽取或其他现象导致活动的可能性。\n3.3 核电厂厂址评价中的气象事件3.3.1 气象危险性评价的基本要求1.气象危险性评价的基本要求包括：（1）必须对气象变量的极端值（极端气象现象）和罕见气象现象（极端气象事件）进行调查。（2）调查区域的大小、收集资料的类型以及调查的范围与详细程度，应根据厂址所在区域气象和地理环境的特性和复杂性来确定。（3）应对全球变暖带来的可能的气象灾害后果加以关注，并应描述其在核电厂寿期内的可能影响。（4）在任何情况下，收集资料的范围和详细程度以及所进行的调査，对确定防范气象危险的设计基准应是充分的。（5）在核电厂寿期内应连续进行数据收集，包括退役和安全封存期间。（6）应在那些影响安全的各项调查及相关环节中制定质量保证大纲。\n3.3.2 气象危险性分析所需资料与调查2.进行气象危险性分析必须进行气象资料的收集与调查。\n3.气象变量极端值数据库包括厂址外气象数据和厂址现场气象观测数据两部分。（1）厂址外气象数据：在收集厂址外气象数据时应考虑的问题包括：①所选择的厂址区域范围内的气象台站应最能代表厂址条件或者是属于相同气候区的邻近气象台站。②一般地，数据分析的时间间隔为一年，开始日期最好避开一年之中相关气象变量循环周期的极大值或极小值。这样一个循环周期被称为“气象年”。在考虑极端最高温度时，气象年的起点最好在冬季；相反，考虑极端最低温度时，气象年应从夏季开始。③每年应确定一个该年的极端事件并列入表中，进行极端值统计的计算。长期数据应最好覆盖至少30年的时间。④应当注意不同台站可能采用不同的观测方法。例如，通常风速标准测量高度为地面上10m，但有的气象站不标准，需要对数据进行评价和修正。⑤应对每个气象台站的情况以及台站的地理位置和地理环境进行描述。（2）现场气象观测计划：①厂址确定后，应建立气象塔并设置仪器实行垂直向的风速、温度观测等，为评价核电厂放射性物质在大气中的弥散提供基础数据。②利用一年以上的观测资料获得气象变量的极端值，以便用这一数据与邻近的场外记录数据做比较并验证场外数据的使用价值。③在核电厂运行阶段一直进行气象观测，按长期记录数据来确认设计基准参数。\n3.3.3 极端气象设计基准的确定4.极端风：我国在核电厂的设计中是沿用美国的要求，取百年一遇的3s阵风作为设计基准。\n5.极端降水：常规收集用于极端降水分析的数据一般包括24h最大降水深度。在设计构筑物屋顶时，要使用与适当的参照时间间隔的“预计极端降水”，一般使用的参照时间约为50年或更长；关于其他项目的设计，如排水系统，要对“低概率极端降水量”进行计算。根据降水量与安全的关系，选择与极端降水量相应的概率等级和相应的参照时间间隔。\n6.极端积雪：对极端积雪评价的目的是为确定积雪对构筑物产生的荷载，该荷载取决于雪深和堆积密度。用水当量深度来表示雪深。设计基准积雪的确定：（1）在雪可能成为核电厂结构设计中重要的荷载因子的区域，必须确定设计基准积雪。积雪是以其在基准时间间隔内被超越的概率为特征的，这些概率和基准时间间隔约为50年或更长。（2）在制定设计基准积雪时，应考虑并入到积雪中的降雨的附加重量。例如把冬季48h的可能最大降水量加入到积雪中。\n7.极端温度。\n8.海平面，滨海核电厂附近海平面受以下因素影响：（1）由于气候变化（或其他现象）引起的平均海平面的变化；（2）天文潮；（3）来自远海的风暴潮和局部地区强风可能会使之增强；（4）风浪；（5）人造构筑物，如碎浪堤和防波堤。\n9.在滨海核电厂设计基准洪水位确定时，极端风暴潮和极端风浪高都必须考虑极端风。\n3.3.4 罕见气象现象设计基准的确定10.确定罕见气象现象（如龙卷风或水龙卷、热带气旋及其他事件）危险性的方法有：（1）评估每种现象在区域内发生的可能性，如可能发生，则对区域气候进行评价，确定现象发生的强度和频率；（2）确定与该现象不同强度相关的物理参数；（3）建立适合于该区域极端气象现象分析的模型；（4）应对设计基准现象指定的超越概率进行评价。\n11.龙卷风分类应包括强度（F一标度）、路径长度和路径宽度。在跳跃式龙卷风情况下，采用总路径长度的1&#x2F;4作为路径长度；对“碰到地面”的龙卷风，保守的假设其路径长度为1.6km。\n12.龙卷风的设计基准参数：切向速度、最大旋转风速、最大风速半径和压降、飞射物。\n13.规定将以下数据作为龙卷风飞射物：（1）台1800kg的汽车；（2）一个125kg、D20cm的穿甲炮弹；（3）一个D2.5cm的实心钢球。对于这些飞射物，可把设计基准龙卷风最大水平速度的35%作为碰撞速度。\n14.热带气旋对核电厂的影响主要表现在热带气旋引起的极端风和极端降水的设计值。从设计角度看，最关心的是可能最大热带气旋（PMTC）。\n15.闪电对核设施的安全影响：闪电瞬变出现的极端的高电压、高电流和高的电流升高速率，造成的破坏通常分为直接破坏和诱导（间接）破坏。\n3.3.5 与最终热阱有关的设计基准气象问题16.最终热阱的定义，总能接受核电厂所排出余热的各种介质。介质可以是大气或水体或它们的组合。\n17.与最终热阱有关的气象参数：（1）提供最终热阱及其有关的输热系统的设计所应考虑的气象条件。在选择这些条件时应当考虑每个具体最终热阱的控制参数和关键时限；（2）关键环境参数及其数值，只是那些对热交换和水损失方面有决定意义的值；（3）应考虑低温和冷冻对最终热阱有关的构筑物、系统及部件的影响。\n3.4 滨海和滨河核电厂厂址的洪水灾害3.4.1 洪水事件及洪水对核电厂的主要影响1.滨海厂址（海、湖和半封闭水体）洪水灾害应考虑的洪水类型（当合适时）：（1）可能最大风暴潮引起的洪水；（2）能最大海啸引起的洪水；（3）能最大假潮引起的洪水；（4）风浪作用引起的洪水，它可以单独的考虑或者与上述洪水组合在一起考虑。\n2.设计基准洪水的评价方法有两种：确定论方法，概率论方法。\n3.4.2 滨海核电厂的设计基准洪水3.滨海核电厂的洪水资料的收集分为两个步骤：初步调查、资料收集与厂址确认（详细资料）。\n4.为了确定设计基准水位应研究下列现象：（1）天文潮；（2）海平面异常；（3）由于河流流量所引起的水位变化；（4）预期的世界气候的重要改变而引起的未来水位的可能变化。\n5.滨海核电厂的组合洪水事件：（1）严重事件（极端事件）：诸如风暴潮、假潮或海啸；（2）与极端事件有关或无关的风浪；（3）基准水位，包括潮汐、海平面异常现象以及潮汐河流和封闭水体的水位变化。\n6.滨海核电厂厂址通常要考虑的洪水事件包括：可能最大风暴潮；可能最大假潮；可能最大海啸；严重风暴潮、严重假潮和严重海啸的组合。\n7.海啸的发生包含三项基本条件：（1）地震必须发生在深海（破坏性海啸的震源区水深一般在200m左右，灾难性海啸的震源区水深在千米以上）；（2）地震要有足够的强度；（3）海底的位移和错断须在竖向上有一定的规模。\n8.我国渤海和黄海不满足海啸所要求的深水条件；东海和南海具备一定的条件。\n9.当核电厂厂址位于封闭或半封闭水体岸边时，应考虑到潜在假潮的可能性。\n10.我国在实际工作中选用的洪水基准水位组合为：（1）可能最大海啸；风浪活动（几年重现期）；10%超概率高潮位；25年一遇的江、河洪水位；（2）可能最大热带气旋产生的可能最大风暴潮；风浪活动（最大风浪活动）；10%超概率高潮位；河流的设计基准洪水（适用于热带气旋区内流域面积小于800km2）；（3）百年一遇海啸；25年一遇的风暴潮或假潮；风浪活动（最大风浪活动）；10%超概率高潮位。根据上述洪水事件组合，可计算出设计基准洪水位。\n3.4.3 滨河核电厂设计基准洪水11.滨河核电厂设计基准洪水可由下述原因之一或几个原因所引起：（1）降雨、融雪；（2）由地震、水文因素或运行失误导致的挡水构筑物破坏；（3）滑坡、冰凌、漂木、碎石和火山活动等导致的河道堵塞般设计基准洪水位不低于任一有记录的或历史上的洪水。\n12.滨河核电厂洪水资料的收集分为两个步骤：初步调查、资料收集与厂址确认（详细资料）。\n13.滨河核电厂引起洪水的类型有：径流引起的洪水；天然或人工蓄水构筑物突然释放引起的洪水；地震引起的溃坝洪水；除水文和地震原因外引起的溃坝造成的洪水。\n3.4.4 滨海、滨河核电厂的防洪和防护监测与预报14.核电厂防洪设计的考虑，应包括：（1）护厂区的构筑物（如大坝和防波堤）设计参数的评价；（2）厂区高于计算洪水水位以上的可能影响的评价；（3）抵御洪水侵蚀的最佳材料的选择；（4）对核电厂最佳防洪布置的评价；（5）防护构筑物和电厂部件的可能相互影响的研究。\n15.防洪措施的类型：（1）所有的安全重要物项都建在设计基准洪水的水位以上，并考虑风浪影响及冰和碎石可能的堆积作用。（2）建造永久性的外部屏障，如防波堤、海堤和隔墙。屏障本身应作为安全重要物项来考虑。\n16.滨海核电厂的监测和预警系统网络：（1）基本大气参数的监测系统；（2）水位测量系统；（3）海啸预警系统。\n17.滨河核电厂的监测和预警系统网络：（1）洪水的预报和监测系统；（2）可能与核电厂安全有关的挡水构筑物的监测和报警系统。\n3.5 核电厂厂址评价中的地基和岩土工程问题1.核电厂厂址位置的地基强度、变形、稳定性、土和结构的相互作用等直接关系到与安全相关的构筑物、系统和部件的安全。\n3.5.1 核电厂的厂址勘察2.在核电厂的厂址安全评价中，地基的评价所占的工作量最大，开展工作耗时长并且耗资大，在安全评价中的四个阶段表现最明确。\n3.厂址勘察的目的是获得地质和土工方面的资料，这些资料可分类如下：（1）地质资料（地层的和构造的）；（2）地下岩土材料的范围和特征的描述；（3）土和岩石的特性（性质）（4）地下水资料（地下水特征、水文单元的位置和特性，水的物理化学特性）。\n4.核电厂的厂址安全评价包括四个阶段：厂址选择阶段、厂址评定阶段、运行前阶段、运行阶段。（1）厂址选择阶段：在厂址选择阶段勘察的目的是确定厂址的适宜性。核电厂所要求的测绘范围为1km2，比例尺为1：1000。做好测绘工作是选择核岛位置和布置钻孔的前提。厂址选择阶段评价的内容主要有：①应确定和评价地质灾害，确定厂址不存在不可接受的地质条件；②对厂址进行分类：分类中要把土的类型进一步划分为非黏性土和黏性土；③地下水特征；④地基条件：可根据所确定的土的类型、基岩的深度及沉积物性质初步选择可接受的地基类型。（2）厂址评定阶段：进一步划分为验证阶段、确认阶段。①验证阶段主要根据预先明确的厂址排除准则来验证核电厂厂址的适宜性。②确认阶段为分析和详细设计确定所需要的厂址特征。（3）运行前阶段。（4）运行阶段：应测量结构的沉降及其他参数，如地下水位等数值，并与预期值比较以便修正安全评价。\n5.厂址勘察的数据来源有：历史和近期资料、原位勘察、实验室试验。\n3.5.2 厂址研究6.厂址研究的内容包括：厂址分类、剖面参数、自由场地震反应与厂址特定反应谱、液化可能性。\n7.厂址分类为了分析地震反应，对核电厂的地基采用以下厂址分类：（1）1类厂址：Vs&gt;1100m&#x2F;s；（2）2类：1100m&#x2F;s&gt;Vs&gt;300m&#x2F;s；（3）3类：Vs&lt;300m&#x2F;s。\n8.评定厂址液化可能性的方法有三种：经验法、常规分析法、综合分析法。我国常用的是前两种方法。\n3.5.3 地基研究9.地基研究包括地基工程、土-结构的相互作用、稳定性、沉降与隆起、诱发振动效应。\n10.在常规的承载力方法中，安全系数在静荷载作用下不应低于3.0，在包含SL-2地震输入（倾覆影响）的组合荷载作用下不应低于1.5。对在包含SL-2地震输入组合荷载作用下的常规滑动面分析，其安全系数应大于2.0。\n3.5.4 土工结构设计11.采用静力法计算边坡稳定性时，通常，采用地震系数将地震影响考虑为一个等效静态惯性力。安全系数应等于或大于1.5。\n3.5.5 岩土参数的监测12.岩土监测内容包括：（1）开挖和回填阶段地下岩土材料的变形（在电厂寿期内应连续监测）；（2）建筑物以下和邻近区域的地下水状况；（3）挡土结构和土工结构在内的安全相关结构物的倾斜和位移以及相关参数；（4）厂址和地下岩土材料的地震特性。\n3.6 核电厂厂址评价的外部人为事件3.6.1 外部人为事件的资料收集与调查1.外部人为事件的潜在源可以分为固定源和移动源：（1）固定源：这类源的初始位置是固定的，如化工厂、炼油厂、仓库以及同一厂址上的其他核设施；（2）移动源：这类源初始位置是不固定的，如危险品或潜在爆炸物以任何方式运输。\n2.对潜在源收集资料的范围通常在半径5～10km的范围内。收集区域内固定源和移动源的资料是为确定：①与运输系统有关的外部人为事件的可能源的位置；②事件发生的概率及其影响的严重性。\n3.6.2 对外部人为事件的初步评价3.采用保守的方法确定每一个特定类型源（固定源和移动源）的筛选距离值（SDV），对超过此距离的源不考虑对核电厂构成影响。我国在进行核电厂选址时采用这些值：（1）机场：除最大的飞机场外，所有机场采用10km作为筛选距离值（SDV）。（2）固定和移动爆炸源：SDV取5～10km。（3）着火：SDV取1～2km。（4）飞机坠落。（5）危险气云源：SDV为8～10km。（6）毒性气体。\n4.筛选概率水平：如果所考虑的始发事件发生的概率大于特定的筛选概率水平，则应对始发事件进行详的评价。特定的筛选概率水平（SPL）大多数国家取10-7&#x2F;年。\n3.6.3 对外部人为事件的详细评价5.如果所考虑的始发事件发生的概率大于特定的筛选概率水平（10-7&#x2F;年），则应对始发事件进行详细的评价，并确定有影响的设计基准概率值（DBPV）。\n3.7 核电厂厂址评价中放射性物质流出物的弥散和人口分布问题1.核电厂对其所在区域产生影响的厂址特征包括：放射性物质的大气弥散、放射性物质的地表水弥散、放射性物质的地下水弥散、人口分布、土地和水的利用、环境的放射性本底。\n2.为做好核电厂流出物向环境的评价，需做好以下工作：（1）提出厂址气象、水文和水文地质调查的内容；（2）收集气象和水文数据（地表水和地下水）的方法；（3）为论证实施应急计划的可行性而收集厂址周围人口分布数据的方法。\n3.7.1 流出物在大气中的输运与扩散的评价3.应保证收集的数据能充分代表厂址气象条件，应提供至少一整年有代表性的气象数据，并说明这些数据表征厂址长期气象特征的程度。气象数据至少每隔一小时收集一次，并且每小时平均记录时间不应小于10min。\n3.7.2 流出物在水中的输运和扩散的评价4.水体调查的目的：确认厂址的适宜性；选择和确认适合于厂址的弥散模型；建立放射性物质向水体排放的限值；评价释放的辐射后果；以及辅助论证应急计划的可行性。\n5.核电厂应在开始建造前两年启动地下水监测大纲，应在核电厂的整个寿期内持续执行监测大纲。\n6.可用于计算正常排放和事故释放进入地表水的弥散模型有三种：先进模型、箱型模型、解析模型。核电厂厂址评价中最常用的标准计算模型是箱型模型和解析模型。\n7.放射性核素进入地下水系统的方式主要有以下三种方式：（1）核电厂排放的放射性物质污染的地表水渗透到地下水中；（2）贮存罐或人工水池中的放射性液体渗透到地下水中；（3）核电厂直接释放，核电厂事故可能导致放射性物质渗透到地下水系统中。\n8.水文地质特征评价应确定以下内容：（1）人类抽取地下水作为生活用水的区域内，最近取水点的地下水中放射性物质的估算浓度；（2）放射性物质从释放点到取水点的迁移路径和迁移时间；（3）地表水流、壤中流和地下水给的输运能力；（4）不同水平下，含水层受污染的敏感度；（5）核电厂事故排放的放射性物质在地下水中浓度的时空分布。\n9.为确定水文地质系统和主流路径，应收集厂址区域和厂址的资料，包括：（1）气候资料；（2）放射性核素的初始浓度；（3）主要的水文地质单元及其水力参数，以及地下水的年代或平均交替时间；（4）补给和排泄的关系；（5）地表水文的数据。\n3.7.3 厂址区域的土地利用和水的利用以及人后分布10.研究区域的人口分布和特征的目的是：评价正常排放和事故释放的潜在放射性影响，以及辅助论证应急响应计划的可行性。\n11.人口分布的调查分为外围地带人口调查、区域人口调查：（1）外围地带人口调查：该地带又称规划限制区，规划限制区边界以反应堆为中心半径不得小于5km。（2）区域人口调查：调查的范围为80km。\n12.评价人口分布的方法使用较为普遍的是“厂址和扇形因子”法。\n13.对厂址人口特征的限制：（1）居住区边界以反应堆中心为半径不得小于500m；（2）核电厂规划限制区内不宜有1万人以上的乡镇；（3）厂址半径10km范围内不宜有10万人以上的城；（4）核电厂距100万人口以上的城市应保持适当的直线距离。\n3.7.4 关于应急计划的可行性14.烟羽应急计划区：是针对烟羽照射途径（烟羽浸没外照射和地面沉积外照射）而建立的应急计划区。这种应急计划区又可分为内、外两区。在内区能在紧急情况下做到立即釆取隐蔽、服用稳定碘和紧急撤离等紧急防护行动。\n15.烟羽应急计划区按反应堆热功率的大小、在以反应堆为中心半径7～10km范围内确定。内区在以反应堆为中心，半径3～5km的范围内确定。\n16.在论证应急计划的可行性时，应考虑诸多与厂址有关的因素。其中最重要的因素有：（1）区域内人口密度和人口分布；（2）厂址距人口中心的距离；（3）难以撤离或隐蔽的特殊人群组，例如医院或监狱中的人群、流动人群；（4）特殊的地理特征，如岛屿、山地和河流等；（5）当地交通和通讯网络特征；（6）可能存在潜在危险活动的工业设施；（7）易受可能释放的放射性核素影响的农业活动；（8）可能同时发生的外部事件。\n3.8 放射性废物处置场所选址1.评价处置设施的长期性能，应当考虑可能被容纳的放射性废物的放射性核素含量、物理和化学性质，以及处置系统所提供的屏障的放射性。\n2.五种放射性废物类型及其对应的处置方式：（1）极短寿命放射性废物：贮存衰变后解控；（2）极低水平放射性废物：填埋处置；（3）低水平放射性废物：近地表处置；（4）中水平放射性废物：中等深度处置；（5）高水平放射性废物：深地质处置。\n3.8.1 放射性废物近地表处置场选址3.近地表处置场选址阶段分为四个阶段：（1）规划选择阶段；（2）区域调查阶段；（3）场址特征评价阶段；（4）选址确定阶段。\n4.选址时所考虑的厂址特征包括：地质、水文地质、地球化学、大地构造和地震活动、地表作用气象、人为事件、废物运输、土地利用、人口分布、环境保护。\n5.水文地质一水文地质条件应遵循的准则是：（1）下水埋深较大；（2）地下水流速低、流程长；（3）能限制放射性核素的迁移。\n6.地质介质和地下水的地球化学应遵循的准则是：（1）有利于限制放射性核素从处置场的释放；（2）不应明显降低工程屏障的寿命。\n7.环境保护需遵循的准则：在考虑了技术、经济、社会和环境诸因素的条件下，应使场址所处位置的环境在处置整个寿期内得到足够保护的地方，以便把可能的不利影响减轻到可以接受的程度。\n3.8.2 放射性废物地质处置库选址8.对高放废液和残渣的固化世界上开发了三种固化方法：玻璃固化、陶瓷固化和岩熔固化，投入使用的只有玻璃固化。\n9.为防止处置库中的放射性物质向生物圈的迁移，需设置一系列的天然的和人工屏障，这些屏障是：（1）废物包装（废物，固化材料，废物罐和可能的外包装）；（2）工程屏障（处置库建筑物和废物周围的回填材料）；（3）地质屏障（天然地质介质和巷道关闭系统）。\n10.放射性废物地质处置库选址过程可划分为四个阶段：规划选址阶段、区域调查阶段、库址特性评价阶段和库址确定阶段。\n11.选址过程所涉及的主要内容：地质环境、自然变化、地球化学、人类活动、建造和工程条件、废物运输、环境保护、土地利用、社会影响。\n四、核动力厂的设计安全要求\n了解核动力厂系统设计总体安全要求，核动力厂安全管理要求，核动力厂安全功能、安全分级和设计规范，核动力厂构筑物、系统和部件的可靠性设计，核动力厂辐射防护设计安全要求，核动力厂防火设计安全要求，核动力厂概率安全分析及其在安全管理中的应用。\n熟悉核动力厂纵深防御原则，核动力厂设计基准事故安全分析，核动力厂严重事故的预防和缓解。\n掌握核动力厂安全目标和设计基本安全要求。\n\n4.1 核动力厂安全目标4.1.1 基本安全目标1.基本安全目标是在核动力厂中建立并保持对放射性危害的有效防御,以保护人与环境免受放射性危害。\n2.美国核管会的政策声明提出两个定性安全目标是:（1）应该对公众的个体成员提供对核动力厂运行后果的一定水平的防护,以至这些成员不承受对生命和健康明显的加风险。（2）核动力厂运行对生命和健康所产生的社会风险与其他可行的竞争发电技术相比较应该是可比的或更低的,应该对社会风险没有明显的增加。\n3.典型的定量安全目标是美国核管会在其政策声明“5IFR3008”中所确定的,即:（1）对紧邻核动力厂的正常个体来说,由于反应堆事故所导致立即死亡的风险不应该超过美国社会成员所面对的其他事故所导致的立即死亡的风险总和的千分之一。（2）对核动力厂邻近区域的人口来说,由于核动力厂运行所导致癌症死亡风险不应该超过其他原因所导致的癌症死亡风险总和的千分之一。\n4.1.2 基本安全目标的实现4.为了实现基本安全目标,必须采取下列措施：（1）控制在运行状态下对人员的辐射照射和放射性物质向环境的释放；（2）限制导致核动力厂反应堆堆芯、乏燃料、放射性废物或任何其他辐射源失控事件发生的可能性；（3）如果上述事件发生,减轻这些事件产生的后果。\n5.辐射防护设计必须保证在所有运行状态下核动力厂内的辐射照射或由于该核动力厂任何计划排放放射性物质引起的辐射照射低于规定限值,且可合理达到的尽量低。\n6.人员照射和放射性排放必须受到严格控制,并符合运行限值和辐射防护标准,且可合理达到的尽量低。\n7.安全设计必须做到:（1）防止由于反应堆堆芯或其他辐射源失控所引起有害后果的事故,并在一旦发生事故时减轻其后果;（2）保证在设计中考虑的所有事故的放射性后果都低于相关限值,并保持在可合理达到的尽量低的水平;（3）保证有严重放射性后果的事故发生的可能性极低,并尽最大可能减轻这种事故的放射性后果。\n8.安全评价要考虑以下内容：（1）核动力厂的正常运行；（2）预计运行事件时核动力厂的性能;（3）事故工况。\n9.安全设计的基本目标是在技术上实现减轻放射性后果的场外防护行动是有限的甚至是可以取消的。\n4.2 纵深防御原则1.防止核动力厂发生事故和减轻事故后果的主要手段是应用纵深防御概念。\n2.纵深防御概念的应用，主要是通过一系列连续和独立的防御层次的结合，防止事故对人员和环境造成危害。每层防御的独立有效性都是纵深防御的必要组成部分。\n3.纵深防御的五个层次：（1）第一层次：防止偏离正常运行及防止安全重要物项的故障。（2）第二层次：检测和控制偏离正常运行状态，防止预计运行事件升级为事故工况，尽管注意预防，核动力厂寿期内仍然可能发生某些假设始发事件，在设计中设置特定的系统和设施，通过安全分析确认其有效性，并制定规程防止始发事件发生，让核动力厂回到安全状况。（3）第三层次：尽管极不可能，某些预计运行事件或假设始发事件升级未被前一层次防御所制止，而演变成事故。必须通过固有安全特征或专设、安全系统和规程，防止堆芯损伤或需要采取场外干预措施的放射性释放，让核动力厂回到安全状况；（4）第四层次：减轻第三层次失效导致的事故后果，通过控制事故进展和减少严重事故后果来实现。安全目标是仅需要在区域或和时间上采取有限的防护行动，且避免场外放射性污染或降至最低。（5）第五层次：减轻可能由事故工况引起的潜在放射性释放造成的放射性后果，配备恰当的应急设施，制定用于场内、场外引起相应的应急计划和应急程序。\n4.纵深防御的具体表现（应该做到）：（1）设置多道屏障，阻止放射性物质向环境释放；（2）采取保守的设计和高质量建造；（3）采用固有特性和工程手段控制，减少和排除哪些需要启动安全系统的故障和偏离正常运行；（4）附加控制采用安全系统的自动触发，早期阶段对操纵员的要求减至最少；（5）提供构筑物、系统和部件及规程，以控制故障和偏离，限值事故后果；（6）必须提供多种手段保证每项基本安全功能；（7）防止陡边效应。\n5.为了贯彻纵深防御概念,设计必须尽实际可能地防止：（1）出现影响实体屏障完整性的情况；（2）一道或多道屏障失效；（3）一道屏障因另一道屏障的失效而失效；（4）运行和维修差错产生有害后果的可能性。\n五、核动力厂的运行\n了解核动力厂的在役检查和定期试验。\n熟悉运行限值和条件、核动力厂运行的安全管理。\n\n5.1 运行限值和条件5.1.1 概述1.运行限制和条件：是经国务院核安全监管部门批准的参数限值、设备功能与性能及人员执行任务的水平等一整套规定。包括技术和管理两个方面的限制和条件。\n2.运行限值和条件分为以下几类：（1）安全限值；（2）安全系统整定值；（3）正常运行的限值和条件；（4）监督要求。\n5.1.2 安全限值与安全系统整定值3.安全限值：其作用是为了保护实体屏障的完整性。是防止核动力厂发生不可接受的放射性释放为依据的，通过对燃料和包壳温度、冷却剂压力、压力边界完整性和其他影响放射性物质从燃料中释放的运行特性施加限值来实现的。\n4.安全系统整定值：是为了防止出现超过安全限值的状态，在发生预计运行事件或设计基准事故时启动有关自动保护装置而设定的触发点。\n5.1.3 正常运行的限值和条件5.目的：保证正常安全运行，保证安全分析报告假定的有效性，并保证在核动力厂运行中不超过规定的安全限值。在正常限值与安全系统整定值之间需留有可接受的裕度，以避免安全系统出现不希望的频繁启动。\n6.内容：包括运行参数的限值、可运行设备最低需要量、各层次运行人员的最低配备，在偏离规定的运行限值和条件的事件中运行人员应采取的规定动作及完成时间。\n5.1.4 监督要求7.为保证安全系统整定值以及正常运行限值和条件始终得到满足，应根据批准的监督大纲监测、检查、核对、标定和试验有关的系统和部件。\n8.监督大纲涵盖运行限值和条件的各个方面，应根据可靠性分析（概率安全评价分析、经验研究）规定监督频度，在监督规程中明确验收准则。\n5.1.5 标准技术规格书9.机组运行模式：以美国西屋公司的标准技术规格书为例，将机组运行模式分为6个：①功率运行模式；②启动；③热备用；④热停堆；⑤冷停堆；⑥换料。\n10.安全限值（1）在机组功率运行和启动模式下，热功率、反应堆冷却剂系统最高的环路平均温度和稳压器压力的组合不得超过规定的安全限值。（2）反应堆堆芯安全限值：稳态、正常运行瞬态和预计运行事件期间不得超过可接受的燃料设计限值。所以堆芯应满足双95%偏离泡核沸腾准则（95%置信度，95%概率不发生偏离DNB）和燃料棒中心温度低于融化温度（2804℃）。具体要求是：偏离泡核沸腾比（DNBR）≥1.17；燃料中心峰值温度低于2804℃，每10000mwd&#x2F;tu燃耗下，此值下降32℃。\n\n⚠如果违反堆芯安全限值，采取如下响应：①将机组置于运行模式3（热备用）；②在1h内进入热备用状态；③如违反安全限值只有得到监管单位批准后方可重启。（3）反应堆冷却剂系统压力安全限值：反应堆冷却剂系统压力的安全限值用于保护反应堆冷却剂系统的完整性，防止超压。在机组功率运行、启动、热备用、热停堆、冷停堆模式下，反应堆冷却剂系统压力必须小于或等于18.86mpa。其设计压力是17.34mpa，正常运行和预计运行事件期间瞬态压力不得超过设计压力的10%，未装料前所有反应堆冷却剂系统部件要在125%设计压力下进行水压试验验证。（4）按照美国机械工程师学会相关规范，反应堆冷却机系统压力容器允许最大瞬态压力为110%的设计压力，管道、阀门、接头允许最大瞬态压力为设计压力的120%，所以反应堆冷却剂系统允许的压力极限值是110%设计压力。\n⚠如果违反反应堆冷却剂系统压力安全限值时，采取如下响应：①如果机组在功率运行和启动模式，在必须在1小时内将压力恢复到安全限值以下，并且进入热备用模式；②如果机组在热备用、热停堆、冷停堆模式，则必须在5分钟内恢复安全限值以下，因为反应堆压力容器在较低温度下材料延展性降低，危害更严重。③要求在不降低模式的前提下采取措施，不然会使温度下降导致的热应力附加到现存压力应力上，加重问题的严重性。④如违反安全限值只有得到监管单位批准后方可重启\n\n11.安全系统整定值：当达到安全系统整定值时，保护系统和安全系统触发自动动作，以便保障机组不会到达安全限值。自动动作包括：反应堆紧急停堆和相关联锁；专设安全设施驱动和相关联锁等。\n12.正常运行限制条件：核动力厂标准技术规格书对正常运行限制条件的内容、适用范围、采取的措施、完成时间和监督要求按照统一的格式编写。把正常运行限制条件应用分为9类（100个条件），监督要求应用分为4类。\n5.2 核动力厂运行的安全管理5.2.1 核动力厂运行安全监督1.核动力厂安全监督包括：检查和处理、处罚、强制命令，简称对核动力厂运行安全的检查和执法；\n2.监督方式：日常安全监督由国家核安全局地区监督站执行；专项安全监督由国家核安全局组织核安全检查组、核安全监督员和受委托的专家执行。\n5.2.2 核动力厂营运单位3.核动力厂营运单位是申请获准或已经获准经营和运行核动力厂并负责核动力厂安全的单位。\n4.核动力厂营运单位作为许可证持有者，必须对核动力厂的安全运行负全面责任。营运单位可以把安全运行授权给运行管理者，但仍必须保持对安全负有首要责任。\n5.营运单位必须强调核动力厂的运行安全，必须贯彻安全第一的原则。\n6.营运单位建立组织机构时，必须考虑决策职能、运行职能、支持职能和审查职能。\n7.营运单位必须制订核安全政策并由所在厂区人员贯彻执行。核安全政策必须把核动力厂安全放在首位，必要时可不考虑生产和计划进度的要求。\n8.国务院核安全监督部门和核动力厂营运单位必须严格履行各自的职责，并建立起相互理解、相互尊重、坦诚、透明的工作关系。\n9.营运单位必须系统地评价核动力厂的运行经验。必须调查研究安全重要的异常事件以确定其直接原因和根本原因。\n5.2.3 人员的资格和培训10.承担特定安全重要职能的人员（如核动力厂操纵人员），按规定必须持有国务院核安全监管部门颁发的证书。\n11.其职能影响安全的所有人员在任用时必须进行体格检查，并在以后的工作中定期进行体格检查，以保证琪健康状况能胜任所承担的职责。\n12.培训大纲必须规定对运行人员进行定期考核及定期再培训。核动力厂人员必须接受处理设计扩展工况的教育。\n5.2.4 运行规程和运行指令13.核动力厂的运行必须遵守国务院核安全监管部门批准的运行限值和条件，并通过制定和实施运行规程来实现。严格地遵守书面的运行规程必须是核动力厂安全政策的根本要素之一。\n14.核动力厂维持在规定的运行限值内的规程可以是事件导向或征兆导向的。对设计扩招工况，指令将是征兆导向的，用于指示核动力厂状态和运行人员最佳恢复途径，无需事故诊断。\n5.2.5 堆芯和燃料管理15.未辐照和已辐照燃料的贮存方案必须按规定报送国务院核安全监管部门批准。\n16.所有裂变材料的贮存、辐照和转移必须按要求保存详细的可核查账目，保存时间至少不短于管理规定的要求。\n5.2.6 核动力厂调试17.调试大纲的实施情况应分阶段进行审查，调试大纲必须便于国务院核安全监管部门选取和释放控制点，不得进行可能使核动力厂进入没有分析过的工况的试验。\n18.核动力厂主要调试阶段：A阶段：预运行试验；B：装料，初始临界和低功率试验；C：功率试验。\n19.核动力厂首次装料前，必须完成全部应急准备，必须进行应急演习以验证应急计划。\n20.为了确认核动力厂已准备好堆芯初始装料，必须在装料前预先规定系统、设备、文件和人员的先决条件。\n21.营运单位必须对放射性排放进行安全分析，证明所评定的对公众的放射性影响和所受剂量保持在合理可行尽量低的水平。国务院核安全监管部门批准的排放限值必须包括在运行限值和条件中。\n5.2.7 运行事件报告制度22.国家核安全局对核动力厂运行事件报告准则、事件通告、事件报告提出了明确的管理要求。\n23.核动力厂运行事件通告：（1）口头通告：必须在事件发生后24小时内口头通告国家核安全局和所在地区监督站。（2）书面通告：必须在事件发生后3天内书面通告国家核安全局和所在地区监督站。\n24.核动力厂事件报告：营运单位以公函形式在事件发生后30天内向国家核安全局和所在地区监督站提交事件报告。\n5.2.8 安全重要构筑物、系统和部件的维修、试验、监督和检查25.进行安全重要构筑物、系统和部件的维修、试验、监督和检查对核动力厂的安全运行至关重要，可以保证安全相关构筑物、系统和部件均按设计要求保持其可靠性和有效性。\n26.维修活动包括预防性维修和纠正性维修两个方面。\n27.必须确定核动力厂所有的安全重要构筑物、系统和部件的维修、试验、监督和检查的标准和频度。\n28.必须根据以下因素确定单个构筑物、系统和部件的预防性和预测性维修、试验、监督和检查的频度：（1）构筑物、系统和部件对安全的重要性；（2）固有的可靠性；（3）所评定的运行时性能劣化的可能性和老化特性；（4）运行经验；（5）制造商的建议。\n5.2.9 核动力厂修改29.核动力厂的修改包括：（1）构筑物、系统和部件的修改；（2）运行限值和条件的修改；（3）指令和规程的修改；（4）上述各项的组合；（5）组织机构的变更。\n30.影响到颁发运行许可证依据的安全重要构筑物、系统和部件的修改，运行限值和条件的修改，以及原先由国务院核安全监管部门批准的程序和文件的修改，必须在实施前报送国务院核安全监管部门批准。\n5.2.10 辐射防护和放射性废物管理31.营运单位必须制定和实施辐射防护大纲，以保证在所有的运行状态下由于核动力厂的电离辐射（简称辐射）或由于从核动力厂有计划地释放放射性物质所引起的辐射照射保持在规定的限值以下，并保持在合理可行尽量低的水平。\n32.按适当的运行实践，必须将产生的放射性废物的活度和体积都保持在实际可行的最小量。必须严格地控制放射性废物的处理和中间贮存，使其符合放射性废物的最终安全处置的要求。运行经验反馈\n33.必须调查研究安全重要的异常事件以确定其直接原因和根本原因。应该采用人员行为分析的方法调查与人员行为有关的事件。\n5.2.11 核动力厂定期安全审查34.对核动力厂进行系统的安全重新评价必须采用定期安全审查的方式。营运单位负有进行定期安全审查的主要责任。审查策略和需要评价的安全要素必须由国务院核安全监管部门批准或同意。\n35.定期安全审查必须考虑核动力厂的实际情况、运行经验、预期的寿期末状况、目前的分析方法、适用的规定、标准及科技水平。\n36.为了补充确定轮评价，必须考虑使用概率安全分析（PSA）来作为定期安全审查的输入，以便了解核动力厂各个不同方面对安全的相对贡献。\n5.2.12 核动力厂退役37.在核动力厂关闭前，营运单位必须尽早对核动力厂的退役做出适当的安排（包括财政安排），并必须尽早由国务院核安全监管部门批准退役安排。\n5.3 核动力厂的在役检查和定期试验5.3.1 核动力厂的在役检查1.在役检查的目的：检查核动力厂的系统和部件，找出可能的损伤，以判断它们对核动力厂继续安全运行是否可接受，或是否有必要采取补救措施。\n2.在建造阶段设计、制造和安装产生的缺陷，以及设备材料中难以检查出的缺陷，在运行阶段，一定的条件下有可能会进一步扩展，导致设备失效。这样的条件至少包括：①运行水质不合格；②运行状态不稳定；③违反运行规程。\n3.核一级容器在设计阶段，所用材料的许用应力强度只保守地取到材料抗拉强度的1&#x2F;3，或屈服强度的2&#x2F;3。通俗地讲，设计工况下，承压容器的涉及内压和其他设计机械载荷产生的一次总体薄膜应力，距离容器发生整体塑形变形至少还有30%以上的裕度，距离容器断裂失效至少还有60%以上的裕度。\n4.核动力厂部件与设备的设计、制造和安装质量符合相应的设计、建造规范标准是核动力厂实施在役检查大纲的前提和基础。\n5.对在役检查的设计考虑：设计审查“保证在役检查能顺利进行”的核心问题之一是实施在役检查的可达性。在役检查的可达性问题，除了涉及人员和检验设备的几何空间的可达性外，还涉及检验方法的可达性。\n6.辐射防护是区别核动力厂在役检查不同于常规工业的无损检验的主要问题。\n7.修理过的或更换过的部件，必须做役前检查。\n8.运行开始前的役前检查，目的是为了建立设备或部件在初始状态下的数据，人们称役前检查为在役检查的“起始零点”。役前检查是在役检查的基础，是核设施运行安全的基础。役前检查时采用的无损检验技术、仪器类型必须与随后的在役检查相同。\n9.役前检查的目的不是为了检查超过标准的缺陷，而是为后续的在役检查建立“初始零点”。\n10.修理后或更换后的役前检查标准采用的是核设施运行前的役前检查标准，不是核设施运行后的在役检查标准。\n11.水压试验是一种超压试验（超过工作压力或设计压力）和部件或系统的强度考核试验。\n12.针对一级设备的水压试验，《压水堆核电厂在役检查规则RSEM》规定：第一次由业主完成的水压试验应在初始装料结束后30个月内完成，后续相邻的重复水压试验时间间隔不应超过10年。\n13.《在役检查大纲》是该核动力厂执行役前检查和全寿期在役检查的依据。\n14.在核动力厂全寿期在役检查中的“完整检查”通常安排在役前检查阶段进行，以确定“初始零点”，然后安排在反应堆首次装料的30个月以内再进行第二次。若无异常情况，随后的“完整检查”每间隔10年进行一次。\n5.3.2 核动力厂的定期试验15.核安全法规《核动力厂设计安全规定》（HAF102）规定：设计应保证安全重要物项能否进行标定、试验、维护、修理或更换、检查和监测，以在设计基准规定的所有条件下保证其执行功能的能力并保持功能的完整性。核动力厂的布置必须便于执行标定、试验、维护、修理或更换、检查和监测等活动。\n16.定期试验大纲中应该对试验的范围、项目、方法、频度以及可以接受的准则加以规定。\n17.定期试验的目的是保证系统和设备的可用性以及良好性能。定期试验的类型可以分为功能试验和整体试验。\n18.定期试验周期的确定，需要考虑下列因素：①物项的安全重要性和满足可靠性目标的需要；②收集到的系统和设备的经验（试验台架、生产厂家的数据、运行经验）；③已知的故障类型；④系统或设备的固有可靠性；⑤设备降级的速度或者在维护时可能产生的后果。\n六、民用核安全设备质量监管\n了解我国民用核安全设备监管的发展历程；我国对进口民用核安全设备监管的基本要求；我国对民用核安全设备活动过程中质量保证体系建立、关键物项分包、报告制度及标准的基本要求；我国民用核安全设备资格管理制度的基本要求；我国民用核安全设备特种工艺人员资格管理的基本要求。\n熟悉我国民用核安全设备关于设备鉴定、重大质量问题及在役检查能力验证等方面的管理原则要求。\n掌握我国民用核安全设备监管的主要制度手段；我国民用核安全设备资格管理证书的分类；我国民用核安全设备特种工艺人员资格管理的分类。\n\n6.1民用核安全设备监管及相关法规文件1.民用核安全设备是指在民用核设施中执行核安全功能的机械设备与电气设备，其质量和可靠性对核设施安全稳定运行十分重要，高质量和高可靠性的设备是保证民用核设施安全的一个重要的前提条件。\n2.核安全设备监管的发展历程：①1992-1993年国家核安全局会同机械电子工业部、能源部，发布《民用核承压设备安全监督管理规定》（HAF601）和《民用核承压设备安全监督管理规定实施细则》（HAF601&#x2F;01）将核承压设备的质量监管正式纳入核安全监管范围。②2007年7月11日国务院颁布了《民用核安全设备监督管理条例》（国务院第500号令）。③2008年1月1日国家核安全局发布了4个核安全设备方面的部门规章《民用核安全设备设计制造安装和无损检验监督管理规定》（HAF601）、《民用核安全设备无损检验人员资格管理规定》（HAF602）、《民用核安全设备焊工操作工资格管理规定》（HAF603）、《进口民用核安全设备监督管理规定》（HAF604）。\n3.《民用核安全设备监督管理条例》的意义：①赋予国家核安全局全面实施核安全设备监管方面的职能；②将监管范围从核承压设备扩充至核安全设备（机械、电气）；③将监管对象从境内单位延伸到境外单位，实体单位延伸到个体人员。\n4.监管手段主要通过以下制度来实现：①国内民用核安全设备活动单位资格许可证管理制度；②民用核安全设备活动的监督检查制度；③境外民用核安全设备活动单位的注册登记制度；④进口民用核安全设备的安全检验制度；⑤特种工艺人员资格许可制度。\n6.2民用核安全设备及其资格许可制度1.民用核安全设备目录由国务院核安全监管部门商国务院有关部门制定并发布。①2007年12月，国家核安全局发布第一批核安全设备目录；②2010年6月，国家核安全局发文将主变压器纳入目录；③2010年11月，国家核安全局发文对第一批目录进行细化、解释；④2016年4月，国家核安全局发文更新监管目录，机械设备增加了设备模块，电气设备中电源设备进行了重新归类划分，并增加了成套开关设备和控制设备等。还补充了核燃料循环设施后处理厂专用核安全设备。（现行有效目录）\n2.国内单位需要取得国家核安全局颁发的许可证，国外单位需要按照HAF604的相关规定进行注册登记。\n3.申请许可证的单位应具有符合国家核安全监管要求的技术水平和质量管理能力，活动单位在取证后方可进行相关活动，这是确保核安全设备质量的前提和基础。\n4.国内民用核安全设备单位许可证分4类：设计许可证、制造许可证、安装许可证、无损检验许可证。\n5.2009年5月国家核安全局修订并发布了《民用核安全设备设计制造安装无损检验许可证申请审批程序》、《民用核安全设备设计制造安装无损检验许可证扩证申请审批程序》、《民用核安全设备设计制造安装无损检验许可证延续申请审批程序》。\n6.国务院核安全监管部门依据上述法规对申请单位的“技术”和“管理能力”进行审查。审查内容包括：①质保体系是否符合法规，质保体系的完整性、有效性、可操作性及以往质保体系运行情况；②人力、装备、关键技术储备状况；③模拟件试制情况。\n7.审查原则：受理有前提，审批有程序。\n8.单位、人员及技术能力要求：①申请单位需有独立法人资格，尚不支持无独立法人资格单位或多法人单位取证；②申请单位从事焊接、无损检验人员也需取得相应人员资格证书；③申请单位要有健全的管理制度和完善的质量保证体系，符合法规的质量保证大纲；\n9.单位资格许可的业绩要求：（1）国核安发〔2010〕156号：①核安全机械设备及1E级电缆设计、制造许可证申请单位须具有近5年内完整的核设施中非核级同种设备制造业绩，并提供合同、完工报告、验收报告等证明文件；②安装许可申请单位须具有近5年核设施常规岛安装业绩，延续及扩证单位必须具有原持证范围安装业绩，并提供合同、完工报告、验收报告等证明文件；③主变压器制造许可申请单位，须具有近5年内核动力厂主变供货业绩或正在执行的供货合同，并提供合同、完工报告、验收报告等证明文件。（2）国核安发〔2011〕52号：①样机制造和鉴定活动不能作为业绩；②持证期间仅承接一次活动，许可证期满但活动未结束的，许可证到期日至活动结束日之间，不得承接新合同；活动结束后，视其活动情况确定是否延期；③核专项及军工业绩可作为相近业绩；④无业绩安装单位，不得延期，需重新申请；⑤安装业绩不足，但分包了部分核岛安装活动或有完整的常规岛安装业绩的单位，可受理延期，但需对其分包活动进行监督检查并对相关人员进行考核。（3）国核安发〔2011〕118号：①“相关工作业绩”：设计、制造、安装和无损检验活动申请单位从事过与拟申请的活动类别、设备类别相同的活动；②“相近工作业绩”：非核级同种设备或常规岛工业中相类似设备的活动业绩；③初次申请机械设备取照单位只能申请核2、3级设备许可证；④扩证单位应具备同种设备5年以上和近5年相近工作业绩，并提供合同、完工报告、验收报告等证明文件；另外核2、3级扩大至1级或增加设备品种的的需具有原活动范围的供货业绩和良好的质量史；⑤延期申请：设计、制造、无损检验持证单位须有原持证范围的业绩，且质量史良好；安装单位须有原持证范围核安全设备安装业绩或常规岛安装业绩；具备完整的合同、完工报告、验收报告等证明文件的核设施备品制造活动可以作为相关业绩；⑥许可证到期时正在执行的合同，由于其活动还未完成，质量不确定，不作为业绩；⑦许可范围内持证单位不足三家的，业绩可视情况特殊处理。\n10.模拟件要求：（1）申请民用核安全设备制造、安装许可证的单位应制作有代表性的模拟件；（2）针对所申请的设备类别：①近5年内有良好的供货业绩或者正在执行供货合同的单位，在申请许可证时原则上可以不用进行模拟件试制，但应提供业绩及样机鉴定资料；②已经经过省部级以上机构组织的样机鉴定，但近5年没有供货业绩的单位，原则上需进行模拟件试制，除非能证明其完成的样机鉴定过程和结果完全满足核安全法规、标准规范和技术文件要求；③没有供货业绩且未通过省部级以上机构样机鉴定的必须制作模拟件。（3）泵、阀门、风机等能动设备设计、制造申请单位必须完成模拟件设计鉴定试验和出厂性能试验；（4）国内持证单位申请小范围参数调整的情况：①原许可范围上限尺寸规格或接近上限尺寸规格的核级业绩（近5年），同时申请的调整范围有大量常规业绩，不做模拟件；②申请1E级电缆设计、制造或扩证单位按IEEE383-2003中的有关要求选择模拟件；③模拟件施工图纸及制作技术要求可以由有资质单位出具，或申请单位根据核动力厂系统要求自行制定。\n11.关键工艺环节：对最终的质量形成较大影响的工艺环节称为关键工艺环节。根据《民用核安全设备监督管理条例》规定关键工艺环节不能分包，必须由持证单位独立完成。其他在许可证中明确界定的由持证单位独立完成的工艺环节也不得分包。\n12.资格许可的其他要求：①民用核安全设备设计、制造、安装和无损检验持证单位名称、地址、法人代表等信息变更，应在变更工商登记之日起20日内向国务院核安全监管部门申请许可证变更。②民用核安全设备设计、制造、安装和无损检验变更许可证规定的活动种类或者范围的，需要重新申请许可。③民用核安全设备设计、制造、安装和无损检验许可资质的有效期为5年，需要延续的，在许可证到期前6个月提出延续申请。\n6.3特种工艺人员资格管理1.如果一个工艺过程形成的质量不能通过最终的检查来确认的工艺，通过称为特种工艺过程。\n2.在核级产品的制造过程中，特种工艺一般指焊接、无损检验和热处理。在核安全设备生产过程中，界定了两种特种工艺过程来进行规范管理，即焊接和无损检验。从事这两种工作的人员需取得国家核安全局颁发的资格证书。\n3.民用核安全设备无损检验人员的资格等级分为Ⅰ级（初级）、Ⅱ级（中级）和Ⅲ级（高级）。资格考核按照不同等级、方法分别进行。\n4.Ⅰ级无损检测人员可以承担下列工作：①调整和使用仪器设备；②在Ⅱ级或者Ⅲ级人员监督指导下，根据操作规程进行无损检验活动，并记录检验结果；③依据标准对检验结果进行初步评定，但不得出具无损检验结果报告。\n5.Ⅱ级无损检测人员可以承担下列工作：①根据确定的工艺，编制技术操作规程；②安装和校准仪器设备，具体实施无损检验活动；③依据法规、标准和规范评价检验结果；④编写和签署无损检验结果报告；⑤培训和指导相应方法的Ⅰ级无损检测人员。\n6.Ⅲ级无损检测人员可以承担下列工作：①确定无损检验技术和工艺，监督和管理无损检验活动；②依据法规、标准和规范评价检验结果；③编制特殊的无损检验工艺；④没有验收准则可供引用时，协助有关部门制定验收准则；⑤培训相应方法的Ⅰ级和Ⅱ级人员。\n7.无损检验活动以Ⅱ级或Ⅲ级人员为主操作，结果报告只能由Ⅱ级或Ⅲ级人员编制和审核。\n8.无损检验人员的资格证有效期为5年，持证人员不得在2个及以上单位执业。\n9.焊工、焊接操作工考试是向国家核安全局认可的考试中心提出申请，分理论考试和操作技能考试；证书有效期为3年，持证人员应每半年上报一次连续操作记录，不得在2个及以上单位执业。\n6.4 进口民用核安全设备监管要求1.《民用核安全设备监督管理条例》建立的境外民用核安全设备活动单位的注册登记制度，首次把境外单位纳入核安全监管范围。2.《民用核安全设备监督管理条例》建立的进口民用核安全设备活动单位的安全检验制度，首次明确对进口民用核安全设备实施安全检验。\n3.《进口民用核安全设备监督管理规定》（HAF604）适用于为我国境内民用核设施进行民用核安全设备设计、制造、安装和无损检验活动的境外单位的注册登记管理以及进口民用核安全设备的安全检验。\n4.境外单位应当事先到国务院核安全监管部门申请注册登记。拟从事核安全设备设计、制造、安装活动，应根据活动种类（设计、制造、安装）、设备类别和核安全级别提出申请。拟从事无损检验的应当按照无损检验方法提出申请。\n5.注册登记确认书的有效期为5年，需要延续的，需在有效期届满前6个月重新提出注册登记申请。经注册登记的境外单位，变更单位名称、所在国家（地区）、住所或者法定代表人的，应当自其在所在国家（地区）变更登记之日起30日内办理变更手续。（国内单位变更是20日内）\n6.营运单位应当自对外贸易合同生效之日起20个工作日内，向核安全监管部门及其派出机构提交书面报告。营运单位在民用核安全设备设计、制造、安装、无损检验活动1个月前，核安全监管部门及其派出机构提交书面报告。\n7.民用核设施营运单位应当对进口民用核安全设备进行监造、装运前检验、监装、质量验收等。\n8.国务院核安全监管部门及其所属的检验机构依法对进口民用核安全设备进行安全检验，安全检验可以采取独立检验或验证方式。\n9.进口核安全设备到达口岸前条，民用核设施营运单位应当向国务院核安全监管部门及其所属的检验机构报检，并获取口岸检查放行单。报检提交的材料包括：①进口民用核安全设备报检申请表；②注册登记确认书复印件；③装箱清单；④产品质量合格证书。上述材料应当为中文或英文。\n6.5 民用核安全设备活动监管要求1.民用核设施营运单位对民用核安全设备的使用和运行安全负全面责任。不管如何委托，所有核安全重要活动都应该在核设施质量保证体系的控制之下，核设施营运单位都要承担最终核安全责任。\n2.民用核安全设备设计、制造、安装单位应在设计、制造、安装活动开始前30日前，将项目设计、制造、安装质量保证分大纲和程序清单报国务院核安全监管部门备案。无损检验单位应在检验活动开始15日前，将项目质量保证分大纲和程序清单报国务院核安全监管部门备案。\n3.民用核安全设备设计、制造、安装和无损检验单位，不得将国务院核安全监管部门确定的关键工艺环节分包给其他单位。\n4.核岛工程总承包活动中，包括设计（含管理）、采购、施工（含管理）、调试等活动，必须在合同中约定建造期间双方各自所应承担的安全、质量责任和义务，总包方负直接责任。\n5.总包方能独立完成核岛及核安全设备的设计管理、采购和施工管理，且不能分包；总承包活动不转移、不减轻营运单位的全面核安全责任。\n6.核动力厂营运单位应在签署核岛总包合同前1个月，将确认的核岛工程总承包单位上报国务院核安全监管部门备案。委托有经验及资质的第三方进行监理；监理活动应公正、独立、自主。核安全监管部门可对监理部门进行必要的监督检查和业务指导。\n7.民用核安全设备持证单位每年4月1日前向国务院核安全监管部门提交上一年度评估报告。核安全设备相关活动开始30日前（无损检验活动开始15日前）向国务院核安全监管部门备案。设计、制造、安装持证单位在每季度开始第7个工作日前提交上一季度的活动报告。\n8.民用核安全设备制造阶段的不符合项分为三类：一般不符合项、较大不符合项、重大不符合项。\n9.一般符合项：制造过程不符合工艺规程、程序、验收要求。但满足法规标准及采购技术文件要求的不符合项。\n10.较大不符合项：指1E级核安全电气设备及其核级零部件，以及核2、3级机械设备制造过程不符合相关法规标准或采购技术文件要求的不符合项。持证单位在10个工作日内书面上报生态环境部华北核与辐射安全监督站（简称华北站），根据华北站要求提交相关材料，并通报项目责任单位。处理方案提交项目责任单位备案或审查，其返工和返修的处理结果需得到项目责任单位的书面认可。\n11.重大不符合项：指核1级机械设备及其核级零部件制造过程不符合相关法规标准或采购技术文件要求的不符合项。持证单位在5个工作日内书面上报国家核安全局和华北站，根据国家核安全局和华北站要求提交相关材料，并通报项目责任单位。处理方案提交项目责任单位备案或审查，其返工和返修的处理结果需得到项目责任单位的书面认可。\n12.《民用核安全设备监督管理条例》规定，核安全设备使用的标准应经国务院核安全监管部门认可。\n6.6 民用核安全设备活动监管中的几个特殊问题1.核安全设备鉴定包括设备的抗震鉴定和设备的环境鉴定，只有经过设备鉴定合格的设备，才能用于核设施。设备鉴定是常规设备过渡到核安全级设备的重要一环。\n2.设备鉴定的过程是，首先对核设施设备按照安全重要性确定安全分级，凡是安全1、2、3级机械设备和1E级电气设备（另外还包括一些是非安全级但对安全重要或其损坏会危及安全级设备的设备）均应列入其中，然后对设备进行设备鉴定。\n3.设备鉴定可以采用：分析、试验、经验反馈方法进行。①对于环境鉴定一般采用试验方法进行。②抗震鉴定原则：对于能动的安全级机械设备和1E级电气设备应采用试验方法（机械尺寸较大的可以使用分析，数学模型必须精确，并经过核安全审查）。设备的合格鉴定试验在原型样机上进行。③不同核动力厂应有不同的鉴定要求，不存在通用的核安全设备合格鉴定。\n4.重大质量问题包括重大不符合项和严重有损于质量的情况。\n5.对于严重的有损于质量的情况，大纲必须对查明起因和采取纠正措施做出规定，以防止其再次出现。对于严重的有损于质量的情况，必须用文件阐明其鉴别、起因和所采取的纠正措施，并向有关各级的管理部门报告。\n6.出现重大质量问题时，有必要组织质量保证体系的监督检查。仅从技术上不能根本解决问题，根本原因通常是没有切实有效实施质量保证要求。\n7.对于不符合项的审评一般只审查申请单位提交的不符合项的报告核处理方案，对于重大不符合项还要到产生不符合项的场所进行调查了解。对于严重有损于质量的情况报告，其内容也应基本相同。\n8.核电厂在役检查无损能力验证是指通过对无损检验涉及的程序、设备、人员进行综合评价，减少无损检验过程中发生缺陷漏检或误判的可能性，提高无损检验结果的准确性和可靠性，降低核电厂运行安全风险。\n9.当前国际上主要有两个能力验证考核体系：美国PDI体系；欧洲ENIQ体系。\n10.我国2008年依托秦山二期扩建工程和岭澳二期等项目，正式启动能力验证工作，经历了相互验证及独立验证两个发展阶段。\n11.我国能力验证参照欧洲ENIQ将验证流程分为：验证方案审查、检验程序和技术规格书等文件审查、盲测试块设计、设备功能测试、检验程序和设备明测、检验人员盲测等环节。参照法规RSEM规范将检验项目分为：特殊验证、综合验证、常规验证、不需验证和专家论证5类。\n七、核燃料循环设施核安全监督管理\n了解铀矿开采和加工的辐射安全监督管理、核燃料加工、处理设施的辐射防护、核燃料加工、处理设施的临界安全、非核燃料循环装置的其他安全和环境问题。\n\n7.0 引言1.核燃料循环设施核安全监督管理包括：铀矿勘探开采和加工的辐射安全监督管理；核燃料加工、处理设施的辐射防护、核临界安全和化学安全的安全监督管理。\n2.核燃料循环设施根据放射性物质总量、形态和潜在事故风险或后果进行分类。按照合理、简化方法，分为四类：（1）一类：具有潜在厂外显著辐射风险或后果，如后处理设施、高放废液集中处理、贮存设施；（2）二类：具有潜在厂内显著辐射风险或后果，并具有高度临界危害，如乏燃料离堆贮存、混合氧化物（mox）元件制造；（3）三类：具有潜在厂内显著辐射风险或后果，或具有临界危害，如铀浓缩、铀燃料元件制造、中低放废液集中处理、贮存设施；（4）四类：仅具有厂房内辐射风险或后果，或具有常规工业风险，如天然铀存化&#x2F;转化设施，重水堆元件制造等。\n3.铀矿勘探开采和加工是辐照剂量最高、三废产量最大、环境影响较重的单独一类设施。\n4.铀纯化（精制）和元件加工工序是整个循环中废物量最少、放射性水平较低、对工作人员及环境污染危害较低的环节。\n7.1 铀矿勘探开采和加工的辐射安全监督管理1.铀矿勘探、开采和加工，工作环境差、自动化水平较低，是核燃料循环系统中辐射危害大、剂量高和安全事故多的环节。\n2.铀矿工集体受照剂量占整个核燃料循环总集体剂量的67.8%；铀矿环境公众剂量占整个循环公众环境剂量的91.5%；其中辐射贡献最大的是氡及氡子体，在矿工中占比96%，公众中占89.8%。\n3.铀矿勘探开采和加工主要危害因素是：氡及氡子体，放射性铀矿尘和长寿命放射性气溶胶、γ外照射、表面放射性污染、共生和伴生元素危害、三废环境污染。\n4.氡及氡子体：（1）氡：Rn，原子序数86，质量222，无色无味无臭放射性惰性气体，易溶于水和有机溶剂，最后一代衰变字体为稳定的铅206Pb；（2）氡子体危害远大于氡，90%氡可在其衰变前呼出体外，只有40%子体被呼出，60%滞留；（3）氡被国际定性为A类致癌物质，是引发肺癌的第二大因素，在人类受照剂量中占56%。\n5.铀矿勘探开采和加工人员剂量限值：    铀矿工作人员有效剂量约束值连续5年得平均有效剂量（不可追溯性平均）为15mSv&#x2F;a，    特殊情况下，1年有效剂量约束可高于15mSv&#x2F;a，但不得高于20mSv&#x2F;a。\n6.环境标准：铀矿开采和加工矿冶环境公众的受照有效剂量约束值为0.5mSv&#x2F;a。\n7.居民室内氡200-400Bp&#x2F;m³，上限用于已建住宅氡持续照射的干预，下限制用于住宅氡持续照射的控制。\n8.县级以上人名政府环保行政主管部门，对本行政区域内铀矿开发利用中放射性污染防治进行检查。\n9.铀矿勘探开采和加工辐射监督管理要求和责任：（1）需履行国家相关规定施行许可证制度；（2）选址、建造、运行、退役等活动，必须严格遵循和执行相关的国家、行业相关技术规范和标准；（3）配套的安全设施和辐射防护措施，“三废”处理设施，以及放射性污染防治和环保设施，必须与主体工程同时设计、同时施工、同时投入使用。（4）应当对全部作业场所和岗位，对产生的放射性气态和液态“流出物”，以及单位周围的环境实施监测，并定期向环境保护行政主管部门报告检测结果。（5）产生铀矿石、尾矿（渣）的单位，必须建造专用的铀矿石场和尾矿（渣）库，满足相关法规标准的要求，确保长期安全稳定。（6）应当考虑有利于将来退役治理的有关问题。（7）运输铀矿石、天然铀产品、放射性废物的，应严格执行相关放射性物质运行的规定和标准。\n7.2铀矿勘探开采和加工的辐射防护1.我国铀矿开采初期，主要采用通风稀释控制氡；20世纪70年代后由于法规标准严格，目前主要采用综合降氡法，主要有：（1）通风将氡，根据氡及子体总析出量和浓度设计通风量；（2）密闭氡源，密闭废旧巷道和采空区；（3）喷涂防氡保护层；（4）控制入风流污染；（5）排出矿坑水；（6）正压通风；（7）分区通风；（8）清除堆积的铀矿石。\n2.矿石氡射气系数（f）随矿矿石含水率在14%-17%之间出现峰值；氡析出是镭按指数规律衰变产生，氡也将按指数规律衰变。\n3.常规铀矿井降氡方法：根据铀矿通风特点和要求，采用综合防护措施降低矿井氡及氡子体浓度。\n4.铀矿勘探开采的综合防护：（1）铀矿尘防护防护措施：凿岩设备装设水雾；爆破孔采用水封爆破；出渣、搬运过程喷雾洒水；巷道重要部位安设水幕；定期清扫巷道；工作人员佩戴高效过滤口罩。（2）γ外照射防护措施：铀品位大于1%就要考虑γ辐射防护，20%品位矿石γ外照射剂量可达20mgy&#x2F;h。主要措施是：穿戴好劳保用品，减少作业时间，无关人员远离高品位铀矿体。（3）表面污染防护措施：工作人员上岗前必须在卫生闸门更换衣服；离岗前在卫生闸门淋浴去污（效果可达85%），表面监测合格后方可离开；工作服去污效率可达70%。\n5.铀矿选冶厂生产过程前段主要危害是：铀矿尘、氡气、γ外照射；后段主要危害是：铀化合物、放射性表面污染和酸碱蒸汽。\n6.铀矿选冶厂主要是做好负压通风、分区通风、密闭、除尘、去污等工作。\n7.选冶加工防尘措施（1）密闭矿尘发生源：局部密闭、整体密闭、大体积密闭；（2）密闭设备内部通风：负压、防止外溢；（3）湿式作业：加水7%-12%较为适宜，马克尼喷嘴，圆锥形水雾；（4）加强排尘净化。\n8.选冶厂的降氡主要采取通风排氡措施。\n9.选冶车间全面换气原则和次数：各作业场所放射性物质最大日操作量及放射性场所级别选定为6-10次换气。\n10.铀矿石加工过程中基本都是在密闭设备中进行，β防护可不必考虑；但在进行管道、容器检修是需注意β防护，佩戴防护眼镜，保护眼晶体。\n11.铀选冶厂的γ辐射只有在铀品位大于1.0%时才应考虑γ射线外照射防护问题，防护措施是：加强机械化、自动化水平，减少人员的直接接触（距离、时间防护）。\n12.铀选冶厂的β辐射主要存在于铀水冶加工的后半部工序，防护措施是：设备内部检修时，应佩戴防护眼镜，防止对眼晶体的损伤。\n7.3 铀矿勘探开采和加工的环境保护1.控制矿井氡浓度主要措施：一是采矿工艺选择；二是矿井通风防护。其中矿井通风防护是铀矿通风降氡的最主要手段。\n2.洒水和洗壁是减少矿山粉尘的重要措施，加湿矿石的含水量达10%时，可以降低氡析出量的70%。\n3.铀选冶厂废气的治理的总体要求是：（1）合理选择场址；（2）厂房内工艺设备采取有效的密闭和通风净化措施；（3）烟囱设计安全可靠的排放高度；（4）加强对密闭通风设备运行的安全检查；（5）加强对环境大气的监测。\n4.铀选冶厂废气的治理的技术措施是：（1）设备密闭；（2）通风净化；（3）滤材净化氡子体：滤材除氡可到60%以上。（4）湿法作业：湿法作业是一种简单、方便、经济有效的防尘措施；（5）吸收法：对常规水冶中硫酸雾，可用10%的NaOH或10%的氨溶液吸收，采用洗涤塔、泡沫塔和填料等设备；铀纯化产生的氮氧化物可用水吸附后再用一级尿素吸收。\n5.矿井勘探开采和加工产生的液态废物包括：矿井水、水冶工艺废水、尾矿库废水、废石场和尾渣库的渗漏水。最主要的是矿井水、水冶工艺废水、尾矿库废水。\n6.水体保护的主要方法有：（1）清污分流减少废水量；（2）矿井水复用及工艺废水循环使用；（3）废水处理：具体技术包括，    ①物理法（沉降、过滤、蒸发等）；    ②化学或物理化学法（化学沉淀、离子交换、渗析等）；    ③生物法（细菌、曝气池等）。\n7.目前我国主要采用化学沉淀、离子交换、电渗析等方法进行废水处理，其中离子交换应用最普遍。\n8.堆浸废水中含有大量的铀、镭、砷、镉等重金属有害物质，以及化学有害物质，这些废水流入地表、地下水体及农田，会造成环境污染。\n9.堆浸废水的主要处理方法：（1）石灰中和法，除铀等杂质；（2）二氧化锰吸附法、高锰酸钾活化锯末法、重晶石吸附法、硫化钡沉淀法除镭；（3）污渣循环法，通过沉淀除铀、镭、重金属、砷等。\n10.减少废水对环境影响的主要措施有：提高循环利用效率，减少废水排放量。\n11.地下水复原技术措施：（1）地下水清除法：不断抽取污染的地下水；（2）反渗透法：将污染的地下水抽出到地表经反渗透装置进行净化处理；（3）自然净化法；（4）还原沉淀法：将还原剂H2S注入含水层，能有效还原和沉淀重金属元素，是目前比较有效的处理方法，缺点是又将新的化学试剂注入了地下含水层。\n12.铀矿勘探开采和加工产生的固体废物影响面广、危害最大的是铀废石和尾矿。\n13.尾矿库事故具有较大的危害性，在世界100种重大灾害中被列为第18位。\n7.4 铀矿冶设施退役（关闭）治理（处置）及长期监护1.我国铀矿勘探开采和加工工业具有如下特点：（1）影响范围广；（2）铀矿冶废物辐射潜在危害大时间长；（3）放射性危害与非放射性危害同时并存；（4）铀废石矿、尾矿库关闭处置受自然和社会影响因素多。\n2.退役治理基本原则和退役治理技术政策：（1）以人为本，生态文明原则；（2）废物最小化原则；（3）科学态度、实事求是原则；（4）百年大计，质量第一原则；（5）清洗去污，物尽其用原则。\n3.铀矿冶设施退役（关闭）治理（处置）程序主要有：前期准备、施工管理、竣工验收、工程移交和长期监护。其中，竣工验收分为预验收和竣工验收。\n4.退役（关闭）环境治理（处置）目标：保护广大公众健康和环境安排，严格控制由于铀废石场和尾矿库引起环境恶化给后代造成不适当负担。\n5.铀矿冶设施退役环境治理的技术政策：全面规划、突出重点、因地制宜、安全可靠、经济合理\n6.根据矿冶退役设施的性质和特点，采取的处置措施：封闭（堵）、覆土（回填）植被、清洗去污。\n7.废石、尾矿表面覆盖隔离层的设计应考虑多重防护作用，典型铀矿滩面覆盖隔离层应包括防氡层、排水层、生物阻挡层、砂滤层、土壤生长层和侵蚀阻挡层，以确保防氡效果。\n8.目前认为对尾矿渗出水处理效果较好的方法主要是：中和氧化沉淀曝气法（PH值控制在10左右，曝气时间20-30min）。\n9.废石场、尾矿（渣）库稳定化的主要方法：（1）物理稳定法：覆盖岩石、泥土或渣土，喷水；（2）化学稳定法：用化学物质与尾矿砂反应，形成抗风防水的硬壳；（3）植被稳定法：植被或种植作物；（4）综合稳定法。\n10.我国规定铀废石场、尾矿库治理后的工程达到长期安全稳定，222Rn析出率不超过0.74Bq&#x2F;（m2·s），在工程验收移交后对工程安全有效性进行长期监护。\n11.放射性污染废旧金属去污方法主要有：化学表面去污法、金属熔炼去污法。\n7.5核燃料加工、处理设的施辐射防护1.所有核燃料加工、处理设施在建造、运行、退役期间都要制定一个完善的辐射防护大纲。\n2.辐射防护要遵循辐射防护实践的正当化、辐射防护的最优化、个人剂量限制三项基本原则；要保证工作人员受照剂量低于《电离辐射防护与辐射源安全基本标准》（GB18871-2002）。\n3.辐射防护大纲应包括：辐射安全设计、辐射安全监测、辐射安全措施等主要内容。\n4.辐射安全设计：（1）设施分区布置，工作场所分为放射性工作场所和非放射性工作场所，放射性工作场所分为控制区、监督区。（2）设施密封原则，厂房密闭，易泄露的房间要设置单独房间。（3）气流组织，负压，保证风从低剂量区流向高剂量区，在容易产生放射性气溶胶的部位应设置局部排风系统。（4）人流控制，设置卫生通过间，人员出入淋雨及手脚表面污染检测。（5）辐射屏蔽和污染控制。（6）防火防爆措施，配备足够防火防爆器材，严格执行防火规范。（7）事故应急措施，运行前制定，并进行人员培训和考核。\n5.铀浓缩厂主要工作物质是UF6，主要污染物是铀及氟化物。\n6.UF6辐射危害主要是α辐射及铀衰变系的β和少量r，所以主要是防止吸入体内造成内照射危害。\n7.按照GB18871规定将放射性工作场所分为：控制区（如供取料厂房、排风机房等）、监督区（如质谱分析间、剂量监测室、放射性厂房的生活间与走廊等）。\n8.职业照射监测的主要内容是：空气监测；外照射监测；个人剂量监测。\n9.环境安全与公众剂量估算包括：流出物监测；环境监测；公众剂量估计。\n10.燃料元件加工厂曾多次发生UF6泄漏事件或事故，主要发生在UF6气化岗位。\n11.后处理厂的处理对象是乏燃料，具有极强的β、γ和中子辐射。辐射防护设计的主要内容辐射安全、辐射屏蔽和辐射剂量监测。\n12.降低工作人员职业辐射的防护措施：分区及出入控制；密封与通风；设备、材料选择；设备布置、检修与去污；远距离测量和控制；屏蔽；辐射剂量监测。\n13.降低公众受照射剂量的防护措施：（1）选择合适的厂址；（2）设计多重屏障；（3）事故预防和应急；（4）妥善治理三废。\n14.后处理厂需要屏蔽的主要是β辐射、γ辐射和中子辐射。\n15.后处理厂放射性厂房按照四区划分：白区、绿区、橙区、红区。\n7.6 核燃料加工、处理设施临界安全1.中子链式反应及临界：一个中子使235U产生裂变，后者通常分裂成两个碎片，同时释放出能量，还伴随平均放出2.5个中子，裂变产生的中子又会与235U核发生反应，引起核裂变，如此继续下去，就形成中子链式反应。\n2.第二代235U吸收的中子数与前一代被235U核吸收的中子数之比，叫做增殖因子。考虑了泄漏后的增殖因子，称为有效增殖因子（keff）。当keff&#x3D;1，系统就能维持自持链式反应，达到临界。因此，临界条件就是keff&#x3D;1。\n3.影响临界安全的因素：（1）易裂变核素和可转换核素份额；（2）易裂变核素质量；（3）容器的几何条件和容积；（4）易裂变核素在溶液中的浓度；（5）慢化剂性质和浓度；（6）易裂变材料周围反射层的性质和厚度；（7）中子毒物性质和浓度；（8）燃料-慢化剂-中子毒物混合均匀性；（9）两个或多个易裂变材料在容器间的相互作用。\n4.对于组分确定的燃料，保证次临界的最简单和最严格的条件是控制上述（2）（3）（4）三项因素，即分别施行易裂变核素的质量控制、盛装易裂变材料的容器的几何控制、易裂变材料在溶液中的浓度控制，这种方法叫做“易裂变核素单参数临界安全极限法”。\n5.易裂变核素单参数临界安全极限法的优点是：可给出确保次临界的质量、尺寸、体积、浓度的最大值。缺点是只能小批量处理，能应用的设备也小。\n6.燃耗信用制：燃耗测量是采用燃耗信用制的关键步骤，测量方法有中子发射法、γ射线能谱法、γ射线法。\n7.铀富集厂核临界安全的特点（1）易裂变材料时单一的235U，其富集度范围在0.2%-90%以上，当富集度大于1%是，就存在核临界安全问题。（2）工艺主机级联中大量气相UF6虽然不存在临界问题，但该介质易溶于液体，铀水混合一定比例时候容易临界。（3）主机级联厂房及检修厂房供取料厂房无辐射屏蔽层，回收再生厂房虽有部分间隔，但屏蔽效果不大。\n8.核临界控制的手段：（1）几何控制：限制工艺设备的几何尺寸和形状，例如使用容积小于5L的容器盛取高富集度的产品。（2）质量控制：限制设备和系统内易裂变材料的质量，考虑双批投料的可能，清洗槽和杨液器中溶液的235U含量不大于350g。（3）浓度控制：限制溶液中易裂变材料的质量浓度，如混合澄清槽、清洗槽、扬液器中溶液的235U浓度不大于5g&#x2F;L。（4）富集度控制：按不同富集度不同分别制定核临界安全限额。（5）慢化控制：限制可能进入含铀物料的含氢漫画集的质量。例如系统冷却由水冷改风冷，限制与慢化材料的接触。（6）间距控制：限制容器之间的距离不得小于一定值，以防产生临界。（7）毒物控制：使用中子吸收材料，例如在处理接近或者超过临界量的含235U的溶液反应器中设置镉片。\n9.乏燃料贮存密集化：高密度贮存方式可以将容量密度从4.2tHM&#x2F;㎡提高到12tHM&#x2F;㎡（HM-重金属，指燃料中辐照前铀和钚的量），密集化措施有：（1）将燃料组（元）件在水下由单层改为双层排列；（2）将组件拆解成元件单棒排列；（3）水中加入可溶的中子毒物；（4）水池或格架中设置固态中子毒物。\n10.乏燃料贮存时必须做临界分析，临界分析时应采用双偶然事件原则。通常乏燃料阵列Keff限值取0.90，有时为了提高容器容量，也可取0.95。\n11.乏燃料后处理厂是核燃料循环中典型的堆外操作、加工、处理易裂变材料的核设施，在其设计、运行和管理中核临界安全控制占有特殊又重要的地位。后处理厂不仅含有235U，而且有相当含量的钚。因此，该类设施的核临界安全控制应尽可能采用几何控制；对于不能采用几何控制的大型设备，则应采用可溶的或固定的中子毒物控制。\n12.临界控制的设计要求：对于设置重屏蔽，后处理厂设计上遵循双偶然原则；对于无重屏蔽的场合，则应遵循三重偶然原则。\n13.主要工艺步骤的临界控制：（1）燃料剪切：通过控制剪切组件数量防止临界。（2）燃料溶解：临界反应性在溶解过程中达到峰值，此时应通过多重手段控制，并应加入硝酸钆作为可溶性中子毒物。\n7.7 核燃料加工、处理设施的化学安全1.UF6是铀浓缩厂主工艺系统的工作物料，对于操作物UF6物料的岗位，温度控制对于安全生产起着很重要的作用。\n2.核燃料循环加过过程中经常使用的有机试剂（TBP&#x2F;煤油等）；无机试剂（酸碱等）。\n3.UF6物理状态与其压力、温度有关，三相点为0.15MPa，64.1℃。其从固体到液体过程中体积膨胀25%，所以温度控制对其安全生产很重要，相关容器必须留有足够空间。\n4.国标规定废气处理后氟化物排放浓度9mg&#x2F;m³，废液为10mg&#x2F;L。\n5.美国制定了氟化物化学毒性防护行为准则PAC将氟化物对人体健康影响分为四级：0级（对人体健康无不利影响）；1级（轻微、短暂影响）；2级（产生不可逆或严重健康影响）；3及（可能危及生命）。\n6.氢气的爆炸极限是4%-75%（体积），工艺过程中防止氢气爆炸的主要措施是对氢气浓度实施连续监测报警和引入稀释空气（如氮气），保持氢气浓度低于爆炸下限（4%以下，后处理厂一般控制在2%以下）。\n7.锆屑主要是防止燃烧、爆炸：微米级颗粒可自然（2.54×10-3mm）；粒径大于1.27×10-2mm，可在火焰中燃烧；粉尘微粒小于6.2×10-2mm可强烈爆炸。\n8.后处理厂通常使用的溶剂有两种：30%TBP-煤油和5%TBP-煤油。防止溶剂着火主要是防止发生泄漏，系统温度保持在70℃以下，隔绝火源。\n9.”红油”是硝化的TBP和铀、钚等重金属复杂化合物，极不稳定，130℃强烈分解爆炸；该类事故主要是发生在各类蒸发器中，所以需保持蒸发器压力在0.3MPa，系统温度控制在130℃以下。\n7.8后处理设施物项分级与事故防范1.后处理厂的物项按照性质划分为：化工设备、机械设备、电气设备、建（构）筑物四类。\n2，放化安全等级划分：①放化安全级，化工设备细分为放化1级（RS-1）、放化2级（RS-2）；②非安全级（NR）；③有特殊要求的非安全级物项NR（S）。\n3.抗震等级分类：①Ⅰ类抗震物项，按照SL-2地震动设计和论证，应能在SL-1地震动下保证可运行，在SL-2地震动下应能够保证安全功能（完整性和&#x2F;或可运行性）；②其他抗震类物项（NA）。\n4.质量保证等级划分：①质量保证QA1级；②质量保证QA2级；③质量保证QA3级；④非核质量保证级QAN。\n5.典型事故：后处理厂工艺设备室中核临界事故、后处理厂的“红油的产生及引起爆炸”。\n6.针对后处理厂工艺设备室中核临界事故：（1）临界安全预防设计原则：包括几何控制、质量控制、浓度控制、慢化条件控制和中子毒物控制，首选几何控制，或者以保证几何良好为前提与其他控制原则结合使用。（2）事故探测：一旦发生临界事故，工厂内各关键部位上至少有两个探测器会立即报警。（3）预防和纠正：后处理厂设计中，对易裂变材料可能发生临界的关键部位，设置了中子探测装置，另外还设置了γ报警装置，共同探测临界事故的发生。（4）我国在早期的后处理厂设计中规定，凡潜在临界事故的工艺设备室的四壁和顶部防护屏蔽墙厚不小于800mm混凝土。\n7.针对后处理厂的“红油的产生及引起爆炸”事故：（1）“红油”是亚硝基化合物，其红色是亚硝基化合物在稀释剂中的颜色，当混合物温度超过130℃时，“红油”易发生爆炸性分解反应，红油的爆炸只有在温度超过139℃条件下才有可能发生。（2）“红油”爆炸是由于在蒸发器中“红油”的形成和积累，温度高于135℃时形成的热失控反应，导致蒸发器严重超压所致。（3）不同事件和事故的反馈表明：在后处理厂浓缩或蒸发操作时，应全面控制待浓缩的水相溶液中有机相含量、蒸发物料的温度以及蒸发器的排气卸压条件。\n八、核材料管制与核设施实物保护1.核材料安全：一方面防止破坏，造成放射性环境污染；一方面防止偷盗、非法转移、非法使用。\n2.在整个核燃料循环过程中，铀的浓缩、元件制造、乏燃料运输、贮存和后处理过程是核材料最易流失的环节，应严加防范。\n3.核反应堆工程主要是防止破坏，循环设施主要是防止偷盗、非法转移、非法使用。\n8.1 核材料管制的目的、基本要求和采取的政策1.核材料：源材料（不包括钍）、特种可裂变材料、氚、锂-6及含有上述物质的材料和制品都称为核材料。\n2.直接使用的核材料：不需经过核素转换或进一步富集就能用于制造核爆炸装置的核材料。例如高富集度的235U、233U、238PU含量低于80%的钚；以及含有上述物质的化合物、混合物，（如铀-钚混合氧化物元件）和乏燃料中的钚。\n3.间接使用的核材料：除直接使用核材料以外的所有核材料，例如天然铀、贫铀、低富集度铀和钍。\n4.确保核材料的安全与合法利用，防止被盗、破坏、丢失、非法转让和非法使用。保护国家和人民群众的安全，促进核能事业的健康发展。\n5.防范有预谋的核走私和极端恐怖集团的袭击，以及恐怖分子利用核材料进行恐怖活动，也是核材料管制的目的之一。\n6.核材料管制的基本要求是：    （1）保证符合国家利益及法律规定；    （2）保证国家和人民群众的安全；    （3）保证国家对核材料的控制，必要时国家可以征收所有核材料。\n7.核材料安全也是通过制定核材料管制法律和实行许可证制度以及严格的监督来保证。\n8.根据“安全第一，预防为主”的方针和国际惯用的对核材料“看住、发觉、追回”的纵深防御思想，对核材料管制所采取的主要对策是：（1）实物保护。实施技防措施和人防措施相结合的方法，达到“看住”核材料。不让核材料丢失或破坏或非法使用。（2）核材料衡算与控制。通过核材料进出量的严格控制，定期盘存和衡算，及时“发觉”核材料的丢失。（3）制定应急行动计划（又叫紧急情况的处置方案）。一旦发觉核材料丢失，根据预先制定的应急计划，采取措施，全力侦破，“追回”核材料。\n8.2 核材料衡算管理1.实物保护难以发现在正常的核材料活动掩护下的一些非法转移，以及内外勾结的少量多次转移或偷盗。采取核材料衡算的办法可以及早发现这种非法的转移或偷盗。\n2.核材料衡算管理概括为三部分：①记录报告系统；②衡算计算方法和评价；③监督大纲和程序。\n3.记录报告系统为核材料衡算管理、为核材料衡算系统的核查提供所需要的一切信息和数据。为此，记录报告系统必须做到真实性、准确性和及时性。数据的可追溯性、技术支持文件的系统完整性是设计记录报告系统的重要指标。如果失去数据的可追溯性，即认为出现反常现象，这意味着极可能发生了核材料丢失或非法转移。为此，要及时做好物料盘点、建立账目。\n4.核材料衡算管理分为：件料核设施（例如各种反应堆）和散料核设施（例如元件制造厂、离心分离厂和后处理厂等）。\n5.件料核设施是以点件数、核对标识符和辅以定性检验来实现核材料衡算控制，可以说不依靠测量系统提供衡算数据。\n6.散料核设施的核材料衡算必须建立在测量系统提供的测量数据基础上。衡算系统必须建立，对于无法及时达标的衡算系统，可以在许可证中规定达标期限。\n7.核材料衡算采用闭合平衡的方法。所谓闭合是指在实物盘存中每一项的物料量必须是实测值，而所用测量系统的误差必须是已知的。\n8.核材料平衡是指加工生产过程中，核材料的不平衡差（MUF，无名损失量）必须在法规限定的标准误差的2倍范围内，否则就认为核材料未达到闭合平衡，有可能存在核材料的丢失、盗窃和非法转移。\n9.核材料的不平衡差（MUF，无名损失量）又称为“核材料不明量”，实际上它等于账面物料存量与实务盘存量之间的差值，MUF是核材料衡算管理好坏的量度，也是监管部门评估核材料管理的关键性定量指标。\n10.件料设施MUF值一般为零；散料设施一般不为零，原因是测量误差、未测的存留量和未测的损失量等。核材料不平衡差的计算公式如下（单位kg）：MUF&#x3D;X-Y+PB-K-PE\n\nMUF表示不平衡差X表示周期内调入量,Y表示周期内调出量,\nPB表示期初存量,K表示已知损失量,PE表示衡算周期期末存量\n\n11.为了能及时发现核材料丢失，还需要根据核材料性质规定衡算周期。因为核材料管制是以核不扩散为目标，因此衡算周期要保证使觉察时间小于转换时间。转换时间和时效目标值相当，规定觉察的最小转用速度为每年一个显著量。\n12.高浓缩铀、钚的衡算周期为2个月；核动力厂、及元件加工厂的衡算周期每年至少一次。\n13.轻水反应堆达到一个核材料显著量应为10-15个新燃料组件或5-6个乏燃料组件。\n14.为了核材料衡算管理的方便，一个衡算单位往往划分为若干个核材料平衡区。平衡区划分的原则是：（1） 平衡区的划分应尽量与实体边界相一致；（2） 平衡区的大小应有利于核材料的准确测量和行政管理；（3） 平衡区的划分应充分采用封隔／监视系统，以减少测量工作量和保证物流测量的完整性；（4） 衡算的方法是清点件数还是测量；（5） 物料平衡计算可能达到的精度和衡算报告的简易性；（6） 充分考虑企业商业敏感数据的保密性。\n15.在核材料转移交接地点设物流关键测量点，在贮存或实物盘存点设置盘存关键测点。\n16.核动力厂一般采用单一的核材料平衡区（MBA）结构，设立3个关键测量点（KMP），即新燃料贮存库、堆芯和乏燃料贮存池；每个堆划分为一个MBA。\n","categories":["NSE"],"tags":["NSE"]},{"title":"XPS 9340 (intel 集显)使用Solidworks卡顿","url":"/2024/07/25/xps/XPS9340-Intel%E9%9B%86%E6%98%BE-Solidworks%E5%8D%A1%E9%A1%BF/","content":"新 XPS 9340（Intel Ultra 7 155H）使用 Solidworks 2023 还是会卡。\n毛病跟之前 XPS 9370 一样。\n但是现在 Solidworks 官方已经给出类解决方案：\n\nhttps://www.solidworks.com/support/hardware-certification/\n\n下载 SolidWorks_GraphicsCards_Support.msi, 安装就行了。\n\n\n\n\n","categories":["xps"],"tags":["xps","solidworks"]},{"title":"cat-catch 插件调用 N_m3u8DL-RE","url":"/2024/04/04/apps/n_m3u8dl-re_cat-catch/","content":"cat-catch 设置 N_m3u8DL-RE\nref https://github.com/nilaoda/N_m3u8DL-REref https://github.com/xifangczy/cat-catchref https://github.com/corbamico/m3u8dl-invoke/\n\n1.1 电脑安装 n-m3u8dl-re 软件scoop install n-m3u8dl-re_x\n\n1.2 Edge 浏览器安装 cat-catch 插件\nhttps://cat-catch.bmmmd.com/\nhttps://cat-catch.bmmmd.com/docs/m3u8dl\n\n设置 -  N_m3u8DL-RE 的参数：\n&quot;$&#123;url&#125;&quot; --save-dir &quot;%USERPROFILE%\\Downloads\\m3u8dl&quot; --save-name &quot;$&#123;title&#125;_$&#123;now&#125;&quot; $&#123;referer|exists:&#x27;-H &quot;Referer:*&quot;&#x27;&#125; --del-after-done --no-log\n1.3 添加 m3u8dl协议\n使用 https://github.com/xifangczy/URLProtocol 工具。\n下载URLProtocol和N_m3u8DL-RE 并放置在一起。\n打开URLProtocol工具，协议名填写 m3u8dl 点击选择目标程序按钮，选择N_m3u8DL-RE.exe 点击添加。\n\n1.4 添加 m3u8dl协议（另一种方法）\n\n先用 powershell 写一段脚本 n_m3u8dl-re_protocol.ps1 ，然后转换成可执行文件 n_m3u8dl-re_protocol.exe \n\n脚本\n\n# 接收m3u8://xxxxxxparam($m3u8url)Write-Host &quot;m3u8url: $m3u8url&quot;$bs64 = $m3u8url.replace(&#x27;m3u8dl://&#x27;, &#x27;&#x27;).replace(&#x27;/&#x27;, &#x27;&#x27;)$httpurl = [Text.Encoding]::ASCII.GetString([Convert]::FromBase64String($bs64))Write-Host &quot;httpurl: $httpurl&quot;$path = &#x27;c:\\Users\\xxxxx\\scoop\\shims\\N_m3u8DL-re.exe&#x27; $cmd = $path + &#x27; &#x27; + $httpurlWrite-Host &quot;$cmd&quot;Start-Process &quot;$path&quot; &quot;$httpurl&quot; -NoNewWindowStart-Sleep 30\n\n转换\n\nInstall-Module ps2exeps2exe n_m3u8dl-re_protocol.ps1 n_m3u8dl-re_protocol.exe\n\n添加注册表 m3u8dl 协议\nreg add &quot;HKCR\\m3u8dl\\shell\\open\\command&quot; /ve /t REG_SZ /d &quot;C:\\Users\\XXXX\\n_m3u8dl-re_protocol.exe %1&quot; /f# 测试在浏览器输入 &#x27;m3u8dl://&#x27; , 能够打开？ \n\n&#x3D;&#x3D;&#x3D;\n2 N_m3u8DL-RE on Synology2.1 下载&#x2F;安装 N_m3u8DL-REwget https://github.com/nilaoda/N_m3u8DL-RE/releases/download/v0.2.0-beta/N_m3u8DL-RE_Beta_linux-x64_20230628.tar.gz\n\n2.2 设置 ffmpeg 等路径~/N_m3u8DL-RE --del-after-done --binary-merge \\  --ffmpeg-binary-path /var/packages/ffmpeg7/target/bin/ffmpeg7 \\  --tmp-dir /volume2/downloads/ \\  --save-dir /volume2/video \\  -M mp4 https://xxxxxxxxxxxxxxxxxxxxxx.m3u8\n\n2.3 或者 新建 config 文件# N_m3u8DL-RE.cfg--del-after-done --binary-merge --ffmpeg-binary-path /var/packages/ffmpeg7/target/bin/ffmpeg7--tmp-dir /volume2/downloads/--save-dir /volume2/video-M mp4\n\n~/N_m3u8DL-RE @N_m3u8DL-RE.cfg --save-name 1229 https:xxxxxxxxxxxxxxxxxxxxxx.m3u8\n","categories":["apps"],"tags":["N_m3u8DL-RE"]},{"title":"数据可视化：matplotlib color 字符对照","url":"/2024/03/07/sci-matplotlib/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-matplotlib-color-%E5%AD%97%E7%AC%A6%E5%AF%B9%E7%85%A7/","content":"matplotlib marker color 字符对照\nref: https://matplotlib.org/stable/api/colors_api.htmlref: https://matplotlib.org/stable/gallery/color/named_colors.html\n\nimport matplotlib.pyplot as pltimport matplotlib.colors as mcolorsfor (k, v) in mcolors.BASE_COLORS.items():    v = &quot;#&quot; + &quot;&quot;.join(format(round(val * 255), &quot;02x&quot;) for val in v)    print(f&#x27;&lt;font color=&quot;&#123;v&#125;&quot;&gt; &#123;k:&lt;10&#125; ■  &lt;/font&gt;&#x27;)for (k, v) in mcolors.TABLEAU_COLORS.items():    print(f&#x27;&lt;font color=&quot;&#123;v&#125;&quot;&gt; &#123;k:&lt;10&#125; ■ &lt;/font&gt;&#x27;)\nmcolors.BASE_COLORS (8) ████ b           ████ g           ████ r           ████ c           ████ m           ████ y           ████ k           ████ w          \n\n\nmcolors.TABLEAU_COLORS (10) ████ tab:blue    ████ tab:orange  ████ tab:green   ████ tab:red     ████ tab:purple  ████ tab:brown   ████ tab:pink    ████ tab:gray    ████ tab:olive   ████ tab:cyan   \n\n\n\n\nmcolors.CSS4_COLORS (148)\n\nmcolors.XKCD_COLORS (949)\n\ncodeimport mathimport matplotlib.pyplot as pltimport matplotlib.colors as mcolorsfrom matplotlib.patches import Rectangledef plot_colortable(colors, *, ncols=4, sort_colors=True):    cell_width = 212    cell_height = 22    swatch_width = 48    margin = 12    # Sort colors by hue, saturation, value and name.    if sort_colors is True:        names = sorted(            colors, key=lambda c: tuple(mcolors.rgb_to_hsv(mcolors.to_rgb(c))))    else:        names = list(colors)    n = len(names)    nrows = math.ceil(n / ncols)    width = cell_width * ncols + 2 * margin    height = cell_height * nrows + 2 * margin    dpi = 72    fig, ax = plt.subplots(figsize=(width / dpi, height / dpi), dpi=dpi)    fig.subplots_adjust(margin/width, margin/height,                        (width-margin)/width, (height-margin)/height)    ax.set_xlim(0, cell_width * ncols)    ax.set_ylim(cell_height * (nrows-0.5), -cell_height/2.)    ax.yaxis.set_visible(False)    ax.xaxis.set_visible(False)    ax.set_axis_off()    for i, name in enumerate(names):        row = i % nrows        col = i // nrows        y = row * cell_height        swatch_start_x = cell_width * col        text_pos_x = cell_width * col + swatch_width + 7        ax.text(text_pos_x, y, name, fontsize=14,                horizontalalignment=&#x27;left&#x27;,                verticalalignment=&#x27;center&#x27;)        ax.add_patch(            Rectangle(xy=(swatch_start_x, y-9), width=swatch_width,                      height=18, facecolor=colors[name], edgecolor=&#x27;0.7&#x27;)        )    return fig# =========== 1 =================for cl in [mcolors.BASE_COLORS, mcolors.TABLEAU_COLORS, mcolors.CSS4_COLORS, mcolors.XKCD_COLORS]:    print(len(cl))for (k, v) in mcolors.BASE_COLORS.items():    v = &quot;#&quot; + &quot;&quot;.join(format(round(val * 255), &quot;02x&quot;) for val in v)    print(f&#x27;&lt;font color=&quot;&#123;v&#125;&quot;&gt; ████ &#123;k:&lt;10&#125; &lt;/font&gt;&#x27;)for (k, v) in mcolors.TABLEAU_COLORS.items():    print(f&#x27;&lt;font color=&quot;&#123;v&#125;&quot;&gt; ████ &#123;k:&lt;10&#125; &lt;/font&gt;&#x27;)# =========== 2 =================plot_colortable(mcolors.BASE_COLORS, ncols=5, sort_colors=False)# plt.savefig(&#x27;mcolors.BASE_COLORS.png&#x27;, dpi=300)plt.show()plot_colortable(mcolors.TABLEAU_COLORS, ncols=5, sort_colors=False)# plt.savefig(&#x27;mcolors.TABLEAU_COLORS.png&#x27;, dpi=300)plt.show()plot_colortable(mcolors.CSS4_COLORS, ncols=10)# plt.savefig(&#x27;mcolors.CSS4_COLORS.png&#x27;, dpi=300)plt.show()plot_colortable(mcolors.XKCD_COLORS, ncols=10)# plt.savefig(&#x27;mcolors.XKCD_COLORS.png&#x27;, dpi=300)plt.show()\n","categories":["sci"],"tags":["matplotlib"]},{"title":"Win 11 禁用文件夹的文件类型识别","url":"/2024/03/04/apps/Win11-folder/","content":"文件夹禁用文件类型识别文件夹启动时默认会识别该文件夹内的文件类型（比如图片、音乐、视频等媒体文件的信息），媒体文件过多时加载速度较慢。\n可以禁用此功能。\n# 管理员运行运行后重启：reg add &quot;HKCU\\SOFTWARE\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\Bags\\AllFolders\\Shell&quot; /v &quot;FolderType&quot; /t REG_SZ /d &quot;NotSpecified&quot; /f  # 恢复默认：# reg.exe delete &quot;HKCU\\SOFTWARE\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\Bags\\AllFolders\\Shell&quot; /f \n\n","categories":["apps"],"tags":["config"]},{"title":"python f-string 备忘表","url":"/2024/03/03/python/python-f-string/","content":"Python f-string 备忘单\nref https://fstring.help/cheat/\nref https://cheatography.com/brianallan/cheat-sheets/python-f-strings-basics/ref https://cheatography.com/brianallan/cheat-sheets/python-f-strings-number-formatting/\n\n数字\n\n\nnum\nformat\n\n\n\n%d\n整数\n\n\n%e\n科学计数\n\n\n%f\n浮点\n\n\n%\n百分数\n\n\n%b\n二进制\n\n\n%o\n八进制\n\n\n%x\n十六进制\n\n\n%c\nUnicode\n\n\n\n\n\ninteger &#x3D; 123number_ &#x3D; 9876.6789percent &#x3D; 0.98765\n\n\n\n\n\n\nvar\nnum\nformat\nf-string\noutput\n\n\n\ninteger\n123\nd\nf’{integer:d}’\n123\n\n\ninteger\n123\nb\nf’{integer:b}’\n1111011\n\n\ninteger\n123\n8b\nf’{integer:8b}’\n1111011\n\n\ninteger\n123\n_b\nf’{integer:_b}’\n111_1011\n\n\ninteger\n123\n09_b\nf’{integer:09_b}’\n0111_1011\n\n\ninteger\n123\no\nf’{integer:o}’\n173\n\n\ninteger\n123\n#o\nf’{integer:#o}’\n0o173\n\n\ninteger\n123\nx\nf’{integer:x}’\n7b\n\n\ninteger\n123\n#x\nf’{integer:#x}’\n0x7b\n\n\ninteger\n123\n08x\nf’{integer:08x}’\n0000007b\n\n\ninteger\n123\nc\nf’{integer:c}’\n{\n\n\nnumber_\n9876.6789\nf\nf’{number_:f}’\n9876.678900\n\n\nnumber_\n9876.6789\n.2f\nf’{number_:.2f}’\n9876.68\n\n\nnumber_\n9876.6789\n09.2f\nf’{number_:09.2f}’\n009876.68\n\n\nnumber_\n9876.6789\n09.5f\nf’{number_:09.5f}’\n9876.67890\n\n\nnumber_\n9876.6789\n.2f\nf’{number_:.2f}’\n9876.68\n\n\npercent\n0.98765\n%\nf’{percent:%}’\n98.765000%\n\n\npercent\n0.98765\n9.5%\nf’{percent:9.5%}’\n98.76500%\n\n\npercent\n0.98765\n09.4%\nf’{percent:09.4%}’\n098.7650%\n\n\npercent\n0.98765\n09.5%\nf’{percent:09.5%}’\n98.76500%\n\n\nnumber_\n9876.6789\n.2e\nf’{number_:.2e}’\n9.88e+03\n\n\nnumber_\n9876.6789\n09.2e\nf’{number_:09.2e}’\n09.88e+03\n\n\n\n\n\nstring &#x3D; “Python”\n\n\n\n\n\n\nvar\nnum\nformat\nf-string\noutput\n\n\n\nstring\nPython\n20\nf’{string:20}’\nPython\n\n\nstring\nPython\n&gt;20\nf’{string:&gt;20}’\nPython\n\n\nstring\nPython\n&lt;20\nf’{string:&lt;20}’\nPython\n\n\nstring\nPython\n^20\nf’{string:^20}’\nPython\n\n\nstring\nPython\n&gt;&gt;20\nf’{string:&gt;&gt;20}’\n&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Python\n\n\nstring\nPython\n&lt;&lt;20\nf’{string:&lt;&lt;20}’\nPython&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n\n\nstring\nPython\n^^20\nf’{string:^^20}’\n^^^^^^^Python^^^^^^^\n\n\nstring\nPython\n&#x3D;^20\nf’{string:&#x3D;^20}’\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Python&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\n\n\n\n\n\n","categories":["python"],"tags":["python"]},{"title":"python 正则表达式备忘表","url":"/2024/02/03/python/python-regex/","content":"Python 正则表达式备忘表\nref https://regexlearn.com/zh-cn/cheatsheet\n\n\nref https://www.w3schools.com/python/python_regex.asp\n\n\n\n\n\n","categories":["python"],"tags":["python"]},{"title":"放射性核素衰变-radioactivedecay(2)","url":"/2024/01/04/nuclear/Python-%E6%94%BE%E5%B0%84%E6%80%A7%E6%A0%B8%E7%B4%A0%E8%A1%B0%E5%8F%98-radioactivedecay(2)/","content":"radioactivedecay 用于放射性核素衰变的简单分析计算的开源包，支持放射性核素、亚稳态和分支衰变的衰变链。\n\nhttps://github.com/radioactivedecay/radioactivedecay\n\n安装：pip install radioactivedecay\n# %%# ============ (2) ==================import radioactivedecay as rdimport matplotlib.pyplot as plt# 创建一组放射性源项：Inventoryinv = rd.Inventory(&#123;&#x27;U-235&#x27;: 1&#125;, &#x27;Ci&#x27;)inv_t1 = inv.decay(50, &#x27;d&#x27;)print(inv_t1.activities(&#x27;Bq&#x27;))# 绘图 inv.plot(50, &#x27;d&#x27;)inv.plot(50, &#x27;d&#x27;, order=&#x27;alphabetical&#x27;)# %%import radioactivedecay as rdimport matplotlib.pyplot as pltfrom cycler import cyclerplt.rcParams[&quot;font.family&quot;] = &quot;monospace&quot;cm = [&#x27;#1f77b4&#x27;, &#x27;#ff7f0e&#x27;, &#x27;#2ca02c&#x27;, &#x27;#d62728&#x27;, &#x27;#9467bd&#x27;, &#x27;#8c564b&#x27;, &#x27;#e377c2&#x27;, &#x27;#7f7f7f&#x27;, &#x27;#bcbd22&#x27;, &#x27;#17becf&#x27;]ls = [&#x27;-&#x27;, &#x27;--&#x27;]mk = [&#x27;+&#x27;, &#x27;x&#x27;, &#x27;*&#x27;, &#x27;^&#x27;, &#x27;s&#x27;]me = [31, 71, 91, 113, 161]cc = (cycler(color=cm) + cycler(linestyle=ls) * (cycler(marker=mk))) + cycler(markevery=me) * 2DICT = &#123;&#x27;U-235&#x27;: 1e9,        &#x27;Rn-222&#x27;: 1e9&#125;TIME = iter([10, 1])for (hesu, huodu) in DICT.items():    t1 = next(TIME)    inv = rd.Inventory(&#123;hesu: huodu&#125;, &#x27;Bq&#x27;)    inv_t1 = inv.decay(t1, &#x27;d&#x27;)    act_t1 = inv_t1.activities(&#x27;Bq&#x27;)    fig_name = f&#x27;&#123;hesu&#125; @ &#123;huodu:0.2e&#125; Bq&#x27;    fig_note = f&#x27;the Activity after &#123;t1&#125; days of Decay:\\n&#x27;    fig_note += &#x27;\\n&#x27;.join(f&#x27;- &#123;k&#125; &#123;v:.2e&#125; Bq&#x27; for (k, v) in act_t1.items())    print(fig_name, &#x27;\\n&#x27; ,fig_note)    fig0 = plt.figure(figsize=(9, 9))    plt.gca().set_prop_cycle(cc)       fig, ax = inv.plot(t1, &#x27;d&#x27;, yscale=&#x27;log&#x27;, ymin=1e-8, order=&#x27;alphabetical&#x27;, fig=fig0)    plt.title(fig_name)    plt.text(0.3, 0.1, fig_note, transform=ax.transAxes)    plt.grid(True, linestyle=&#x27;:&#x27;, color=&#x27;gray&#x27;, alpha=0.5)    plt.show()    fig.savefig(f&#x27;decay_activity_&#123;hesu&#125;.png&#x27;, dpi=300)\n\n\n\n\n","categories":["python"],"tags":["python","radioactivedecay"]},{"title":"放射性核素衰变-radioactivedecay","url":"/2024/01/04/nuclear/Python-%E6%94%BE%E5%B0%84%E6%80%A7%E6%A0%B8%E7%B4%A0%E8%A1%B0%E5%8F%98-radioactivedecay/","content":"radioactivedecay 用于放射性核素衰变的简单分析计算的开源包，支持放射性核素、亚稳态和分支衰变的衰变链。\n\nhttps://github.com/radioactivedecay/radioactivedecay\n\n安装：pip install radioactivedecay\n#%%import radioactivedecay as rdimport matplotlib.pyplot as plt# 创建一个放射性核素： Nuclidencld = rd.Nuclide(&#x27;U-235&#x27;)half = ncld.half_life(&#x27;readable&#x27;)    # 半衰期prog = ncld.progeny()                # 衰变产物frac = ncld.branching_fractions()    # 占比mode = ncld.decay_modes()            # 衰变射线类型print(ncld, mode, prog, frac, half, sep=&#x27;\\n&#x27;)# 绘制衰变链ncld.plot()#%%# 列出多个核算衰变类型NUCs = [&#x27;U-235&#x27;,        &#x27;Pu-239&#x27;]for name in NUCs:    ncld = rd.Nuclide(name)    half = ncld.half_life(&#x27;readable&#x27;)    prog = ncld.progeny()    frac = ncld.branching_fractions()    mode = ncld.decay_modes()    print(ncld, mode, prog, frac, half, sep=&#x27;\\n&#x27;)    fig, ax = ncld.plot()    fig.savefig(f&#x27;decay_chains_&#123;name&#125;.png&#x27;, dpi=300)\n\n\n\n","categories":["python"],"tags":["python","radioactivedecay"]},{"title":"pandas按条件筛选和设置表格样式","url":"/2023/11/06/sci-pandas/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-pandas%E6%8C%89%E6%9D%A1%E4%BB%B6%E7%AD%9B%E9%80%89/","content":"pandas 按条件筛选和设置表格样式。\n\nhttps://pandas.pydata.org/docs/user_guide/indexing.html#boolean-indexing\nhttps://pandas.pydata.org/docs/reference/style.html#style\n\n\n\n#%%import pandas as pd# df 数据来自 《pandas合并pd.concat-pd.merge》#%%print(&#x27;\\n*** 计算: 对比数据 与 基础 的差 标记： _pd  ***&#x27;)cols = [&#x27;rmse1&#x27;, &#x27;r_2_1&#x27;, &#x27;rmse2&#x27;, &#x27;r_2_2&#x27;, &#x27;rmse3&#x27;, &#x27;r_2_3&#x27;]        for col in cols:        df[col] = df[col] * 100    df[col+&#x27;p&#x27;] = df[col+&#x27;p&#x27;] * 100    df[col+&#x27;_pd&#x27;] = df[col] - df[col+&#x27;p&#x27;]df.head(10)#%%print(&#x27;\\n*** 计算: LSTM模型 与 RNN 的差, 标记： _md  ***&#x27;)for idx, row in df.iterrows():    if row.model==&#x27;LSTM&#x27;:        on1 = df.model    == &#x27;RNN&#x27;        on2 = df.steps    == row.steps        on3 = df.seed     == row.seed        on4 = df.epochs   == row.epochs        on5 = df.out_size == row.out_size                pk = df[on1 &amp; on2 &amp; on3 &amp; on4 &amp; on5]        pk_idx = pk.index[0]                for col in cols:            md = df.loc[idx, col] - df.loc[pk_idx, col]            df.loc[idx, col+&#x27;_md&#x27;] = md# %%colsp = [&#x27;rmse1_pd&#x27;, &#x27;r_2_1_pd&#x27;, &#x27;rmse2_pd&#x27;, &#x27;r_2_2_pd&#x27;, &#x27;rmse3_pd&#x27;, &#x27;r_2_3_pd&#x27;]colsm = [&#x27;rmse1_md&#x27;, &#x27;r_2_1_md&#x27;, &#x27;rmse2_md&#x27;, &#x27;r_2_2_md&#x27;, &#x27;rmse3_md&#x27;, &#x27;r_2_3_md&#x27;]cols1 = [&#x27;rmse1_md&#x27;, &#x27;rmse2_md&#x27;, &#x27;rmse3_md&#x27;]cols2 = [&#x27;r_2_1_md&#x27;, &#x27;r_2_2_md&#x27;, &#x27;r_2_3_md&#x27;]format_dict = &#123;&#x27;delta&#x27;: &#x27;&#123;0:.2%&#125;&#x27;&#125;for col in colsp: format_dict[col] = &#x27;&#123;0:.2%&#125;&#x27;for col in colsm: format_dict[col] = &#x27;&#123;0:.2%&#125;&#x27;def color_map1(val):    color = &#x27;white&#x27;    if val &lt; 0: color = &#x27;lightgreen&#x27;    return f&#x27;background-color: &#123;color&#125;&#x27;def color_map2(val):    color = &#x27;#FFFFFF&#x27;    if val &gt; 0: color = &#x27;lightblue&#x27;    return f&#x27;background-color: &#123;color&#125;&#x27;df.style.format(format_dict)\\        .highlight_between(left=-0.05,right=0.05, subset=colsp)\\        .applymap(color_map1, subset=[&#x27;rmse1_md&#x27;, &#x27;rmse2_md&#x27;, &#x27;rmse3_md&#x27;])\\        .applymap(color_map2, subset=[&#x27;r_2_1_md&#x27;, &#x27;r_2_2_md&#x27;, &#x27;r_2_3_md&#x27;])","categories":["sci"],"tags":["pandas"]},{"title":"pandas合并pd.concat-pd.merge","url":"/2023/11/01/sci-pandas/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-pandas%E5%90%88%E5%B9%B6pd.concat-pd.merge/","content":"pandas 合并数据常用的两个函数：\n\npd.concat https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\n\npd.merge https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.merge.html\n\n\n刚好有一个对比 RNN 和 LSTM 神经网络运行结果的场景分别用到了这两个函数：\n\n采用 concat 合并两个csv表； csv表为两次运行结果的，列名基本一致。\n采用 merge 合并模型运行条件类似的表， 用于对比数据\n\n\n\n#%%import pandas as pdimport iopd.set_option(&#x27;display.width&#x27;, 1000)pd.set_option(&#x27;display.max_rows&#x27;, 500)pd.set_option(&#x27;display.max_columns&#x27;, 500)# -------------print(&#x27;*** 基础数据 ***&#x27;)res1_csv = &#x27;&#x27;&#x27;model,steps,out_size,seed,epochs,rmse1p,r_2_1p,rmse2p,r_2_2p,rmse3p,r_2_3pRNN,24,2,0,0,0.1131,0.8846,0.1681,0.7449,,RNN,48,2,0,0,0.1119,0.8871,0.1694,0.7412,,LSTM,24,2,0,0,0.1108,0.8894,0.166,0.7514,,LSTM,48,2,0,0,0.1109,0.8892,0.1661,0.7511,,RNN,24,3,0,0,0.1157,0.8797,0.1629,0.76,0.1978,0.6471RNN,48,3,0,0,0.1159,0.8792,0.162,0.7628,0.1982,0.6455LSTM,24,3,0,0,0.1126,0.886,0.1584,0.7732,0.1926,0.6653LSTM,48,3,0,0,0.1125,0.8863,0.1587,0.7723,0.1933,0.6629&#x27;&#x27;&#x27;df_res1 = pd.read_csv(io.StringIO(res1_csv))print(df_res1)#%%# -------------print(&#x27;\\n*** 对比数据 ***&#x27;)res2_csv = &#x27;&#x27;&#x27;model,steps,seed,epochs,rmse1,r_2_1,rmse2,r_2_2LSTM,24,1,50,0.1110,0.8890,0.1661,0.7512LSTM,24,2,50,0.1109,0.8892,0.1658,0.7520LSTM,24,3,50,0.1118,0.8874,0.1667,0.7494LSTM,24,4,50,0.1109,0.8891,0.1666,0.7496LSTM,24,5,50,0.1127,0.8855,0.1662,0.7507LSTM,24,6,50,0.1107,0.8896,0.1659,0.7518LSTM,24,7,50,0.1110,0.8889,0.1659,0.7516LSTM,24,8,50,0.1119,0.8872,0.1667,0.7493LSTM,24,9,50,0.1109,0.8892,0.1657,0.7523LSTM,48,1,50,0.1110,0.8891,0.1663,0.7504LSTM,48,2,50,0.1106,0.8897,0.1658,0.7520LSTM,48,3,50,0.1120,0.8869,0.1671,0.7481LSTM,48,4,50,0.1117,0.8876,0.1677,0.7464LSTM,48,5,50,0.1110,0.8890,0.1662,0.7508LSTM,48,6,50,0.1145,0.8819,0.1683,0.7445LSTM,48,7,50,0.1113,0.8883,0.1676,0.7467LSTM,48,8,50,0.1106,0.8898,0.1665,0.7499LSTM,48,9,50,0.1107,0.8896,0.1657,0.7524RNN,24,1,50,0.1219,0.8660,0.1723,0.7321RNN,24,2,50,0.1114,0.8882,0.1674,0.7471RNN,24,3,50,0.1139,0.8830,0.1675,0.7468RNN,24,4,50,0.1106,0.8898,0.1678,0.7461RNN,24,5,50,0.1145,0.8818,0.1738,0.7275RNN,24,6,50,0.1134,0.8842,0.1677,0.7463RNN,24,7,50,0.1164,0.8778,0.1694,0.7412RNN,24,8,50,0.1121,0.8867,0.1711,0.7358RNN,24,9,50,0.1104,0.8901,0.1668,0.7490RNN,48,1,50,0.1121,0.8868,0.1682,0.7447RNN,48,2,50,0.1134,0.8842,0.1657,0.7524RNN,48,3,50,0.1122,0.8865,0.1678,0.7459RNN,48,4,50,0.1123,0.8864,0.1673,0.7476RNN,48,5,50,0.1146,0.8817,0.1694,0.7411RNN,48,6,50,0.1185,0.8735,0.1722,0.7325RNN,48,7,50,0.1122,0.8865,0.1725,0.7317RNN,48,8,50,0.1175,0.8756,0.1752,0.7231RNN,48,9,50,0.1130,0.8849,0.1662,0.7509&#x27;&#x27;&#x27;df_res2 = pd.read_csv(io.StringIO(res2_csv))df_res2[&#x27;out_size&#x27;] = 2res3_csv = &#x27;&#x27;&#x27;model,steps,seed,epochs,rmse1,r_2_1,rmse2,r_2_2,rmse3,r_2_3LSTM,24,1,50,0.114,0.8833,0.1588,0.7721,0.1937,0.6615LSTM,24,2,50,0.1126,0.8861,0.1588,0.7721,0.1928,0.6648LSTM,24,3,50,0.1138,0.8835,0.1585,0.7728,0.1931,0.6637LSTM,24,4,50,0.1124,0.8864,0.1583,0.7735,0.1925,0.6657LSTM,24,5,50,0.1131,0.8851,0.1581,0.7741,0.1922,0.6667LSTM,24,6,50,0.1126,0.886,0.159,0.7715,0.1931,0.6636LSTM,24,7,50,0.1129,0.8854,0.16,0.7684,0.1942,0.6599LSTM,24,8,50,0.1121,0.887,0.1583,0.7734,0.1931,0.6635LSTM,24,9,50,0.1126,0.8861,0.1584,0.7732,0.193,0.6639LSTM,48,1,50,0.1119,0.8874,0.1578,0.7748,0.1928,0.6646LSTM,48,2,50,0.1124,0.8865,0.1592,0.771,0.1948,0.6577LSTM,48,3,50,0.1131,0.8851,0.1588,0.772,0.1932,0.6634LSTM,48,4,50,0.1127,0.8858,0.158,0.7742,0.193,0.6639LSTM,48,5,50,0.1124,0.8865,0.1583,0.7735,0.1932,0.6632LSTM,48,6,50,0.1122,0.8869,0.1585,0.773,0.1933,0.663LSTM,48,7,50,0.1135,0.8842,0.1599,0.7688,0.1934,0.6626LSTM,48,8,50,0.1121,0.887,0.158,0.7744,0.1932,0.6632LSTM,48,9,50,0.1132,0.8848,0.1591,0.7711,0.193,0.6639RNN,24,1,50,0.1175,0.876,0.1597,0.7694,0.195,0.657RNN,24,2,50,0.1153,0.8804,0.1597,0.7693,0.1946,0.6584RNN,24,3,50,0.1176,0.8757,0.159,0.7714,0.1951,0.6567RNN,24,4,50,0.1144,0.8823,0.159,0.7715,0.1949,0.6572RNN,24,5,50,0.1146,0.8819,0.1599,0.769,0.196,0.6533RNN,24,6,50,0.1168,0.8774,0.1611,0.7653,0.1954,0.6556RNN,24,7,50,0.1192,0.8723,0.1594,0.7702,0.194,0.6604RNN,24,8,50,0.1154,0.8803,0.1591,0.7712,0.1942,0.6599RNN,24,9,50,0.1152,0.8806,0.1609,0.7659,0.1955,0.6551RNN,48,1,50,0.116,0.879,0.1611,0.7653,0.1985,0.6445RNN,48,2,50,0.113,0.8853,0.161,0.7657,0.1957,0.6544RNN,48,3,50,0.115,0.8812,0.1589,0.7716,0.195,0.6568RNN,48,4,50,0.1131,0.8851,0.159,0.7715,0.1945,0.6589RNN,48,5,50,0.1141,0.883,0.1599,0.769,0.1953,0.6558RNN,48,6,50,0.1156,0.8799,0.1596,0.7698,0.1952,0.6561RNN,48,7,50,0.1169,0.8773,0.1626,0.761,0.1967,0.6508RNN,48,8,50,0.1213,0.8678,0.1605,0.7672,0.1946,0.6583RNN,48,9,50,0.1132,0.8848,0.1587,0.7723,0.1943,0.6594&#x27;&#x27;&#x27;df_res3 = pd.read_csv(io.StringIO(res3_csv))df_res3[&#x27;out_size&#x27;] = 3print(df_res2)print(df_res3)#%%# concat# res2、res3 分别为两次运行结果的# 由于res3 比 res2 多两列， 合并后 res2 会有两列缺失的数据。print(&#x27;\\n*** 合并对比数据 Nx2 Nx3 ***&#x27;)df_res = pd.concat((df_res2, df_res3)).reset_index(drop=True)df_res# 将列重新排序df_res = df_res[[&#x27;model&#x27;, &#x27;steps&#x27;, &#x27;out_size&#x27;, &#x27;seed&#x27;, &#x27;epochs&#x27;,                  &#x27;rmse1&#x27;, &#x27;r_2_1&#x27;, &#x27;rmse2&#x27;, &#x27;r_2_2&#x27;, &#x27;rmse3&#x27;, &#x27;r_2_3&#x27;]]# print(df_res.columns)df_res#%%# merge# 这里将res 与 res1 按照模型、步长、输出等条件进行合并# 会产生扩展的列，不需要的列一并删掉print(&#x27;\\n*** 拼接结果 ***&#x27;)df = pd.merge(df_res, df_res1, how=&#x27;outer&#x27;,               on=[&#x27;model&#x27;, &#x27;steps&#x27;, &#x27;out_size&#x27;],               suffixes=(&#x27;&#x27;, &#x27;_DROP&#x27;)).filter(regex=&#x27;^(?!.*_DROP)&#x27;)df.info()df = df.fillna(0)df.head(10)","categories":["sci"],"tags":["pandas"]},{"title":"Win10-WSL-Ubuntu22.04-openmc 安装与配置","url":"/2023/10/12/wsl/wsl-ubuntu-openmc/","content":"一、WSL 安装 Ubuntu22.04\n启用 WSL\n\n打开 Microsoft Store，安装 Ubuntu22.04\n\n设置源，更新ref： https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/\n\n\n更新：sudo apt update\n升级：sudo apt upgrade\n\n安装 ZSH、oh-my-zsh\n\n参考 zsh &amp; oh-my-zsh 安装配置 \n二、安装 openmc with condaref： https://docs.openmc.org/en/stable/quickinstall.html\n\n参照 Installing on Linux&#x2F;Mac with Conda，安装 openmc。\n\n# https://www.anaconda.com/docs/getting-started/miniconda/install#linux# 安装 minicondawget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.shbash ~/Miniconda3-latest-Linux-x86_64.sh# 安装 openmcconda config --add channels conda-forgeconda config --set channel_priority strictconda create --name openmc-env openmcconda activate openmc-env\n\n安装完成后，运行 openmc 试一下, 提示错误： 找不到材料数据卡 cross_sections.xml。\n\n下载材料数据集\n\ngit clone https://github.com/openmc-dev/data openmc-dev_datacd openmc-dev_datapython3 convert_nndc71.py\n\n\n材料库数据集目录如下：\n.├── LICENSE├── README.md├── combine_libraries.py├── convert_fendl.py├── convert_jeff32.py├── convert_jeff33.py├── convert_lib80x.py├── convert_mcnp70.py├── convert_mcnp71.py├── convert_nndc71.py  ### 下载脚本， ENDF/B-VII.1├── convert_tendl.py├── convert_tendl_rand.py├── depletion│   └── ...├── generate_cendl.py├── generate_endf.py├── generate_jeff33.py├── generate_jendl.py├── make_compton.py├── make_stopping_powers.py├── make_test_data.py├── nndc-b7.1-ace│   ├── ENDF-B-VII.1-neutron-293.6K│   │   ├── Ac_225_293.6K.ace│   │   ├── Ac_226_293.6K.ace│   │   ...│   │   ├── Zr_095_293.6K.ace│   │   ├── Zr_096_293.6K.ace│   │   └── xsdir│   ├── al.acer│   ├── be.acer│   ...│   └── zrzrh.acer├── nndc-b7.1-download    ### 下载的源文件│   ├── neutron│   │   ├── ENDF-B-VII.1-neutron-293.6K.tar.gz│   │   └── ENDF-B-VII.1-tsl.tar.gz│   └── photon│       ├── ENDF-B-VII.1-atomic_relax.zip│       └── ENDF-B-VII.1-photoat.zip├── nndc-b7.1-endf│   ├── atomic_relax│   │   ├── atom-001_H_000.endf│   │   ├── atom-002_He_000.endf│   │   ...│   │   ├── atom-099_Es_000.endf│   │   └── atom-100_Fm_000.endf│   └── photoat│       ├── photoat-001_H_000.endf│       ├── photoat-002_He_000.endf│       ...│       ├── photoat-099_Es_000.endf│       └── photoat-100_Fm_000.endf├── nndc-b7.1-hdf5│   ├── cross_sections.xml    ### 转换生成的材料卡，以后主要就是调用这个│   ├── neutron│   │   ├── Ac225.h5│   │   ├── Ac226.h5│   │   ...│   │   ├── c_para_D.h5│   │   └── c_para_H.h5│   └── photon│       ├── Ac.h5│       ├── Ag.h5│       ...│       ├── Zn.h5│       └── Zr.h5├── sample_sandy.py└── utils.py\n\n\n把 cross_sections.xml 的路径加入环境变量，或直接在openmc程序中设置：\n# code /home/xxxx/.local/lib/python3.10/site-packages/openmc/config.pyconfig[&#x27;cross_sections&#x27;] = &quot;/home/xxxx/openmc-dev_data/nndc-b7.1-hdf5/cross_sections.xml&quot;\n\n\ndone.\n\n","categories":["WSL"],"tags":["Ubuntu","WSL","openmc"]},{"title":"使用 scoop 安装管理 windows 软件（4）：安装包解压密码","url":"/2023/07/23/scoop/%E4%BD%BF%E7%94%A8scoop%E5%AE%89%E8%A3%85%E7%AE%A1%E7%90%86windows%E8%BD%AF%E4%BB%B6(4)-%E5%AE%89%E8%A3%85%E5%8C%85%E8%A7%A3%E5%8E%8B%E5%AF%86%E7%A0%81/","content":"ref: https://github.com/ScoopInstaller/Scoop/issues/4390\n0. 问题： scoop 本身不支持安装包有解压密码的自动解压。scoop 本身不支持安装包有解压密码的自动解压。因此在安装 MAS 时会卡在解压处，无法继续安装。\n1. 7z 命令手册7z 命令是支持的： 7z x FILENAME.7z -pPWD -oOUTDIR\n2. 查 Scoop 源码的解压函数找到 Scoop 源码里的 “~\\scoop\\apps\\scoop\\current\\lib\\decompress.ps1” 文件。文件封装了 Expand-7zipArchive 函数命令， 但参数没有能将密码传入的方法。\n3. 试 Scoop 的 pre_installScoop Wiki 里提到了 pre_install 等说法。\n在 MAS.json 中加入：\n&quot;pre_install&quot;: &quot;7z x $dir\\\\$fname -p1234 $(&#x27;-o&#x27; + $dir)&quot;，\n尝试了很多次还是不起作用，Scoop的策略是遇到压缩包先执行解压、再做后续的事情。所以这一句不会被执行，安装程序依旧卡在解压处，无法继续安装。\n\n\n\ngithub 也有类似问题：ref: https://github.com/ScoopInstaller/Scoop/issues/4390JourneyOver commented on Sep 27, 2022\n Does this no longer work? I&#39;ve tried multiple different things of trying to set it to install / pre_install and neither seem to actually work, looking at task manager it seems that it&#39;s not actually calling 7-zip at all with the password and instead just defaulting to trying to extract the file without the password at all.does extract_dir or extract_to support password any? as looking at https://scoop-docs.vercel.app/docs/concepts/App-Manifests.html#a-simple-example doesn&#39;t seem to show an example with &gt; password protect files at all.\nniheaven commented on Sep 27, 2022\nUse Expand-7zipArchive and pass arguments, sorry the password has not been supported in manifest.\nJourneyOver commented on Sep 28, 2022\nSo I actually figured out the situation, whenever the url ends in either .zip/.rar or any other rared typed of extension, it&#39;ll always throw the default extraction method, no matter the pre_install or installer stuff.. solution is just to append random bit at end that isn’t .zip&#x2F;.rar or other rar type of extensions and then it’ll extract the file correctly with the installer or pre_install bits.&#96;\nniheaven commented on Sep 28, 2022\nSo I actually figured out the situation, whenever the url ends in either .zip/.rar or any other rared typed of extension, it&#39;ll always throw the default extraction method, no matter the pre_install or installer stuff.. solution is just to append random bit at end that isn&#39;t .zip/.rar or other rar type of extensions and then it&#39;ll extract the file correctly with the installer or pre_install bits.\n\n4. 解决办法下载时将文件后缀改为不是压缩包的格式，将 url 后面加上 #dl.7z_ , 下载完成后缀名就变成了 .7z_。\nScoop 的安装程序就不会自动执行默认的解压程序 Expand-7zipArchive ； 这样 pre_install 命令就可以正常工作。 \n修改后的安装配置文件：\nmas_x.json\n&#123;    &quot;version&quot;: &quot;1.7&quot;,    &quot;description&quot;: &quot;Microsoft-Activation-Scripts https://massgrave.dev&quot;,    &quot;homepage&quot;: &quot;https://github.com/massgravel/Microsoft-Activation-Scripts&quot;,    &quot;url&quot;: &quot;https://github.com/massgravel/Microsoft-Activation-Scripts/releases/download/1.7/MAS_1.7_Password_1234.7z#dl.7z_&quot;,    &quot;hash&quot;: &quot;852946f630a25b46f9fcbf34b777f57aacfe10036ba0d7e9e919385c510c212e&quot;,    &quot;bin&quot;: &quot;All-In-One-Version\\\\MAS_AIO.cmd&quot;,    &quot;shortcuts&quot;: [        [            &quot;All-In-One-Version\\\\MAS_AIO.cmd&quot;,            &quot;MAS_AIO&quot;        ]    ],    &quot;pre_install&quot;:[        &quot;$zip=(Get-ChildItem $dir\\\\MAS_*).Name&quot;,        &quot;7z x $dir\\\\$zip -p1234 $(&#x27;-o&#x27; + $dir) | Out-Null&quot;,        &quot;Move-Item $dir\\\\MAS_$version\\\\* $dir&quot;    ],    &quot;post_install&quot;: [        &quot;Remove-Item $dir\\\\*dl.7z_ -Force&quot;,        &quot;Remove-Item $dir\\\\MAS_$version -Force -Recurse&quot;    ],    &quot;checkver&quot;: &#123;        &quot;github&quot;: &quot;https://github.com/massgravel/Microsoft-Activation-Scripts&quot;    &#125;,    &quot;autoupdate&quot;: &#123;        &quot;url&quot;: &quot;https://github.com/massgravel/Microsoft-Activation-Scripts/releases/download/$version/MAS_$version_Password_1234.7z&quot;    &#125;&#125;","categories":["apps"],"tags":["scoop"]},{"title":"ESP8266 定时开关 [Micropython]","url":"/2023/07/22/esp8266/ESP8266%20Switch%20Micropython/","content":"0. 引脚表引脚如下图所示：\n\n\n\n\n\n\n\n注意：开机之后有的引脚是默认上电的!!!https://zhuanlan.zhihu.com/p/568057038https://www.yiboard.com/thread-1834-1-1.html\n\n1. 定时开关from machine import Pinimport networkimport timeimport ntptimeimport uasyncio as asyncio# === 0. wifi config ==========================ssid = &#x27;xxxx&#x27;pswd = &#x27;cccc&#x27;led = Pin(2, Pin.OUT)led.on()async def wifi_connect():    while True:        try:            wlan = network.WLAN(network.STA_IF)            wlan.active(True)            wlan.connect(ssid, pswd)            status = wlan.ifconfig()            print(&#x27;wifi=&#123;&#125;  ip=&#123;&#125;&#x27;.format(ssid, status[0]))            print(time.localtime(), &#x27;wifi time&#x27;)            led.off()            await asyncio.sleep(300)                    except Exception as e:            led.on()            print(&#x27;ERROR&#x27;, e)# === 1. ntp update ==========================async def ntp_update():    while True:        try:            # https://www.pool.ntp.org/zone/cn            ntptime.host = &#x27;cn.pool.ntp.org&#x27;            ntptime.settime()            now = time.localtime(time.time() + 8*3600)            print(now, ntptime.host)            led.off()            await asyncio.sleep(300)                    except Exception as e:            led.on()            print(&#x27;ERROR&#x27;, e)# === 2. light control ==========================light = Pin(5, Pin.OUT)light.on()async def led_control():    while True:        try:            now = time.localtime(time.time() + 8*3600)            hh, mm, ss = now[3], now[4], now[5]                        if hh not in range(7, 22):                light.on()            else:                light.off()                        await asyncio.sleep(3)                    except Exception as e:            print(&#x27;ERROR&#x27;, e)loop = asyncio.get_event_loop()loop.create_task(wifi_connect())loop.create_task(ntp_update())loop.create_task(led_control())loop.run_forever()","categories":["ESP8266"],"tags":["ESP8266","Micropython"]},{"title":"ESP8266 Micropython 配置","url":"/2023/07/17/esp8266/ESP8266%20Micropython%20config/","content":"板子型号：ESP-12E\n0. 安装 windows 驱动：CP2102\nhttps://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers?tab=downloads\nCP210x_Universal_Windows_Driver\n\n1. 安装 esptoolpip install esptool# usb 连接电脑，# &quot;我的电脑&quot;-&gt;&quot;管理&quot;-&gt;&quot;设备管理器&quot;-&gt;&quot;端口&quot;# 检查端口号esptool chip_id \n\n\n\n\n2. 刷入固件\nhttps://micropython.org/download/esp8266/\nesp8266-20210618-v1.16.bin\n\nesptool --port COM3 erase_flashesptool --port COM3 --baud 115200 write_flash --flash_size=detect 0 esp8266-20230426-v1.20.0.bin \n\n2. 刷入固件（Thonny）安装 Thonny， scoop install thonny\nThonny 对 Micropython 的支持也挺好的，可以当作代码编辑器。\n3. Led 测试板载 LED 的编号是 2， 测试一下。\nfrom machine import Pinled = Pin(2, Pin.OUT)  # 对应板子上的引脚编号是 D4led.off()              # 亮灯，你们看错，是相反的!#led.on()               # 灭灯\n\n板载LED 亮灭的逻辑是反向的GPIO2 为高电平时，LED 熄灭；GPIO2 低电平时，LED 亮起。\n注意：开机之后有的引脚是默认上电的!!!\n\n","categories":["ESP8266"],"tags":["ESP8266","Micropython"]},{"title":"群晖 VSCode Remote 配置","url":"/2023/07/16/synology/%E7%BE%A4%E6%99%96-vscoderemote%E9%85%8D%E7%BD%AE/","content":"1. 客户端 VSCode 安装 Remote 插件安装插件, 略\n添加远程连接 aaa@192.168.1.xxx， 连接、等待， 输入密码\n2. 连接时可能连不上，并出现警告\n警告： The remote host may not meet VS Code Server&#39;s prerequisitesfor glibc and libstdc++\n\n\n\n\n\n这个警告实际上不用管它。我在这个问题上卡了很久。。。\n3. 连不上的真实原因原因：群晖考虑安全性默认禁止了TCP转发，即配置文件里AllowTcpForwarding的默认值为: “no”\n解决方法： 通过ssh 连接群晖， 编辑 /etc/ssh/sshd_config 文件，修改：\n# AllowTcpForwarding no  AllowTcpForwarding yes\n保存后重启群晖。\n","categories":["synology"],"tags":["vscode","synology"]},{"title":"日历：从在线日历获取事件","url":"/2023/07/12/office/%E6%97%A5%E5%8E%86%EF%BC%9A%E4%BB%8E%E5%9C%A8%E7%BA%BF%E6%97%A5%E5%8E%86%E8%8E%B7%E5%8F%96%E4%BA%8B%E4%BB%B6/","content":"从在线日历获取事件Outlook 查看日历链接： 设置-日历-共享日历-发布日历，可以看到如下链接：\n“https://outlook.live.com/owa/calendar/d82e6afe-XXXX-XXXX/cid-YYYY/calendar.ics“\nfrom ics import Calendarimport requests # Parse the URLurl = &quot;https://outlook.live.com/owa/calendar/d82e6afe--XXXX-XXXX/cid-YYYY/calendar.ics&quot;cal = Calendar(requests.get(url).text)#%%# Print all the eventsevents = sorted(cal.events)for event in events:    print(event.begin , event.name )#%%timeline = cal.timelinefor tl in timeline:    print(tl.begin , tl.name )# %%# 获取今天及之后的事件from ics import Calendarimport requestsimport arrowcal = Calendar(requests.get(url).text)today = arrow.now()print(today)today = arrow.now().replace(hour=0, minute=0, second=0, microsecond=0)print(today)today = arrow.now().span(&#x27;day&#x27;)[0]print(today)evts = cal.timeline.start_after(today)for evt in evts:    print(evt.begin.strftime(&quot;%Y-%m-%d %a %H:%M&quot;), evt.name )\n","categories":["office"],"tags":["calendar"]},{"title":"使用 scoop 安装管理 windows 软件（3）：自己制作一个安装配置文件","url":"/2023/02/23/scoop/%E4%BD%BF%E7%94%A8scoop%E5%AE%89%E8%A3%85%E7%AE%A1%E7%90%86windows%E8%BD%AF%E4%BB%B6(3)-%E8%87%AA%E5%B7%B1%E5%81%9A%E4%B8%80%E4%B8%AA%E5%AE%89%E8%A3%85%E6%96%87%E4%BB%B6/","content":"\nref: (https://github.com/ScoopInstaller/Scoop/wiki/App-Manifests)\n\n尝试自己制作一个安装配置文件， 软件是 N_m3u8DL-RE。\n&#123;    &quot;version&quot;: &quot;v0.2.0-beta&quot;,    &quot;description&quot;: &quot;Cross-Platform, modern and powerful stream downloader for MPD/M3U8/ISM&quot;,    &quot;homepage&quot;: &quot;https://github.com/nilaoda/N_m3u8DL-RE&quot;,    &quot;license&quot;: &quot;MIT&quot;,    &quot;suggest&quot;: &#123;        &quot;ffmpeg&quot;: [            &quot;ffmpeg&quot;,            &quot;ffmpeg-nightly&quot;        ]    &#125;,    &quot;url&quot;: &quot;https://github.com/nilaoda/N_m3u8DL-RE/releases/download/v0.2.0-beta/N_m3u8DL-RE_Beta_win-x64_20230628.zip&quot;,    &quot;hash&quot;: &quot;9e3133f03e112cc57f34bf04234b7857ae7c997c214f0eb510a120739c388652&quot;,    &quot;bin&quot;: [        &quot;N_m3u8DL-RE_Beta_win-x64/N_m3u8DL-RE.exe&quot;,        [            &quot;N_m3u8DL-RE.exe&quot;,            &quot;N_m3u8DL_RE&quot;        ]    ],    &quot;checkver&quot;: &#123;        &quot;url&quot;: &quot;https://api.github.com/repos/nilaoda/N_m3u8DL-RE/releases&quot;,        &quot;regex&quot;: &quot;releases/download/(?&lt;tag&gt;[vV]?[\\\\w-.]+)/N_m3u8DL-RE_Beta_win-x64_(?&lt;date&gt;[\\\\d.-]+).zip&quot;,        &quot;replace&quot;: &quot;$&#123;tag&#125;&quot;    &#125;,    &quot;autoupdate&quot;: &#123;        &quot;url&quot;: &quot;https://github.com/nilaoda/N_m3u8DL-RE/releases/download/$matchTag/N_m3u8DL-RE_Beta_win-x64_$matchDate.zip&quot;    &#125;&#125;\n\n\n参数说明：\n\nurl: 下载地址\n\nhash: 可缺省。 要添加的话： aria2 下载后会有输出，复制过来。 \n\nbin: 可执行文件的相对路径，根目录是 ~\\scoop\\apps\\XXXX\\current\\\n\ncheckver: 可缺省。 \n\nautoupdate: 可缺省。这两项原理也搞不清楚，看其他类似软件的配置文件做相对应修改。\n\n\n","categories":["apps"],"tags":["scoop"]},{"title":"zsh & oh-my-zsh 安装配置","url":"/2023/02/03/wsl/oh-my-zsh/","content":"1 安装 zshsudo apt install zsh# echo $SHELL           # 显示当前 shell 类型# cat /etc/shells       # 显示可使用的 shell# chsh -s /bin/zsh      # 将 zsh 设为默认终端\n2 安装 ohmyzshref: https://ohmyz.sh/\n\n用 wget 安装。\n\nsh -c &quot;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)&quot;\n\n\n有时候会出现 443 网路错误，可手动下载、安装 install.sh\nnano zsh-install.sh\n打开 https://github.com/ohmyzsh/ohmyzsh/blob/master/tools/install.sh将安装代码全部复制进去\nsudo chmod +x zsh-install.sh./zsh-install.sh\n3 安装 ohmyzsh （gitee 源）ref: https://gitee.com/mirrors/oh-my-zsh.git\nsh -c &quot;$(wget https://gitee.com/mirrors/oh-my-zsh/raw/master/tools/install.sh -O -)&quot;\n\n4 配置 ohmyzsh （gitee 源）\n打开配置文件\n\nnano ~/.zshrc\n\n\n修改如下：\n\n# 主题ZSH_THEME=&quot;ys&quot;# 插件plugins=(git zsh-autosuggestions zsh-syntax-highlighting )\n\n也可以用命令修改：\n\nsed -i &#x27;s/^ZSH_THEME=.*/ZSH_THEME=&quot;ys&quot;/g&#x27; .zshrcsed -i &#x27;s/^plugins=.*/plugins=(git zsh-autosuggestions zsh-syntax-highlighting)/g&#x27; .zshrc\n\n\n\n下载插件\n\ngit clone https://gitee.com/mirrors/zsh-autosuggestions $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-autosuggestionsgit clone https://gitee.com/mirrors/zsh-syntax-highlighting $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlighting\nref: https://github.com/zsh-users/zsh-autosuggestions\nref: https://github.com/zsh-users/zsh-syntax-highlighting\n\n加载配置文件， 使生效\n\nsource ~/.zshrc\n\n&#x3D;&#x3D;&#x3D;\nsudo apt install zsh -ysudo apt install git -ysh -c &quot;$(wget https://gitee.com/mirrors/oh-my-zsh/raw/master/tools/install.sh -O -)&quot;sed -i &#x27;s/^ZSH_THEME=.*/ZSH_THEME=&quot;ys&quot;/g&#x27; .zshrcsed -i &#x27;s/^plugins=.*/plugins=(git zsh-autosuggestions zsh-syntax-highlighting)/g&#x27; .zshrcgit clone https://gitee.com/mirrors/zsh-autosuggestions $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-autosuggestionsgit clone https://gitee.com/mirrors/zsh-syntax-highlighting $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlightingsource ~/.zshrc\n\n&#x3D;&#x3D;&#x3D;\n# Clean, simple, compatible and meaningful.# Tested on Linux, Unix and Windows under ANSI colors.# It is recommended to use with a dark background.# Colors: black, red, green, yellow, *blue, magenta, cyan, and white.## Mar 2013 Yad Smood# VCSYS_VCS_PROMPT_PREFIX1=&quot; %&#123;$reset_color%&#125;on%&#123;$fg[blue]%&#125; &quot;YS_VCS_PROMPT_PREFIX2=&quot;:%&#123;$fg[cyan]%&#125;&quot;YS_VCS_PROMPT_SUFFIX=&quot;%&#123;$reset_color%&#125;&quot;YS_VCS_PROMPT_DIRTY=&quot; %&#123;$fg[red]%&#125;x&quot;YS_VCS_PROMPT_CLEAN=&quot; %&#123;$fg[green]%&#125;o&quot;# Git infolocal git_info=&#x27;$(git_prompt_info)&#x27;ZSH_THEME_GIT_PROMPT_PREFIX=&quot;$&#123;YS_VCS_PROMPT_PREFIX1&#125;\\ue0a0&quot;ZSH_THEME_GIT_PROMPT_SUFFIX=&quot;$YS_VCS_PROMPT_SUFFIX&quot;ZSH_THEME_GIT_PROMPT_DIRTY=&quot;$YS_VCS_PROMPT_DIRTY&quot;ZSH_THEME_GIT_PROMPT_CLEAN=&quot;$YS_VCS_PROMPT_CLEAN&quot;# SVN infolocal svn_info=&#x27;$(svn_prompt_info)&#x27;ZSH_THEME_SVN_PROMPT_PREFIX=&quot;$&#123;YS_VCS_PROMPT_PREFIX1&#125;svn$&#123;YS_VCS_PROMPT_PREFIX2&#125;&quot;ZSH_THEME_SVN_PROMPT_SUFFIX=&quot;$YS_VCS_PROMPT_SUFFIX&quot;ZSH_THEME_SVN_PROMPT_DIRTY=&quot;$YS_VCS_PROMPT_DIRTY&quot;ZSH_THEME_SVN_PROMPT_CLEAN=&quot;$YS_VCS_PROMPT_CLEAN&quot;# HG infolocal hg_info=&#x27;$(ys_hg_prompt_info)&#x27;ys_hg_prompt_info() &#123;        # make sure this is a hg dir        if [ -d &#x27;.hg&#x27; ]; then                echo -n &quot;$&#123;YS_VCS_PROMPT_PREFIX1&#125;hg$&#123;YS_VCS_PROMPT_PREFIX2&#125;&quot;                echo -n $(hg branch 2&gt;/dev/null)                if [[ &quot;$(hg config oh-my-zsh.hide-dirty 2&gt;/dev/null)&quot; != &quot;1&quot; ]]; then                        if [ -n &quot;$(hg status 2&gt;/dev/null)&quot; ]; then                                echo -n &quot;$YS_VCS_PROMPT_DIRTY&quot;                        else                                echo -n &quot;$YS_VCS_PROMPT_CLEAN&quot;                        fi                fi                echo -n &quot;$YS_VCS_PROMPT_SUFFIX&quot;        fi&#125;# VirtualenvVIRTUAL_ENV_DISABLE_PROMPT=1local py_versionif  [[ -n &quot;$VIRTUAL_ENV&quot; ]] ; then    py_version=$&#123;(@)$(python -V 2&gt;&amp;1)[2]&#125;filocal venv_info=&#x27;$(virtualenv_prompt_info)&#x27;virtualenv_prompt_info()&#123;    [[ -n $&#123;VIRTUAL_ENV&#125; ]] || return    echo &quot;($&#123;VIRTUAL_ENV:t:gs/%/%%&#125; \\ue235 $&#123;py_version&#125;)&quot;&#125;local exit_code=&quot;%(?,,C:%&#123;$fg[red]%&#125;%?%&#123;$reset_color%&#125;)&quot;# Prompt format:## PRIVILEGES USER @ MACHINE in DIRECTORY on git:BRANCH STATE [TIME] C:LAST_EXIT_CODE# $ COMMAND## For example:## % ys @ ys-mbp in ~/.oh-my-zsh on git:master x [21:47:42] C:0# $PROMPT=&quot;%&#123;$terminfo[bold]$fg[blue]%&#125;#%&#123;$reset_color%&#125; \\%(#,%&#123;$bg[yellow]%&#125;%&#123;$fg[black]%&#125;%n%&#123;$reset_color%&#125;,%&#123;$fg[cyan]%&#125;%n) \\%&#123;$reset_color%&#125;@ \\%&#123;$fg[green]%&#125;%m \\%&#123;$terminfo[bold]$fg[magenta]%&#125;$&#123;venv_info&#125; \\%&#123;$reset_color%&#125;in \\%&#123;$terminfo[bold]$fg[yellow]%&#125;%~%&#123;$reset_color%&#125;\\$&#123;hg_info&#125;\\$&#123;git_info&#125;\\$&#123;svn_info&#125;\\ \\[%*] $exit_code%&#123;$terminfo[bold]$fg[red]%&#125;$ %&#123;$reset_color%&#125;&quot;","categories":["ubuntu"],"tags":["zsh"]},{"title":"用树莓派 pico w 和墨水屏做一个 mnist-clock","url":"/2022/12/23/raspi/raspberry-pico-w-epaper-mnist-clock/","content":"用 raspberry pico w 和墨水屏做一个 mnist-clock1. 墨水屏\n型号：Pico-ePaper-2.9\nhttps://www.waveshare.net/wiki/Pico-ePaper-2.9\n工作电压：3.3V&#x2F;5V\n通信接口：SPI\n分辨率：296 x 128\n显示颜色：黑、白\n局部刷新：0.3s\n全局刷新 ：2s\n\n2. pico w 基本配置2.1 刷固件\nhttps://micropython.org/download/rp2-pico-w/\n\n下载类似rp2-pico-w-20221107-unstable-v1.19.1-616-g5987130af.uf2\n\n首次将 pico w 连接电脑之后，会以U盘形式弹出来，把固件拖进去。\n\n已经刷过固件的，按着板子上的 BOOTTSEL 按钮连接电脑。\n\n\n重新上电，固件就自动刷好了。\n2.2 开发环境 thonny\n安装 thonny, scoop install thonny \nThonny IED： 打开 ‘运行’ - ‘配置解释器’， 配置一下\n运行一下板载的 LED 测试程序：\n\nfrom machine import Pin import timeled = Pin(&#x27;LED&#x27;, Pin.OUT)while(True):    led.on()    time.sleep(1)    led.off()    time.sleep(1)\n可以看到板载的 LED 在闪烁。\n\n\n3. 处理 mnist 数据集，保存成二进制文件\n由于pico可用的内存有限， thonny中显示仅有 800kb 左右可用？\n\n每个数字的mnist字符为 28x28 &#x3D; 784 像素， 原始数据集是 0-255 黑白色阶的。\n\n这里我们节省存储空间，将每个像素压缩成以黑、白图像保存，这样每个像素仅占1个bit\n\n那么784个bit需要 784 &#x2F; 8 &#x3D; 98 个字节，约 0.1kb\n\n也就是每个数字的 mnist 字符的存储空间为 ~ 0.1kb\n\n选择x_train数据集， 选出中 0-9 每个数字的前 500 个\n\n分别转换成一个 *.bin 文件保存，文件名：font_lib_{0-9}.bin \n\n那么每个*.bin 文件为 48kb，全部 mnist font lib 总共占用 480kb\n\n\n#%%import jsonimport numpy as np# 1.load mnist datasetwith np.load(&#x27;../mnist.npz&#x27;) as f:    x_train, y_train = f[&#x27;x_train&#x27;], f[&#x27;y_train&#x27;]    x_test, y_test = f[&#x27;x_test&#x27;], f[&#x27;y_test&#x27;]with open(&#x27;../mnist_index.json&#x27;, &#x27;r&#x27;) as f:    idx_dict = json.load(f)#%%# 2. 将 mnist 打印成字符画def draw_mnist_num(image):    bool_array = np.array(image &gt; 128, dtype=int)    print(bool_array)    char_array = np.where(image &gt; 128, &#x27;@&#x27;, &#x27;-&#x27;)    for row in char_array:        print(&#x27;&#x27;.join(i for i in row))draw_mnist_num(x_train[0])#%%# 3. 将mnist转成2进制字符def convert_2_hex_str(image):    # print(image.shape)    image_bw = image &gt; 128    image_bit = np.packbits(image_bw)    # print(image_bit)    char_2 = image_bit.tobytes()    # print(char_2)    return char_2mm_2 = convert_2_hex_str(x_train[0])print(len(mm_2), mm_2)# %% # 4. 转成字符数组def gen_mnist_font_lib_str(m=1):    font_lib = []    for num in range(10):        font = b&#x27;&#x27;        for idx in idx_dict[str(num)][:m]:            img = x_train[idx]            xxx = convert_2_hex_str(img)            font += xxx        font_lib.append(font)    return font_libmnist_font_lib = gen_mnist_font_lib_str(500)print(len(mnist_font_lib))# 5. 保存for n, font in enumerate(mnist_font_lib):    f = open(f&#x27;font_lib_&#123;n&#125;.bin&#x27;, &#x27;wb&#x27;)    f.write(font)    f.close()\n\n4. 先测试下用 pico w 显示 mnist 字符\n将生成的 *.bin 文件通过 Thonny 全部上传至 pico w。\n\n测试一下能否正常读取并显示。\n\n\n4.1 读取 mnist 字符# 读取字符，返回一个由 &#x27;0&#x27; 或 &#x27;1&#x27; 组成的字符串，字符串长度为784。def get_mnist_font(num):        SIZE = 98    NUM = 500            f = open(&#x27;font_lib_&#123;&#125;.bin&#x27;.format(num), &#x27;rb&#x27;)    f.seek(random.randrange(0, NUM) * SIZE)    mf_bin = f.read(SIZE)    f.close()         # string: 784 * &#x27;0&#x27; or &#x27;1&#x27;    mf_str = &#x27;&#x27;.join([&#x27;&#123;:08b&#125;&#x27;.format(mf_bin[i]) for i in range(SIZE)])    # mf_x28 = [[mf_str[i*28+j] for j in range(28)] for i in range(28)]     return mf_str\n\n4.2 绘制字符 28x28 像素# 字符串长度为784，按照 28x28 逐个绘制像素 def MNIST(draw, mf, i):        c0 = [2, 72, 154, 224]    r0 = [20, 20, 20, 20]    mf_x28 = [[mf_str[i*28+j] for j in range(28)] for i in range(28)]    for r in range(28):        for c in range(28):            color = 0x00 if mf[r*28+c]==&#x27;1&#x27; else 0xff            draw.pixel(c + c0[i], r + r0[i], color)\n\n4.3 绘制字符，缩放为 nR x nC 像素# 字符串长度为784，按照 nR x nC 逐个绘制像素 def MNIST(draw, mf, i):        c0 = [2, 72, 154, 224]    r0 = [20, 20, 20, 20]    nR = 100    nC = 70    # resize: 28x28 -&gt; nRxnC    # mf_x28 = [[mf_str[i*28+j] for j in range(28)] for i in range(28)]    # mf_rsz = [[int(mf_x28[int(28*r/nR)][int(28*c/nC)]) for c in range(nC)] for r in range(nR)]    for r in range(nR):        for c in range(nC):            color = mf[ int(28*r/nR) * 28 + int(28*c/nC) ]            color = 0x00 if color == &#x27;1&#x27; else 0xff            draw.pixel(c + c0[i], r + r0[i], color)\n\n4.4 完整代码import randomimport timeimport Pico_ePaper29 as epd29import gcgc.collect()print(&quot;mem: &quot;, gc.mem_free())# === 1. load mnist font libdef get_mnist_font(num):    SIZE = 98    NUM = 100            f = open(&#x27;font_lib_&#123;&#125;.bin&#x27;.format(num), &#x27;rb&#x27;)    f.seek(random.randrange(0, NUM) * SIZE)    mf_bin = f.read(SIZE)    f.close()         # string: 784 * &#x27;0&#x27; or &#x27;1&#x27;    mf_str = &#x27;&#x27;.join([&#x27;&#123;:08b&#125;&#x27;.format(mf_bin[i]) for i in range(SIZE)])    # mf_x28 = [[mf_str[i*28+j] for j in range(28)] for i in range(28)]     return mf_str# === 2. epaper29: 296x128;     0xff:white;  0x00:black;   epd = epd29.EPD_2in9_Landscape()       def MNIST(draw, mf, i):        c0 = [2, 72, 154, 224]    r0 = [20, 20, 20, 20]    nR = 100    nC = 70    # mf_x28 = [[mf_str[i*28+j] for j in range(28)] for i in range(28)]    # for r in range(28):    #     for c in range(28):    #         color = 0x00 if mf[r*28+c]==&#x27;1&#x27; else 0xff    #         draw.pixel(c + c0[i], r + r0[i], color)        # resize: 28x28 -&gt; nRxnC    # mf_rsz = [[int(mf_x28[int(28*r/nR)][int(28*c/nC)]) for c in range(nC)] for r in range(nR)]    for r in range(nR):        for c in range(nC):            color = mf[ int(28*r/nR) * 28 + int(28*c/nC) ]            color = 0x00 if color == &#x27;1&#x27; else 0xff            draw.pixel(c + c0[i], r + r0[i], color)    gc.collect()    print(i, &quot;mem: &quot;, gc.mem_free())    # --------------------------------------------print(&#x27;full update&#x27;)epd.Clear(0xff)        epd.delay_ms(100)epd.fill(0xff)epd.delay_ms(100)epd.display(epd.buffer)epd.display_Partial(epd.buffer)last_time = [-1, -1, -1, -1]now_time = [1, 2, 3, 4]        for i in range(4):    if last_time[i] != now_time[i]:        mnist = get_mnist_font(now_time[i])        MNIST(epd, mnist, i)        print(&#x27;partial update&#x27;, now_time)        epd.display_Partial(epd.buffer)        epd.delay_ms(1000)gc.collect()print(&quot;mem: &quot;, gc.mem_free())\n\n5. 在墨水屏显示时间import networkimport randomimport timeimport ntptimeimport Pico_ePaper29 as epd29# === 0. wifi config ==========================ssid = &#x27;aaa&#x27;pswd = &#x27;xxx&#x27;wlan = network.WLAN(network.STA_IF)wlan.active(True)wlan.connect(ssid, pswd)status = wlan.ifconfig()print(&#x27;wifi=&#123;&#125;  ip=&#123;&#125;&#x27;.format(ssid, status[0]))print(time.localtime())try:    # https://www.pool.ntp.org/zone/cn    ntptime.host = &#x27;cn.pool.ntp.org&#x27;    ntptime.settime()except Exception as e:    print(&#x27;NTPTIME ERROR&#x27;, e, ntptime.host)# === 1. load mnist font lib ==================def get_mnist_font(num):        SIZE = 98    NUM = 100            f = open(&#x27;font_lib_&#123;&#125;.bin&#x27;.format(num), &#x27;rb&#x27;)    f.seek(random.randrange(0, NUM) * SIZE)    mf_bin = f.read(SIZE)    f.close()         # string: 784 * &#x27;0&#x27; or &#x27;1&#x27;    mf_str = &#x27;&#x27;.join([&#x27;&#123;:08b&#125;&#x27;.format(mf_bin[i]) for i in range(SIZE)])    # mf_x28 = [[mf_str[i*28+j] for j in range(28)] for i in range(28)]     return mf_str# === 2. epaper29: 296x128;     0xff:white;  0x00:black;   epd = epd29.EPD_2in9_Landscape()def YMD(draw, ymd, wid):    draw.fill(0xff)        draw.fill_rect(5, 5, 95, 8, 0xff)    draw.text(wid, 5, 5, 0x00)        draw.fill_rect(100, 5, 120, 8, 0xff)    draw.text(ymd, 100, 5, 0x00)        def HMS(draw, txt):    draw.fill_rect(240, 5, 50, 8, 0xff)    draw.text(txt, 240, 5, 0x00)def DOT(draw):    draw.fill_rect(144, 60, 7, 7, 0x00)    draw.fill_rect(144, 80, 7, 7, 0x00)def MNIST(draw, mf, i):        c0 = [2, 72, 154, 224]    r0 = [20, 20, 20, 20]    nR = 100    nC = 70    # mf_x28 = [[mf_str[i*28+j] for j in range(28)] for i in range(28)]    # for r in range(28):    #     for c in range(28):    #         color = 0x00 if mf[r*28+c]==&#x27;1&#x27; else 0xff    #         draw.pixel(c + c0[i], r + r0[i], color)        # resize: 28x28 -&gt; nRxnC    # mf_rsz = [[int(mf_x28[int(28*r/nR)][int(28*c/nC)]) for c in range(nC)] for r in range(nR)]    for r in range(nR):        for c in range(nC):            color = mf[ int(28*r/nR) * 28 + int(28*c/nC) ]            color = 0x00 if color == &#x27;1&#x27; else 0xff            draw.pixel(c + c0[i], r + r0[i], color)            def MNIST_clear(draw):    draw.fill_rect(0, 20, 296, 100, 0xff)    draw.fill_rect(240, 5, 50, 8, 0xff)    # === 3. run ==================================last_time = [-1, -1, -1, -1]while (True):    # 2.1 get time.now    wifi_id = ssid if wlan.status()==3 else &#x27;no wifi&#x27;    now = time.localtime(time.time() + 8*3600)        year, mon, day = now[0], now[1], now[2]    hour, mnt, sec = now[3], now[4], now[5]    week = [&#x27;Mon&#x27;, &#x27;Tue&#x27;, &#x27;Wed&#x27;, &#x27;Thu&#x27;, &#x27;Fri&#x27;, &#x27;Sat&#x27;, &#x27;Sun&#x27;]    weekday = week[now[6]]    now_time = [hour//10, hour%10, mnt//10, mnt%10]        print(now, wifi_id, last_time, now_time)            # 2.2 full update    if -1 in last_time or (mnt%10==0 and sec&lt;5):        print(&#x27;full update&#x27;)        epd.Clear(0xff)                epd.delay_ms(100)                YMD(epd, &#x27;&#123;:04d&#125;-&#123;:02d&#125;-&#123;:02d&#125; &#123;&#125;&#x27;.format(year, mon, day, weekday), wifi_id)        epd.display(epd.buffer)        epd.delay_ms(100)                MNIST_clear(epd)        epd.display_Partial(epd.buffer)        epd.delay_ms(100)                last_time = [-1, -1, -1, -1]            # 2.3 partial update    for i in range(4):        if last_time[i] != now_time[i]:            print(&#x27;partial update&#x27;, last_time, now_time)            last_time[i] = now_time[i]                        mnist = get_mnist_font(now_time[i])            HMS(epd, &#x27;&#123;:02d&#125;:&#123;:02d&#125;&#x27;.format(hour, mnt))            MNIST(epd, mnist, i)                        epd.display_Partial(epd.buffer)            epd.delay_ms(100)                        if i == 1:                DOT(epd)                epd.display_Partial(epd.buffer)                epd.delay_ms(100)                     time.sleep(5)\n\n\n仓库： https://github.com/shenbo/mnist-clock\n","categories":["raspi"],"tags":["raspberry-pi","mnist-clock"]},{"title":"runcat-pyqt5-win：在windows任务栏养猫（3）","url":"/2022/11/28/python-app/runcat-for-win-%E5%9C%A8windows%E4%BB%BB%E5%8A%A1%E6%A0%8F%E5%85%BB%E7%8C%AB%20V3/","content":"runcat-pystray-win V3之前撸了一个 runcat-pyqt5-win，可以在windows任务栏养猫，用奔跑的猫来显示当前系统资源（CPU）的占用情况。\n\ngithub仓库： https://github.com/shenbo/runcat-pyqt5-win\n原mac应用： http://kyomesuke.com/runcat/index.html\n\n原来的基于 ptqt5 库比较大； 这次采用 pystray 轻量实现：\nRequirements\npsutil\npystray\n\n\n\n\n完整代码import threadingimport timefrom psutil import cpu_percent, virtual_memoryfrom pystray import Icon, Menu, MenuItem# PIL dependency simplification# ref: https://github.com/moses-palmer/pystray/issues/26class ICOImage:    def __init__(self, path: str):        with open(path, &#x27;rb&#x27;) as file:            self._data = file.read()    def save(self, file, format):        file.write(self._data)# get cpu usagedef thread_get_usage():    global cpu_usage, mem_usage    while True:        if thread_flag: break        cpu_usage = cpu_percent(interval=1) / 100        mem_usage = virtual_memory().percent / 100        time.sleep(0.5)def changeMonitor(new_monitor):    global monitor    print(monitor, new_monitor)    if new_monitor != monitor:        monitor = new_monitordef on_quit():    global thread_flag    thread_flag = 1    runcat.stop()# 初始化monitor = &#x27;CPU&#x27;cpu_usage = 0.2  # 初始化mem_usage = 0.2  # 初始化cats = [ICOImage(f&#x27;icons/runcat/&#123;i&#125;.ico&#x27;) for i in range(5)]menu = (MenuItem(text=&#x27;CPU&#x27;, action=lambda: changeMonitor(&#x27;cpu&#x27;)),        MenuItem(text=&#x27;MEM&#x27;, action=lambda: changeMonitor(&#x27;mem&#x27;)),        MenuItem(text=&#x27;QUIT&#x27;, action=on_quit))runcat = Icon(&#x27;run cat&#x27;, icon=cats[0], title=&#x27;run cat&#x27;,  menu=menu)# 创建两个 threading：一个获取使用率，一个更新图标thread_flag = 0threading.Thread(target=runcat.run).start()threading.Thread(target=thread_get_usage).start()while True:    if thread_flag: break    for icon in cats:        runcat.icon = icon        mon = mem_usage if monitor == &#x27;mem&#x27; else cpu_usage        t = 0.2 - mon * 0.15                print(f&#x27;&#123;mon=:.2%&#125;, &#123;t=:.2f&#125;s, &#123;cpu_usage=:.2%&#125;, &#123;mem_usage=:.2%&#125;&#x27;)        tip = f&#x27;cpu: &#123;cpu_usage:.2%&#125; \\nmem: &#123;mem_usage:.2%&#125;&#x27;        runcat.title = tip        time.sleep(t)# pyinstaller -w -i favicon.ico runcat-v0.6-pystray.py --add-data &quot;icons;icons&quot;\n","categories":["python"],"tags":["python","pyqt5"]},{"title":"使用leancloud存储运行日志","url":"/2022/10/13/python-app/%E4%BD%BF%E7%94%A8leancloud%E5%AD%98%E5%82%A8%E8%BF%90%E8%A1%8C%E6%97%A5%E5%BF%97/","content":"\n申请 leancloud 应用。\n\n\nref: https://console.leancloud.cn/apps\n\n\n安装 pip install leancloud\n\nimport leancloudleancloud.init(&quot;xxx&quot;, &quot;yyy&quot;)TestObject = leancloud.Object.extend(&#x27;my_log&#x27;)test_object = TestObject()test_object.set(&#x27;col1&#x27;, &#x27;a&#x27;)test_object.set(&#x27;col2&#x27;, &#x27;b&#x27;)test_object.set(&#x27;col3&#x27;, &#x27;c&#x27;)test_object.save()\n","categories":["python"],"tags":["leancloud"]},{"title":"群晖安装aria2","url":"/2022/07/13/synology/%E7%BE%A4%E6%99%96%E5%AE%89%E8%A3%85aria2/","content":"群晖型：   DS218+，CPU:     Intel Celeron J3355DSM版本:  7.0\n1. 安装 bootstrapwget http://ipkg.nslu2-linux.org/feeds/optware/syno-i686/cross/unstable/syno-i686-bootstrap_1.2-7_i686.xshchmod +x syno-i686-bootstrap_1.2-7_i686.xshsudo sh syno-i686-bootstrap_1.2-7_i686.xshreboot\n\n\n2. 安装 aria2ipkg updateipkg install aria2\n\n\n\nref: https://www.kejiwanjia.com/circle/10888.htmlref: http://homtang.com/ds216j-install-aria2/\n\n","categories":["synology"],"tags":["synology","aria2"]},{"title":"access-python调用odbc数据库","url":"/2022/07/04/office/access-python%E8%B0%83%E7%94%A8odbc%E6%95%B0%E6%8D%AE%E5%BA%93/","content":"1. 安装 Access (以access 2016 为例)\n安装 Access 2016: 略 \n安装 Microsoft Access Database Engine\n\nhttps://www.microsoft.com/zh-CN/download/details.aspx?id=54920\naccessdatabaseengine_X64.exe    2020&#x2F;8&#x2F;11  File Size: 79.5 MB\n\n\n\n\n2. 安装 pyodbcpip install pyodbc\n\n3. 新建数据库并进行操作\n\nimport pyodbc# 数据库路径accdb_dir = &#x27;C:/Users/xxx/Documents/Database1.accdb&#x27;# 1.1 创建数据表create_table_sql = &#x27;&#x27;&#x27;\\  create table suanfa  (    id      autoincrement primary key,    value1  varchar(255),    value2  varchar(255),      result  varchar(255)  )&#x27;&#x27;&#x27;# 2.2 查询、插入、更新select_sql = &#x27;select * from suanfa where id&gt;0&#x27;insert_sql = &#x27;insert into suanfa(value1, value2, result) values (?, ?, ?)&#x27;update_sql = &#x27;update suanfa(result,) values (?,)&#x27;# 2 连接数据库connection = pyodbc.connect(rf&#x27;Driver=&#123;&#123;Microsoft Access Driver (*.mdb, *.accdb)&#125;&#125;;DBQ=&#123;accdb_dir&#125;;&#x27;)connection.autocommit = True# 2.1 创建数据表，插入数据with connection.cursor() as cursor:    cursor.execute(create_table_sql)with connection.cursor() as cursor:    for i in range(10):        cursor.execute(insert_sql, i, i, i+1)# 2.2. 读取、更新数据with connection.cursor() as cursor:    cursor.execute(select_sql)    values = cursor.fetchall()    print(values)        aa, bb = values[0], values[1]    rst = aa * bb  # 改成我们的算法:  rst = f(a， b)    cursor.execute(update_table_sql, rst)    for row in cursor.execute(select_sql):        print(row)\n","categories":["office"],"tags":["access"]},{"title":"日历文件：将csv文件转换为ics","url":"/2022/07/01/office/%E6%97%A5%E5%8E%86%E6%96%87%E4%BB%B6%EF%BC%9A%E5%B0%86csv%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E4%B8%BAics/","content":"日历文件：将csv文件转换为ics# pip install icalendar# %%import pandas as pddf = pd.read_csv(&#x27;1.csv&#x27;,                  encoding=&#x27;gbk&#x27;,                header=0,                 parse_dates=[0,1],                 date_parser=lambda x: pd.to_datetime(x, format=&#x27;%Y/%m/%d %H:%M&#x27;))print(df)# %%from icalendar import Calendar, Eventcal = Calendar()cal.add(&#x27;version&#x27;, &#x27;2.0&#x27;)for row in df.itertuples(index=False):    stime, etime, thing = row[0], row[1], row[2]    # print(row[0], row[1], row[2])    event = Event()    event.add(&#x27;summary&#x27;, thing)    event.add(&#x27;dtstart&#x27;, stime)    event.add(&#x27;dtend&#x27;, etime)    # print(event)    cal.add_component(event)    txt = cal.to_ical()    print(str(txt, encoding=&#x27;utf8&#x27;))# %%with open(&#x27;1.ics&#x27;, &#x27;wb&#x27;) as f:    f.write(txt)\n","categories":["office"],"tags":["calendar"]},{"title":"文件替换：保留原始路径","url":"/2022/06/28/office/%E6%96%87%E4%BB%B6%E6%9B%BF%E6%8D%A2%EF%BC%9A%E4%BF%9D%E7%95%99%E5%8E%9F%E5%A7%8B%E8%B7%AF%E5%BE%84/","content":"文件替换：保留原始路径问题描述：将特定类型文件的文件挑出来，放入一个文件夹，批量处理之后再替换原文件。\n1. 文件迁移\n将文件路径经过md5加密后，作为文件名前缀。\n复制文件到一个新文件夹\n\n# xyz_a.py# %%import osimport shutilfrom hashlib import md5# 创建 md5 对象def encrypt_md5(s):    new_md5 = md5()    new_md5.update(s.encode(encoding=&#x27;utf-8&#x27;))    return new_md5.hexdigest()# old_root = os.getcwd()    # 待处理文件的根目录old_root = &quot;E:\\\\&quot;new_root = &quot;D:\\\\0\\\\&quot;exts = [&#x27;.xyz&#x27;]for parent, dirnames, filenames in os.walk(old_root):    for filename in filenames:        extension = os.path.splitext(filename)[1]                if extension.lower() in ext:            old_dir = os.path.join(parent, filename)            new_name = encrypt_md5(old_dir) + &#x27;_&#x27; + filename   # 修改文件名            new_dir = os.path.join(new_root, new_name)                        print(f&#x27;&#123;old_dir&#125;;; &#123;new_name&#125;;; &#123;new_dir&#125;&#x27;)                        # shutil.copyfile(old_dir, new_dir)    # 复制到新文件夹\n\n\n用命令行运行：\n\npython xyz_a.py &gt; zzz.csv\n\n\n\n\n2. 文件处理略\n3. 替换原始文件# xyz_b.py# %%import osimport pandas as pdimport shutil# ------df = pd.read_csv(&#x27;zzz.csv&#x27;, encoding=&#x27;utf16&#x27;, sep=&#x27;;;&#x27;, )df.columns = [&#x27;old_dir&#x27;, &#x27;new_name&#x27;, &#x27;new_dir&#x27;]df[&#x27;new_name&#x27;] = df[&#x27;new_name&#x27;].str.strip()print(df.head())# ------new_root = &quot;D:\\\\0\\\\&quot;for parent, dirnames, filenames in os.walk(new_root):    for filename in filenames:        # print(filename)        new_dir = os.path.join(parent, filename)        rst = df[df[&#x27;new_name&#x27;] == filename]                try:            old_dir = rst[&#x27;old_dir&#x27;].values[0]            print(new_dir, &#x27;-&gt;&#x27;, old_dir)            # f1, f2 = os.path.split(old_dir)[0], os.path.split(old_dir)[1]            # print(f1, f2)                        # shutil.copyfile(new_dir, old_dir)                except Exception as result:            print(result)\n","categories":["office"],"tags":["file"]},{"title":"使用 winget 安装管理 windows 软件 - Win10 LTSC","url":"/2022/06/23/scoop/%E4%BD%BF%E7%94%A8winget%E5%AE%89%E8%A3%85%E7%AE%A1%E7%90%86windows%E8%BD%AF%E4%BB%B6-Win10-LTSC/","content":"0 Winget官网\nWinget官网: https://github.com/microsoft/winget-cli \n\n1. 安装 winget （Win10 LTSC）目前官方只支持 windows store 安装，但 LTSC 并没有应用商店。\n版本\tWindows 10 企业版 LTSC版本号 \t21H2操作系统内部版本\t19044.1766体验\tWindows Feature Experience Pack 120.2212.4170.0\n\nWin10 手动安装 winget 方法如下：\n\n参考安装方法: https://github.com/muradbuyukasik/winget-script   \n\n1.1 安装 VC++ v14 依赖\n下载页面： https://docs.microsoft.com/en-gb/troubleshoot/developer/visualstudio/cpp/libraries/c-runtime-packages-desktop-bridge#how-to-install-and-update-desktop-framework-packages\n\n下载、安装 appx：\n\n\ncd ~aria2c -c -s 5 -x 5 https://aka.ms/Microsoft.VCLibs.x64.14.00.Desktop.appx  # 注意版本号Add-AppxPackage Microsoft.VCLibs.x64.14.00.Desktop.appx\n\n1.2 安装 Microsoft.UI.Xaml 依赖\n下载页面： https://www.nuget.org/packages/Microsoft.UI.Xaml/\n\n下载、解压、安装 appx：\n\n\ncd ~aria2c -c -s 5 -x 5 https://www.nuget.org/api/v2/package/Microsoft.UI.Xaml/2.7.1  # 注意版本号# 下载的文件： microsoft.ui.xaml.2.7.1.nupkg，解压7z x microsoft.ui.xaml.2.7.1.nupkg -o*cd microsoft.ui.xaml.2.7.1\\tools\\AppX\\x64\\ReleaseAdd-AppxPackage microsoft.ui.xaml.2.7.appx\n\n1.3 安装 winget\n下载页面：https://github.com/microsoft/winget-cli/releases\n下载、安装 msixbundle\n\ncd ~aria2c -c -s 5 -x 5 https://github.com/microsoft/winget-cli/releases/download/v1.2.10271/Microsoft.DesktopAppInstaller_8wekyb3d8bbwe.msixbundle  # 注意版本号# aria2c -c -s 5 -x 5 https://ghproxy.net/https://github.com/microsoft/winget-cli/releases/download/v1.2.10271/Microsoft.DesktopAppInstaller_8wekyb3d8bbwe.msixbundle Add-AppPackage .\\Microsoft.DesktopAppInstaller_8wekyb3d8bbwe.msixbundle.\\Microsoft.DesktopAppInstaller_8wekyb3d8bbwe.msixbundle\n\n\n\n\n2. 安装常用软件# 安装 windows store appswinget search &quot;Mail and Calendar&quot;winget install 9WZDNCRFHVQMwinget search &quot;Microsoft Photos&quot;winget install 9WZDNCRFJBH4# 安装常用软件winget install Microsoft.Edgewinget install Microsoft.Teamswinget install Tencent.QQwinget install Tencent.WeChatwinget install Tencent.TencentMeetingwinget install NetEase.MailMasterwinget install TortoiseGit","categories":["apps"],"tags":["winget"]},{"title":"powershell配置(6)-ohmyposh3-v2","url":"/2022/06/08/powershell/powershell%E9%85%8D%E7%BD%AE6-ohmyposh3-v2/","content":"1.安装以scoop安装oh-my-posh。\n#scoop install psreadlinescoop install posh-git#scoop install oh-my-posh\n\n2. 配置文件新建、修改配置文件，运行:\nif (!(Test-Path -Path $PROFILE )) &#123; New-Item -Type File -Path $PROFILE -Force &#125;code $PROFILE\n\n加入以下内容：\nchcp 65001Set-PSReadLineOption -PredictionSource Historyoh-my-posh init pwsh --config ~\\scoop\\persist\\oh-my-posh\\themes\\yo.omp.yaml | Invoke-Expression\n\n\nref: https://ohmyposh.dev/docs/\n\n\n\n3. 自定义ys主题\n打开主题文件，路径： ~\\scoop\\persist\\oh-my-posh\\themes\\yo.omp.yaml\n\n# https://shenbo.github.io/tags/powershell/# yaml-language-server: $schema=https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/schema.jsonconsole_title_template: &quot;&#123;&#123;.User&#125;&#125; :: &#123;&#123;.Folder&#125;&#125; :: &#123;&#123;.Shell&#125;&#125;&quot;blocks:- type: prompt  alignment: left  segments:  - style: plain    template: &quot;&#123;&#123; if .Root &#125;&#125;% &#123;&#123; else &#125;&#125;&lt;blue&gt;# &lt;/&gt;&#123;&#123;end&#125;&#125;&quot;    foreground: red    type: text  - style: plain    template: &quot;&#123;&#123; .UserName &#125;&#125;&lt;white&gt; @ &lt;/&gt;&lt;green&gt;&#123;&#123; .HostName &#125;&#125;&lt;/&gt;&quot;    foreground: cyan    type: session  - style: plain    template: &quot;&#123;&#123; if .Error &#125;&#125;&#123;&#123; .Error &#125;&#125;&#123;&#123; else &#125;&#125; (&#123;&#123; if .Venv &#125;&#125;&#123;&#123; .Venv &#125;&#125; &#123;&#123; end &#125;&#125;\\ue235&#123;&#123; .Full &#125;&#125;&#123;&#123; end &#125;&#125;)&quot;    foreground: magenta    type: python  - properties:      style: short    style: plain    template: &quot;&lt;white&gt; in &lt;/&gt;&#123;&#123; .Path &#125;&#125; &quot;    foreground: lightYellow    type: path  - properties:      fetch_status: true    style: plain    template: &quot; &#123;&#123; .HEAD &#125;&#125; &#123;&#123; .BranchStatus &#125;&#125;&#123;&#123; if .Working.Changed &#125;&#125; \\uf044 &#123;&#123; .Working.String &#125;&#125;&#123;&#123; end &#125;&#125;&#123;&#123; if and (.Staging.Changed) (.Working.Changed) &#125;&#125; |&#123;&#123; end &#125;&#125;&#123;&#123; if .Staging.Changed &#125;&#125; \\uf046 &#123;&#123; .Staging.String &#125;&#125;&#123;&#123; end &#125;&#125;&#123;&#123; if gt .StashCount 0&#125;&#125; \\uf692 &#123;&#123; .StashCount &#125;&#125;&#123;&#123; end &#125;&#125;&#123;&#123; if gt .WorktreeCount 0&#125;&#125; \\uf1bb &#123;&#123; .WorktreeCount &#125;&#125;&#123;&#123; end &#125;&#125; &quot;    foreground: cyan    type: git  - properties:      time_format: &quot;15:04:05&quot;    style: plain    template: &quot;[&#123;&#123; .CurrentDate | date .Format &#125;&#125;]&quot;    foreground: white    type: time  - style: plain    template: &quot; C: &#123;&#123; .Code &#125;&#125;&quot;    foreground: red    type: exit- type: prompt  alignment: left  segments:  - style: plain    template: $    foreground: red    type: text  newline: truefinal_space: trueversion: 3\n\n4. 自定义ys主题 （oh-my-zsh）modified ys.zsh-theme for oh-my-zsh \n# Clean, simple, compatible and meaningful.# Tested on Linux, Unix and Windows under ANSI colors.# It is recommended to use with a dark background.# Colors: black, red, green, yellow, *blue, magenta, cyan, and white.## Mar 2013 Yad Smood# VCSYS_VCS_PROMPT_PREFIX1=&quot; %&#123;$reset_color%&#125;on%&#123;$fg[blue]%&#125; &quot;YS_VCS_PROMPT_PREFIX2=&quot;:%&#123;$fg[cyan]%&#125;&quot;YS_VCS_PROMPT_SUFFIX=&quot;%&#123;$reset_color%&#125;&quot;YS_VCS_PROMPT_DIRTY=&quot; %&#123;$fg[red]%&#125;x&quot;YS_VCS_PROMPT_CLEAN=&quot; %&#123;$fg[green]%&#125;o&quot;# Git infolocal git_info=&#x27;$(git_prompt_info)&#x27;ZSH_THEME_GIT_PROMPT_PREFIX=&quot;$&#123;YS_VCS_PROMPT_PREFIX1&#125;\\ue0a0&quot;ZSH_THEME_GIT_PROMPT_SUFFIX=&quot;$YS_VCS_PROMPT_SUFFIX&quot;ZSH_THEME_GIT_PROMPT_DIRTY=&quot;$YS_VCS_PROMPT_DIRTY&quot;ZSH_THEME_GIT_PROMPT_CLEAN=&quot;$YS_VCS_PROMPT_CLEAN&quot;# SVN infolocal svn_info=&#x27;$(svn_prompt_info)&#x27;ZSH_THEME_SVN_PROMPT_PREFIX=&quot;$&#123;YS_VCS_PROMPT_PREFIX1&#125;svn$&#123;YS_VCS_PROMPT_PREFIX2&#125;&quot;ZSH_THEME_SVN_PROMPT_SUFFIX=&quot;$YS_VCS_PROMPT_SUFFIX&quot;ZSH_THEME_SVN_PROMPT_DIRTY=&quot;$YS_VCS_PROMPT_DIRTY&quot;ZSH_THEME_SVN_PROMPT_CLEAN=&quot;$YS_VCS_PROMPT_CLEAN&quot;# HG infolocal hg_info=&#x27;$(ys_hg_prompt_info)&#x27;ys_hg_prompt_info() &#123;\t# make sure this is a hg dir\tif [ -d &#x27;.hg&#x27; ]; then\t\techo -n &quot;$&#123;YS_VCS_PROMPT_PREFIX1&#125;hg$&#123;YS_VCS_PROMPT_PREFIX2&#125;&quot;\t\techo -n $(hg branch 2&gt;/dev/null)\t\tif [[ &quot;$(hg config oh-my-zsh.hide-dirty 2&gt;/dev/null)&quot; != &quot;1&quot; ]]; then\t\t\tif [ -n &quot;$(hg status 2&gt;/dev/null)&quot; ]; then\t\t\t\techo -n &quot;$YS_VCS_PROMPT_DIRTY&quot;\t\t\telse\t\t\t\techo -n &quot;$YS_VCS_PROMPT_CLEAN&quot;\t\t\tfi\t\tfi\t\techo -n &quot;$YS_VCS_PROMPT_SUFFIX&quot;\tfi&#125;# VirtualenvVIRTUAL_ENV_DISABLE_PROMPT=1local py_versionif  [[ -n &quot;$VIRTUAL_ENV&quot; ]] ; then    py_version=$&#123;(@)$(python -V 2&gt;&amp;1)[2]&#125;filocal venv_info=&#x27;$(virtualenv_prompt_info)&#x27;virtualenv_prompt_info()&#123;    [[ -n $&#123;VIRTUAL_ENV&#125; ]] || return    echo &quot;($&#123;VIRTUAL_ENV:t:gs/%/%%&#125; \\ue235 $&#123;py_version&#125;)&quot;&#125;local exit_code=&quot;%(?,,C:%&#123;$fg[red]%&#125;%?%&#123;$reset_color%&#125;)&quot;# Prompt format:## PRIVILEGES USER @ MACHINE in DIRECTORY on git:BRANCH STATE [TIME] C:LAST_EXIT_CODE# $ COMMAND## For example:## % ys @ ys-mbp in ~/.oh-my-zsh on git:master x [21:47:42] C:0# $PROMPT=&quot;%&#123;$terminfo[bold]$fg[blue]%&#125;#%&#123;$reset_color%&#125; \\%(#,%&#123;$bg[yellow]%&#125;%&#123;$fg[black]%&#125;%n%&#123;$reset_color%&#125;,%&#123;$fg[cyan]%&#125;%n) \\%&#123;$reset_color%&#125;@ \\%&#123;$fg[green]%&#125;%m \\%&#123;$terminfo[bold]$fg[magenta]%&#125;$&#123;venv_info&#125; \\%&#123;$reset_color%&#125;in \\%&#123;$terminfo[bold]$fg[yellow]%&#125;%~%&#123;$reset_color%&#125;\\$&#123;hg_info&#125;\\$&#123;git_info&#125;\\$&#123;svn_info&#125;\\ \\[%*] $exit_code%&#123;$terminfo[bold]$fg[red]%&#125;$ %&#123;$reset_color%&#125;&quot;\n\n\n# 查看 unicode 字符[char] 0xf044[char] 0xf046[char] 0xf692[char] 0xf1bb\n","categories":["powershell"],"tags":["powershell"]},{"title":"Git Bash 安装 zsh 和 on-my-zsh","url":"/2022/05/23/apps/git-bash%E5%AE%89%E8%A3%85zsh%E5%92%8Cohmyzsh/","content":"\nref: (https://dominikrys.com/posts/zsh-in-git-bash-on-windows/)\n\n1. 安装 zsh\nhttps://packages.msys2.org/package/zsh?repo=msys&amp;variant=x86_64\n\n\n1.1 从 MSYS2 下载 zsh package\n\naria2c -c -s 8 -x 8 https://mirror.msys2.org/msys/x86_64/zsh-5.8-5-x86_64.pkg.tar.zst\n\n1.2 解压压缩文件的格式是ZST, 需要安装一个支持的解压软件\n\nscoop install zstdzstd -d zsh-5.8-5-x86_64.pkg.tar.zst\n将 \\etc、\\usr 文件夹解压到本机 git 的安装目录：\n\n1.3 运行\n\nzshautoload -U zsh-newuser-installzsh-newuser-install -f\n\n设置 zsh 自启动, 在~/.bashrc加入：\n\nif [ -t 1 ]; then  exec zshfi\n\n\n\n2. 安装 oh-my-zsh\n下载安装\n\n$ sh -c &quot;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)&quot;# gitee 镜像$ sh -c &quot;$(wget https://gitee.com/mirrors/oh-my-zsh/raw/master/tools/install.sh -O -)&quot;\n\n\n简单配置一下，打开配置文件 nano ~/.zshrc\n\n# 主题ZSH_THEME=&quot;ys&quot;# 插件plugins=(git zsh-syntax-highlighting zsh-autosuggestions)\n\n下载插件\n\ngit clone https://github.com/zsh-users/zsh-autosuggestions $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-autosuggestionsgit clone https://github.com/zsh-users/zsh-syntax-highlighting $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlighting\n\n加载配置文件， source ~/.zshrc\n\n","categories":["apps"],"tags":["git"]},{"title":"XPS9370 更换屏幕","url":"/2022/04/30/xps/XPS9370-%E6%9B%B4%E6%8D%A2%E5%B1%8F%E5%B9%95/","content":"书包没拿好掉地上， XPS13 9370 屏幕左上角磕到了，开机花屏。\n想罢工是不可能的。\n换新屏，连壳一起换了。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","categories":["xps"],"tags":["xps"]},{"title":"Win 11 右键菜单设置","url":"/2022/03/14/apps/Win11-config/","content":"右键菜单# 管理员运行运行后重启：reg.exe add &quot;HKCU\\Software\\Classes\\CLSID\\&#123;86ca1aa0-34aa-4e8b-a509-50c905bae2a2&#125;\\InprocServer32&quot; /f /ve # 恢复默认：# reg.exe delete &quot;HKCU\\Software\\Classes\\CLSID\\&#123;86ca1aa0-34aa-4e8b-a509-50c905bae2a2&#125;&quot; /f ","categories":["apps"],"tags":["win11"]},{"title":"PDF文档合并-报销单批量粘贴电子发票","url":"/2022/02/22/office/PDF%E6%96%87%E6%A1%A3%E5%90%88%E5%B9%B6-%E6%8A%A5%E9%94%80%E5%8D%95%E6%89%B9%E9%87%8F%E7%B2%98%E8%B4%B4%E7%94%B5%E5%AD%90%E5%8F%91%E7%A5%A8/","content":"\npymupdf \npip install pymupdf\nhttps://pymupdf.readthedocs.io/en/latest/index.html\n\n\n\n用 pymupdf 将电子发票转成图片，再插入报销单中# %%import osimport fitzfrom pprint import pprintfapiao_dir = &#x27;src/&#x27;zhantiedan = &#x27;zhantiedan_blank.pdf&#x27;ztd_pdf = fitz.open(zhantiedan)new_name = &#x27;fapiao_dayin.pdf&#x27;new_pdf = fitz.open()def fapiao_zhantie(fapiao=&#x27;&#x27;):        print(f&#x27;\\n=== fapiao pdf file:\\n    &#123;fapiao&#125;&#x27;)    src_pdf = fitz.open(fapiao)    for p, page in enumerate(src_pdf):        pixmap = page.get_pixmap(dpi=300)        pixmap.save(f&#x27;&#123;fapiao&#125;_&#123;str(p)&#125;.png&#x27;)                new_pdf.insert_pdf(ztd_pdf)        end_page = new_pdf[-1]        end_page.insert_image((100, 100, 700, 500), pixmap=pixmap)    src_pdf.close()    new_pdf.save(new_name)    print(f&#x27;    &#123;fapiao&#125; :\\n*** Done! ***\\n&#x27;)for dir, folders, files in os.walk(fapiao_dir):    for file in files:        path = os.path.join(dir, file)        print(path)        if path[-4:] == &#x27;.pdf&#x27;:            fapiao_zhantie(path)ztd_pdf.close()new_pdf.close()\n\n","categories":["office"],"tags":["pdf"]},{"title":"python调用ffmpeg处理音频-转换格式","url":"/2022/02/02/python/python-%E8%B0%83%E7%94%A8ffmpeg%E5%A4%84%E7%90%86%E9%9F%B3%E9%A2%91-%E8%BD%AC%E6%8D%A2%E6%A0%BC%E5%BC%8F/","content":"ffmpeg 使用说明查看使用说明：ffmpeg -h。\n# usage: ffmpeg [options] [[infile options] -i infile]... &#123;[outfile options] outfile&#125;...# options:-ab:                比特率-vn:                video no-map_metadata 0:    保留 meta data-y:    overwrite output files\n\n\n\n遍历文件夹中的所有 flac 文件, 转成 mp3 或 aac# %%def convert(path=&#x27;/&#x27;, ext=&#x27;&#x27;):    for parent, dirnames, filenames in os.walk(path):        for filename in filenames:            extension = os.path.splitext(filename)[1]            if extension == ext:                old_dir = os.path.join(parent, filename)                                # 转 mp3                # new_dir = old_dir.replace(&#x27;.flac&#x27;, &#x27;.mp3&#x27;)                # ffmpeg_command = f&#x27;ffmpeg -i &quot;&#123;old_dir&#125;&quot; -ab 320k -map_metadata 0 &quot;&#123;new_dir&#125;&quot; -y&#x27;                                # 转 aac                new_dir = old_dir.replace(&#x27;.flac&#x27;, &#x27;.m4a&#x27;)                # ffmpeg_command = f&#x27;ffmpeg -i &quot;&#123;old_dir&#125;&quot; -ab 320k -vn &quot;&#123;new_dir&#125;&quot; -y&#x27;                ffmpeg_command = f&#x27;ffmpeg -i &quot;&#123;old_dir&#125;&quot; &quot;&#123;new_dir&#125;&quot; -y&#x27;                                p = subprocess.Popen(ffmpeg_command, shell=True, stdout=subprocess.PIPE)                for line in iter(p.stdout.readline, b&#x27;&#x27;):                    msg = line.strip().decode(&#x27;gbk&#x27;)                    print(msg)convert(os.getcwd(), ext=&#x27;.flac&#x27;)# %%import osimport subprocessdef remove(path=&#x27;/&#x27;, ext=&#x27;&#x27;):    for parent, dirnames, filenames in os.walk(path):        for filename in filenames:            extension = os.path.splitext(filename)[1]            if extension == ext:                dir = os.path.join(parent, filename)                print(dir)                os.remove(dir)# remove(os.getcwd(), ext=&#x27;.flac&#x27;)\n","categories":["python"],"tags":["python","ffmpeg"]},{"title":"群晖升级ffmpeg","url":"/2022/01/06/synology/%E7%BE%A4%E6%99%96%E5%8D%87%E7%BA%A7ffmpeg/","content":"群晖自带的 ffmpeg 版本较低、支持编码库也比较少， 似乎不支持h265。从 SynoCommunity 升级 ffmpeg。 \nSynoCommunity 上给出了 DSM7版本 各套件的适配情况：\n\n issue #4524: https://github.com/SynoCommunity/spksrc/issues/4524\n\n1. 先从 SynoCommunity 安装 ffmpeg 套件略\n2. 设置 Video Station 调用 SynoCommunity 版本的 ffmpeg\n https://github.com/SynoCommunity/spksrc/wiki/FAQ-FFmpeg\n\n命令如下：\nsudo mv /var/packages/VideoStation/target/bin/ffmpeg /var/packages/VideoStation/target/bin/ffmpeg.oldsudo ln -sf /var/packages/ffmpeg/target/bin/ffmpeg /var/packages/VideoStation/target/bin/ffmpegsudo cp -p /var/packages/VideoStation/target/lib/libsynovte.so /var/packages/VideoStation/target/lib/libsynovte.so.oldsudo sed -i &#x27;s/eac3/ZXXZ/&#x27; /var/packages/VideoStation/target/lib/libsynovte.sosudo sed -i &#x27;s/dts/ZXZ/&#x27; /var/packages/VideoStation/target/lib/libsynovte.sosudo sed -i &#x27;s/truehd/ZXZZXZ/&#x27; /var/packages/VideoStation/target/lib/libsynovte.so\n\n恢复原来的设置\n# Reverse the above changes:sudo mv -f /var/packages/VideoStation/target/bin/ffmpeg.old /var/packages/VideoStation/target/bin/ffmpegsudo mv -f /var/packages/VideoStation/target/lib/libsynovte.so.old /var/packages/VideoStation/target/lib/libsynovte.so\n\n\n\n\n3. 设置 命令行 默认调用 SynoCommunity 版本的 ffmpeg\n打开配置文件 nano ~/.zshrc\n\n# 加到最后一行export PATH=&quot;/var/packages/ffmpeg/target/bin:$PATH&quot;\n\n\n加载配置文件， source ~/.zshrc\n\n\nN_m3u8DL-RE --save-dir /volume2/video --del-after-done --ffmpeg-binary-path /var/packages/ffmpeg6/target/bin/ffmpeg6 https://xxx.xxx/index.m3u8\n","categories":["synology"],"tags":["synology"]},{"title":"PDF文档翻译","url":"/2021/12/24/office/PDF%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91/","content":"PDF文档全文翻译，保留原有的PDF格式\n\npymupdf \npip install pymupdf\nhttps://pymupdf.readthedocs.io/en/latest/index.html\n\n\nyoudao api\n\n1. 采用 pymupdf 识别 pdf 的图片和文字import fitzimport refrom pprint import pprintpdf_name = &#x27;xxx-en.pdf&#x27;print(f&#x27;Source pdf file: &#123;pdf_name&#125; \\n&#x27;)src_pdf = fitz.open(pdf_name)new_pdf = fitz.open()for p, page in enumerate(src_pdf):    print(f&#x27;\\n- translating PAGE -&#123;p&#125;- ...&#x27;)    # 1.1 创建大小相同的新页面    new_page = new_pdf.new_page(width=page.rect.width, height=page.rect.height)    blocks = page.get_text(&#x27;dict&#x27;)[&#x27;blocks&#x27;]    # 1.2 图片    img_blks = [b for b in blocks if b[&#x27;type&#x27;] == 1]    for img in img_blks:        # pprint(img)        new_page.insert_image(img[&#x27;bbox&#x27;], stream=img[&#x27;image&#x27;])    # 1.3 文字    txt_blks = [b for b in blocks if b[&#x27;type&#x27;] != 1]    for txt in txt_blks:        text_tmp = &#x27;&#x27;.join([s[&#x27;text&#x27;] for l in txt[&#x27;lines&#x27;] for s in l[&#x27;spans&#x27;]])        text_tmp = re.sub(&#x27;[@#$%^&amp;*\\&#x27;\\&quot;\\n\\r\\t]&#x27;, &#x27; &#x27;, text_tmp).strip()        if text_tmp:            # print(txt[&#x27;bbox&#x27;], text_tmp)            text_translate = &#x27;中国 &#x27; + text_tmp            # text_translate = youdao(text_tmp)            new_page.insert_textbox(txt[&#x27;bbox&#x27;], text_translate,                                    fontsize=6,                                    fontname=&#x27;simhei&#x27;,                                    fontfile=r&#x27;C:\\Windows\\Fonts\\simhei.ttf&#x27;)    # if p == 1:    #     breaknew_name = pdf_name.replace(&#x27;.pdf&#x27;, &#x27;-zh.pdf&#x27;)new_pdf.save(new_name)print(&#x27;\\n------Done!-------&#x27;)\n\n\n2. 有道翻译# %%# %%import requestsimport jsonimport timedef youdao(en_txt=&#x27;&#x27;):    api_url = &#x27;http://fanyi.youdao.com/translate?&amp;i=&#123;&#125;&amp;doctype=json&#x27;    res = requests.get(api_url.format(en_txt)).json()    time.sleep(3.0)    # print(res)    zh_txt = &#x27;&#x27;.join([seq[&#x27;tgt&#x27;] for seq in res[&#x27;translateResult&#x27;][0]])    print(f&#x27;*** &#123;en_txt&#125; \\n--&gt; &#123;zh_txt&#125;&#x27;)    return zh_txten_txt = &#x27;so we beat on, boats against the current, borne back ceaselessly into the past.&#x27;youdao(en_txt)\n\n3. 百度翻译# %%import requestsimport randomimport jsonfrom hashlib import md5import time# ref: https://api.fanyi.baidu.com/doc/appid = &#x27;2222222222222222&#x27;appkey = &#x27;ooooooooooooooooooo&#x27;# Generate salt and signdef make_md5(s, encoding=&#x27;utf-8&#x27;):    return md5(s.encode(encoding)).hexdigest()def baidu(en_txt=&#x27;&#x27;):    salt = random.randint(32768, 65536)    sign = make_md5(appid + en_txt + str(salt) + appkey)    api_url = &#x27;http://api.fanyi.baidu.com/api/trans/vip/translate&#x27;    headers = &#123;&#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;&#125;    payload = &#123;&#x27;appid&#x27;: appid, &#x27;q&#x27;: en_txt, &#x27;from&#x27;: &#x27;en&#x27;, &#x27;to&#x27;: &#x27;zh&#x27;, &#x27;salt&#x27;: salt, &#x27;sign&#x27;: sign&#125;    res = requests.get(api_url, params=payload, headers=headers, timeout=3.0).json()    time.sleep(3.0)    if &#x27;trans_result&#x27; in res.keys():        zh_txt = &#x27;&#x27;.join([seq[&#x27;dst&#x27;] for seq in res[&#x27;trans_result&#x27;]])        print(f&#x27;*** &#123;en_txt&#125; \\n--&gt; &#123;zh_txt&#125;&#x27;)        return zh_txt    if &#x27;error_code&#x27; in res.keys():        print(f&#x27;*** &#123;en_txt&#125; \\n??? &#123;res&#125;&#x27;)en_txt = &#x27;so we beat on, boats against the current, borne back ceaselessly into the past.&#x27;baidu(en_txt)\n\n","categories":["office"],"tags":["pdf"]},{"title":"群晖218+增加内存","url":"/2021/09/25/synology/%E7%BE%A4%E6%99%96218+%E5%A2%9E%E5%8A%A0%E5%86%85%E5%AD%98/","content":"\n这里可查CPU、内存型号https://kb.synology.com/en-us/DSM/tutorial/What_kind_of_CPU_does_my_NAS_have\n\n\n群晖型号：DS218+\nCPU ：Intel Celeron J3355\tDual Core\n架构： Apollolake(x64)：\n内存：DDR3L SODIMM 2GB\n\n\n群晖 DS218+ 原装内存只有 2GB，机器内预留了一个内存插槽，准备再加一个。\n看了网上说群晖的机子认内存，而且最大识别到8G，也有说16G的，可以命令查询。\n查看群晖内存 sudo dmidecode -t memory：\n$ sudo dmidecode -t memory# dmidecode 3.2Getting SMBIOS data from sysfs.SMBIOS 3.0.0 present.Handle 0x0023, DMI type 16, 23 bytesPhysical Memory Array        Location: System Board Or Motherboard        Use: System Memory        Error Correction Type: None        Maximum Capacity: 16 GB        Error Information Handle: No Error        Number Of Devices: 1Handle 0x0025, DMI type 17, 40 bytesMemory Device        Array Handle: 0x0023        Error Information Handle: No Error        Total Width: 8 bits        Data Width: 8 bits        Size: 2048 MB        Form Factor: SODIMM        Set: None        Locator: ChannelB-DIMM0        Bank Locator: BANK 1        Type: DDR3        Type Detail: Synchronous        Speed: 1600 MT/s        Manufacturer: 0824        Serial Number: 25073816        Asset Tag: 9876543210        Part Number: D3SS56161XL10AA        Rank: Unknown        Configured Memory Speed: 1600 MT/s        Minimum Voltage: Unknown        Maximum Voltage: Unknown        Configured Voltage: Unknown\n\n可以看到 Maximum Capacity: 16 GB\n\n\n我这里只考虑加个 4G 的就行了，总共 6G，目前需求不大。。。\n京东随便买了一个：\n\n协德 (xiede)1.35V低电压版DDR3L 1866 1867 4G笔记本内存条\n\n我去，安上去直接翻车了。。。群晖不开机。\n\n家里有个老的 Dell 笔记本是 8G 内存（2 x 4G），有个金士顿的\n把金士顿的调换过来，群晖可以开机了，笔记本也没问题。\n$ sudo dmidecode -t memory# dmidecode 3.2Getting SMBIOS data from sysfs.SMBIOS 3.0.0 present.Handle 0x0023, DMI type 16, 23 bytesPhysical Memory Array        Location: System Board Or Motherboard        Use: System Memory        Error Correction Type: None        Maximum Capacity: 16 GB        Error Information Handle: No Error        Number Of Devices: 2Handle 0x0024, DMI type 17, 40 bytesMemory Device        Array Handle: 0x0023        Error Information Handle: No Error        Total Width: 8 bits        Data Width: 8 bits        Size: 4096 MB        Form Factor: SODIMM        Set: None        Locator: ChannelA-DIMM0        Bank Locator: BANK 0        Type: DDR3        Type Detail: Synchronous        Speed: 1600 MT/s        Manufacturer: Kingston        Serial Number: 19041716        Asset Tag: 9876543210        Part Number: HP16D3LS1KBG/4G        Rank: Unknown        Configured Memory Speed: 1600 MT/s        Minimum Voltage: Unknown        Maximum Voltage: Unknown        Configured Voltage: UnknownHandle 0x0025, DMI type 17, 40 bytesMemory Device        Array Handle: 0x0023        Error Information Handle: No Error        Total Width: 8 bits        Data Width: 8 bits        Size: 2048 MB        Form Factor: SODIMM        Set: None        Locator: ChannelB-DIMM0        Bank Locator: BANK 1        Type: DDR3        Type Detail: Synchronous        Speed: 1600 MT/s        Manufacturer: 0824        Serial Number: 25073816        Asset Tag: 9876543210        Part Number: D3SS56161XL10AA        Rank: Unknown        Configured Memory Speed: 1600 MT/s        Minimum Voltage: Unknown        Maximum Voltage: Unknown        Configured Voltage: Unknown\n\n","categories":["synology"],"tags":["synology"]},{"title":"OrangeRobot","url":"/2021/09/07/yoyo/20210907-OrangeRobot/","content":"\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"自行车","url":"/2021/09/07/yoyo/20210907-%E8%87%AA%E8%A1%8C%E8%BD%A6/","content":"暑假马上结束了，悠悠约了琪琪姐姐要好好玩，连续几天晚上吃过饭都骑自行车去秦淮河边公园，一直玩到9点多。\n我准备给她自行车加一个小灯，这样方便我能一眼找到她。\n灯就用仙女棒上的，棒子已经丢了，一串小灯还留着，挺长的有1米多，但纽扣电池没电了，换成两节5号电池，刚好有个电池盒。\n我正在安，悠悠说，爸爸你要做成能拆下来的。\n我问为啥？\n我下次要换大自行车，还把这灯安上去。\n我说不用，到时候灯也换新的。\n过一会，我把灯缠好了，线头准备焊到电池盒上。\n悠悠说，你这可以换电池吗？没电了咋办。\n可以换的，电池盒子可以打开。\n有开关吗？灯是一直亮着的吗？\n有。呶，关了。\n\n\n\n我继续固定电池盒，用热熔胶固定座椅下面，再用透明胶带缠了几圈。\n小家伙又跑来，爸爸，你开关要放在外面，我能看到的地方，不然我就够不到了。\n我说我已经安好了，你来看看能不能够到。\n嗯，可以。\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"企业微信推送 x Github Action [python]","url":"/2021/08/22/python-app/wechat-push-github-action/","content":"配置 Github Action, 推送企业微信消息\n1. 将企业微信的 secret 添加到 Action Secret打开 hexo-source 仓库设置，在 Secrets 选项中，分别新建 3个 repo secret:\n\n名称设为CORP_ID, 内容为corpid的内容\n名称设为CORP_SECRET, 内容为secret的内容\n名称设为AGENT_ID, 内容为agentid的内容\n\n2. 修改 wechat-push 代码以发送 commit log 信息为列, 代码如下：\n\n\nimport osimport jsonimport requests# https://work.weixin.qq.com/wework_admin/frame#profilecorp_id = os.environ[&#x27;CORP_ID&#x27;]corp_secret = os.environ[&#x27;CORP_SECRET&#x27;]agent_id = os.environ[&#x27;AGENT_ID&#x27;]def get_access_token(corp_id, corp_secret):    resp = requests.get(f&#x27;https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=&#123;corp_id&#125;&amp;corpsecret=&#123;corp_secret&#125;&#x27;)    js = json.loads(resp.text)    print(js)    if js[&quot;errcode&quot;] == 0:        access_token = js[&quot;access_token&quot;]        expires_in = js[&quot;expires_in&quot;]        return access_token, expires_indef wechat_push_text(agent_id, access_token, message):    data = &#123;        &quot;touser&quot;: &quot;@all&quot;,        &quot;msgtype&quot;: &#x27;text&#x27;,        &quot;agentid&quot;: agent_id,        &quot;text&quot;: &#123;            &quot;content&quot;: message        &#125;,        &quot;safe&quot;: 0,        &quot;enable_id_trans&quot;: 0,        &quot;enable_duplicate_check&quot;: 0,        &quot;duplicate_check_interval&quot;: 1800    &#125;    resp = requests.post(f&#x27;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=&#123;access_token&#125;&#x27;, json=data)    js = json.loads(resp.text)    print(js)    if js[&quot;errcode&quot;] == 0:        return jswith open(&#x27;commit_log.md&#x27;, &#x27;r&#x27;) as f:    log = f.read()    access_token, expires_in = get_access_token(corp_id, corp_secret)    wechat_push_text(agent_id=agent_id, access_token=access_token, message=log)\n\n3. 编写 Github Actions 配置文件name: Wework MSG Auto Pushon: [push]jobs:  build:    name: Wework MSG Auto Push by GitHub Actions    runs-on: ubuntu-latest    steps:    - name: 1. setup python...      uses: actions/setup-python@v1    - name: 2. send commit log to wework ...      env:        CORP_ID: $&#123;&#123; secrets.CORP_ID &#125;&#125;        CORP_SECRET: $&#123;&#123; secrets.CORP_SECRET &#125;&#125;        AGENT_ID: $&#123;&#123; secrets.AGENT_ID &#125;&#125;      run: |        echo -e &quot;commit log:\\n&quot; &gt; commit_log.md        echo -e &quot;$(git log -1 --stat)&quot; &gt;&gt; commit_log.md                log=$(cat commit_log.md)        python -m pip install requests        python wechat_push.py\n\n\n以上。\n","categories":["python"],"tags":["python","github_actions","wechat"]},{"title":"企业微信推送[python]","url":"/2021/08/03/python-app/wechat-push-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%8E%A8%E9%80%81/","content":"qiye-wechat-push企业微信推送 python版：\n\n不需要安装企业微信客户端\n可在微信中直接收到文本消息，内容显全文\n\n1. 企业微信注册\n1.1 注册企业\n\n用电脑打开企业微信官网，https://work.weixin.qq.com/， 注册一个企业\n\n1.2 获取企业ID\n\n我的企业 –&gt; 最下边可以看到企业ID: corpid\n\n1.3 获取应用ID\n\n管理企业 –&gt; 应用管理 –&gt; 创建应用 \n创建完成后可得到应用ID agentid \n\n1.4 获取Secret\n\n还在应用页面， 获取 Secret， 需要在企业微信客户端里接收。\n这样就得到了 secret \n2. 发送文本消息 python\n\n\n2.1 官方API：\n\n用到了两个API\n\n\n获取 access_token ： https://work.weixin.qq.com/api/doc/90000/90135/91039\n发送应用消息 ： https://work.weixin.qq.com/api/doc/90000/90135/90236\n\n\n\n2.2 python 代码：\n\nimport jsonimport requests# https://work.weixin.qq.com/wework_admin/frame#profilecorp_id = &#x27;wwxxxxxxxxxxxxxxxxx&#x27;corp_secret = &#x27;Ghxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;agent_id = &#x27;10xxxxxx&#x27;def get_access_token(corp_id, corp_secret):    resp = requests.get(f&#x27;https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=&#123;corp_id&#125;&amp;corpsecret=&#123;corp_secret&#125;&#x27;)    js = json.loads(resp.text)    print(js)    if js[&quot;errcode&quot;] == 0:        access_token = js[&quot;access_token&quot;]        expires_in = js[&quot;expires_in&quot;]        return access_token, expires_indef wechat_push_text(agent_id, access_token, message):    data = &#123;        &quot;touser&quot;: &quot;@all&quot;,        &quot;msgtype&quot;: &#x27;text&#x27;,        &quot;agentid&quot;: agent_id,        &quot;text&quot;: &#123;            &quot;content&quot;: message        &#125;,        &quot;safe&quot;: 0,        &quot;enable_id_trans&quot;: 0,        &quot;enable_duplicate_check&quot;: 0,        &quot;duplicate_check_interval&quot;: 1800    &#125;    resp = requests.post(f&#x27;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=&#123;access_token&#125;&#x27;, json=data)    js = json.loads(resp.text)    print(js)    if js[&quot;errcode&quot;] == 0:        return jsaccess_token, expires_in = get_access_token(corp_id, corp_secret)wechat_push_text(agent_id=agent_id, access_token=access_token, message=&#x27;wechat notify\\ntest&#x27;)\n\n\n\n代码：\nhttps://github.com/shenbo/qiye-wechat-push\n\n","categories":["python"],"tags":["python","wechat"]},{"title":"群晖自编译套件SPK","url":"/2021/07/06/synology/%E7%BE%A4%E6%99%96%E8%87%AA%E7%BC%96%E8%AF%91%E5%A5%97%E4%BB%B6SPK/","content":"DSM 升级至 7.0 之后，很多第三方套件不兼容了。\nSynoCommunity 上给出了各套件的适配情况：\n\n issue #4524: https://github.com/SynoCommunity/spksrc/issues/4524\n\nzsh 也在其中，已经可以 build 了，但是还没正式发布。\n我试着自己编译一下。\nCPU 架构我的群晖是DS218+，CPU 是Intel Celeron J3355，架构是 apollolake(x64).\n\n这里可以查： \n\n\nhttps://github.com/SynoCommunity/spksrc/wiki/Architecture-per-Synology-model\n\n\nhttps://kb.synology.com/en-us/DSM/tutorial/What_kind_of_CPU_does_my_NAS_have\n\n\n\n开发环境\nDS218+ 是支持 Docker 的，首先在套件中心中启用 Docker 套件。\n\nSSH 进入群晖。\n\n下载 spksrc 仓库: git clone https://github.com/SynoCommunity/spksrc.git ~/spksrc\n\n拉取 docker： docker pull synocommunity/spksrc\n\n运行 docker： docker run -it -v ~/spksrc:/spksrc synocommunity/spksrc /bin/bash\n\n切换到dsm7分支:  git checkout dsm7-packages\n\n\n编译cd spksrc/make setup dsm-7.0cd spk/zshmake arch-apollolake-7.0# 在这一步会下载对应CPU架构的工具链，# 群晖官方发布在 sourceforge.net 上，# 速度超慢，需耐心等待。。。\n\n\n成功之后在 spksrc&#x2F;packages&#x2F; 目录下可以看到已经生成的spk文件。\n\n安装套件\n打开套件中心，手动安装 spk 。\n\n\ndone！\n","categories":["synology"],"tags":["synology"]},{"title":"Win10-WSL-Ubuntu20.04-Docker 安装与配置","url":"/2021/07/04/wsl/wsl-ubuntu-docker/","content":"一、WSL 安装 Ubuntu20.04\nWin10 启用 WSL\n\n管理员身份运行：\ndism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart\n\n重启电脑。\n开启虚拟器特性\ndism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart\n\n下载安装包:\n\nWSL2 Linux kernel update package for x64 machines\nhttps://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi\n\n设置默认版本：\nwsl --set-default-version 2\n\n\nref: https://docs.microsoft.com/en-us/windows/wsl/install-win10\n\n\n打开 Microsoft Store，安装 Ubuntu20.04\n\n启动 Ubuntu20.04，创建账号、密码\n\n安装 Windows Terminal（可选）\n\n\n用 scoop 安装。\nscoop install windows-terminal\n\nwindows-terminal 简单设置：\n\n启动目录： //wsl$/Ubuntu-20.04//home/bo\n字体： Jetbrains Mono\n\n\n设置源，更新（可选）\n\n\n\n打开配置文件： sudo nano /etc/apt/sources.list, 替换成以下内容：\n# 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse# 预发布软件源，不建议启用# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse\nref： https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/\n更新：sudo apt update\n升级：sudo apt upgrade\n\n安装 ZSH、oh-my-zsh（可选）\n\n参考 zsh &amp; oh-my-zsh 安装配置 \n二、安装 Docker\nref： https://docs.docker.com/engine/install/ubuntu/\n\n\n首先更新索引，安装必要的依赖软件，添加新的 HTTPS 软件源\n\nsudo apt updatesudo apt install apt-transport-https \\                 ca-certificates \\                 curl \\                 gnupg \\                 lsb-release\n\n\n使用下面的 curl 导入源仓库的 GPG key\n\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\n\n\n添加 Docker APT 软件源\n\necho \\  &quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \\  $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n\n现在，Docker 软件源被启用了，你可以安装软件源中任何可用的 Docker 版本。\n\n安装 Docker 最新版本\n\nsudo apt-get updatesudo apt-get install docker-ce docker-ce-cli containerd.io\n\n\n运行一下是否安装成功\n\nsudo docker run hello-world\n\n可能或报错：\nCannot connect to the Docker daemon at unix:///var/run/docker.sock. &gt; Is the docker daemon running?\n再试一下：\nsudo systemctl status dockersudo systemctl status docker\n\n\n还是报错：\nSystem has not been booted with systemd as init system (PID 1). Can&#x27;t operate.Failed to connect to bus: Host is down\n原因是 WSL 没有完全实现 Linux 下的 systemctl 的命令， 可以检查一下：\n# check if your system is using `systemd` or `sysvinit`ps -p 1 -o comm=# If the command doesn&#x27;t return systemd, and in my case, Ubuntu-20.04 on WSL, the command returned init, then use the command pattern# start services using sysvinitservice docker start\n\nref: https://stackoverflow.com/questions/52604068/using-wsl-ubuntu-app-system-has-not-been-booted-with-system-as-init-system-pi\n\n因此，在WSL下 要用以下命令启动 docker。\nservice docker start\n\n\ndone!\n","categories":["WSL"],"tags":["Docker","Ubuntu","WSL"]},{"title":"python调用ffmpeg批量转换音频flac、mp3、m4a","url":"/2021/06/30/python/python%E8%B0%83%E7%94%A8ffmpeg%E6%89%B9%E9%87%8F%E8%BD%AC%E6%8D%A2%E9%9F%B3%E9%A2%91flac%E3%80%81mp3%E3%80%81m4a/","content":"ffmpeg 使用说明查看使用说明：ffmpeg -h。\n# usage: ffmpeg [options] [[infile options] -i infile]... &#123;[outfile options] outfile&#125;...# options:-ab:   -ab bitrate         audio bitrate (please use -b:a)-y:    overwrite output files\n\n转换命令如下：\nffmpeg -i xxx.flac -ab 320k xxx.mp3 -y&#x27;\n\n这次我们用到的主要是 -ab 命令，用来指定音频转换的比特率，常见的有: 192K， 320K 等。\n\n\n遍历文件夹中的所有音频文件, 将 flac 转为 mp3 或 m4aimport osimport subprocesspath = &#x27;~/music/FLAC/&#x27;str = &#x27;ffmpeg -i &quot;&#123;&#125;&quot; -ab 320k &quot;&#123;&#125;&quot; -y&#x27;for parent, dirnames, filenames in os.walk(path):    for filename in filenames:        old_dir = os.path.join(parent, filename)        if old_dir[-4:] == &#x27;flac&#x27;:            new_dir = old_dir.replace(&#x27;.flac&#x27;, &#x27;.mp3&#x27;)            new_dir = old_dir.replace(&#x27;.flac&#x27;, &#x27;.m4a&#x27;)            str_cmd = str.format(old_dir, new_dir)            print(str_cmd)            p = subprocess.Popen(str_cmd, shell=True, stdout=subprocess.PIPE)            for line in iter(p.stdout.readline, b&#x27;&#x27;):                print(line.strip().decode(&#x27;gbk&#x27;))\n\n删除原有的 flac 文件import osimport subprocesspath = &#x27;~/music/FLAC/&#x27;for parent, dirnames, filenames in os.walk(path):    for filename in filenames:        old_dir = os.path.join(parent, filename)        if old_dir[-4:] == &#x27;flac&#x27;:            print(old_dir)            os.remove(old_dir)\n","categories":["python"],"tags":["python","ffmpeg"]},{"title":"视频字幕提取-基于opencv和tesseract","url":"/2021/06/11/sci-opencv/%E8%A7%86%E9%A2%91%E5%AD%97%E5%B9%95%E6%8F%90%E5%8F%96-opencv-tesseract/","content":"视频内字幕提取\n这里是针对内封了硬字幕的视频，字幕已经成为了画面的一部分。\n思路：简单用 opencv 提取视频内的所有帧，然后用 tesseract 对图片进行 ocr 识别。\n目前的效率较低、准确度也一般，凑合用。\n0. 首先需要配置一下0.1 安装 python 库\npython-opencv\npytesseract\nscikit-image\n\n0.2 安装 tesseract 软件，下载训练好的语言包\ntesseract 软件可以用 scoop 安装：\n\nscoop install tesseract\n\ntesseract 训练好的语言包\n\n帮助文档： https://tesseract-ocr.github.io/tessdoc/\n官方体提供了三种训练好的模型： \n\ntessdata\ntessdata_best\ntessdata_fast\n\n我们这里选择 tessdata_fast ：\n\n中文： https://raw.githubusercontent.com/tesseract-ocr/tessdata-fast/master/{}.traineddata\n英文： https://raw.githubusercontent.com/tesseract-ocr/tessdata-dast/master/{}.traineddata\n中括号里是语言的名字：如 chi_sim、eng 等。\n\n\n\n可以用python下载：\nimport osfrom urllib.request import urlretrievedef download_tessdata(url, savepath=&#x27;./&#x27;):    # 显示下载进度    def reporthook(a, b, c):        print(&quot;\\rdownloading: %5.1f%%&quot; % (a * b * 100.0 / c), end=&quot;&quot;)    filename = os.path.basename(url)    if not os.path.isfile(os.path.join(savepath, filename)):        print(&#x27;Downloading data from %s&#x27; % url)        urlretrieve(url, os.path.join(savepath, filename), reporthook=reporthook)        print(&#x27;\\nDownload finished!&#x27;)    else:        print(&#x27;File already exsits!&#x27;)    filesize = os.path.getsize(os.path.join(savepath, filename))  # 获取文件大小    print(&#x27;File size = %.2f Mb&#x27; % (filesize / 1024 / 1024))  # Bytes转换为Mbtessdata_dir = &#x27;./tessdata/&#x27;tessdata_url = &#x27;https://ghproxy.net/https://raw.githubusercontent.com/tesseract-ocr/tessdata/master/&#123;&#125;.traineddata&#x27;# 语言： 中+英lang = &#x27;chi_sim+eng&#x27;for lang_name in lang.split(&#x27;+&#x27;):    download_tessdata(tessdata_url.format(lang_name), tessdata_dir)\n\n1. 读取视频使用 opencv 读取视频\nimport cv2video_path = &#x27;d7.mp4&#x27;v = cv2.VideoCapture(video_path)num_frames = int(v.get(cv2.CAP_PROP_FRAME_COUNT))fps = v.get(cv2.CAP_PROP_FPS)height = int(v.get(cv2.CAP_PROP_FRAME_HEIGHT))width = int(v.get(cv2.CAP_PROP_FRAME_WIDTH))print(f&#x27;video      :  &#123;video_path&#125;\\n&#x27;      f&#x27;num_frames :  &#123;num_frames&#125;\\n&#x27;      f&#x27;fps        :  &#123;fps&#125;\\n&#x27;      f&#x27;resolution :  &#123;width&#125; x &#123;height&#125;&#x27;)\n\n2. 提取所有帧import datetimedef get_frame_index(time_str: str, fps: float):    t = time_str.split(&#x27;:&#x27;)    t = list(map(float, t))    if len(t) == 3:        td = datetime.timedelta(hours=t[0], minutes=t[1], seconds=t[2])    elif len(t) == 2:        td = datetime.timedelta(minutes=t[0], seconds=t[1])    else:        raise ValueError(            &#x27;Time data &quot;&#123;&#125;&quot; does not match format &quot;%H:%M:%S&quot;&#x27;.format(time_str))    index = int(td.total_seconds() * fps)    return index# 起始时间、结束时间time_start = &#x27;0:00&#x27;time_end = &#x27;0:10&#x27;ocr_start = get_frame_index(time_start, fps) if time_start else 0ocr_end = get_frame_index(time_end, fps) if time_end else num_framesnum_ocr_frames = ocr_end - ocr_startprint(f&#x27;ocr_start       :  &#123;ocr_start&#125;\\n&#x27;      f&#x27;ocr_end         :  &#123;ocr_end&#125;\\n&#x27;      f&#x27;num_ocr_frames  :  &#123;num_ocr_frames&#125;&#x27;)\n\n3. 只保留画面中有字幕的区域# *** 调整字幕区域的高度，按比例 ***h1, h2 = 0.86, 0.94h1, h2 = int(height * h1), int(height * h2)v.set(cv2.CAP_PROP_POS_FRAMES, ocr_start)frames = [v.read()[1] for _ in range(num_ocr_frames)]z_frames = [frame[h1:h2, :] for frame in frames]# 预览一下title = &#x27;preview&#x27;cv2.startWindowThread()cv2.namedWindow(title)for idx, img in enumerate(z_frames):    tmp_img = img.copy()    cv2.putText(tmp_img, f&#x27;idx:&#123;idx&#125;&#x27;, (5, 25),                 cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 255, 255), 2)    cv2.imshow(title, tmp_img)    cv2.imshow(title, img)    cv2.waitKey(50)cv2.destroyWindow(title)cv2.destroyAllWindows()\n\n4. 去除相似度较高的帧，保留关键帧为了减少识别量，先去除一部分相似度较高的图片。\n\n计算两个图片的均方差（即 MSE）， 采用 skimage.metrics.mean_squared_error 函数\n\n# 设置阈值mse_threshold = 100from skimage.metrics import mean_squared_errork_frames = [&#123;&#x27;start&#x27;: 0,             &#x27;end&#x27;: 0,             &#x27;frame&#x27;: z_frames[0],             &#x27;text&#x27;: &#x27;&#x27;&#125;]for idx in range(1, num_ocr_frames):    img1 = z_frames[idx - 1]    img2 = z_frames[idx]    mse = mean_squared_error(img1, img2)    # print(idx, mse)    if mse &lt; mse_threshold:        k_frames[-1][&#x27;end&#x27;] = idx    else:        k_frames.append(&#123;&#x27;start&#x27;: idx,                         &#x27;end&#x27;: idx,                         &#x27;frame&#x27;: z_frames[idx],                         &#x27;text&#x27;: &#x27;&#x27;&#125;)for kf in k_frames:    print(f&quot;&#123;kf[&#x27;start&#x27;]&#125; --&gt; &#123;kf[&#x27;end&#x27;]&#125; : &#123;kf[&#x27;text&#x27;]&#125;&quot;)\n\n5. 识别字幕import pytesseractconfig = f&#x27;--tessdata-dir &quot;&#123;tessdata_dir&#125;&quot; --psm 7&#x27;for idx, kf in enumerate(k_frames):    # 识别为字符串    ocr_str = pytesseract.image_to_string(kf[&#x27;frame&#x27;], lang=lang, config=config)    ocr_str = ocr_str.strip().replace(&#x27; &#x27;, &#x27;&#x27;)    if ocr_str:        k_frames[idx][&#x27;text&#x27;] = ocr_str        print(f&quot;&#123;kf[&#x27;start&#x27;]&#125; --&gt; &#123;kf[&#x27;end&#x27;]&#125; : &#123;kf[&#x27;text&#x27;]&#125;&quot;)print([k_frames.remove(kf) for kf in k_frames if not kf[&#x27;text&#x27;]])\n\n6. 格式化字幕for kf in k_frames:    print(f&quot;&#123;kf[&#x27;start&#x27;]&#125; --&gt; &#123;kf[&#x27;end&#x27;]&#125; : &#123;kf[&#x27;text&#x27;]&#125;&quot;)def get_srt_timestamp(frame_index: int, fps: float):    td = datetime.timedelta(seconds=frame_index / fps)    ms = td.microseconds // 1000    m, s = divmod(td.seconds, 60)    h, m = divmod(m, 60)    return &#x27;&#123;:02d&#125;:&#123;:02d&#125;:&#123;:02d&#125;,&#123;:03d&#125;&#x27;.format(h, m, s, ms)for kf in k_frames:    time1 = get_srt_timestamp(kf[&#x27;start&#x27;], fps)    time2 = get_srt_timestamp(kf[&#x27;end&#x27;], fps)    print(f&quot;&#123;time1&#125; --&gt; &#123;time2&#125;\\n&#123;kf[&#x27;text&#x27;]&#125;\\n&quot;)\n\n\n完整代码：ref: https://github.com/shenbo/video-subtitles-ocr\n# %%# 0. 下载语言import osfrom urllib.request import urlretrievedef download_tessdata(url, savepath=&#x27;./&#x27;):    # 显示下载进度    def reporthook(a, b, c):        print(&quot;\\rdownloading: %5.1f%%&quot; % (a * b * 100.0 / c), end=&quot;&quot;)    filename = os.path.basename(url)    if not os.path.isfile(os.path.join(savepath, filename)):        print(&#x27;Downloading data from %s&#x27; % url)        urlretrieve(url, os.path.join(savepath, filename), reporthook=reporthook)        print(&#x27;\\nDownload finished!&#x27;)    else:        print(&#x27;File already exsits!&#x27;)    filesize = os.path.getsize(os.path.join(savepath, filename))  # 获取文件大小    print(&#x27;File size = %.2f Mb&#x27; % (filesize / 1024 / 1024))  # Bytes转换为Mbtessdata_dir = &#x27;./tessdata/&#x27;tessdata_url = &#x27;https://ghproxy.net/https://raw.githubusercontent.com/tesseract-ocr/tessdata/master/&#123;&#125;.traineddata&#x27;# 语言： 中+英lang = &#x27;chi_sim+eng&#x27;for lang_name in lang.split(&#x27;+&#x27;):    download_tessdata(tessdata_url.format(lang_name), tessdata_dir)# %%# 1. 读取视频import cv2video_path = &#x27;d7.mp4&#x27;v = cv2.VideoCapture(video_path)num_frames = int(v.get(cv2.CAP_PROP_FRAME_COUNT))fps = v.get(cv2.CAP_PROP_FPS)height = int(v.get(cv2.CAP_PROP_FRAME_HEIGHT))width = int(v.get(cv2.CAP_PROP_FRAME_WIDTH))print(f&#x27;video      :  &#123;video_path&#125;\\n&#x27;      f&#x27;num_frames :  &#123;num_frames&#125;\\n&#x27;      f&#x27;fps        :  &#123;fps&#125;\\n&#x27;      f&#x27;resolution :  &#123;width&#125; x &#123;height&#125;&#x27;)# %%# 2. 提取帧import datetimedef get_frame_index(time_str: str, fps: float):    t = time_str.split(&#x27;:&#x27;)    t = list(map(float, t))    if len(t) == 3:        td = datetime.timedelta(hours=t[0], minutes=t[1], seconds=t[2])    elif len(t) == 2:        td = datetime.timedelta(minutes=t[0], seconds=t[1])    else:        raise ValueError(            &#x27;Time data &quot;&#123;&#125;&quot; does not match format &quot;%H:%M:%S&quot;&#x27;.format(time_str))    index = int(td.total_seconds() * fps)    return index# 起始时间、结束时间time_start = &#x27;0:00&#x27;time_end = &#x27;0:10&#x27;ocr_start = get_frame_index(time_start, fps) if time_start else 0ocr_end = get_frame_index(time_end, fps) if time_end else num_framesnum_ocr_frames = ocr_end - ocr_startprint(f&#x27;ocr_start       :  &#123;ocr_start&#125;\\n&#x27;      f&#x27;ocr_end         :  &#123;ocr_end&#125;\\n&#x27;      f&#x27;num_ocr_frames  :  &#123;num_ocr_frames&#125;&#x27;)# %%# 3. 只保留画面中的字幕区域# *** 调整字幕区域的高度，按比例 ***h1, h2 = 0.86, 0.94h1, h2 = int(height * h1), int(height * h2)v.set(cv2.CAP_PROP_POS_FRAMES, ocr_start)frames = [v.read()[1] for _ in range(num_ocr_frames)]z_frames = [frame[h1:h2, :] for frame in frames]# 预览一下title = &#x27;preview&#x27;cv2.startWindowThread()cv2.namedWindow(title)for idx, img in enumerate(z_frames):    tmp_img = img.copy()    cv2.putText(tmp_img, f&#x27;idx:&#123;idx&#125;&#x27;, (5, 25),                 cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 255, 255), 2)    cv2.imshow(title, tmp_img)    cv2.imshow(title, img)    cv2.waitKey(50)cv2.destroyWindow(title)cv2.destroyAllWindows()# %%# 4. 去除相似度较高的帧，保留关键帧# 设置阈值mse_threshold = 100from skimage.metrics import mean_squared_errork_frames = [&#123;&#x27;start&#x27;: 0,             &#x27;end&#x27;: 0,             &#x27;frame&#x27;: z_frames[0],             &#x27;text&#x27;: &#x27;&#x27;&#125;]for idx in range(1, num_ocr_frames):    img1 = z_frames[idx - 1]    img2 = z_frames[idx]    mse = mean_squared_error(img1, img2)    # print(idx, mse)    if mse &lt; mse_threshold:        k_frames[-1][&#x27;end&#x27;] = idx    else:        k_frames.append(&#123;&#x27;start&#x27;: idx,                         &#x27;end&#x27;: idx,                         &#x27;frame&#x27;: z_frames[idx],                         &#x27;text&#x27;: &#x27;&#x27;&#125;)for kf in k_frames:    print(f&quot;&#123;kf[&#x27;start&#x27;]&#125; --&gt; &#123;kf[&#x27;end&#x27;]&#125; : &#123;kf[&#x27;text&#x27;]&#125;&quot;)# %%# 5. 识别字幕import pytesseractconfig = f&#x27;--tessdata-dir &quot;&#123;tessdata_dir&#125;&quot; --psm 7&#x27;for idx, kf in enumerate(k_frames):    # 识别为字符串    ocr_str = pytesseract.image_to_string(kf[&#x27;frame&#x27;], lang=lang, config=config)    ocr_str = ocr_str.strip().replace(&#x27; &#x27;, &#x27;&#x27;)    if ocr_str:        k_frames[idx][&#x27;text&#x27;] = ocr_str        print(f&quot;&#123;kf[&#x27;start&#x27;]&#125; --&gt; &#123;kf[&#x27;end&#x27;]&#125; : &#123;kf[&#x27;text&#x27;]&#125;&quot;)print([k_frames.remove(kf) for kf in k_frames if not kf[&#x27;text&#x27;]])# %%# 6. 格式化字幕for kf in k_frames:    print(f&quot;&#123;kf[&#x27;start&#x27;]&#125; --&gt; &#123;kf[&#x27;end&#x27;]&#125; : &#123;kf[&#x27;text&#x27;]&#125;&quot;)def get_srt_timestamp(frame_index: int, fps: float):    td = datetime.timedelta(seconds=frame_index / fps)    ms = td.microseconds // 1000    m, s = divmod(td.seconds, 60)    h, m = divmod(m, 60)    return &#x27;&#123;:02d&#125;:&#123;:02d&#125;:&#123;:02d&#125;,&#123;:03d&#125;&#x27;.format(h, m, s, ms)for kf in k_frames:    time1 = get_srt_timestamp(kf[&#x27;start&#x27;], fps)    time2 = get_srt_timestamp(kf[&#x27;end&#x27;], fps)    print(f&quot;&#123;time1&#125; --&gt; &#123;time2&#125;\\n&#123;kf[&#x27;text&#x27;]&#125;\\n&quot;)","categories":["opencv"],"tags":["opencv","tesseract"]},{"title":"GMiner-ETH-HuobiPool","url":"/2021/04/23/tensorflow/GMiner-ETH-HuobiPool/","content":"1. GMiner 说明ref： https://github.com/develsoftware/GMinerRelease\n\n1.1 下载 gminer_2_XX_windows64.zip, 解压后目录如下：\n\n├───miner.exe            # 主程序├───mine_aeternity.bat   # 快捷脚本├───...├───readme.txt           # 说明文档├───sample_config.txt    # 配置文件\n\n\n1.2 参数设置说明\n\n以在 火币矿池 挖 以太币 为例，\nhttps://pool.huobi.pe/pow/help/3/all\n主要参数如下： \n--algo:     算法,可省略； 对于以太币，默认 ethash--server:   矿池地址； 这里填写的是火币矿池--user:     火币矿池的子账户名；注意不是钱包地址，也不是邮箱号...\n\n\n1.3 使用方法（ 直接命令行运行 ）\n\n./miner --algo ethash --server stratum+tcp://es.huobipool.com:1800 --user shenyoyo0706\n\n\n也可以用配置文件运行, 或用快捷脚本运行， 参数设置方法是一样的。\n\n# Sample configuration file to mine BitcoinGold# options has same names as command line arguments# you can access to environment variables by %variable_name%# run &quot;miner --config sample_config.txt&quot;[common]algo=ethashtemplimit=80color=1api=10555logfile=miner.loglog_date=1log_newjob=0# Main pool[server]host=es.huobipool.comport=1800user=shenyoyo0706pass=x\n\n\n\n2. Huobi 网站\n2.1 注册火币网&#x2F;火币矿池账户 （统一的）火币网： https://www.huobi.pe/zh-cn/火币矿池： https://pool.huobi.pe/pow/火币矿池ETH连接规则: https://pool.huobi.pe/pow/help/3/all\n\n2.2 创建子账户\n\n子账户需要设置币种，这里选 ETH，即收益会按 以太币 结算。\n\n子账户名就是火币矿池的收款地址！\n\n这也意味着不用关注以太币的钱包地址有利有弊吧，优点： 可在火币平台上用火币账户直接交易，提现；不用记钱包地址。缺点： 收益默认都托管在平台上。\n\n\n\n\n2.3 开始挖矿\n\n\n开始挖矿后，一般等待15-30分钟后就能看到收益。\n\n2.4 监测矿机、收益\n\nweb版\n\n矿机监控： https://pool.huobi.pe/pow/miners\n收益监控： https://pool.huobi.pe/pow/earnings\n\napp版\n\n火币矿池 pro： http://eoshuobipool.com/zj.html\n\n名词解释：\n\n\n\n名称\n单位\n说明\n备注\n\n\n\n币价\nUSDT&#x2F;ETH\n3091\n美元&#x2F;以太币\n\n\n币价\nCNY&#x2F;ETH\n20311\n人民币&#x2F;以太币\n\n\n全网算力\nTH&#x2F;s\n541.07\n\n\n\n矿池算力\nTH&#x2F;s\n30.51\n\n\n\n预计日收益\nCNY&#x2F;M\n0.63\n人民币&#x2F;兆算力\n\n\n预计日收益\nETH&#x2F;M\n0.00003117\n\n\n\n我的算力\nMH&#x2F;s\n36.08\n\n\n\nETH收益\nETH&#x2F;d\n0.00128769\n\n\n\n\n2.5 交易、提现\n\napp版\n\n火币 pro： http://m.huobi.pe/zh-cn/download/\n\n提现流程：\n\n资产页面 –&gt; 币币 –(划转)–&gt; 法币 –(我要卖)–&gt; 散户收购（支持 微信&#x2F;支付宝&#x2F;银行卡）\n\n","categories":["tensorflow"],"tags":["GMiner","Huobi","ETH","RTX2070"]},{"title":"使用 scoop 安装管理 windows 软件（2）：github 加速","url":"/2021/03/23/scoop/%E4%BD%BF%E7%94%A8scoop%E5%AE%89%E8%A3%85%E7%AE%A1%E7%90%86windows%E8%BD%AF%E4%BB%B6(2)-github%E5%8A%A0%E9%80%9F/","content":"\nref: (https://github.com/ScoopInstaller/Scoop)\n\n1. 安装 scoop1.1 安装 PowerShell 5.0 以上版本\nwin10： 已自带；\nwin7 x64： 下载 Win7AndW2K8R2-KB3191566-x64.zip，安装；\nref: https://docs.microsoft.com/zh-cn/powershell/scripting/install/installing-windows-powershell?view=powershell-6\n\n\n\n1.2 以当前Win账户运行PowerShellSet-ExecutionPolicy RemoteSigned -Scope CurrentUser\n1.3 安装 scoopgithubghproxyirm get.scoop.sh | iexcd ~curl -o scoop_install.ps1 https://ghproxy.net/https://raw.githubusercontent.com/ScoopInstaller/install/master/install.ps1# 修改 `scoop_install.ps1` 内容：(Get-Content scoop_install.ps1).replace(&#x27;https://github.com/ScoopInstaller/&#x27;, &#x27;https://ghproxy.net/https://github.com/ScoopInstaller/&#x27;) | Set-Content scoop_install.ps1# 安装.\\scoop_install.ps1\n\n使用默认安装时经常卡住，是因为 https://get.scoop.sh 其实指向了 https://raw.githubusercontent.com/，因而导致安装失败。\n对应的安装文件在这里： https://github.com/ScoopInstaller/Install/blob/master/install.ps1\n1.4 可用的镜像源\n镜像1:  https://hub.fastgit.xyz/\n镜像2:  https://github.com.cnpmjs.org/\n镜像3:  https://ghproxy.net/\n镜像4:  https://pd.zwc365.com/\n\n\n\n2. 使用 github (mirror) 更新 Scoop、 bucket 库githubghproxyscoop config SCOOP_REPO &#x27;https://github.com/ScoopInstaller/Scoop&#x27;scoop bucket add mainscoop bucket add extrasscoop bucket add versionsscoop bucket add portablesoft &#x27;https://github.com/shenbo/portablesoft&#x27;scoop bucket listscoop config SCOOP_REPO &#x27;https://ghproxy.net/https://github.com/ScoopInstaller/Scoop&#x27;scoop bucket add main &#x27;https://ghproxy.net/https://github.com/ScoopInstaller/Main&#x27;scoop bucket add extras &#x27;https://ghproxy.net/https://github.com/ScoopInstaller/Extras&#x27;scoop bucket add versions &#x27;https://ghproxy.net/https://github.com/ScoopInstaller/Versions&#x27;scoop bucket add portablesoft &#x27;https://ghproxy.net/https://github.com/shenbo/portablesoft&#x27;\n\n3 安装常用软件# main bucketsscoop install 7zipscoop install gitscoop install aria2scoop install concfgscoop install psreadlinescoop install posh-gitscoop install oh-my-poshscoop install ffmpeg# extra bucketsscoop install everythingscoop install trafficmonitorscoop install vscodescoop install windows-terminalscoop install forkscoop install snipastescoop install handbrakescoop install qbittorrentscoop intsall speccyscoop install vcredist2022# portablesoftscoop install goodsync_xscoop install mas_x# pythonscoop install python39    # versions# pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simplescoop install pycharm     # extrascoop install cuda11.2# ref:  https://developer.nvidia.com/rdp/cudnn-archive# nodejsscoop install nodejs      # main# latexscoop install miktex      # mainscoop install texstudio   # extrascoop install mupdf\n\n3. 修改 scoop 安装文件源码， 加速软件源文件从 github 上的下载手动修改命令修改恢复默认cd ~\\scoop\\apps\\scoop\\current\\ | notepad lib\\install.ps1# line 245 左右，添加以下内容：# $urlstxt_content += &quot;$(handle_special_urls $url)`n&quot;$urlstxt_content += &quot;$(handle_special_urls $url)`n&quot;.Replace(&quot;https://github.com&quot;, &quot;https://hub.fastgit.xyz&quot;).Replace(&quot;https://raw.githubusercontent.com&quot;, &quot;https://raw.fastgit.org&quot;)$urlstxt_content += &quot;$(handle_special_urls $url)`n&quot;.Replace(&quot;https://github.com&quot;, &quot;https://ghproxy.net/https://github.com&quot;).Replace(&quot;https://raw.githubusercontent.com&quot;, &quot;https://ghproxy.net/https://raw.githubusercontent.com&quot;)$scoop_install_file = &#x27;~\\scoop\\apps\\scoop\\current\\lib\\install.ps1&#x27;$old_install_cmd = &#x27;$urlstxt_content += &quot;$(handle_special_urls $url)`n&quot;&#x27;$web_github = &quot;https://github.com&quot;$web_mirror = &quot;https://ghproxy.net/https://github.com&quot;$raw_github = &quot;https://raw.githubusercontent.com&quot; $raw_mirror = &quot;https://ghproxy.net/https://raw.githubusercontent.com&quot;$new_install_cmd = &#x27;&#123;0&#125;.Replace(&quot;&#123;1&#125;&quot;, &quot;&#123;2&#125;&quot;).Replace(&quot;&#123;3&#125;&quot;, &quot;&#123;4&#125;&quot;)&#x27; -f $old_install_cmd, $web_github, $web_mirror, $raw_github, $raw_mirror(Get-Content $scoop_install_file).replace($old_install_cmd, $new_install_cmd) | Set-Content $scoop_install_filecd ~\\scoop\\apps\\scoop\\currentgit checkout . \n\n\nPS. 快捷命令\n打开 powershell 配置文件：\n\ncode $PROFILE\n\nPSS. 自定义一个命令# https://shenbo.github.io/tags/powershell/# https://shenbo.github.io/tags/scoop/# https://gitee.com/scoop-bucket/# Set-Location ~chcp 65001Set-PSReadLineOption -PredictionSource Historyoh-my-posh init pwsh --config ~\\scoop\\persist\\oh-my-posh\\themes\\yo.omp.yaml | Invoke-Expressionfunction scoop-source &#123;    param (        [Parameter(Mandatory = $True, Position = 0)]        [String] $Name    )    $info = &quot;USEAGE:`n  scoop-source [github | mirror]`n&quot;    Write-Output $info    if ($Name -eq &#x27;github&#x27;) &#123;        scoop config SCOOP_REPO &#x27;https://github.com/ScoopInstaller/Scoop&#x27;        cd ~\\scoop\\buckets\\main         | git remote set-url origin &#x27;https://github.com/ScoopInstaller/Main&#x27;        cd ~\\scoop\\buckets\\extras       | git remote set-url origin &#x27;https://github.com/ScoopInstaller/Extras&#x27;        cd ~\\scoop\\buckets\\versions     | git remote set-url origin &#x27;https://github.com/ScoopInstaller/Versions&#x27;        cd ~\\scoop\\buckets\\portablesoft | git remote set-url origin &#x27;https://github.com/shenbo/portablesoft&#x27;        scoop bucket list        cd ~\\scoop\\apps\\scoop\\current   | git checkout .        git diff    &#125;    if ($Name -eq &#x27;mirror&#x27;) &#123;        scoop config SCOOP_REPO &#x27;https://gitee.com/scoop-bucket/Scoop&#x27;        cd ~\\scoop\\apps\\scoop\\current   | git checkout .   | git pull                $scoop_install_file = &#x27;~\\scoop\\apps\\scoop\\current\\lib\\install.ps1&#x27;        $old_install_cmd = &#x27;$urlstxt_content += &quot;$(handle_special_urls $url)`n&quot;&#x27;        $web_github = &quot;https://github.com&quot;        $web_mirror = &quot;https://ghproxy.net/https://github.com&quot;        $raw_github = &quot;https://raw.githubusercontent.com&quot;         $raw_mirror = &quot;https://ghproxy.net/https://raw.githubusercontent.com&quot;        $new_install_cmd = &#x27;&#123;0&#125;.Replace(&quot;&#123;1&#125;&quot;, &quot;&#123;2&#125;&quot;).Replace(&quot;&#123;3&#125;&quot;, &quot;&#123;4&#125;&quot;)&#x27; -f $old_install_cmd, $web_github, $web_mirror, $raw_github, $raw_mirror        (Get-Content $scoop_install_file).replace($old_install_cmd, $new_install_cmd) | Set-Content $scoop_install_file        git diff --pretty=oneline                        cd ~\\scoop\\buckets\\main         | git remote set-url origin &#x27;https://ghproxy.net/https://github.com/ScoopInstaller/Main&#x27;        cd ~\\scoop\\buckets\\extras       | git remote set-url origin &#x27;https://ghproxy.net/https://github.com/ScoopInstaller/Extras&#x27;        cd ~\\scoop\\buckets\\versions     | git remote set-url origin &#x27;https://ghproxy.net/https://github.com/ScoopInstaller/Versions&#x27;        cd ~\\scoop\\buckets\\portablesoft | git remote set-url origin &#x27;https://ghproxy.net/https://github.com/shenbo/portablesoft&#x27;        cd ~        scoop bucket list    &#125;&#125;\n\n","categories":["apps"],"tags":["scoop"]},{"title":"powershell配置(5)-ohmyposh3","url":"/2021/02/28/powershell/powershell%E9%85%8D%E7%BD%AE5-ohmyposh3/","content":"1.安装以scoop安装oh-my-posh3。\nscoop install oh-my-posh\n\n2. 配置文件新建、修改配置文件，运行:\nif (!(Test-Path -Path $PROFILE )) &#123; New-Item -Type File -Path $PROFILE -Force &#125;code $PROFILE\n\n加入以下内容：\nchcp 65001Set-PSReadLineOption -PredictionSource Historyoh-my-posh init pwsh --config ~\\scoop\\persist\\oh-my-posh\\themes\\yo.omp.json | Invoke-Expression\n\n\nref: https://ohmyposh.dev/docs/installation\n\n\n\n3. 自定义ys主题\n打开主题文件，路径： ~\\scoop\\persist\\oh-my-posh\\themes\\yo.omp.json\n\n&#123;  &quot;$schema&quot;: &quot;https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/schema.json&quot;,  &quot;blocks&quot;: [    &#123;      &quot;alignment&quot;: &quot;left&quot;,      &quot;segments&quot;: [        &#123;          &quot;foreground&quot;: &quot;red&quot;,          &quot;style&quot;: &quot;plain&quot;,          &quot;template&quot;: &quot;&#123;&#123; if .Root &#125;&#125;% &#123;&#123; else &#125;&#125;&lt;blue&gt;# &lt;/&gt;&#123;&#123;end&#125;&#125;&quot;,          &quot;type&quot;: &quot;text&quot;        &#125;,        &#123;          &quot;foreground&quot;: &quot;cyan&quot;,          &quot;style&quot;: &quot;plain&quot;,          &quot;template&quot;: &quot;&#123;&#123; .UserName &#125;&#125;&lt;white&gt; @ &lt;/&gt;&lt;green&gt;&#123;&#123; .HostName &#125;&#125;&lt;/&gt;&quot;,          &quot;type&quot;: &quot;session&quot;        &#125;,        &#123;          &quot;foreground&quot;: &quot;lightYellow&quot;,          &quot;properties&quot;: &#123;            &quot;style&quot;: &quot;short&quot;          &#125;,          &quot;style&quot;: &quot;plain&quot;,          &quot;template&quot;: &quot;&lt;white&gt; in &lt;/&gt;&#123;&#123; .Path &#125;&#125; &quot;,          &quot;type&quot;: &quot;path&quot;        &#125;,        &#123;          &quot;foreground&quot;: &quot;cyan&quot;,          &quot;properties&quot;: &#123;            &quot;fetch_status&quot;: true          &#125;,          &quot;style&quot;: &quot;plain&quot;,          &quot;template&quot;: &quot; &#123;&#123; .HEAD &#125;&#125; &#123;&#123; .BranchStatus &#125;&#125;&#123;&#123; if .Working.Changed &#125;&#125; \\uf044 &#123;&#123; .Working.String &#125;&#125;&#123;&#123; end &#125;&#125;&#123;&#123; if and (.Staging.Changed) (.Working.Changed) &#125;&#125; |&#123;&#123; end &#125;&#125;&#123;&#123; if .Staging.Changed &#125;&#125; \\uf046 &#123;&#123; .Staging.String &#125;&#125;&#123;&#123; end &#125;&#125;&#123;&#123; if gt .StashCount 0&#125;&#125; \\uf692 &#123;&#123; .StashCount &#125;&#125;&#123;&#123; end &#125;&#125;&#123;&#123; if gt .WorktreeCount 0&#125;&#125; \\uf1bb &#123;&#123; .WorktreeCount &#125;&#125;&#123;&#123; end &#125;&#125; &quot;,          &quot;type&quot;: &quot;git&quot;        &#125;,        &#123;          &quot;foreground&quot;: &quot;white&quot;,          &quot;properties&quot;: &#123;            &quot;time_format&quot;: &quot;15:04:05&quot;          &#125;,          &quot;style&quot;: &quot;plain&quot;,          &quot;template&quot;: &quot;[&#123;&#123; .CurrentDate | date .Format &#125;&#125;]&quot;,          &quot;type&quot;: &quot;time&quot;        &#125;,        &#123;          &quot;foreground&quot;: &quot;red&quot;,          &quot;style&quot;: &quot;plain&quot;,          &quot;template&quot;: &quot; C: &#123;&#123; .Code &#125;&#125;&quot;,          &quot;type&quot;: &quot;exit&quot;        &#125;      ],      &quot;type&quot;: &quot;prompt&quot;    &#125;,    &#123;      &quot;type&quot;: &quot;newline&quot;    &#125;,    &#123;      &quot;alignment&quot;: &quot;left&quot;,      &quot;segments&quot;: [        &#123;          &quot;foreground&quot;: &quot;red&quot;,          &quot;style&quot;: &quot;plain&quot;,          &quot;template&quot;: &quot;$&quot;,          &quot;type&quot;: &quot;text&quot;        &#125;      ],      &quot;type&quot;: &quot;prompt&quot;    &#125;  ],  &quot;console_title_template&quot;: &quot;&#123;&#123;.User&#125;&#125; :: &#123;&#123;.Folder&#125;&#125; :: &#123;&#123;.Shell&#125;&#125;&quot;,  &quot;final_space&quot;: true,  &quot;version&quot;: 2&#125;\n\n\ndone!\n\n# 查看 unicode 字符[char] 0xf044[char] 0xf046[char] 0xf692[char] 0xf1bb\n","categories":["powershell"],"tags":["powershell"]},{"title":"caj2pdf：将知网caj文件转换为pdf","url":"/2021/02/04/office/caj2pdf%EF%BC%9A%E5%B0%86%E7%9F%A5%E7%BD%91caj%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E4%B8%BApdf/","content":"caj2pdf：将知网caj文件转换为pdfhttps://github.com/caj2pdf/caj2pdf/\n使用1. 环境和依赖（win10）\nPython 3.3+\nPyPDF2, https://github.com/mstamy2/PyPDF2\npypi安装： https://pypi.org/project/PyPDF2/\n\npip install PyPDF2\nmutool, https://mupdf.com/index.html\n实际上不用安装，只要把一个 mutool.exe 文件放进 caj2pdf/ 目录就行了。\n\n\n\n2. 官方用法\n\n\n克隆仓库： git clone https://github.com/caj2pdf/caj2pdf.git\n\n在caj2pdf/ 目录下运行。\n\n\n# 打印文件基本信息（文件类型、页面数、大纲项目数）python caj2pdf show [input_file]# 转换文件# - 输出文件名可省略python caj2pdf convert [input_file] -o/--output [output_file]# 从 CAJ 文件中提取大纲信息并添加至 PDF 文件# 遇到不支持的文件类型或 Bug 时，可用 CAJViewer 打印 PDF 文件，并用这条命令为其添加大纲python caj2pdf outlines [input_file] -o/--output [pdf_file]\n\n\n3. 拖拽caj文件自动转换（个人自用版）上述官方命令行的方法实际使用起来比较烦，\n我这里写个 bat 脚本支持拖拽文件实现格式转换。\n\n方法：\n\n在caj2pdf目录下，新建一个文件：caj2pdf_convert_by_drag.bat，内容如下：\n:: 切换目录cd /d %~dp0:: 转换文件python caj2pdf convert %*:: 暂停方便看error logpause\n\n使用：\n\n直接把 caj 论文文件拖到 bat 脚本文件上就可以了，\n生成的 pdf 文件与原 caj 文件的目录保持一致。\n\nPS个人修改后的全部代码见：https://github.com/shenbo/caj2pdf可直接下载使用。\n\nPS: 有坑 !!!\n官方的帮助文档并不友好\n只支持部分文件的转换，全凭运气\n\n","categories":["office"],"tags":["caj2pdf"]},{"title":"Win10-WSL-Ubuntu18.04-ROS-melodic 安装与配置","url":"/2020/12/22/wsl/wsl-ubuntu-ros/","content":"一、WSL 安装 Ubuntu18.04\nWin10 启用 WSL\n\n管理员身份运行：\ndism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart\n\n重启电脑。\n\n打开 Microsoft Store，安装 Ubuntu18.04\n\n启动 Ubuntu18.04，创建账号、密码\n\n安装 Windows Terminal（可选）\n\n\n用 scoop 安装。\nscoop install windows-terminal\n\nwindows-terminal 简单设置：字体、启动目录。\n&#123;    &quot;guid&quot;: &quot;&#123;c6eaf9f4-32a7-5fdc-b5cf-066e8a4b1e40&#125;&quot;,    &quot;hidden&quot;: false,    &quot;fontFace&quot;: &quot;Jetbrains Mono&quot;,    &quot;fontSize&quot;: 11,    &quot;name&quot;: &quot;Ubuntu-18.04&quot;,    &quot;source&quot;: &quot;Windows.Terminal.Wsl&quot;,    &quot;startingDirectory&quot;: &quot;//wsl$/Ubuntu-18.04//home/bo&quot;,&#125;\n\n\n设置源，更新（可选）\n\n\n\n打开配置文件： sudo nano /etc/apt/sources.list, 替换成以下内容：\n# 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse# 预发布软件源，不建议启用# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\nref： https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/\n更新：sudo apt update\n升级：sudo apt upgrade\n\n安装 ZSH、oh-my-zsh（可选）\n\n参考 zsh &amp; oh-my-zsh 安装配置 \n二、安装 ROS-melodicref： http://wiki.ros.org/melodic/Installation/Ubuntu\n\n设置源，URL: http://mirrors.tuna.tsinghua.edu.cn/ros/\n\nsudo sh -c &#x27;. /etc/lsb-release &amp;&amp; echo &quot;deb http://mirrors.tuna.tsinghua.edu.cn/ros/ubuntu/ `lsb_release -cs` main&quot; &gt; /etc/apt/sources.list.d/ros-latest.list&#x27;\n\n\n设置 keys\n\nsudo apt-key adv --keyserver &#x27;hkp://keyserver.ubuntu.com:80&#x27; --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654\n\n\n安装\n\nsudo apt update# 建议完全安装 (Recommended) # 含：ROS, rqt, rviz, robot-generic libraries, #    2D/3D simulators and 2D/3D perceptionsudo apt install ros-melodic-desktop-full\n\n\n设置环境变量\n\n# zshecho &quot;source /opt/ros/melodic/setup.zsh&quot; &gt;&gt; ~/.zshrcsource ~/.zshrc\n\n\n安装必要的依赖\n\nsudo apt install python-rosdepsudo rosdep initrosdep update\n\nsudo rosdep init 需要从 raw.githubusercontent.com 下载文件。\n如果报错，可以试下修改 hosts：\n# 打开hosts文件sudo nano /etc/hosts# 在文件末尾添加151.101.84.133  raw.githubusercontent.com\n\n\n\n测试一下\n\nroscore# 会出现几行 log：# started roslaunch server http://DESKTOP-FL776UK:56357/# ros_comm version 1.14.10### SUMMARY# ========## PARAMETERS#  * /rosdistro: melodic#  * /rosversion: 1.14.10# ...# started core service [/rosout]# \n\n\n测试一下小乌龟\n\n\n先在 win10 下安装 X Server：scoop install vcxsrv.\n\n然后依次在 Ubuntu18.04下打开三个 terminal：\n\n\n# terminal - 1roscore# terminal - 2rosrun turtlesim turtlesim_node# terminal - 3rosrun turtlesim turtle_teleop_key\n\n\nwindows terminal 分屏快捷键：\n\n\n\n快捷键\n功能\n\n\n\nctrl + shift + w\nclosePane\n\n\nalt + shift + -\nsplitPane: horizontal\n\n\nalt + shift + +\nsplitPane: vertical\n\n\n\n\n\n","categories":["WSL"],"tags":["Ubuntu","WSL","ROS"]},{"title":"树莓派与LCD屏1602a","url":"/2020/12/15/raspi/raspberry-pi-lcd-1602a/","content":"1. 1602a LCD屏\n接线端子表：\n\n\n\n\n序号\nLCD屏 16PIN\n树莓派 40PIN 物理序号\n备注\n\n\n\n1\nVSS\n06\nGND\n\n\n2\nVDD\n02\n5V\n\n\n3\nV0\n电位器\n对比度，0-5V\n\n\n4\nRS\n08\nGPIO-14\n\n\n5\nRW\n06\n写模式：接地\n\n\n6\nEN\n10\nGPIO-15\n\n\n7\nD0\n-\n\n\n\n8\nD1\n-\n\n\n\n9\nD2\n-\n\n\n\n10\nD3\n-\n\n\n\n11\nD4\n11\nGPIO-17\n\n\n12\nD5\n12\nGPIO-18\n\n\n13\nD6\n13\nGPIO-27\n\n\n14\nD7\n15\nGPIO-22\n\n\n15\nA\n串约500Ω电阻后接02\n背光正\n\n\n16\nK\n06\n背光负\n\n\n\n\n\n接线图\n\n\n\n2. 代码\n目录如下，就两个文件：\n\n.├───LCD1602a│   ├───1602.py     # 主程序，可显示时间、CPU、RAM的使用情况│   └───lcd1602.py  # 配置程序│...\n\nlcd1602.py# based on code from lrvick and LiquidCrystal# lrvic - https://github.com/lrvick/raspi-hd44780/blob/master/hd44780.py# LiquidCrystal - https://github.com/arduino/Arduino/blob/master/libraries/LiquidCrystal/LiquidCrystal.cppimport timeclass lcd1602:    # commands    LCD_CLEARDISPLAY \t\t= 0x01    LCD_RETURNHOME \t\t    = 0x02    LCD_ENTRYMODESET \t\t= 0x04    LCD_DISPLAYCONTROL \t\t= 0x08    LCD_CURSORSHIFT \t\t= 0x10    LCD_FUNCTIONSET \t\t= 0x20    LCD_SETCGRAMADDR \t\t= 0x40    LCD_SETDDRAMADDR \t\t= 0x80    # flags for display entry mode    LCD_ENTRYRIGHT \t\t        = 0x00    LCD_ENTRYLEFT \t\t        = 0x02    LCD_ENTRYSHIFTINCREMENT \t= 0x01    LCD_ENTRYSHIFTDECREMENT \t= 0x00    # flags for display on/off control    LCD_DISPLAYON \t\t= 0x04    LCD_DISPLAYOFF \t\t= 0x00    LCD_CURSORON \t\t= 0x02    LCD_CURSOROFF \t\t= 0x00    LCD_BLINKON \t\t= 0x01    LCD_BLINKOFF \t\t= 0x00    # flags for display/cursor shift    LCD_DISPLAYMOVE \t= 0x08    LCD_CURSORMOVE \t    = 0x00    # flags for display/cursor shift    LCD_DISPLAYMOVE \t= 0x08    LCD_CURSORMOVE \t\t= 0x00    LCD_MOVERIGHT \t\t= 0x04    LCD_MOVELEFT \t\t= 0x00    # flags for function set    LCD_8BITMODE \t\t= 0x10    LCD_4BITMODE \t\t= 0x00    LCD_2LINE \t\t\t= 0x08    LCD_1LINE \t\t\t= 0x00    LCD_5x10DOTS \t\t= 0x04    LCD_5x8DOTS \t\t= 0x00    def __init__(self, pin_rs=14, pin_e=15, pins_db=[17, 18, 27, 22], GPIO = None):        if not GPIO:            import RPi.GPIO as GPIO        self.GPIO = GPIO        self.pin_rs = pin_rs        self.pin_e = pin_e        self.pins_db = pins_db        self.GPIO.setmode(GPIO.BCM)        self.GPIO.setup(self.pin_e, GPIO.OUT)        self.GPIO.setup(self.pin_rs, GPIO.OUT)        for pin in self.pins_db:            self.GPIO.setup(pin, GPIO.OUT)        self.write4bits(0x33) # initialization        self.write4bits(0x32) # initialization        self.write4bits(0x28) # 2 line 5x7 matrix        self.write4bits(0x0C) # turn cursor off 0x0E to enable cursor        self.write4bits(0x06) # shift cursor right        self.displaycontrol = self.LCD_DISPLAYON | self.LCD_CURSOROFF | self.LCD_BLINKOFF        self.displayfunction = self.LCD_4BITMODE | self.LCD_1LINE | self.LCD_5x8DOTS        self.displayfunction |= self.LCD_2LINE        &quot;&quot;&quot; Initialize to default text direction (for romance languages) &quot;&quot;&quot;        self.displaymode =  self.LCD_ENTRYLEFT | self.LCD_ENTRYSHIFTDECREMENT        self.write4bits(self.LCD_ENTRYMODESET | self.displaymode)   #  set the entry mode        self.clear()    def begin(self, cols, lines):        if (lines &gt; 1):            self.numlines = lines            self.displayfunction |= self.LCD_2LINE            self.currline = 0    def home(self):        self.write4bits(self.LCD_RETURNHOME)    # set cursor position to zero        self.delayMicroseconds(3000)            # this command takes a long time!            def clear(self):        self.write4bits(self.LCD_CLEARDISPLAY)  # command to clear display        self.delayMicroseconds(3000)            # 3000 microsecond sleep, clearing the display takes a long time    def setCursor(self, col, row):        self.row_offsets = [ 0x00, 0x40, 0x14, 0x54 ]        if ( row &gt; self.numlines ):                 row = self.numlines - 1         # we count rows starting w/0        self.write4bits(self.LCD_SETDDRAMADDR | (col + self.row_offsets[row]))    def noDisplay(self):         &quot;&quot;&quot; Turn the display off (quickly) &quot;&quot;&quot;        self.displaycontrol &amp;= ~self.LCD_DISPLAYON        self.write4bits(self.LCD_DISPLAYCONTROL | self.displaycontrol)    def display(self):        &quot;&quot;&quot; Turn the display on (quickly) &quot;&quot;&quot;        self.displaycontrol |= self.LCD_DISPLAYON        self.write4bits(self.LCD_DISPLAYCONTROL | self.displaycontrol)    def noCursor(self):        &quot;&quot;&quot; Turns the underline cursor on/off &quot;&quot;&quot;        self.displaycontrol &amp;= ~self.LCD_CURSORON        self.write4bits(self.LCD_DISPLAYCONTROL | self.displaycontrol)    def cursor(self):        &quot;&quot;&quot; Cursor On &quot;&quot;&quot;        self.displaycontrol |= self.LCD_CURSORON        self.write4bits(self.LCD_DISPLAYCONTROL | self.displaycontrol)    def noBlink(self):        &quot;&quot;&quot; Turn on and off the blinking cursor &quot;&quot;&quot;        self.displaycontrol &amp;= ~self.LCD_BLINKON        self.write4bits(self.LCD_DISPLAYCONTROL | self.displaycontrol)    def noBlink(self):        &quot;&quot;&quot; Turn on and off the blinking cursor &quot;&quot;&quot;        self.displaycontrol &amp;= ~self.LCD_BLINKON        self.write4bits(self.LCD_DISPLAYCONTROL | self.displaycontrol)    def DisplayLeft(self):        &quot;&quot;&quot; These commands scroll the display without changing the RAM &quot;&quot;&quot;        self.write4bits(self.LCD_CURSORSHIFT | self.LCD_DISPLAYMOVE | self.LCD_MOVELEFT)    def scrollDisplayRight(self):        &quot;&quot;&quot; These commands scroll the display without changing the RAM &quot;&quot;&quot;        self.write4bits(self.LCD_CURSORSHIFT | self.LCD_DISPLAYMOVE | self.LCD_MOVERIGHT);    def leftToRight(self):        &quot;&quot;&quot; This is for text that flows Left to Right &quot;&quot;&quot;        self.displaymode |= self.LCD_ENTRYLEFT        self.write4bits(self.LCD_ENTRYMODESET | self.displaymode);    def rightToLeft(self):        &quot;&quot;&quot; This is for text that flows Right to Left &quot;&quot;&quot;        self.displaymode &amp;= ~self.LCD_ENTRYLEFT        self.write4bits(self.LCD_ENTRYMODESET | self.displaymode)    def autoscroll(self):        &quot;&quot;&quot; This will &#x27;right justify&#x27; text from the cursor &quot;&quot;&quot;        self.displaymode |= self.LCD_ENTRYSHIFTINCREMENT        self.write4bits(self.LCD_ENTRYMODESET | self.displaymode)    def noAutoscroll(self):         &quot;&quot;&quot; This will &#x27;left justify&#x27; text from the cursor &quot;&quot;&quot;        self.displaymode &amp;= ~self.LCD_ENTRYSHIFTINCREMENT        self.write4bits(self.LCD_ENTRYMODESET | self.displaymode)    def write4bits(self, bits, char_mode=False):        &quot;&quot;&quot; Send command to LCD &quot;&quot;&quot;        self.delayMicroseconds(1000) # 1000 microsecond sleep        bits=bin(bits)[2:].zfill(8)        self.GPIO.output(self.pin_rs, char_mode)        for pin in self.pins_db:            self.GPIO.output(pin, False)        for i in range(4):            if bits[i] == &quot;1&quot;:                self.GPIO.output(self.pins_db[::-1][i], True)        self.pulseEnable()        for pin in self.pins_db:            self.GPIO.output(pin, False)        for i in range(4,8):            if bits[i] == &quot;1&quot;:                self.GPIO.output(self.pins_db[::-1][i-4], True)        self.pulseEnable()    def delayMicroseconds(self, microseconds):        seconds = microseconds / float(1000000)        # divide microseconds by 1 million for seconds        time.sleep(seconds)    def pulseEnable(self):        self.GPIO.output(self.pin_e, False)        self.delayMicroseconds(1)                # 1 microsecond pause - enable pulse must be &gt; 450ns         self.GPIO.output(self.pin_e, True)        self.delayMicroseconds(1)                # 1 microsecond pause - enable pulse must be &gt; 450ns         self.GPIO.output(self.pin_e, False)        self.delayMicroseconds(1)                # commands need &gt; 37us to settle    def message(self, text):        &quot;&quot;&quot; Send string to LCD. Newline wraps to second line&quot;&quot;&quot;        for char in text:            if char == &#x27;\\n&#x27;:                self.write4bits(0xC0) # next line            else:                self.write4bits(ord(char),True)if __name__ == &#x27;__main__&#x27;:    lcd = lcd1602()    lcd.clear()    lcd.message(&quot; LCD 1602 Test \\n123456789ABCDEF&quot;)\n\n1602.pyimport osimport timefrom lcd1602 import *from datetime import datetime# run commanddef run_cmd(cmd):    p = os.popen(cmd).readline().strip().split()    return pdef now():    return datetime.now().strftime(&#x27;%Y-%m-%d %a \\n%H:%M:%S&#x27;)def cpu():    cpu_temp = run_cmd(&#x27;vcgencmd measure_temp&#x27;)    cpu_info = run_cmd(&quot;top -bn1 | awk &#x27;/Cpu\\(s\\)/&#x27;&quot;)    cpu_usage = 1 - float(cpu_info[7])/100.0    status = &#x27;CPU Temp: &#123;&#125;\\n&#x27;.format(cpu_temp[0].replace(&quot;temp=&quot;, &quot;&quot;))    status += &#x27;    Used: &#123;:.2%&#125;&#x27;.format(cpu_usage)    return statusdef ram():    ram_info = run_cmd(&quot;free -m | awk &#x27;/Mem/&#x27;&quot;)    ram_usage = (int(ram_info[1]) - int(ram_info[6])) / float(ram_info[1])    status = &#x27;RAM Totl: &#123;&#125;M\\n&#x27;.format(ram_info[1])    status += &#x27;    Used: &#123;:.2%&#125;&#x27;.format(ram_usage)    return statusdef ip():    ip = run_cmd(&quot;sudo ifconfig wlan0 | awk &#x27;/inet/&#x27;&quot;)    return &#x27;IP Addr: \\n  &#123;&#125;&#x27;.format(ip[1])print(now(), cpu(), ram(), ip(), sep=&#x27;\\n&#x27;)lcd = lcd1602()lcd.clear()while(1):    lcd.clear()    lcd.message(now())    time.sleep(10)    lcd.clear()    lcd.message(cpu())    time.sleep(10)    lcd.clear()    lcd.message(ram())    time.sleep(10)\n","categories":["raspi"],"tags":["raspberry-pi"]},{"title":"用树莓派和墨水屏做一个 mnist-clock","url":"/2020/12/03/raspi/raspberry-pi-epaper-mnist-clock/","content":"1. 墨水屏\n型号：微雪 2.9inch e-Paper Module， 带驱动板，8PIN\n\n工作电压：3.3V&#x2F;5V\n\n通信接口：SPI\n\n分辨率：296 x 128\n\n显示颜色：黑、白\n\n局部刷新：0.3s\n\n全局刷新 ：2s\n\n接线表：\n\n\n\n\n\n墨水屏 8PIN\n树莓派 40PIN 物理序号\n备注\n\n\n\nVCC\n1\n3.3V\n\n\nGND\n6\nGND\n\n\nDIN\n19\n\n\n\nCLK\n23\n\n\n\nCS\n24\n\n\n\nDC\n22\n\n\n\nRST\n11\n\n\n\nBUSY\n18\n\n\n\n\n\n2. 树莓派基本配置\n详细步骤见帮助文档: https://www.waveshare.net/wiki/2.9inch_e-Paper_Module\n程序源码在 github 也有: https://github.com/waveshare/e-Paper\n1.下载git clone https://github.com/waveshare/e-Paper.git --depth 1目录如下，有用的文件就几个：\n\n├───Arduino├───RaspberryPi&amp;JetsonNano│   ├───c│   │   └─── ...│   └───python│       │   readme_rpi_CN.txt│       │   setup.py│       │   ...│       ││       ├───examples│       │       epd_2in9bc_test.py  # 测试程序│       │       ...│       ││       ├───lib│       │   └───waveshare_epd│       │           epd2in9.py      # 主逻辑│       │           epdconfig.py    # 配置文件│       │           __init__.py│       │           ...│       ││       └───pic                │               2in9.bmp            # 图片│               Font.ttc            # 字体文件，文泉驿，含中文字体│               ...└─── ...\n\n\n2.打开 SPI\n\nsudo raspi-config# 选择Interfacing Options -&gt; SPI -&gt; Yes 开启SPI接口\n\n\n3.安装依赖(python3)\n\n# sudo apt-get update# sudo apt-get install python3-pipsudo apt-get install python3-numpysudo apt-get install python3-pilsudo pip3 install RPi.GPIOsudo pip3 install spidev\n\n\n4.运行测试程序\n\ncd e-Paper/&#x27;RaspberryPi&amp;JetsonNano&#x27;/cd python/examplessudo python3 epd_2in9bc_test.py\n\n3. 处理 mnist 数据集，提取 index\n下载 mnist.npzhttps://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz\n\n我们使用x_train的60000个数字，把0-9对应的序号(index)，提取出来，保存到 mnist_index.json\n\n\nimport numpy as npimport jsonimg_rows, img_cols = 28, 28# the data, split between train and test setspath = &#x27;mnist.npz&#x27;with np.load(path) as f:    x_train, y_train = f[&#x27;x_train&#x27;], f[&#x27;y_train&#x27;]    x_test, y_test = f[&#x27;x_test&#x27;], f[&#x27;y_test&#x27;]print(&#x27;x_train.shape: &#123;&#125;, y_train.shape: &#123;&#125;&#x27;.format(x_train.shape, y_train.shape))print(&#x27;x_test.shape: &#123;&#125;, y_test.shape: &#123;&#125;&#x27;.format(x_test.shape, y_test.shape))print(x_train[0], y_train[0])print(x_test[0], y_test[0])# 创建一个字典，keys 是0-9，values为空的list，后面将序号存进去idx_dict = &#123;&#125;for i in range(10):    idx_dict[i] = []print(idx_dict)# 将序号存进去for idx in range(60000):    num = y_train[idx]    idx_dict[num].append(idx)    # if idx == 60: break# print(idx_dict)# 转为 json 格式， 保存idx_json = json.dumps(idx_dict)# print(idx_json)with open(&#x27;mnist_index.json&#x27;, &#x27;w&#x27;) as f:    json.dump(idx_dict, f)# 读取 json 文件# with open(&#x27;mnist_index.json&#x27;, &#x27;r&#x27;) as f:#     data = json.load(f)# print(data)\n\n4. 先测试下用 opencv 显示时间import numpy as npimport jsonimport randomimport cv2import time# load mnist datasetpath = &#x27;mnist.npz&#x27;with np.load(path) as f:    x_train, y_train = f[&#x27;x_train&#x27;], f[&#x27;y_train&#x27;]    x_test, y_test = f[&#x27;x_test&#x27;], f[&#x27;y_test&#x27;]with open(&#x27;mnist_index.json&#x27;, &#x27;r&#x27;) as f:    idx_dict = json.load(f)for i in range(10):    print(i, len(idx_dict[str(i)]))def get_mnist_num(num):    idxs = idx_dict[str(num)]    idx = random.choice(idxs)    return x_train[idx]gap = np.zeros((28, 10))for i in [8, 9, 18, 19]:    for j in [4,5,6,]:        gap[i][j] = 255last_time = [-1, -1, -1, -1, -1, -1]last_imgs = np.zeros((6, 28, 28))while True:    now = time.localtime(time.time())    sec, mnt, hour = now.tm_sec, now.tm_min, now.tm_hour    s1, s2 = sec//10, sec%10    m1, m2 = mnt//10, mnt%10    h1, h2 = hour//10, hour%10    now_time = [h1, h2, m1, m2, s1, s2]    print(last_time, now_time)    for i in range(6):        if last_time[i] != now_time[i]:            last_imgs[i] = get_mnist_num(now_time[i])            last_time[i] = now_time[i]    img = np.hstack((last_imgs[0], last_imgs[1], gap,                     last_imgs[2], last_imgs[3], gap,                     last_imgs[4], last_imgs[5]))    cv2.imshow(&#x27;num&#x27;, img)    # cv2.imwrite(&#x27;mnist-clock.png&#x27;, img)    cv2.waitKey(100)\n\n\n\n5. 在墨水屏显示时间详见 epd29_mnist_clock.py\n# epd29_mnist_clock.py import sysimport osimport loggingimport jsonimport numpy as npimport randomimport timeimport tracebackfrom PIL import Image, ImageDraw, ImageFontfrom lib import epd2in9logging.basicConfig(level=logging.DEBUG)font = ImageFont.truetype(&#x27;lib/Font.ttc&#x27;, 18)# load mnist datasetwith np.load(&#x27;mnist.npz&#x27;) as f:    x_train, y_train = f[&#x27;x_train&#x27;], f[&#x27;y_train&#x27;]    x_test, y_test = f[&#x27;x_test&#x27;], f[&#x27;y_test&#x27;]with open(&#x27;mnist_index.json&#x27;, &#x27;r&#x27;) as f:    idx_dict = json.load(f)gap = np.ones((28, 10)) * 255for i in [8, 9, 18, 19]:    for j in [4,5,6,]:        gap[i][j] = 0def get_mnist_num(num):    idxs = idx_dict[str(num)]    idx = random.choice(idxs)    return 255 - x_train[idx]# === 0. init logging.info(&#x27;epd2in9 Demo&#x27;)epd = epd2in9.EPD()logging.info(&#x27;init and Clear&#x27;)epd.init(epd.lut_full_update)epd.Clear(0xFF)# === 1. show date &amp; timelogging.info(&#x27;show date &amp; time&#x27;)def YMD(draw, x1=10, y1=5, x2=160, y2=30):    draw.rectangle((x1, y1, x2, y2), fill=255)    draw.text((x1, y1), time.strftime(&#x27;%Y-%m-%d  %a&#x27;), font = font, fill=0)def HMS(draw, x1=180, y1=5, x2=280, y2=30):    draw.rectangle((x1, y1, x2, y2), fill = 255)    draw.text((x1, y1), time.strftime(&#x27;%H:%M&#x27;), font = font, fill=0)    def MNIST(img, draw, mnist_img, x1=8, y1=30, x2=280, y2=120):    draw.rectangle((x1, y1, x2, y2), fill = 255)    mnist_img = Image.fromarray(mnist_img)    mnist_img = mnist_img.resize((38*2*3, 28*3))    img.paste(mnist_img, (x1, y1))# partial updatetime_image = Image.new(&#x27;1&#x27;, (epd.height, epd.width), 255)time_draw = ImageDraw.Draw(time_image)last_time = [-1, -1, -1, -1]last_imgs = np.ones((4, 28, 28)) * 255while (True):    now = time.localtime(time.time())    sec, mnt, hour = now.tm_sec, now.tm_min, now.tm_hour    m1, m2 = mnt//10, mnt%10    h1, h2 = hour//10, hour%10    now_time = [h1, h2, m1, m2]    print(f&#x27;&#123;hour&#125;:&#123;mnt&#125;:&#123;sec&#125;&#x27;, last_time, now_time)    if -1 in last_time or (mnt == 0 and sec &lt; 5) :        logging.info(&#x27;partial update&#x27;)        epd.init(epd.lut_full_update)        epd.Clear(0xFF)        time.sleep(1)        logging.info(&#x27;partial update&#x27;)        epd.init(epd.lut_partial_update)        epd.Clear(0xFF)        YMD(time_draw)        time.sleep(1)    for i in range(4):        if last_time[i] != now_time[i]:            last_imgs[i] = get_mnist_num(now_time[i])            last_time[i] = now_time[i]            mnist_image = np.hstack((last_imgs[0], last_imgs[1], gap,                                     last_imgs[2], last_imgs[3]))            HMS(time_draw)              MNIST(time_image, time_draw, mnist_image)                        epd.display(epd.getbuffer(time_image))            time.sleep(1)        time.sleep(3)# Clear        logging.info(&#x27;Clear...&#x27;)epd.init(epd.lut_full_update)epd.Clear(0xFF)# Sleeplogging.info(&#x27;Goto Sleep...&#x27;)epd.sleep()epd.Dev_exit()\n\n\n所有的文件把有用的几个文件拉出来放在一个文件夹里。\n.├── cv2_mnist_clock.py     # 测试用 opencv 显示时间├── epd29_mnist_clock.py   # 在墨水屏显示时间├── epd_2in9_test.py├── lib│ ├── epd2in9.py│ ├── epdconfig.py│ ├── Font.ttc│ └── __init__.py├── mnist_index_gen.py     # 提取序号(index)├── mnist_index.json       # 保存序号(index)，以 json 格式└── mnist.npz              # mnist 原始数据集 \n\n完整代码:https://github.com/shenbo/mnist-clock\n效果\n\n\n灵感: https://github.com/dheera/mnist-clock\n","categories":["raspi"],"tags":["raspberry-pi","mnist-clock"]},{"title":"家庭内网升级","url":"/2020/11/16/network/Home-Network%E5%AE%B6%E5%BA%AD%E5%86%85%E7%BD%91%E5%8D%87%E7%BA%A7/","content":"之前用的小米路由3，小两房勉强够用。\n搬到新家之后就明显不给力了。\n户型图新家的户型：\n\n\n交付时的布线：\n\n\n\n房间\n网口\n\n\n\n弱电箱-客厅前墙（电视）\n网线 + 有线电视同轴线\n\n\n弱电箱-客厅后墙\n网线 + 电话线\n\n\n弱电箱-主卧\n网线 + 电话线\n\n\n弱电箱-次卧\n网线 + 电话线\n\n\n弱电箱-书房\n网线 + 电话线\n\n\n弱电箱-卫生间\n电话线\n\n\n\n网线和有线电视&#x2F;电话线都是两根线同走一个穿线管\n电话线其实也是8芯网线，只不过接口是电话接口\n\n\n\n1. 网络方案 V11.1 网络拓扑\n小米路由器3放在电视墙那里，WAN口接弱电箱的光猫，LAN口接电视。\n书房的网线接光猫。\n\n\n\n\n缺点:\n\n书房电脑和电视、无线设备不在一个网段，\n光猫比较拉跨，时不时会死机。\n\n\n于是，就考虑把电视墙那里的有线电视同轴线换成网线，这样就可以从小米路由器的LAN口接回弱电箱了。\n2. 网络方案 V22.1 换线起初比较担心不好穿线，犹豫了好久。\n后来试了一下把网线固定死，只拔有线电视同轴线。\n嗯，可以拽得动，还算比较轻松。那就开使换线。\n网线哪里找？直接把去主卧的那根电话线抽了出来：）\n用电工胶带把有线和网线搭一起大约30cm，缠好。\n顺利拽出来了。\n2.2 压头借了一套压线钳、信号检测器，顺利整好。\n终于解决了电视墙回弱电箱的问题。\n2.3 弱电箱中转弱电箱里随便用了一个网线延长器把回去的那个网线和书房的网线对接即可。\n\n绿联: 网线转接头对接头 RJ45网线延长器\n\n2.4 群晖 NAS买了群晖 218+ 之后，有线网口也不够了。\n一开始把 NAS 放到电视下面，但是没几天进风口就全是灰尘。\n群晖噪音也很大，晚上很明显。\n因此，又在弱电箱里加了一个 TP-LINK 的交换机（5口千兆）。\n把群晖搬到了弱电箱旁边的柜子里。\n啊呦，，，柜子底板是悬空的，共振起来噪音更大，简直不能忍。\n在群晖底下垫了个鼠标垫，好了一点。\n2.5 换路由器无线信号其实也成问题，路由器放在电视墙那边，信号都被墙挡住了。\n\nWIFI 5G 信号只有客厅有。\nWIFI 2G 主卧室信号只有一半，卫生间和书房的信号关上门就经常中断了。\n\n后来换了个小米 AX3600，块头超大，形状也忒怪异，太占地方。\n好的是WIFI 信号的确比原来好多了，不再出现网络中断的现象。\n但书房角落还是不是满格。。。\n2.6 网络拓扑\n\n\n3. 网络方案 V3后来研究了一段 MESH 组网，还是放弃了。\n贵且不说，无线信号再好也抵不上一根破5类网线。\n最后觉得再折腾一次，玩个大的，这次把全屋的网线全换两根的。\n\n路由器放到客厅后墙沙发那一侧，直接正对过道，这样信号就不会受墙体阻挡了。\nNAS 搬到书房，解决噪音的问题。\n有线网口都改为双网口：弱电箱-电视墙、弱电箱-客厅后墙、弱电箱-书房\n\n3.1 材料、工具准备\n山泽(SAMZHE)压线钳\n信号测试器\n水晶头，六类， 50个\n网线， 六类， 50m×2卷\n双网口面板， 86型，千兆双口\n\n网线六类足够了，基本能满足播放 NAS 影音的需求。\n3.2 换线换线都是体力活，略。\n3.3 最终网络拓扑\n\n\n\ndone！\n全屋5G美滋滋。\n","categories":["synology"],"tags":["network"]},{"title":"树莓派 tensorflow-lite 目标检测","url":"/2020/10/24/raspi/raspberry-pi-tensorflow-lite-object-detect/","content":"0. 安装 tflite-runtimeref: https://tensorflow.google.cn/lite/guide/python\npip3 install https://dl.google.com/coral/python/tflite_runtime-2.1.0.post1-cp37-cp37m-linux_armv7l.whl\n\n1. tensorflow官方示例tensorflow 提供了一个示例, 基于picamera的。\nref: https://github.com/tensorflow/examples/blob/master/lite/examples/object_detection/raspberry_pi/\n# 1. Clonegit clone https://github.com/tensorflow/examples --depth 1# 2. 进入文件夹cd examples/lite/examples/object_detection/raspberry_pi# 文件夹里总共5个文件# README.md              #  # annotation.py          # 用于绘制方框、标签  # detect_picamera.py     # 主程序# download.sh            # 下载 python 依赖包、已训练的模型 # requirements.txt       ## 3. 下载已训练好的模型bash download.sh /tmp# - 下载 python 依赖包： numpy  picamera  Pillow# - 下载 coco_ssd_mobilenet_v1_1.0_quant_2018_06_29.zip, 里面有两个文件：detect.tflite, labelmap.txt，这个label文件有乱码# - 下载正确的label文件： https://dl.google.com/coral/canned_models/coco_labels.txt# 4. 运行程序python3 detect_picamera.py  --model /tmp/detect.tflite --labels /tmp/coco_labels.txt\n\n2. 使用 opencv 调用 usb camera\n\n我这里没有 picamera，只有一个老的 usb 接口的摄像头。 但 picamera 的 API 不支持 USB 摄像头。\n下面改一下代码 使用 opencv 来调用 usb camera.\n&quot;&quot;&quot;Example using TF Lite to detect objects with the Raspberry USB camera.Hardware:- Pi 3b+- usb cameraSoftware- python 3.7.3- tflite runtime 2.1- opencvDataset- coco_ssd_mobilenet_v1_1.0_quant_2018_06_29.zip&quot;&quot;&quot;import reimport timeimport numpy as npimport cv2from tflite_runtime.interpreter import Interpreterargs_camera_width = 640args_camera_height = 480args_model = &#x27;detect.tflite&#x27;args_labels = &#x27;coco_labels.txt&#x27;args_threshold = 0.4def load_labels(path):    &quot;&quot;&quot;Loads the labels file. Supports files with or without index numbers.&quot;&quot;&quot;    with open(path, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:        lines = f.readlines()        labels = &#123;&#125;        for row_number, content in enumerate(lines):            pair = re.split(r&#x27;[:\\s]+&#x27;, content.strip(), maxsplit=1)            if len(pair) == 2 and pair[0].strip().isdigit():                labels[int(pair[0])] = pair[1].strip()            else:                labels[row_number] = pair[0].strip()    return labelsdef detect_objects(interpreter, image, threshold):    # 识别：张量填充，运行推理    interpreter.set_tensor(input_details[0][&#x27;index&#x27;], input_image)    interpreter.invoke()    # 结果输出    boxes = interpreter.get_tensor(output_details[0][&#x27;index&#x27;])    classes = interpreter.get_tensor(output_details[1][&#x27;index&#x27;])    scores = interpreter.get_tensor(output_details[2][&#x27;index&#x27;])    boxes = np.squeeze(boxes)    classes = np.squeeze(classes).astype(np.int32)    scores = np.squeeze(scores)    # print(&#x27;boxes:&#x27;, boxes)    # print(&#x27;classes:&#x27;, classes)    # print(&#x27;scores:&#x27;, classes)    # 设置识别阈值，剔除不好的结果    results = []    for i, score in enumerate(scores):        if score &gt;= threshold:            result = &#123;                &#x27;box&#x27;: boxes[i],                &#x27;class_id&#x27;: classes[i],                &#x27;score&#x27;: scores[i]            &#125;            results.append(result)    return results def annotate_objects(image, results):  for rst in results:    ymin, xmin, ymax, xmax = rst[&#x27;box&#x27;]    class_id = rst[&#x27;class_id&#x27;]    name = labels_dict[class_id]    score = rst[&#x27;score&#x27;]    xmin = int(xmin * args_camera_width)    xmax = int(xmax * args_camera_width)    ymin = int(ymin * args_camera_height)    ymax = int(ymax * args_camera_height)    cv2.rectangle(image, (xmin, ymin), (xmax, ymax), (0, 255, 0))    txt = f&#x27;&#123;name&#125; &#123;score:.2%&#125;&#x27;    cv2.putText(image, txt, (xmin, ymin), 0, 1, (255, 255, 255), 2)# 1. 读取 labelslabels_dict = load_labels(args_labels)print(&#x27;labels_dict: \\n &#x27;, labels_dict)# 2. 加载模型文件interpreter = Interpreter(args_model)interpreter.allocate_tensors()input_details = interpreter.get_input_details()output_details = interpreter.get_output_details()# print(&#x27;input_details：\\n &#x27;, input_details)# print(&#x27;output_details：\\n &#x27;, output_details)# 3. 打开摄像头camera = cv2.VideoCapture(0)camera.set(3, args_camera_height)camera.set(4, args_camera_width)frame_rate_calc = 1.0freq = cv2.getTickFrequency()# 4. 目标识别while (True):    # 4.1 计算FPS, 开始计时    t1 = cv2.getTickCount()    # 4.2 从摄像头读取图片， 缩放为 300x300    ret, frame = camera.read()    input_image = cv2.resize(frame, (300, 300))    input_image = np.expand_dims(input_image, axis=0)    input_image = np.uint8(np.float32(input_image))    # 4.3 识别：张量填充，运行推理       results = detect_objects(interpreter, input_image, args_threshold)        print(f&#x27;--- &#123;time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)&#125; ---&#x27;)    for rst in results:        box = rst[&#x27;box&#x27;]        class_id = rst[&#x27;class_id&#x27;]        name = labels_dict[class_id]        score = rst[&#x27;score&#x27;]                print(f&#x27;* &#123;name&#125; : &#123;score:.2%&#125;  @ &#123;box&#125;&#x27;)        # 4.4 将识别结果绘制在原图上    annotate_objects(frame, results)    # 4.5 将 FPS 绘制在原图上    txt = f&#x27;FPS: &#123;frame_rate_calc:.2f&#125;&#x27;    cv2.putText(frame, txt, (20, 30), 0, 1, (0, 255, 255), 2)    # 4.6 显示图片    cv2.imshow(&#x27;Object detect&#x27;, frame)    # 4.7 更新计算 FPS     t2 = cv2.getTickCount()    frame_rate_calc = freq / (t2 - t1)    cv2.waitKey(1)camera.release()cv2.destroyAllWindows()\n","categories":["raspi"],"tags":["raspberry-pi","tensorflow","tflite","object_detection"]},{"title":"vscode设置python运行时的相对路径","url":"/2020/10/13/apps/vscode-python%E8%BF%90%E8%A1%8C%E6%97%B6%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84/","content":"问题在vscode中运行python时，相对路径有点迷惑，总是配置不好，导致在pycharm中可以顺利运行，到vscode里就找不到文件了。\n这里修改vscode的设置：将’python的运行目录’ 设置成 ‘python文件当前的目录’。\nVSCode 设置打开 setting.json, 加入：\n&#123;    &quot;python.terminal.executeInFileDir&quot;: true,&#125;\n\n\n或在设置里找到python插件中的相应选项，勾选即可。\n\n","categories":["apps"],"tags":["vscode","python"]},{"title":"树莓派小车L298N驱动","url":"/2020/10/07/raspi/raspberry-pi-%E5%B0%8F%E8%BD%A6L298N%E9%A9%B1%E5%8A%A8/","content":"0.1 树莓派GPIO定义ref: https://www.raspberrypi.org/documentation/usage/gpio/\n0.2 L298N端口定义\n\n\n名称\n符号\n备注\n\n\n\n电源\nVCC\n驱动电源，接+5V~+35V\n\n\n\nGND\n接地\n\n\n\n5V\n逻辑控制电源，5V 注1\n\n\n控制端\nENA、ENB\n两路  注2\n\n\n\nIN1IN2、IN3IN4\n高电平有效，接树莓派\n\n\n输出端\nOUT1~OUT4\n接电机\n\n\n\n注1：当驱动电压过高时（&gt;12V），逻辑控制电源单独接5V电源。 一般悬空即可。注2：使能端直接跳线与5V连接。这个5V是驱动电源经过78M05模块输出的。\n\n\n\n1. 接线\n\n\n\n\nIN1 -&gt; PIN 11    # 左前进 \nIN2 -&gt; PIN 12    # 左后退 \nIN3 -&gt; PIN 16    # 右前进 \nIN4 -&gt; PIN 15    # 右后退\n\n2. 程序import RPi.GPIO as GPIOimport timeIN1 = 11  # IN1, 左前进 IN2 = 12  # IN2, 左后退 IN3 = 16  # IN3, 右前进 IN4 = 15  # IN4, 右后退 # GPIO.setwarnings(False)def init():        GPIO.setmode(GPIO.BOARD)    GPIO.setup(IN1,GPIO.OUT)    GPIO.setup(IN2,GPIO.OUT)    GPIO.setup(IN3,GPIO.OUT)    GPIO.setup(IN4,GPIO.OUT)def forward(sleep_time):    init()    GPIO.output(IN1,GPIO.HIGH)    GPIO.output(IN2,GPIO.LOW)    GPIO.output(IN3,GPIO.HIGH)    GPIO.output(IN4,GPIO.LOW)    time.sleep(sleep_time)    GPIO.cleanup() def back(sleep_time):    init()    GPIO.output(IN1,GPIO.LOW)    GPIO.output(IN2,GPIO.HIGH)    GPIO.output(IN3,GPIO.LOW)    GPIO.output(IN4,GPIO.HIGH)    time.sleep(sleep_time)    GPIO.cleanup() def left(sleep_time):    init()    GPIO.output(IN1,False)    GPIO.output(IN2,False)    GPIO.output(IN3,GPIO.HIGH)    GPIO.output(IN4,GPIO.LOW)    time.sleep(sleep_time)    GPIO.cleanup() def right(sleep_time):    init()    GPIO.output(IN1,GPIO.HIGH)    GPIO.output(IN2,GPIO.LOW)    GPIO.output(IN3,False)    GPIO.output(IN4,False)    time.sleep(sleep_time)    GPIO.cleanup()forward(1)\n","categories":["raspi"],"tags":["raspberry-pi","l298n"]},{"title":"台达PLC处理模拟量信号","url":"/2020/09/13/mechatronic/PLC-DVP-%E5%8F%B0%E8%BE%BEPLC%E5%A4%84%E7%90%86%E6%A8%A1%E6%8B%9F%E9%87%8F%E4%BF%A1%E5%8F%B7/","content":"1. 硬件\n1.1 台达PLC\n\n型号： DVP-40EH00T2\n\n\n1.2 信号模块\n\n型号： DVP-04AD-H2\n\n\n1.3 参考文献 \n\n台达PLC手册： DELTA_IA-PLC_DVP-EH3_I_TSE_20201022.pdf\n台达特殊模块手册： DVP-PLC应用技术手册（特殊模块篇）(326P).pdf\n\n\n\n\n\n2. 接线以两线制 4-20mA 信号为例，\n\n仪表正极接PLC的24V+，仪表负极接I+输入端子；\n模块的24V端接PLC的24V+，模块的com端接PLC的24V-\n\n这样可以形成回路。 \n\n\n\n\n\n\n\n\n\n注：DVP-04AD模块测量电流信号时， V+ 及 I+ 端子需要短接\n\n3. 程序LD M1002TO K0 K1 H3 K1       # H3 代表电流信号LD M1002TO K0 K2 K10 K1      # K10 代表平均次数 LD M1000FROM K0 K6 D40 K1    # 平均信号 -&gt; D40LD M1000FROM K0 K12 D50 K1   # 实时信号 -&gt; D50LD M1000DIV D50 K200 D0      # 电流范围0-20mA, D50的数值范围为K0-K4000； 缩小200倍后存入 D0LD M1000CMP D50 K1600 M0     # 比较命令，将比较结果存入 M0...\n详见技术手册。\n\n另：\n\n输入输出点数不多的情况，可直接选用 EX 系列的PLC，PLC上自带模拟量的输入。\n如：DVP-20EX200R\n\n","categories":["mechatronics"],"tags":["PLC"]},{"title":"台达PLC控制步进电机","url":"/2020/09/13/mechatronic/PLC-Stepper%E5%8F%B0%E8%BE%BEPLC%E6%8E%A7%E5%88%B6%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA/","content":"1. 硬件\n1.1 台达PLC\n\n型号： DVP-40EH00T2\n\n1.2 驱动器\n\n型号： 雷赛 M542\n端子名称及说明如下（仅参考，以说明书为准）：\n\n\n\n名称\n符号\n备注\n\n\n\n24V电源\nDC+、DC-\n接DC24V电源\n\n\n电机接口\nA+、A-、B+、B-\n接电机\n\n\n使能端子\nPUL+、PUL-\n5v\n\n\n脉冲端子\nDIR+、DIR-\n5V\n\n\n转向端子\nEN+、EN-\n5V\n\n\n注：\n\n使能端这里用不到，可以悬空\n\n脉冲和转向电压要求是5V，接24V需要串一个2K电阻。\n\n1.3 电机型号： 57BYG250C\n\n\n\n\n2. 梯形图IO清单：\n\n\n\n名称\n说明\n备注\n\n\n\nX0\n正转\n\n\n\nX1\n反转\n\n\n\nY0\n脉冲输出\n\n\n\nY2\n换向输出\n\n\n\n\n\n\n3. 接线图\n","categories":["mechatronics"],"tags":["PLC","stepper-motor"]},{"title":"dlib库安装-win10-python37","url":"/2020/09/11/sci-opencv/dlib%E5%BA%93%E5%AE%89%E8%A3%85-win10-python37/","content":"dlib安装目前dlib在pypi中只支持到python36. \npython37下的安装网上搜了一下满地都是坑。\n终于在github中找到了一个编译好的安装包，记录一下。\n\n仓库： https://github.com/ljflinux/dlib\n\n文件： dlib-19.17.0-cp37-cp37m-win_amd64.whl (~ 3M)\n\n\n下载后直接pip安装即可：\npip install dlib-19.17.0-cp37-cp37m-win_amd64.whl\n\n在win10、python3.7.9上使用没有问题。\n","categories":["opencv"],"tags":["dlib","opencv"]},{"title":"Hexo 升级至 5.0 版","url":"/2020/07/30/hexo/hexo-%E5%8D%87%E7%BA%A7%E8%87%B3-HEXO-5.0/","content":"1. 升级 HEXO\n打开package.json, 修改 dependencies 项：\n\n&quot;hexo&quot;: &quot;^5.0.0&quot;,\n\n\n更新\n\nnpm update\n\n2. 改变一：通过npm安装主题\n\n\n安装next主题: npm install hexo-theme-next\n设置hexo主配置文件：\n\n# _config.ymltheme: next\n\n在根目录新建next主题的配置文件_config.next.yml：\n\n# _config.next.ymlscheme: Geminifooter:  since: 2015  icon:    animated: true# balabala ... \n\n然后可以删除原来的主题目录：themes/next\n\n3. 改变二：代码高亮：PrismJS新增了 PrismJS 代码高亮支持:\n# _config.ymlhighlight:  enable: true  auto_detect: false  line_number: true  tab_replace: &#x27;&#x27;  wrap: true  hljs: falseprismjs:  enable: false  preprocess: true  line_number: true  tab_replace: &#x27;&#x27;\n\n试了一下prismjs, 部分代码格式不对, 似乎有bug, 放弃。\n\n","categories":["hexo"],"tags":["hexo"]},{"title":"IKBC DC87 加LED灯","url":"/2020/07/24/device/IKBC-DC87%E5%8A%A0LED%E7%81%AF/","content":"准备\nLED灯，3mm无边LED灯 暖白色\n背光固件：DC87出厂默认没有背光，需要刷固件，关键词搜”信必成m20双模”\n\n焊灯DC87的灯位最上面一排没有预留焊锡，其他的预留了焊锡。\n可以先加热后直接把led戳进去；或者用吸锡器先把预留的焊锡全部吸掉。\n我这里直接加热后戳进去的，个别的需要补一点焊锡防止虚焊。\n\n刷固件\n运行界面\n\n\n\n\n背光快捷键\n\n\n\n\n快捷键\n功能\n备注\n\n\n\nFN + HOME\n打开&#x2F;切换灯光效果\n\n\n\nFN + END\n关闭灯光效果\n\n\n\nFN + ↑\n增加亮度\n\n\n\nFN + ↓\n减少亮度\n\n\n\nFN + INS\n增加亮度\n\n\n\nFN + DEL\n减少亮度\n\n\n\nFN + ←\n灯光方向向左\n灯光向左速度\n\n\nFN + →\n灯光方向向右\n灯光向右速度\n\n\nFN + PGUP\n进入&#x2F;退出自定义灯光\nFN键灯亮\n\n\n\nPS：默认的蓝牙快捷键\n\n\n\n\n快捷键\n功能\n备注\n\n\n\nFN + F1~F4\n切换蓝牙设备1~4\nScrLk灯闪烁\n\n\nFN + F5\n开启蓝牙\n空格左灯闪烁\n\n\nFN + PrtSc\n强制切换到蓝牙模式\nScrLk灯闪烁\n\n\nFN + ScrLk\n强制切换到有线模式\n\n\n\nFN + Pause\n恢复出厂设置\n长按5s，空格灯闪烁\n\n\n","categories":["mechatronics"],"tags":["ikbc"]},{"title":"雷蛇鼠标地狱狂蛇 Razer Abyssus1800 修复微动开关","url":"/2020/07/21/device/RazerAbyssus1800%E4%BF%AE%E5%A4%8D%E5%BE%AE%E5%8A%A8%E5%BC%80%E5%85%B3/","content":"鼠标一直用的地狱狂蛇 Abyssus。\n最早是2010款的磨砂版，当时还是蓝色的led灯，3500DPI，底部有两个调节开关。用了三年多，左键双击了。当时还觉得挺可惜的。\n后面买了两个2014款的，一个公司用，一个家用。这款led灯被改成了绿色，1800DPI，调节开关也被减配了。用了没多久，家里的鼠标中键就不是很灵了；最近公司的也出现了这个现象。\n\n\n\n\n\n琢磨着有空把两个鼠标一起换个微动。拆开鼠标，检查微动型号。\n\n只有一个螺丝，在底部脚贴里面，用美工刀拆开脚贴。\n\n\n\n\n拧出螺丝，掀开上盖，发现中键微动那里比较脏，好像是滚轮里的润滑油脂有一点点漏出来了。\n\n\n\n\n索性把微动开关拆开看一看。\n拆掉USB线的插排、LED的插排。\n\n\n\n\n左右键的微动是国产欧姆龙 D2FC-F-7N；中键的微动是TTC，型号不明。\n\n\n\n\n微动开关上盖是用两个卡扣扣在底座上的，用小螺丝刀从右侧小心拆掉。\n\n\n\n\n里面就一个塑料的白色触点、一个铜的弹簧片，小心把铜片取下来、擦干净、装回去。\n\n鼠标通电试一下，竟然好了。。。\n当然，最好的办法是换微动。\n关键词搜 D2FC-F-7N, 一般选10M的足够了，也可试试其他系列，都是通用的。\n\n\n索性把所有微动全换了。。。\n焊接比较简单，没有图片。\n\n满血复活\n\n\n\n","categories":["mechatronics"],"tags":["Razer"]},{"title":"ctex 配置 els-cas-templates","url":"/2020/07/09/sci/%E8%AE%BA%E6%96%87-ctex%E9%85%8D%E7%BD%AEels-cas-templates/","content":"投稿模板要用 els-cas-templates， ctex编译不过去，错误如下：\n\nerror: Environment graphicalabstract undefined\n\n原因不用想，肯定是ctex内置的latex(miktex)版本太老了。\n1. 试着更新一下miktex。miktex 官网： https://miktex.org/\n最新版是： MiKTeX 20.6 (6&#x2F;28&#x2F;2020)， 大概230M。\nhttps://miktex.org/download/ctan/systems/win32/miktex/setup/windows-x64/basic-miktex-20.6.29-x64.exe\n（最近miktex的版本号也改成了 年.月 的形式，之前是 2.9.x 的格式。）\n\n先把ctex安装目录内的 miktex 文件夹重命名成 miktex-old （保险起见，后面没问题再删）。\n安装MiKTeX 20.6到这个ctex默认的目录下。\n安装完，打开winedit，应该是能自动找到新的latex的；不行的话，检查一下路径。\n\n\n\n2. 打开cas-sc-template.tex，编译一下。\n因为新装的miktex是没有各种依赖包的，需要一个一个重新下载\n下载的包都是最新版，自动下载。\n网速比较慢，如果下载失败了，可以多试几次；也可以打开miktex console手动下载。\n\n3. 过程中又出错了\nSorry, but miktex-makepk did not succeed for the following reason\n\n\n试了原来的tex也打不开。。。\n\n4. 貌似是字体的原因，解决办法：\n找到 updmap.exe, 管理员权限运行一下；\n或者用命令：\n\ncd miktex\\bin\\x64updmap.exe  --force\n\n5. 在编译一次，貌似可以了。\ndone！\n","categories":["sci"],"tags":["latex"]},{"title":"pycharm对比工具加入右键菜单","url":"/2020/06/11/python/pycharm%E5%AF%B9%E6%AF%94%E5%B7%A5%E5%85%B7%E5%8A%A0%E5%85%A5%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95/","content":"Pycharm的文本对比功能强大，比VS Code好用的多。\n\n在工程里的文件树上，选中两个文件，然后Ctrl+D（或者右键-&gt;Compare）即可。\n但是要比较工程以外的文件，或者没打开Pycharm的时候想对比文件时，比较麻烦。毕竟Pycharm又不能秒开。\n\n这里尝试下更方便的用法。\n预期功能： 选中两个文件，然后右键“diff with pycharm”。\n0. Pycharm CLI在官网查到Pycharm支持命令行了，支持打开、对比、合并等一些命令。https://www.jetbrains.com/help/pycharm/working-with-the-ide-features-from-command-line.html\n基本用法如下：\npycharm.bat &lt;file / folder&gt;       # 打开文件或目录pycharm.bat diff &lt;file&gt; &lt;file&gt;    # 对比两个文件......\n我们这里只用到 diff 命令。\n方法1. 改注册表添加到右键菜单（失败）先尝试修改注册表，把diff命令添加到右键菜单。\n但是注册表里好像不支持把两个或多个文件作为参数传入。\n下面的设置，只能分别打开两个pycharm程序，实现不了打开一个pycharm，传入两个文件名。\nWindows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Classes\\*\\shell\\diff with pycharm\\command]@=&quot;C:\\\\Users\\\\xxxx\\\\scoop\\\\apps\\\\PyCharm-Professional\\\\current\\\\IDE\\\\bin\\\\pycharm.bat diff  \\&quot;%1\\&quot;&quot;\n\n试了把 %1 改成 %*, %V, 都不行。。。\n\n\n方法2. 添加到右键菜单的send to里\n2.1 找到pycharm安装目录的下的bin\\pycharm.bat，创建一个快捷方式。\n2.2 打开 send to 的目录，文件管理器地址里输入 shell:sendto（或者win+R运行shell:sendto）即可打开。\n2.3 把快捷方式拖进来，重命名diff with pycharm。\n2.4 右键打开属性，修改目标选项，前面的路径不要动，在后面加上 diff即可（diff前面有一个空格）。\n\n\n试下选中选中两个文件，然后右键-&gt;发送到-&gt;diff with pycharm，就能成功用pycharm对比了。\n注意必须是选中2个（或3个）文件，不然会出错的。\n简单测试了一下：\n\n选中一个文件是会出错的；\n选中三个试了也可以，分三栏；\n选中再多的话，就只对比其中两个。\n\n-Enjoy!-\n","categories":["python"],"tags":["python","pycharm"]},{"title":"powershell配置(4)-windows-terminal","url":"/2020/05/25/powershell/powershell%E9%85%8D%E7%BD%AE4-windows-terminal-%E9%85%8D%E7%BD%AE/","content":"1.安装可在应用商店安装，也可以scoop安装。\nscoop install windows-terminal\n\n2. 配置文件在设置里直接打开的是个人配置：setting.json\n按下alt再打开是默认配置文件：default.json\n直接默认文件的内容全部拷贝到个人配置里。\n简单的改一下powershell的设置，主题、字体、启动目录。\n&quot;profiles&quot;:    [        &#123;            &quot;guid&quot;: &quot;&#123;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx&#125;&quot;,            &quot;name&quot;: &quot;Windows PowerShell&quot;,            &quot;commandline&quot;: &quot;%SystemRoot%\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe&quot;,            &quot;icon&quot;: &quot;ms-appx:///ProfileIcons/&#123;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx&#125;.png&quot;,            &quot;colorScheme&quot;: &quot;Campbell&quot;,            &quot;antialiasingMode&quot;: &quot;grayscale&quot;,            &quot;closeOnExit&quot;: &quot;graceful&quot;,            &quot;cursorShape&quot;: &quot;bar&quot;,            &quot;fontFace&quot;: &quot;JetBrains Mono&quot;,            &quot;fontSize&quot;: 11,            &quot;hidden&quot;: false,            &quot;historySize&quot;: 9001,            &quot;padding&quot;: &quot;8, 8, 8, 8&quot;,            &quot;snapOnInput&quot;: true,            &quot;altGrAliasing&quot;: true,            &quot;startingDirectory&quot;: &quot;%USERPROFILE%&quot;,            &quot;useAcrylic&quot;: false        &#125;,     ]\n\n\n\n3. 加入右键菜单\n新建注册表文件 windows terminal here.reg, 内容如下（路径按需修改）\n\nWindows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Classes\\Directory\\Background\\shell\\Open with &amp;terminal]@=&quot;Open with &amp;terminal&quot;&quot;Icon&quot;=&quot;\\&quot;C:\\\\Users\\\\xxxx\\\\scoop\\\\apps\\\\windows-terminal\\\\current\\\\windowsterminal.exe\\&quot;&quot;[HKEY_CURRENT_USER\\Software\\Classes\\Directory\\Background\\shell\\Open with &amp;terminal\\command]@=&quot;\\&quot;C:\\\\Users\\\\xxxx\\\\scoop\\\\apps\\\\windows-terminal\\\\current\\\\windowsterminal.exe\\&quot;&quot;\n","categories":["powershell"],"tags":["powershell"]},{"title":"Jetbrain-Mono 字体","url":"/2020/05/23/apps/jetbrain-mono%E5%AD%97%E4%BD%93/","content":"1. Jetbrains Mono 字体Jetbrains 推出了一款新字体： Jetbrains Mono，还不错。\n\n支持连字\n不含中文字符\n含 powerline 字符\n\n\n\n官网： https://www.jetbrains.com/lp/mono/\nGithub： https://github.com/JetBrains/JetBrainsMono/\n\n官网的更新比Github慢。\n\n2. VSCode 设置编辑器和终端都可以设置，打开 setting.json, 加入：\n&#123;    &quot;editor.fontFamily&quot;: &quot;&#x27;JetBrains Mono&#x27;, &#x27;Courier New&#x27;, monospace&quot;,    &quot;editor.fontLigatures&quot;: true,    &quot;terminal.integrated.fontFamily&quot;: &quot;JetBrains Mono&quot;,&#125;\n\n默认的0是中间带点的0，要改为带斜杆的0，改成下面的：\n&#123;    &quot;editor.fontLigatures&quot;: &quot;&#x27;calt&#x27; off, &#x27;zero&#x27; on&quot;, // 关闭连字    &quot;editor.fontLigatures&quot;: &quot;&#x27;calt&#x27; on, &#x27;zero&#x27; on&quot;,  // 开启连字&#125;\n\n3. Jetbrains Mono Nerd-Fonts 版\nhttps://github.com/ryanoasis/nerd-fonts/tree/master/patched-fonts/JetBrainsMono/\n\ngithubghproxyaria2c https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/JetBrainsMono/Ligatures/Regular/complete/JetBrains%20Mono%20Nerd%20Font%20Complete%20Mono%20Windows%20Compatible%20Regular.ttfaria2c https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/JetBrainsMono/Ligatures/Italic/complete/JetBrains%20Mono%20Nerd%20Font%20Complete%20Mono%20Windows%20Compatible%20Italic.ttfaria2c https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/JetBrainsMono/Ligatures/Bold/complete/JetBrains%20Mono%20Nerd%20Font%20Complete%20Mono%20Windows%20Compatible%20Bold.ttfaria2c https://ghproxy.net/https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/JetBrainsMono/Ligatures/Regular/complete/JetBrains%20Mono%20Nerd%20Font%20Complete%20Mono%20Windows%20Compatible%20Regular.ttfaria2c https://ghproxy.net/https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/JetBrainsMono/Ligatures/Italic/complete/JetBrains%20Mono%20Nerd%20Font%20Complete%20Mono%20Windows%20Compatible%20Italic.ttfaria2c https://ghproxy.net/https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/JetBrainsMono/Ligatures/Bold/complete/JetBrains%20Mono%20Nerd%20Font%20Complete%20Mono%20Windows%20Compatible%20Bold.ttf\n\nVS Code 编辑器和终端都可以设置，打开 setting.json, 加入：\n&#123;    &quot;editor.fontFamily&quot;: &quot;&#x27;JetBrainsMono Nerd Font Mono&#x27;, &#x27;Courier New&#x27;, monospace&quot;,&#125;\n","categories":["apps"],"tags":["Jetbrain-Mono"]},{"title":"步进电机","url":"/2020/05/22/mechatronic/Stepper-%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA/","content":"1. 硬件\n1.1 步进电机\n\n一般4线制：A+、A-、B+、B-\n\n1.2 驱动器\n\n驱动器一般有总线控制和脉冲控制两种方法，这里用的脉冲控制。\n端子名称及说明如下（仅参考，以说明书为准）：\n\n\n\n名称\n符号\n备注\n\n\n\n24V电源\nDC+、DC-\n接DC24V电源\n\n\n电机接口\nA+、A-、B+、B-\n接电机\n\n\n总线接口\nCANH、CANL\n\n\n\n脉冲接口\nDIR、PUL、GND、EN\n\n\n\n\n1.3 控制器这里用YF-19控制器，实验用。\n\n\n\n2. 接线示意\n","categories":["mechatronics"],"tags":["stepper-motor"]},{"title":"害怕","url":"/2020/05/17/yoyo/20200517-%E5%AE%B3%E6%80%95/","content":"（书房里）\n妈妈：我睡在这个床上的时候，老是害怕空调会掉下来。\n悠悠：你是不是还害怕天花板会掉下来。。。\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"群晖安装oh-my-zsh","url":"/2020/05/13/synology/%E7%BE%A4%E6%99%96%E5%AE%89%E8%A3%85oh-my-zsh/","content":"1. zsh 安装\nref: https://synocommunity.com/\n\n先从套件中心中安装zsh 。\n\n登录DSM，找到 套件中心 → 设置， 将 信任层级 设为 Synology Inc. 和信任的发行者.\n\n在 套件来源 选项卡中, 增加一项：\n\n名称： SynoCommunity \n位置： http://packages.synocommunity.com/\n\n\n返回 套件中心， 左侧可以看到 社群 选项卡， 打开后可以看到里面有 Z shell (with modules)， 安装套件.\n\n\n# 显示当前 shell 类型echo $SHELL# 显示可使用的 shellcat /etc/shells# 显示 zsh 安装路径which zsh\n\n2. oh-my-zsh 安装\nref: https://ohmyz.sh/ref: https://gitee.com/mirrors/oh-my-zsh.git\n\n\n需要先安装 git. (在套件中心里有)\n\n用 wget 安装。\n$ sh -c &quot;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)&quot;# gitee 镜像$ sh -c &quot;$(wget https://gitee.com/mirrors/oh-my-zsh/raw/master/tools/install.sh -O -)&quot;\n简单配置一下，打开配置文件 nano ~/.zshrc\n# 主题ZSH_THEME=&quot;ys&quot;# 插件plugins=(git zsh-syntax-highlighting zsh-autosuggestions)\n下载插件\ngit clone https://github.com/zsh-users/zsh-autosuggestions $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-autosuggestionsgit clone https://github.com/zsh-users/zsh-syntax-highlighting $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlighting\n\n加载配置文件， source ~/.zshrc\n\n\n\n\n\n3. 将 zsh 设为默认一般用 chsh -s /bin/zsh 就可以更改了。\n但群晖没有 chsh 命令，新建配置文件 nano ~/.profile，加入以下内容：\nif [[ -x /usr/local/bin/zsh ]]; thenexport SHELL=/usr/local/bin/zshexec /usr/local/bin/zshfi\n\n\nref: https://migege.com/post/install-ohmyzsh-on-synology-dsmref: https://3os.org/guides/synology/\n\n","categories":["synology"],"tags":["synology","zsh"]},{"title":"BLDC无刷电机","url":"/2020/05/13/mechatronic/BLDC%E6%97%A0%E5%88%B7%E7%94%B5%E6%9C%BA/","content":"1. 硬件\n1.1 直流电机\n\n一般是8线制：\n\n\n\n名称\n符号\n备注\n\n\n\n电机电源\nU、V、W\n\n\n\n霍尔开关电源\nREF+、REF-\nDC5V， 接控制器或5V电源\n\n\n霍尔开关信号\nHU、HV、HW\n\n\n\n\n1.2 控制器\n\n控制器种类太多，部分端子名称及说明如下（仅参考，以说明书为准）：\n\n\n\n名称\n符号\n备注\n\n\n\n24V电源\nDC+、DC-\n接DC24V电源\n\n\n电机电源\nU、V、W\n\n\n\n霍尔开关电源\n5V+, GND\n\n\n\n霍尔开关信号\nHU、HV、HW\n\n\n\n使能\nRUN &#x2F; EN\n低电平启动，断开停止\n\n\n正、反转\nREV &#x2F; FR\n低电平反转，断开正转\n\n\n调速\nSPD &#x2F; SV\n0-5V电压调速\n\n\n刹车\nBK\n高电平刹车\n\n\n转速输出(脉冲)\nPLS\n5V脉冲信号\n\n\n转速输出(开漏)\nPG\n需在5V与PG间加2K-10K上拉电阻\n\n\n\n\n\n1.3 调速器（可调电阻&#x2F;电位器，10K）\n\n1.4 转速表\n\n\n\n\n\n名称\n符号\n备注\n\n\n\n信号输入\nIN、GND\n脉冲信号\n\n\n信号地\nV++，V–\n接DC5V电源\n\n\n2. 接线示意（一）\n\n\n3. 接线示意（二）\n\n\n","categories":["mechatronics"],"tags":["bldc-motor"]},{"title":"Hexo中的数学公式","url":"/2020/04/24/hexo/hexo-%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F/","content":"0. 官方文档Next 介绍了两种方案： mathjax &#x2F; katex 。\n\nhttps://theme-next.js.org/docs/third-party-services/math-equations\n\n这里用的是 mathjax。\n1. mathjax配置1.1 正文 Front-matter---title: Hexo中的数学公式date: 2020-04-25 01:46:39mathjax: true---\n\n1.2 Next主题配置math:  # Default (true) will load mathjax / katex script on demand.  # That is it only render those page which has `mathjax: true` in Front-matter.  # If you set it to false, it will load mathjax / katex srcipt EVERY PAGE.  per_page: true  # hexo-renderer-pandoc (or hexo-renderer-kramed) required for full MathJax support.  mathjax:    enable: true    # See: https://mhchem.github.io/MathJax-mhchem/    mhchem: false\n\n1.3 安装插件（貌似可以不装，默认的也能用）先卸载 hexo-renderer-marked， 再安装 hexo-renderer-pandoc\nnpm un hexo-renderer-markednpm i hexo-renderer-pandoc\n\n\n\n2. 坑遇到了公式无法正常显示的问题。\n\n公式：$RMSE &#x3D; 1 - \\dfrac{\\sum_{i&#x3D;1}^n (y_i - \\hat{y}_i)^2} {\\sum_{i&#x3D;1}^n (y_i - \\bar{y})^2}$\n\nHexo显示如下：\n\n\n\n\n\n\n安装hexo-renderer-pandoc插件也无法解决；\n\n换 katex 方案也不行。\n\n\n\n最后发现是 $\\hat{y}_i$ 这里出了问题，原因不明。\n在 $\\hat{y}_i$ 下标符号 _ 前加了一个反斜杠 \\ ，搞定。\n$RMSE = 1 - \\dfrac&#123;\\sum_&#123;i=1&#125;^n (y_i - \\hat&#123;y&#125;_i)^2&#125; &#123;\\sum_&#123;i=1&#125;^n (y_i - \\bar&#123;y&#125;)^2&#125;$$RMSE = 1 - \\dfrac&#123;\\sum_&#123;i=1&#125;^n (y_i - \\hat&#123;y&#125;\\_i)^2&#125; &#123;\\sum_&#123;i=1&#125;^n (y_i - \\bar&#123;y&#125;)^2&#125;$\n\n\n\n","categories":["hexo"],"tags":["hexo"]},{"title":"深度学习-回归问题的评估指标：MAE, MAPE, MSE, RMSE, R2_Score","url":"/2020/04/24/tensorflow/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-%E5%9B%9E%E5%BD%92%E9%97%AE%E9%A2%98%E7%9A%84%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87%EF%BC%9AMAE-MAPE-MSE-RMSE-R2_Score/","content":"回归问题常用的评估指标回归问题常用的评估指标包括：MAE, MAPE, MSE, RMSE, R2_Score等。\n这些评价指标基本都在 sklearn 包中都封装好了，可直接调用。\n安装 sklearn, 完整的名字是 scikit-learn。\npip install -U scikit-learn# 现在最新版是 V0.22.2.post1\n\n\n\n\nmetric\nformula\nmethod\n\n\n\nMAE\n$\\frac{1}{n} \\sum_{i&#x3D;1}^n \\vert y_i - \\hat{y}_i \\vert$\nsklearn.metrics.mean_absolute_error\n\n\nMAPE\n$\\frac{1}{n} \\sum_{i&#x3D;1}^n \\frac{\\vert y_i - \\hat{y}_i \\vert }{\\vert y_i \\vert}$\nsklearn.metrics.mean_absolute_percentage_error\n\n\nMSE\n$\\frac{1}{n} \\sum_{i&#x3D;1}^n (y_i - \\hat{y}_i)^2$\nsklearn.metrics.mean_squared_error\n\n\nRMSE\n$\\sqrt{\\frac{1}{n} \\sum_{i&#x3D;1}^n (y_i - \\hat{y}_i)^2}$\nsklearn.metrics.mean_squared_error\n\n\nR2 Score\n$1 - \\dfrac{\\sum_{i&#x3D;1}^n (y_i - \\hat{y}_i)^2} {\\sum_{i&#x3D;1}^n (y_i - \\bar{y})^2}$\nsklearn.metrics.r2_score\n\n\n注：\n\nMAPE 在V0.22.2中还不能直接调用，预计会在V0.23中发布；\n参见 github #15007\n\n\nRMSE 可以调用 mean_squared_error 方法实现, 设置 squared=False 即可;\nrmse_score = mean_squared_error(y_test, y_pred, squared=False)\n\n\n\n\n\n示例from sklearn.metrics import mean_absolute_errorfrom sklearn.metrics import mean_absolute_percentage_errorfrom sklearn.metrics import mean_squared_errorfrom sklearn.metrics import r2_scorex_true = xxxy_true = yyyy_pred = model.predict(x_true)# 评估标准： mae, mape, mse, rmse, r2_scoremae_score = mean_absolute_error(y_true, y_pred)mape_score = mean_absolute_percentage_error(y_true, y_pred)mse_score = mean_squared_error(y_true, y_pred)rmse_score = mean_squared_error(y_true, y_pred, squared=False)r_2_score = r2_score(y_true, y_pred)\n\n\nPS： 修改 sklearn(0.22.2) 源码， 直接调用 mean_absolute_percentage_error需要修改两个文件： sklearn/metrics/__init__.py, sklearn/metrics/_regression.py\n\nsklearn/metrics/__init__.py, 修改两处。\n\n## 第 63 行左右from ._regression import explained_variance_scorefrom ._regression import max_errorfrom ._regression import mean_absolute_errorfrom ._regression import mean_absolute_percentage_error  # +++ add MAPE +++from ._regression import mean_squared_errorfrom ._regression import mean_squared_log_errorfrom ._regression import median_absolute_error# 第 126 行左右    &#x27;matthews_corrcoef&#x27;,    &#x27;max_error&#x27;,    &#x27;mean_absolute_error&#x27;,    &#x27;mean_absolute_percentage_error&#x27;,  # +++ add MAPE +++    &#x27;mean_squared_error&#x27;,    &#x27;mean_squared_log_error&#x27;,    &#x27;mean_poisson_deviance&#x27;,\n\n\nsklearn/metrics/_regression.py, 修改两处\n\n# 第 36 行左右    &quot;max_error&quot;,    &quot;mean_absolute_error&quot;,    &quot;mean_absolute_percentage_error&quot;,  # +++ add MAPE +++    &quot;mean_squared_error&quot;,    &quot;mean_squared_log_error&quot;,    &quot;median_absolute_error&quot;,# 第 190 行左右    return np.average(output_errors, weights=multioutput)# +++ add MAPE +++def mean_absolute_percentage_error(y_true, y_pred,                                   sample_weight=None,                                   multioutput=&#x27;uniform_average&#x27;):    &quot;&quot;&quot;Mean absolute percentage error regression loss    Note here that we do not represent the output as a percentage in range    [0, 100]. Instead, we represent it in range [0, 1/eps]. Read more in the    :ref:`User Guide &lt;mean_absolute_percentage_error&gt;`.    Parameters    ----------    y_true : array-like of shape (n_samples,) or (n_samples, n_outputs)        Ground truth (correct) target values.    y_pred : array-like of shape (n_samples,) or (n_samples, n_outputs)        Estimated target values.    sample_weight : array-like of shape (n_samples,), default=None        Sample weights.    multioutput : &#123;&#x27;raw_values&#x27;, &#x27;uniform_average&#x27;&#125; or array-like        Defines aggregating of multiple output values.        Array-like value defines weights used to average errors.        If input is list then the shape must be (n_outputs,).        &#x27;raw_values&#x27; :            Returns a full set of errors in case of multioutput input.        &#x27;uniform_average&#x27; :            Errors of all outputs are averaged with uniform weight.    Returns    -------    loss : float or ndarray of floats in the range [0, 1/eps]        If multioutput is &#x27;raw_values&#x27;, then mean absolute percentage error        is returned for each output separately.        If multioutput is &#x27;uniform_average&#x27; or an ndarray of weights, then the        weighted average of all output errors is returned.        MAPE output is non-negative floating point. The best value is 0.0.        But note the fact that bad predictions can lead to arbitarily large        MAPE values, especially if some y_true values are very close to zero.    Examples    --------    &gt;&gt;&gt; from sklearn.metrics import mean_absolute_percentage_error    &gt;&gt;&gt; y_true = [3, -0.5, 2, 7]    &gt;&gt;&gt; y_pred = [2.5, 0.0, 2, 8]    &gt;&gt;&gt; mean_absolute_percentage_error(y_true, y_pred)    0.3273...    &gt;&gt;&gt; y_true = [[0.5, 1], [-1, 1], [7, -6]]    &gt;&gt;&gt; y_pred = [[0, 2], [-1, 2], [8, -5]]    &gt;&gt;&gt; mean_absolute_percentage_error(y_true, y_pred)    0.5515...    &gt;&gt;&gt; mean_absolute_percentage_error(y_true, y_pred, multioutput=[0.3, 0.7])    0.6198...    &quot;&quot;&quot;    y_type, y_true, y_pred, multioutput = _check_reg_targets(        y_true, y_pred, multioutput)    check_consistent_length(y_true, y_pred, sample_weight)    epsilon = np.finfo(np.float64).eps    mape = np.abs(y_pred - y_true) / np.maximum(np.abs(y_true), epsilon)    output_errors = np.average(mape,                               weights=sample_weight, axis=0)    if isinstance(multioutput, str):        if multioutput == &#x27;raw_values&#x27;:            return output_errors        elif multioutput == &#x27;uniform_average&#x27;:            # pass None as weights to np.average: uniform mean            multioutput = None    return np.average(output_errors, weights=multioutput)# +++ add MAPE +++def mean_squared_error(y_true, y_pred,                       sample_weight=None,\n\n\n参考 github：#15007\n\n\n\n","categories":["tensorflow"],"tags":["sklearn","deeplearning"]},{"title":"raspberry pi 使用 selenium firefox","url":"/2020/04/13/raspi/raspberry-pi-%E4%BD%BF%E7%94%A8-selenium-firefox/","content":"1. 安装虚拟屏幕我的树莓派系统是 buster lite 版，没有界面，所以先要安装 xvfb\nsudo apt install xvfb\n\n2. 安装 firefoxsudo apt install firefox-esrfirefox-esr -v # 安装完可以检测一下版本# Mozilla Firefox 68.7.0esr\n\n\n\n3. 安装 geckodriver下载安装 geckodriver-v0.23.0-arm7hf 版的。\n\nv0.24.0以后不发布arm7hf平台了，需要自己编译。\n好在v0.23.0也可以支持较新版本的 Firefox。\n\n# 下载aria2c -c https://github.com/mozilla/geckodriver/releases/download/v0.23.0/geckodriver-v0.23.0-arm7hf.tar.gz# 解压tar -xf geckodriver-v0.23.0-arm7hf.tar.gz# 修改权限sudo chmod a+x geckodriver# 移到 path下sudo mv geckodriver /usr/local/bin/  \nref: https://github.com/mozilla/geckodriver/releases\n4. 安装 selenium, pyvirtualdisplayref: https://www.selenium.dev/downloads/\npip3 install selenium==4.0.0a5pip3 install pyvirtualdisplay\n\n5. python代码import timefrom bs4 import BeautifulSoupfrom selenium import webdriverimport pyvirtualdisplay# 创建虚拟桌面display = pyvirtualdisplay.Display(backend=&#x27;xvfb&#x27;, visible=False, size=(1024, 768))display.start()print(&#x27;Initalized Display:&#x27;, display.size, display.backend)# 设置浏览器options = webdriver.FirefoxOptions()options.log.level = &quot;trace&quot; # 方便调试options.headless = True # 无头模式driver = webdriver.Firefox(options=options)# 测试一下url = &#x27;https://www.baidu.com&#x27;driver.get(url)print(driver.title)# 退出driver.close()driver.quit()display.stop()print(&#x27;Quit...&#x27;)\n\n6. 添加 selenium 定时任务可以用 crontab -e 命令添加 selenium 定时任务， 最后一行加入：\n# 格式# minute hour dayofmonth month dayofweek    command 0 8 * * * python3 task.py &amp;\n\n如果执行不成功，可能是找不到 selenium webdriver 的路径。\n\n检查 firefox-esr 和 geckodriver 的安装目录。\n\nwhich firefox-esr# /usr/binwhich geckodriver# /usr/local/bin\n\n然后，在命令前面加上路径配置， export PATH=/usr/local/bin:/usr/bin;\n\n0 8 * * * export PATH=/usr/local/bin:/usr/bin; python3 task.py &amp;\n\n","categories":["raspi"],"tags":["selenium","raspberry-pi","firefox"]},{"title":"pytorch调用inception-v3报错 'max() received an invalid combination of arguments'","url":"/2020/04/07/tensorflow/pytorch%E8%B0%83%E7%94%A8inception-v3%E6%8A%A5%E9%94%99/","content":"pytorch调用inception-v3报错：\nerror：  train_model(model, criterion, optimizer, scheduler, num_epochs)       37    outputs = model(inputs)  ---&gt; 38    _, preds = torch.max(outputs, 1)       39    loss = criterion(outputs, labels)  TypeError: max() received an invalid combination of arguments - got (InceptionOutputs, int), but expected one of: ...\n\n软件版本：\n\npython: 3.7.7\npytorch: 1.4.0\ntorchvision: 0.5.0\n\n解决办法：\n参考 https://stackoverflow.com/questions/51045839/pytorch-inceptionv3-transfer-learning-gives-error-max-received-an-invalid-co\nmodel_ft = models.inception_v3(pretrained=True)# 加入下面这一行model_ft.aux_logits=False \n\n","categories":["pytorch"],"tags":["pytorch"]},{"title":"tensorflow报错 'failed to create cublas handle', 'Failed to get convolution algorithm'","url":"/2020/04/03/tensorflow/tensoeflow%E6%8A%A5%E9%94%99/","content":"tensorflow gpu 报错：\n... tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED...... tensorflow/stream_executor/cuda/cuda_dnn.cc:329] Could not create cudnn handle: CUDNN_STATUS_ALLOC_FAILED...... Unknown:  Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\n\n软件版本：\n\npython: 3.7.7\nkeras: 2.3.1\ntensorboard: 2.1.0\ntensorflow: 2.1.0\n\n显卡版本：\n\ngpu: RTX 2070\ncuda: 10.1\ncudnn: 7.8\n\n解决办法：\n参考tensorflow的 pull #34888 : “Failed to get convolution algorithm. This is probably because cuDNN failed to initialize” \nhttps://github.com/tensorflow/tensorflow/issues/34888\n\n\nYou may try limiting your gpu memory usage with set_memory_growth option.See https://www.tensorflow.org/guide/gpu#limiting_gpu_memory_growthPut the following snippet on top of your code and execute again\n  import tensorflow as tfgpus= tf.config.experimental.list_physical_devices(&#x27;GPU&#x27;)tf.config.experimental.set_memory_growth(gpus[0], True)\n","categories":["tensorflow"],"tags":["tensorflow","keras"]},{"title":"梦想","url":"/2020/04/01/yoyo/20200401-%E6%A2%A6%E6%83%B3/","content":"妈妈：悠悠，你长大了有什么梦想？想当医生，老师，加油站工作人员，开挖掘机，还是科学家？\n悠悠：我想开挖掘机，妈妈，你小时候的梦想是什么？\n妈妈：是当一名教师。\n悠悠： 爸爸，你小时候的梦想是什么呢 ？\n爸爸： 我想当一名修理工，修摩托车，修汽车。。。 \n悠悠：那你修了吗 ？\n爸爸：没有，我没有实现，我现在也不会修车 。\n悠悠：我长大了可以帮你实现你的理想，你们也可以帮我实现我的理想 。\n爸爸：你的理想是什么？\n悠悠：我的理想是开挖掘机呀。。。妈妈只想当一个老师。\n爸爸：当老师也很好啊。\n悠悠：当老师可以教学生。\n爸爸：额… 那你想开挖掘机去挖什么呢？\n悠悠：就是把路哪里不平了，就把他挖一下。\n爸爸：哦，我知道了，就是把所有路上不平的地方都给他挖平，让别人可以走！\n悠悠：对呀~\n爸爸：哇，那你这个理想很伟大呀！\n悠悠：对呀~。。。你都不知道你要修什么车。\n爸爸：。。。\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"powershell配置(3)-折腾oh-my-posh和ys主题","url":"/2020/03/22/powershell/powershell%E9%85%8D%E7%BD%AE3-ohmyposh%E5%92%8Cys%E4%B8%BB%E9%A2%98/","content":"1. 安装 oh-my-posh， posh-git可以用scoop安装：\n# scoop bucket add extrasscoop install oh-my-posh\n\n新建、修改配置文件，运行:\nif (!(Test-Path -Path $PROFILE )) &#123; New-Item -Type File -Path $PROFILE -Force &#125;code $PROFILE\n加入以下内容：\nImport-Module posh-gitImport-Module oh-my-poshSet-Theme Paradox# 如果PowerShell设置里找不到字体，加上下面这一行# chcp 65001\n\n\nref: https://github.com/JanDeDobbeleer/oh-my-posh/\n\n2. 设置字体然后把字体设置为更纱黑体，就基本看起来比较舒服了。\n也可以用其他的字体，去这里找： https://github.com/ryanoasis/nerd-fonts\n但是我并不想用这些字体。\n\n\n3. 继续瞎折腾： 自定义一个oh-my-posh主题3.1 特殊字符代替使用YaHei Consolas Hybrid等非powerline字体，遇到了缺失字符的问题，那就干脆找出来 oh-my-posh 究竟用了那些特殊字符？\n# 显示当前主题设置$themesettings# 显示当前主题用到的字符$themesettings.promptsymbols$themesettings.gitsymbols# 显示当前主题用到的颜色Show-ThemeColors # 用到的颜色Show-Colors # 所有颜色\n\n还可以暴力搜索所有主题文件里的特殊字符（python代码在后面），\n最后发现里涉及到的特殊字符如下（后面3个字符是我自己加上的）：\n\n\n关于 unicode 字符的查询可以到这里：\n\nhttps://unicode-table.com/cn/https://apps.timwhitlock.info/unicode/inspect/\n\n那么我们可以把一些特殊字符改为一些常见的字符或者字体中已包含的字符：\n\n\n\n名称\ndefault\nys\njetbrains\n备注\n\n\n\n首字符\n#, &#x279c;\n#\n#\nStartSymbol\n\n\n普通用户指示符\n&#x25B6;, &#x276F;\n%\n&gt;\nPromptIndicator\n\n\n管理员指示符\n&#x26A1;\n$\n&#x27E9;\nPromptIndicator\n\n\n版本分支符号\n&#xE0A0;\n\n&#xE0A0;\nBranchSymbol\n\n\n版本状态：一致\n&#x2262;\no\n&#x2260;\nBranchIdenticalStatusToSymbol\n\n\n版本状态：未监视\n&#x2263;\nx\n&#x2261;\nBranchUntrackedSymbol\n\n\n上一命令执行错误\n&#x2A2F;, &#x2717;\n\n?\nFailedCommandSymbol\n\n\n\nys参考了on-my-zsh的ys主题的表示方法。\n\n\nhttps://blog.ysmood.org/my-ys-terminal-theme/\n\n\njetbrains是对应了Jetbrains Mono v1.0.5字体设置的。\n\n\n3.2 自定义posh主题（仿ys主题）本主题已被加入官方库，Set-Theme ys即可使用\n新建主题文件，code C:\\Users\\xxxx\\Documents\\WindowsPowerShell\\PoshThemes\\ys-like.psm1， 写入以下内容：\n#requires -Version 2 -Modules posh-gitfunction Write-Theme &#123;    param(        [bool]        $lastCommandFailed,        [string]        $with    )    # check the last command state and indicate if failed    If ($lastCommandFailed) &#123;        $prompt += Write-Prompt -Object &quot;$($sl.PromptSymbols.FailedCommandSymbol) &quot; -ForegroundColor $sl.Colors.CommandFailedIconForegroundColor    &#125;    # write # and space    $prompt = Write-Prompt -Object $sl.PromptSymbols.StartSymbol -ForegroundColor $sl.Colors.PromptSymbolColor    # write user and host    $user = $sl.CurrentUser    if (Test-NotDefaultUser($user)) &#123;        $prompt += Write-Prompt -Object &quot; $user&quot; -ForegroundColor $sl.Colors.PromptHighlightColor        # write at (devicename)        $computer = $sl.CurrentHostname        $prompt += Write-Prompt -Object &quot; at&quot; -ForegroundColor $foregroundColor        $prompt += Write-Prompt -Object &quot; $computer&quot; -ForegroundColor $sl.Colors.PromptForegroundColor        # write in for folder        $prompt += Write-Prompt -Object &quot; in&quot; -ForegroundColor $foregroundColor    &#125;    # write folder    $dir = Get-FullPath -dir $pwd    $prompt += Write-Prompt -Object &quot; $dir &quot; -ForegroundColor $sl.Colors.GitDefaultColor    # write on (git:branchname status)    $status = Get-VCSStatus    if ($status) &#123;        $themeInfo = Get-VcsInfo -status ($status)        $prompt += Write-Prompt -Object &#x27;on git:&#x27; -ForegroundColor $foregroundColor        $prompt += Write-Prompt -Object &quot;$($themeInfo.VcInfo) &quot; -ForegroundColor $sl.Colors.GitForegroundColor    &#125;    # write [time]    $timeStamp = Get-Date -Format T    $prompt += Write-Prompt &quot;[$timeStamp]&quot; -ForegroundColor $foregroundColor    # new line    $prompt += Set-Newline    if (Test-Administrator) &#123;        $prompt += Write-Prompt -Object ($sl.PromptSymbols.ElevatedSymbol + &quot; &quot;) -ForegroundColor $sl.Colors.AdminIconForegroundColor     &#125;    else&#123;        $prompt += Write-Prompt -Object ($sl.PromptSymbols.PromptIndicator + &quot; &quot;) -ForegroundColor $sl.Colors.PromptSymbolColor     &#125;&#125;$sl = $global:ThemeSettings # local settings$sl.PromptSymbols.StartSymbol                = &#x27;#&#x27;$sl.PromptSymbols.PromptIndicator            = &#x27;%&#x27;$sl.PromptSymbols.ElevatedSymbol             = &#x27;$&#x27;$sl.GitSymbols.BranchSymbol                  = &#x27;&#x27;$sl.GitSymbols.BranchUntrackedSymbol         = &#x27;x&#x27;$sl.GitSymbols.BranchIdenticalStatusToSymbol = &#x27;o&#x27;$sl.PromptSymbols.FailedCommandSymbol        = &#x27;?&#x27;# for dark theme$sl.Colors.AdminIconForegroundColor = [ConsoleColor]::Red$sl.Colors.PromptSymbolColor      = [ConsoleColor]::Blue$sl.Colors.PromptForegroundColor  = [ConsoleColor]::Green$sl.Colors.PromptHighlightColor   = [ConsoleColor]::Cyan$sl.Colors.GitDefaultColor        = [ConsoleColor]::Yellow$sl.Colors.GitForegroundColor     = [ConsoleColor]::Cyan# inspired by ys theme： not to use special characters (powerline fonts).# &gt; https://blog.ysmood.org/my-ys-terminal-theme/\n效果如下：\n\n\n\nPS. 找出 oh-my-posh 用到的特殊字符#%% 找出 `oh-my-posh` 用到的特殊字符import os, redef get_posh_symbols(root):    # 找到所有配置文件    files = []    # - 默认配置文件    default_file = os.path.join(root, &#x27;defaults.ps1&#x27;)     files.append(default_file)        # - 主题配置文件    themes_dir = os.path.join(root, &#x27;Themes&#x27;)    for parent, dirnames, filenames in os.walk(themes_dir):        for filename in filenames:            filedir = os.path.join(parent, filename)            files.append(filedir)    print(&#x27;All config files:\\n &#x27;, &#x27;\\n  &#x27;.join(files))    # 找到所有可能的 powerline 字符    symbols = []    for file in files:        with open(file, &#x27;r&#x27;, encoding=&#x27;utf8&#x27;) as f:            res = f.read(50000)            chars = re.findall(&quot;0x[0-9A-F]&#123;4&#125;&quot;, res)            symbols.extend(chars)    # - 去掉重复的，排序    symbols = sorted(list(set(symbols)))    # - 打印    for i in posh_symbols:        print(f&#x27;&#123;  i:8s&#125; &#123;chr(int(i, base=16)):4s&#125;&#x27;)        return symbolsposh_root = r&#x27;C:\\Users\\xxxx\\scoop\\apps\\oh-my-posh\\current&#x27;posh_symbols = get_posh_symbols(posh_root)#%% 显示 powerline 字符from PIL import  Image,ImageDraw,ImageFontttfont = ImageFont.truetype(&quot;JetBrainsMono-Regular.ttf&quot;, 16)dict = &#123;&#x27;0x00BB&#x27;: &#x27;Right-Pointing Double Angle Quotation Mark&#x27;,        &#x27;0x2191&#x27;: &#x27;Upwards Arrow&#x27;,        &#x27;0x2193&#x27;: &#x27;Downwards Arrow&#x27;,        &#x27;0x2262&#x27;: &#x27;Not Identical To&#x27;,        &#x27;0x2263&#x27;: &#x27;Strictly Equivalent To&#x27;,        &#x27;0x250C&#x27;: &#x27;Box Drawings Light Down And Right&#x27;,        &#x27;0x2514&#x27;: &#x27;Box Drawings Light Up And Right&#x27;,        &#x27;0x25B6&#x27;: &#x27;Black Right-Pointing Triangle&#x27;,        &#x27;0x25F7&#x27;: &#x27;White Circle With Upper Right Quadrant&#x27;,        &#x27;0x26A1&#x27;: &#x27;High Voltage Sign&#x27;,        &#x27;0x276F&#x27;: &#x27;Heavy Right-Pointing Angle Quotation Mark Ornament&#x27;,        &#x27;0x279C&#x27;: &#x27;Heavy Round-Tipped Rightwards Arrow&#x27;,        &#x27;0x2A2F&#x27;: &#x27;Vector Or Cross Product&#x27;,        &#x27;0xE0A0&#x27;: &#x27;Version Control Branch&#x27;,        &#x27;0xE0A1&#x27;: &#x27;LN (line) Symbol&#x27;,        &#x27;0xE0A2&#x27;: &#x27;Closed Padlock&#x27;,        &#x27;0xE0B0&#x27;: &#x27;Rightwards Black Arrowhead&#x27;,        &#x27;0xE0B1&#x27;: &#x27;Rightwards Arrowhead&#x27;,        &#x27;0xE0B2&#x27;: &#x27;Leftwards Black Arrowhead&#x27;,        &#x27;0xE0B3&#x27;: &#x27;Leftwards Arrowhead&#x27;,        &#x27;0xE606&#x27;: &#x27;Python Logo&#x27;,        &#x27;0xF09B&#x27;: &#x27;Github Logo&#x27;,        &#x27;0xF171&#x27;: &#x27;Bitbucket Logo&#x27;,        &#x27;0xF296&#x27;: &#x27;GitLab Logo&#x27;,        &#x27;0x0000&#x27;: &#x27;&#x27;,        &#x27;0x27E9&#x27;: &#x27;Mathematical Right Angle Bracket&#x27;,        &#x27;0x2260&#x27;: &#x27;Not Equal To&#x27;,        &#x27;0x2261&#x27;: &#x27;Identical To&#x27;,        &#x27;0x2717&#x27;: &#x27;BALLOT X&#x27;        &#125;def show_posh_fonts():        im = Image.new(&#x27;RGBA&#x27;, (600, 600), (255, 255, 255))    draw = ImageDraw.Draw(im)    txt = &#x27;\\n&#x27;.join([f&#x27;&#123;i&#125; &#123;chr(int(i, base=16))&#125; &#123;dict[i]&#125;&#x27; for i in dict])    print(txt)    draw.text((5,5), txt, fill=(0,0,0),font=ttfont)    im.show()show_posh_fonts()#%% 打印所有 unicode 字符from PIL import  Image, ImageDraw, ImageFontttfont = ImageFont.truetype(&quot;JetBrainsMono-Regular.ttf&quot;, 16)def show_all_fonts(list):    im = Image.new(&#x27;RGBA&#x27;, (1600, 800), (255, 255, 255))        for st, x, y in list:        txt = &#x27;&#x27;        for i in range(st, st + 0x0100):            if i % 16 == 0:                txt += f&#x27;\\n &#123;hex(i):6s&#125; &#x27;            txt += f&#x27;&#123;chr(i):2s&#125;&#x27;        print(txt)        draw = ImageDraw.Draw(im)        draw.text((x, y+20), txt, fill=(0,0,0),font=ttfont)    im.show()list = [[0x2100, 0, 0],        [0x2200, 400, 0],        [0x2300, 800, 0],        [0x2400, 1200, 0],        [0x2500, 0, 400],        [0x2600, 400, 400],        [0x2700, 800, 400],        [0xE000, 1200, 400],]show_all_fonts(list)# %%\n\n","categories":["powershell"],"tags":["powershell"]},{"title":"powershell配置(2)-psreadline历史记录和提示","url":"/2020/03/22/powershell/powershell%E9%85%8D%E7%BD%AE2-psreadline%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E5%92%8C%E6%8F%90%E7%A4%BA/","content":"1. 安装 psreadline\nref: https://github.com/PowerShell/PSReadLine\n\n1.1 从 PowerShellGallery 中安装。依次安装PowerShellGet, PSReadLine。\nInstall-Module -Name PowerShellGet -ForceInstall-Module PSReadLine\n安装完就有历史纪录了，关闭后可以保存历史记录。\n1.2 查看已安装的模块Get-InstalledModule\n\n\n2. 智能提示2.1 将PSReadLine 升级至V2.1（测试版）安装完之后没有智能提示，按tab键跳出来的命令都很奇怪。（我安的是稳定版，V2.0.2）\n发现测试版就加入了类似 fish 的智能提示，版本是V2.1.0-beta2。\n\nref: https://github.com/PowerShell/PSReadLine/pull/1496\n\n更新一下PSReadLine，用命令行窗口升级：\n# cmdpowershell -noprofile -command &quot;Install-Module PSReadLine -Force -SkipPublisherCheck -AllowPrerelease&quot;\n或：\nUpdate-Module PSReadLine -Force\n\n然后将 PredictionSourceSource 设为 History：\n# powershellSet-PSReadLineOption -PredictionSource History  # 默认是 None\n\n2.2 查看 PSReadLine 的设置Get-PSReadLineOption\n\n2.3 修改配置文件但是似乎窗口关闭后，就失效了。\n需要把设置这一行加到配置文件里就好了，新建、修改配置文件，运行:\nif (!(Test-Path -Path $PROFILE )) &#123; New-Item -Type File -Path $PROFILE -Force &#125;code $PROFILE\n就能打开配置文件。\n在配置里加入这一句。\nSet-PSReadLineOption -PredictionSource History  # 默认是 None\n\n\nDone!\n","categories":["powershell"],"tags":["powershell"]},{"title":"powershell配置(1)-基本操作：主题和字体","url":"/2020/03/21/powershell/powershell%E9%85%8D%E7%BD%AE1-%E4%B8%BB%E9%A2%98%E3%80%81%E5%AD%97%E4%BD%93/","content":"1. 安装 PowerShell 5.0 以上版本\nwin10： 已自带 V5.1；\nwin7 x64： 下载 Win7AndW2K8R2-KB3191566-x64.zip，安装；\nref: https://docs.microsoft.com/zh-cn/powershell/scripting/install/installing-windows-powershell?view=powershell-6\n\n\n\n2. 用concfg配置主题\nref: https://github.com/lukesampson/concfg\n\nscoop install concfg# 设置主题# concfg import cmd-default  # 暗色调concfg import google-light  # 浅色调# 列出所有预设主题concfg presets# 恢复原始设置concfg clean\n\n3. 安装字体\n\n打开 PowerShell 窗口，右键标题栏 -&gt; 默认值 -&gt; 字体。\n\nYaHei Consolas Hybrid： 含中文；不支持 powerline 字符\n\nhttps://github.com/yakumioto/YaHei-Consolas-Hybrid-1.12\n\n\nJetbrains Mono： 不含中文；支持 powerline 字符\n\n\nhttps://www.jetbrains.com/lp/mono/\nhttps://github.com/JetBrains/JetBrainsMono/\n\n\n\nCascadia Mono： 不含中文；支持 powerline 字符\n\n\nhttps://github.com/microsoft/cascadia-code/releases\n\n\n\nSarasa Gothic， 更纱黑体：含中文；支持 powerline 字符\n\n\n可以用scoop安装更纱黑体：\nscoop bucket add nerd-fontsscoop install SarasaGothic\n\n\n如果要用Powershell作为终端的话, 更纱黑体几乎是唯一的方案…\n可以同时支持powerline、中文、等宽、Truetype…\nhttps://github.com/ryanoasis/nerd-fonts\n\n\n","categories":["powershell"],"tags":["powershell"]},{"title":"群晖-python运行状态提醒","url":"/2020/03/03/synology/%E7%BE%A4%E6%99%96-python%E8%8E%B7%E5%8F%96%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81/","content":"1.获取运行状态获取群晖运行状态用到的命令如下表：\n\n\n\n命令\n说明\n\n\n\ntop\n获取CPU使用率\n\n\ncat /sys/class/hwmon/hwmon0/temp1_input\n获取CPU温度\n\n\nfree\n获取RAM使用率\n\n\ndf\n获取DISK使用率\n\n\nifconfig\n获取IP地址\n\n\n\n1.1 获取CPU温度：\n\n$ cat /sys/class/hwmon/hwmon0/temp1_input    36000   # 实际温度需要除以1000\n\n\n\n\n1.2 获取CPU使用率\n\n$ top -bn1    top - 19:31:32 up 1 day, 15:30,  1 user,  load average: 0.19, 0.05, 0.01 [IO: 0.00, 0.00, 0.00 CPU: 0.19, 0.05, 0.01]    Tasks: 372 total,   1 running, 371 sleeping,   0 stopped,   0 zombie    %Cpu(s): 22.2 us, 36.1 sy,  0.0 ni, 41.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st    GiB Mem :    5.651 total,    0.201 free,    0.660 used,    4.789 buff/cache    GiB Swap:    5.391 total,    5.391 free,    0.000 used.    4.586 avail Mem    PID USER      PR  NI    VIRT    RES  %CPU  %MEM     TIME+ S COMMAND    16145 root      20   0  467.5m  82.6m 94.12 1.427  77:03.73 S /var/packages/DownloadStation/target/sbin/transmissiond +    ...    ...# -bn1 参数： n1指定只运行一次，b输出结果为batch-mode，避免出现乱码# 可以看到CPU的信息在第3行，只要输出CPU这一行$ top -bn1 | awk &#x27;/Cpu\\(s\\)/&#x27;    %Cpu(s):  5.4 us,  8.1 sy,  0.0 ni, 86.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st# 缩写分别是user, system, nice, idle, wait, ...# 计算CPU使用率等于 1 - idle%\n\n\n1.3 获取RAM使用率\n\n$ free -m                  total        used        free      shared  buff/cache   available    Mem:           5786         674         208         126        4904        4698    Swap:          5519           0        5519# -m 参数是指定输出结果以 MB 为单位# 修改一下命令，只要输出 Mem 这一行$ free -m | awk &#x27;/Mem/&#x27;    Mem:           5786         674         208         126        4904        4698# 计算RAM使用率等于 (total - available) / total； （仅供参考）\n\n\n1.4 获取DISK使用率\n\n$ df -h    Filesystem         Size  Used Avail Use% Mounted on    /dev/md0           2.3G  1.3G  909M  59% /    devtmpfs           2.9G     0  2.9G   0% /dev    tmpfs              2.9G  184K  2.9G   1% /dev/shm    tmpfs              2.9G   18M  2.9G   1% /run    tmpfs              2.9G     0  2.9G   0% /sys/fs/cgroup    tmpfs              2.9G  2.3M  2.9G   1% /tmp    /dev/vg1/volume_2  889G  389G  501G  44% /volume2    /dev/vg1000/lv     890G  680G  211G  77% /volume1# -h 参数是指定输出结果人性化，自动选择单位# 修改一下命令，只要输出 /dev/root 这一行$ df -h | awk &#x27;/vg1000/&#x27;    /dev/vg1000/lv     890G  680G  211G  77% /volume1\n\n\n1.5 获取 IP 地址\n\n$ ifconfig eth0    eth0      Link encap:Ethernet  HWaddr 00:11:32:B9:D1:64          inet addr:192.168.31.xxx  Bcast:192.168.31.xxx  Mask:255.255.255.0                ...# ifconfig 命令要用管理员运行# wlan0 参数是指wifi网络；如果是有线网络，改为： eth0# 修改一下命令，只要输出 inet 这一行$ ifconfig eth0 | awk &#x27;/inet/&#x27;    inet addr:192.168.31.xxx  Bcast:192.168.31.xxx  Mask:255.255.255.0\n\n2. 完整的代码import osimport timeimport requestsdef now():    return &#x27;[&#x27; + time.strftime(&#x27;%Y-%m-%d %H:%M:%S&#x27;) + &#x27;]&#x27;# run commanddef run_cmd(cmd):    p = os.popen(cmd).readline().strip().split()    return p# cpu_temp = run_cmd(&quot; vcgencmd measure_temp &quot;)temp1_in = run_cmd(&quot; cat /sys/class/hwmon/hwmon0/temp1_input &quot;)cpu_temp = float(temp1_in[0])/1000.0cpu_stat = run_cmd(&quot; top -bn1 | awk &#x27;/Cpu\\(s\\)/&#x27; &quot;)cpu_used = 1 - float(cpu_stat[7])/100.0ram_stat = run_cmd(&quot; free -m | awk &#x27;/Mem/&#x27; &quot;)ram_used = (int(ram_stat[1]) - int(ram_stat[6])) / float(ram_stat[1])disk_st0 = run_cmd(&quot; df -h | awk &#x27;/vg1/&#x27; &quot;)disk_st1 = run_cmd(&quot; df -h | awk &#x27;/vg2/&#x27; &quot;)ipconfig = run_cmd(&quot; ifconfig eth0 | awk &#x27;/inet/&#x27; &quot;)print(temp1_in, cpu_temp, cpu_stat, cpu_used, sep=&#x27;\\n&#x27;)print(ram_stat, ram_used, disk_st0, disk_st1, ipconfig, sep=&#x27;\\n&#x27;)###status = now() + &#x27;\\n\\n&#x27;status += &#x27;Synology Status:      \\n&#x27;status += &#x27;CPU  Used  = &#123;:.2%&#125;   \\n&#x27;.format(cpu_used)status += &#x27;CPU  Temp  = &#123;:.2f&#125;°C \\n&#x27;.format(cpu_temp)status += &#x27;RAM  Total = &#123;&#125;M      \\n&#x27;.format(ram_stat[1])status += &#x27;RAM  Used  = &#123;:.2%&#125;   \\n&#x27;.format(ram_used)status += &#x27;DISK Total = &#123;&#125;, &#123;&#125;   \\n&#x27;.format(disk_st0[1], disk_st1[1])status += &#x27;DISK Used  = &#123;&#125;, &#123;&#125;   \\n&#x27;.format(disk_st0[2], disk_st1[2])status += &#x27;DISK Perc  = &#123;&#125;, &#123;&#125;   \\n&#x27;.format(disk_st0[4], disk_st1[4])status += &#x27;IP Address = &#123;&#125;       \\n&#x27;.format(ipconfig[1].replace(&#x27;addr:&#x27;, &#x27;&#x27;))print(status)# Send to ftqqkey = &#x27;SCUxxxxxxxxxxxxxxx&#x27;api = &#x27;https://sc.ftqq.com/&#123;&#125;.send&#x27;.format(key)send_data = &#123;&#x27;text&#x27;: &#x27;Synology_Status&#x27;, &#x27;desp&#x27;: status&#125;res = requests.post(api, data=send_data)print(res.content)# Send to wechatimport wechat_push as wpaccess_token, _ = wp.get_access_token(wp.corp_id, wp.corp_secret)wp.wechat_push_text(agent_id=wp.agent_id, access_token=access_token, message=status)\n","categories":["synology"],"tags":["synology"]},{"title":"runcat-pyqt5-win：在windows任务栏养猫（2）","url":"/2020/02/29/python-app/runcat-for-win-%E5%9C%A8windows%E4%BB%BB%E5%8A%A1%E6%A0%8F%E5%85%BB%E7%8C%AB%20V2/","content":"runcat-pyqt5-win V2之前撸了一个 runcat-pyqt5-win，可以在windows任务栏养猫，用奔跑的猫来显示当前系统资源（CPU）的占用情况。\n\ngithub仓库： https://github.com/shenbo/runcat-pyqt5-win\n原mac应用： http://kyomesuke.com/runcat/index.html\n\n原来的功能比较简单，这次增加了右键菜单：\n\n可切换图标类型： [cat, mario]\n可切换监控类型： [cpu, memory, gpu(nVidia)]\n增加了退出按钮\n\n运行效果\n\n\n\nRequirements\npsutil\npyqt5\nnvidia-ml-py\n\n完整代码import osimport sysimport threadingimport timeimport psutilfrom PyQt5.QtGui import QIconfrom PyQt5.QtWidgets import QApplication, QSystemTrayIcon, QMenu, QActionimport pynvmlpynvml.nvmlInit()handle = pynvml.nvmlDeviceGetHandleByIndex(0)   # GPU id: 0class TrayIcon(QSystemTrayIcon):    def __init__(self, parent=None):        super(TrayIcon, self).__init__(parent)        self.monitor = &#x27;cpu&#x27;        self.cpu_usage = 0.2  # 初始化        self.mem_usage = 0.2  # 初始化        self.gpu_usage = 0.2  # 初始化        self.icon_type = &#x27;runcat&#x27;         # 设定默认图标，并加载        self.icon_list = self.loadIcon()        self.setIcon(self.icon_list[0])        self.setVisible(True)        self.setMenu()  # 加载菜单        self.updateIcon()  # 更新图标    # 加载图标    def loadIcon(self):        if self.icon_type == &#x27;mario&#x27;:            return [QIcon(f&#x27;icons/&#123;self.icon_type&#125;/&#123;i&#125;.png&#x27;) for i in range(3)]        return [QIcon(f&#x27;icons/&#123;self.icon_type&#125;/&#123;i&#125;.png&#x27;) for i in range(5)]    # 设置菜单    def setMenu(self):        self.menu = QMenu()        self.action_1 = QAction(QIcon(f&#x27;icons/cat.png&#x27;),                                &#x27;Cat&#x27;, self, triggered=lambda: self.changeIconType(&#x27;runcat&#x27;))        self.action_2 = QAction(QIcon(f&#x27;icons/mario/0.png&#x27;),                                &#x27;Mario&#x27;, self, triggered=lambda: self.changeIconType(&#x27;mario&#x27;))        self.action_c = QAction(QIcon(f&#x27;icons/cpu.png&#x27;),                                &#x27;CPU&#x27;, self, triggered=lambda: self.changeMonitor(&#x27;cpu&#x27;))        self.action_m = QAction(QIcon(f&#x27;icons/mem.png&#x27;),                                &#x27;Memory&#x27;, self, triggered=lambda: self.changeMonitor(&#x27;mem&#x27;))        self.action_g = QAction(QIcon(f&#x27;icons/gpu.png&#x27;),                                &#x27;GPU&#x27;, self, triggered=lambda: self.changeMonitor(&#x27;gpu&#x27;))        self.action_q = QAction(QIcon(f&#x27;icons/quit.png&#x27;),                                &#x27;Quit&#x27;, self, triggered=self.quit)        self.menu.addAction(self.action_c)        self.menu.addAction(self.action_m)        self.menu.addAction(self.action_g)        self.menu.addSeparator()        self.menu.addAction(self.action_1)        self.menu.addAction(self.action_2)        self.menu.addSeparator()        self.menu.addAction(self.action_q)        self.setContextMenu(self.menu)    # 根据使用率更新图标，    # 创建两个 threading：一个获取使用率，一个更新图标    def updateIcon(self):        threading.Timer(0.1, self.thread_get_cpu_usage, []).start()        threading.Timer(0.1, self.thread_update_icon, []).start()    # get cpu usage    def thread_get_cpu_usage(self):        while True:            self.cpu_usage = psutil.cpu_percent(interval=1) / 100            self.mem_usage = psutil.virtual_memory().percent / 100            meminfo = pynvml.nvmlDeviceGetMemoryInfo(handle)            self.gpu_usage = meminfo.used / meminfo.total            # print(self.cpu_usage)            time.sleep(0.5)    # update icon    def thread_update_icon(self):        while True:            mon = self.cpu_usage            if self.monitor == &#x27;mem&#x27;:                mon = self.mem_usage            elif self.monitor == &#x27;gpu&#x27;:                mon = self.gpu_usage                        t = 0.18 - mon * 0.15            # print(mon, t)            for i in self.icon_list:                self.setIcon(i)                tip = f&#x27;cpu: &#123;self.cpu_usage:.2%&#125; \\nmem: &#123;self.mem_usage:.2%&#125; \\ngpu: &#123;self.gpu_usage:.2%&#125;&#x27;                self.setToolTip(tip)                # print(i, self.cpu_usage)                time.sleep(t)    # Change icon type    def changeIconType(self, type):        print(type)        if type != self.icon_type:            self.icon_type = type            self.icon_list = self.loadIcon()            print(f&#x27;Load &#123;self.icon_type&#125;(&#123;len(self.icon_list)&#125;) icons...&#x27;)    # change monitor type    def changeMonitor(self, monitor_type):        print(monitor_type)        if monitor_type != self.monitor:            self.monitor = monitor_type    # 退出程序    def quit(self):        self.setVisible(False)        app.quit()        os._exit(-1) # 完全退出程序if __name__ == &quot;__main__&quot;:    app = QApplication(sys.argv)    tray = TrayIcon()    sys.exit(app.exec_())\n","categories":["python"],"tags":["python","pyqt5"]},{"title":"keras调用tensorborad时报错 AttributeError 'Model' object has no attribute '_get_distribution_strategy'","url":"/2020/02/22/tensorflow/keras%E8%B0%83%E7%94%A8tensorborad%E6%97%B6%E6%8A%A5%E9%94%99/","content":"keras调用tensorborad时报错：AttributeError: &#39;Model&#39; object has no attribute &#39;_get_distribution_strategy&#39;\n软件版本：\n\npython: 3.7.4\nkeras: 2.3.1\ntensorboard: 2.1.0\ntensorflow: 2.1.0\n\n解决办法A：\n参考tensorflow的 pull #34870 : “Use _get_distribution_strategy only when it is available. “ https://github.com/tensorflow/tensorflow/pull/34870\n\n\nThe changes introduced in  06d8f77  are not compatible with standalone Keras (they are compatible with tf.Keras). a keras.Model does not have a _get_distribution_strategy method, which is now assumed for the Tensorboard callback.\n\n\n直接修改tensorflow/python/keras/callbacks.py文件，如下图。\n\n\n\n\n\n相关代码如下。\n# 1529行左右 : # distributed_file_utils.write_dirpath()    # In case this callback is used via native Keras, _get_distribution_strategy does not exist.    if hasattr(self.model, &#x27;_get_distribution_strategy&#x27;):      # TensorBoard callback involves writing a summary file in a      # possibly distributed settings.      self._log_write_dir = distributed_file_utils.write_dirpath(          self.log_dir, self.model._get_distribution_strategy())  # pylint: disable=protected-access    else:      self._log_write_dir = self.log_dir# 1732行左右也要改一下: # distributed_file_utils.remove_temp_dirpath()    # In case this callback is used via native Keras, _get_distribution_strategy does not exist.    if hasattr(self.model, &#x27;_get_distribution_strategy&#x27;):      # Safely remove the unneeded temp files.      distributed_file_utils.remove_temp_dirpath(          self.log_dir, self.model._get_distribution_strategy())  # pylint: disable=protected-access\n\n\n解决办法B：修改引用，改为从tensorflow.keras中引用。\nimport kerasfrom tensorflow.keras.callbacks import TensorBoardfrom tensorflow.keras.layers import *from tensorflow.keras.models import Sequential# xxxxx\n\nref ：https://stackoverflow.com/questions/59765784/attributeerror-sequential-object-has-no-attribute-get-distribution-strategy\n\n","categories":["tensorflow"],"tags":["tensorflow","keras"]},{"title":"数据可视化-等高线-pandas透视图-seaborn热力图-桑基图(Sankey)","url":"/2020/02/17/sci-matplotlib/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-matplotlib%E7%BB%98%E5%88%B6%E7%AD%89%E9%AB%98%E7%BA%BF/","content":"matplotlib绘制等高线ref: https://matplotlib.org/api/_as_gen/matplotlib.pyplot.contour.html\nimport numpy as npimport matplotlib.pyplot as pltx = np.arange(0, 10.0, 0.1)y = np.arange(0, 10.0, 0.1)X, Y = np.meshgrid(x, y)    # 生成x-y网格图Z = X**1.5 + Y**1.5plt.figure()CS = plt.contour(X, Y, Z, levels=6)                   # 设置距离plt.clabel(CS, inline=1, fontsize=10, fmt=&#x27;%d ℃&#x27;)   # 设置标签plt.savefig(&#x27;Temp.png&#x27;, dpi=300, bbox_inches=&#x27;tight&#x27;)plt.show()\n\n\n \n\n\n\npandas透视图1. 创建需要展示的数据import itertoolsimport matplotlib.pyplot as pltimport numpy as npimport pandas as pdimport seaborn as sns# === define paras ==================para_names = [&#x27;layer_n&#x27;, &#x27;activition&#x27;, &#x27;seed&#x27;]layer_n = [1, 2, 3, 4, 5, 6]activition = [&#x27;tanh&#x27;, &#x27;sigmod&#x27;, &#x27;relu&#x27;]seed = [11, 17, 19]# 创建 dataframedf =  pd.DataFrame([], columns=para_names)for values in itertools.product(layer_n, activition, seed):    newline = pd.DataFrame(list(values), index=para_names)    df = df.append(newline.T, ignore_index=True)# 伪造一些训练结果，方便展示# activ_2_num = pd.factorize(df[&#x27;activition&#x27;])[0].astype(&#x27;int&#x27;)  # 激活函数是字符类型，将其映射成整数形activ_dict = &#123;&#x27;tanh&#x27;: 2, &#x27;sigmod&#x27;: 4, &#x27;relu&#x27;: 6&#125;  # 也可以直接定义字典，然后replacedf[&#x27;results&#x27;] = df[&#x27;layer_n&#x27;] + df[&#x27;activition&#x27;].replace(activ_dict) + df[&#x27;seed&#x27;] * 0.1 + np.random.random((54,))df[&#x27;results&#x27;] = df[&#x27;results&#x27;].astype(&#x27;float&#x27;)  # 转换成浮点类型print(df.head())\n\n输出：\n  layer_n activition seed   results\n0       1       tanh   11  4.261361\n1       1       tanh   17  4.822595\n2       1       tanh   19  4.929088\n3       1     sigmod   11  6.698047\n4       1     sigmod   17  7.020531\n\n\n2. 绘制带误差的折线图展示训练结果# 绘制带误差的折线图，横轴为网络层数，纵轴为训练结果，# 激活函数采用不同颜色的线型，误差来自于没有指定的列：不同的随机种子seedplt.figure(figsize=(8, 6))sns.lineplot(x=&#x27;layer_n&#x27;, y=&#x27;results&#x27;, hue=&#x27;activition&#x27;,  style=&#x27;activition&#x27;,              markers=True, data=df)plt.grid(linestyle=&#x27;:&#x27;)plt.show()\n\n\n\n\n3. 使用pandas透视图、seaborn热力图来展示# 创建透视图，# 对于没有指定的列（seed），按最大值进行统计dt = pd.pivot_table(df, index=[&#x27;layer_n&#x27;], columns=[&#x27;activition&#x27;], values=[&#x27;results&#x27;], aggfunc=[max])print(dt)print(dt.columns)  # 找到最大值、最大值所对应的索引max_value, max_idx = dt.stack().max(), dt.stack().idxmax()print(f&#x27; - the max value is &#123;max_value&#125;;\\n - the index is &#123;max_idx&#125;...&#x27;)# 透视图变成了多重索引(MultiIndex)，重新调整一下new_col = dt.columns.levels[2]dt.columns = new_col# dt.index = list(dt.index)print(dt)dt.sort_index(axis=0, ascending=False, inplace=True)  # 必要时将索引重新排序dt.sort_index(axis=1, ascending=False, inplace=True)  # 必要时将索引重新排序# 绘制热力图，横轴为网络层数，纵轴为激活函数，# 栅格的颜色代表训练结果，颜色越深结果越好plt.figure(figsize=(8, 6))g = sns.heatmap(dt, vmin=0.0, annot=True, fmt=&#x27;.2g&#x27;, cmap=&#x27;Blues&#x27;, cbar=True)plt.show()\n\n\n\n\nref:\n\npandas.pivot_table https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html\n\nseaborn.lineplot https://seaborn.pydata.org/generated/seaborn.lineplot.html\n\nseaborn.heatplot https://seaborn.pydata.org/generated/seaborn.heatmap.html\n\n\n\n桑基图(Sankey)1. 桑基图(Sankey)介绍sankey图可用于数据从一系列节点到另一系列节点流入流出的可视化。\n主要有两个基本概念：\n\n节点 （nodes）\n连接 （links）： 源节点至目标节点之间的关系，每个连接包括三个元素：\nsource： 源节点\ntarget： 目标节点\nvalue： 数据\n\n\n\n\nref: https://developers.google.com/chart/interactive/docs/gallery/sankey\n\n2. 绘制桑基图（使用pyecharts）常用的绘图库 matplotlib, seaborn 好像不支持桑基图， 这里使用了 pyecharts 。\n这里 https://gallery.pyecharts.org/#/Sankey/sankey_base 有几个例子。\n\n\n简单用法如下：\nimport pandas as pdfrom pyecharts import options as optsfrom pyecharts.charts import Sankey# 数据data = [[ &#x27;Brazil&#x27;, &#x27;Portugal&#x27;, 5 ],       [ &#x27;Brazil&#x27;, &#x27;France&#x27;, 1 ],       [ &#x27;Brazil&#x27;, &#x27;Spain&#x27;, 1 ],       [ &#x27;Brazil&#x27;, &#x27;England&#x27;, 1 ],       [ &#x27;Canada&#x27;, &#x27;Portugal&#x27;, 1 ],       [ &#x27;Canada&#x27;, &#x27;France&#x27;, 5 ],       [ &#x27;Canada&#x27;, &#x27;England&#x27;, 1 ],       [ &#x27;Mexico&#x27;, &#x27;Portugal&#x27;, 1 ],       [ &#x27;Mexico&#x27;, &#x27;France&#x27;, 1 ],       [ &#x27;Mexico&#x27;, &#x27;Spain&#x27;, 5 ],       [ &#x27;Mexico&#x27;, &#x27;England&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;Portugal&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;France&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;Spain&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;England&#x27;, 5 ],       [ &#x27;Portugal&#x27;, &#x27;Angola&#x27;, 2 ],       [ &#x27;Portugal&#x27;, &#x27;Senegal&#x27;, 1 ],       [ &#x27;Portugal&#x27;, &#x27;Morocco&#x27;, 1 ],       [ &#x27;Portugal&#x27;, &#x27;South Africa&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;Angola&#x27;, 1 ],       [ &#x27;France&#x27;, &#x27;Senegal&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;Mali&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;Morocco&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;South Africa&#x27;, 1 ],       [ &#x27;Spain&#x27;, &#x27;Senegal&#x27;, 1 ],       [ &#x27;Spain&#x27;, &#x27;Morocco&#x27;, 3 ],       [ &#x27;Spain&#x27;, &#x27;South Africa&#x27;, 1 ],       [ &#x27;England&#x27;, &#x27;Angola&#x27;, 1 ],       [ &#x27;England&#x27;, &#x27;Senegal&#x27;, 1 ],       [ &#x27;England&#x27;, &#x27;Morocco&#x27;, 2 ],       [ &#x27;England&#x27;, &#x27;South Africa&#x27;, 7 ],       [ &#x27;South Africa&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;South Africa&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;South Africa&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Angola&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Angola&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Angola&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Senegal&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Senegal&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Senegal&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Mali&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Mali&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Mali&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Morocco&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Morocco&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Morocco&#x27;, &#x27;Japan&#x27;, 3 ]]df = pd.DataFrame(data, columns=[&#x27;source&#x27;, &#x27;target&#x27;, &#x27;value&#x27;])print(&#x27;- data shape: &#x27;, df.shape, &#x27;\\n&#x27;)# 生成节点， 先合并源节点和目标节点，然后去除重复的节点，最后输出成 dict 形式nn = pd.concat([df[&#x27;source&#x27;], df[&#x27;target&#x27;]])nn = nn.drop_duplicates()nodes = pd.DataFrame(nn, columns=[&#x27;name&#x27;]).to_dict(orient=&#x27;records&#x27;)print(&#x27;- nodes:\\n&#x27;, nodes, &#x27;\\n&#x27;)# 生成连接， dict 形式links = df.to_dict(orient=&#x27;records&#x27;)print(&#x27;- links:\\n&#x27;, links, &#x27;\\n&#x27;)# 绘制桑基图sk =(    Sankey(init_opts=opts.InitOpts(width=&quot;800px&quot;, height=&quot;600px&quot;)) # 页面大小    .add(        series_name=&quot;legend&quot;, # legend        nodes=nodes,        links=links,        # opacity 透明度； curve 弯曲程度； color 色系        linestyle_opt=opts.LineStyleOpts(opacity=0.2, curve=0.5, color=&quot;source&quot;),         label_opts=opts.LabelOpts(position=&quot;right&quot;), # 节点名称    )    .set_global_opts(title_opts=opts.TitleOpts(title=&quot;sankey&quot;)) # 标题    .render(&quot;sankey.html&quot;) # 保存成 html 文件)\n\n\n\n代码说明：\n\npyecharts的桑基图对于原始数据的格式比较啰嗦，这里用 pandas 处理了一下，还可以修改一下去读取 csv 文件。\npyecharts直接保存图片也比较麻烦，需要用 selenium 之类的工具，配置一大堆；还不如直接在浏览器截图。\n\n\n使用 D3 绘制D3 绘制桑基图貌似更简便一点，可惜不能用 python。\nhttps://github.com/d3/d3-sankey\n这里还有个在线可实时编辑版。\nhttps://observablehq.com/@mbostock/flow-o-matic\n厉害了！\n","categories":["sci"],"tags":["pandas","seaborn"]},{"title":"数据可视化-等高线-pandas透视图-seaborn热力图-桑基图(Sankey)","url":"/2020/02/17/sci-matplotlib/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-pandas%E9%80%8F%E8%A7%86%E5%9B%BE-seaborn%E7%83%AD%E5%8A%9B%E5%9B%BE/","content":"matplotlib绘制等高线ref: https://matplotlib.org/api/_as_gen/matplotlib.pyplot.contour.html\nimport numpy as npimport matplotlib.pyplot as pltx = np.arange(0, 10.0, 0.1)y = np.arange(0, 10.0, 0.1)X, Y = np.meshgrid(x, y)    # 生成x-y网格图Z = X**1.5 + Y**1.5plt.figure()CS = plt.contour(X, Y, Z, levels=6)                   # 设置距离plt.clabel(CS, inline=1, fontsize=10, fmt=&#x27;%d ℃&#x27;)   # 设置标签plt.savefig(&#x27;Temp.png&#x27;, dpi=300, bbox_inches=&#x27;tight&#x27;)plt.show()\n\n\n \n\n\n\npandas透视图1. 创建需要展示的数据import itertoolsimport matplotlib.pyplot as pltimport numpy as npimport pandas as pdimport seaborn as sns# === define paras ==================para_names = [&#x27;layer_n&#x27;, &#x27;activition&#x27;, &#x27;seed&#x27;]layer_n = [1, 2, 3, 4, 5, 6]activition = [&#x27;tanh&#x27;, &#x27;sigmod&#x27;, &#x27;relu&#x27;]seed = [11, 17, 19]# 创建 dataframedf =  pd.DataFrame([], columns=para_names)for values in itertools.product(layer_n, activition, seed):    newline = pd.DataFrame(list(values), index=para_names)    df = df.append(newline.T, ignore_index=True)# 伪造一些训练结果，方便展示# activ_2_num = pd.factorize(df[&#x27;activition&#x27;])[0].astype(&#x27;int&#x27;)  # 激活函数是字符类型，将其映射成整数形activ_dict = &#123;&#x27;tanh&#x27;: 2, &#x27;sigmod&#x27;: 4, &#x27;relu&#x27;: 6&#125;  # 也可以直接定义字典，然后replacedf[&#x27;results&#x27;] = df[&#x27;layer_n&#x27;] + df[&#x27;activition&#x27;].replace(activ_dict) + df[&#x27;seed&#x27;] * 0.1 + np.random.random((54,))df[&#x27;results&#x27;] = df[&#x27;results&#x27;].astype(&#x27;float&#x27;)  # 转换成浮点类型print(df.head())\n\n输出：\n  layer_n activition seed   results\n0       1       tanh   11  4.261361\n1       1       tanh   17  4.822595\n2       1       tanh   19  4.929088\n3       1     sigmod   11  6.698047\n4       1     sigmod   17  7.020531\n\n\n2. 绘制带误差的折线图展示训练结果# 绘制带误差的折线图，横轴为网络层数，纵轴为训练结果，# 激活函数采用不同颜色的线型，误差来自于没有指定的列：不同的随机种子seedplt.figure(figsize=(8, 6))sns.lineplot(x=&#x27;layer_n&#x27;, y=&#x27;results&#x27;, hue=&#x27;activition&#x27;,  style=&#x27;activition&#x27;,              markers=True, data=df)plt.grid(linestyle=&#x27;:&#x27;)plt.show()\n\n\n\n\n3. 使用pandas透视图、seaborn热力图来展示# 创建透视图，# 对于没有指定的列（seed），按最大值进行统计dt = pd.pivot_table(df, index=[&#x27;layer_n&#x27;], columns=[&#x27;activition&#x27;], values=[&#x27;results&#x27;], aggfunc=[max])print(dt)print(dt.columns)  # 找到最大值、最大值所对应的索引max_value, max_idx = dt.stack().max(), dt.stack().idxmax()print(f&#x27; - the max value is &#123;max_value&#125;;\\n - the index is &#123;max_idx&#125;...&#x27;)# 透视图变成了多重索引(MultiIndex)，重新调整一下new_col = dt.columns.levels[2]dt.columns = new_col# dt.index = list(dt.index)print(dt)dt.sort_index(axis=0, ascending=False, inplace=True)  # 必要时将索引重新排序dt.sort_index(axis=1, ascending=False, inplace=True)  # 必要时将索引重新排序# 绘制热力图，横轴为网络层数，纵轴为激活函数，# 栅格的颜色代表训练结果，颜色越深结果越好plt.figure(figsize=(8, 6))g = sns.heatmap(dt, vmin=0.0, annot=True, fmt=&#x27;.2g&#x27;, cmap=&#x27;Blues&#x27;, cbar=True)plt.show()\n\n\n\n\nref:\n\npandas.pivot_table https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html\n\nseaborn.lineplot https://seaborn.pydata.org/generated/seaborn.lineplot.html\n\nseaborn.heatplot https://seaborn.pydata.org/generated/seaborn.heatmap.html\n\n\n\n桑基图(Sankey)1. 桑基图(Sankey)介绍sankey图可用于数据从一系列节点到另一系列节点流入流出的可视化。\n主要有两个基本概念：\n\n节点 （nodes）\n连接 （links）： 源节点至目标节点之间的关系，每个连接包括三个元素：\nsource： 源节点\ntarget： 目标节点\nvalue： 数据\n\n\n\n\nref: https://developers.google.com/chart/interactive/docs/gallery/sankey\n\n2. 绘制桑基图（使用pyecharts）常用的绘图库 matplotlib, seaborn 好像不支持桑基图， 这里使用了 pyecharts 。\n这里 https://gallery.pyecharts.org/#/Sankey/sankey_base 有几个例子。\n\n\n简单用法如下：\nimport pandas as pdfrom pyecharts import options as optsfrom pyecharts.charts import Sankey# 数据data = [[ &#x27;Brazil&#x27;, &#x27;Portugal&#x27;, 5 ],       [ &#x27;Brazil&#x27;, &#x27;France&#x27;, 1 ],       [ &#x27;Brazil&#x27;, &#x27;Spain&#x27;, 1 ],       [ &#x27;Brazil&#x27;, &#x27;England&#x27;, 1 ],       [ &#x27;Canada&#x27;, &#x27;Portugal&#x27;, 1 ],       [ &#x27;Canada&#x27;, &#x27;France&#x27;, 5 ],       [ &#x27;Canada&#x27;, &#x27;England&#x27;, 1 ],       [ &#x27;Mexico&#x27;, &#x27;Portugal&#x27;, 1 ],       [ &#x27;Mexico&#x27;, &#x27;France&#x27;, 1 ],       [ &#x27;Mexico&#x27;, &#x27;Spain&#x27;, 5 ],       [ &#x27;Mexico&#x27;, &#x27;England&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;Portugal&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;France&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;Spain&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;England&#x27;, 5 ],       [ &#x27;Portugal&#x27;, &#x27;Angola&#x27;, 2 ],       [ &#x27;Portugal&#x27;, &#x27;Senegal&#x27;, 1 ],       [ &#x27;Portugal&#x27;, &#x27;Morocco&#x27;, 1 ],       [ &#x27;Portugal&#x27;, &#x27;South Africa&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;Angola&#x27;, 1 ],       [ &#x27;France&#x27;, &#x27;Senegal&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;Mali&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;Morocco&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;South Africa&#x27;, 1 ],       [ &#x27;Spain&#x27;, &#x27;Senegal&#x27;, 1 ],       [ &#x27;Spain&#x27;, &#x27;Morocco&#x27;, 3 ],       [ &#x27;Spain&#x27;, &#x27;South Africa&#x27;, 1 ],       [ &#x27;England&#x27;, &#x27;Angola&#x27;, 1 ],       [ &#x27;England&#x27;, &#x27;Senegal&#x27;, 1 ],       [ &#x27;England&#x27;, &#x27;Morocco&#x27;, 2 ],       [ &#x27;England&#x27;, &#x27;South Africa&#x27;, 7 ],       [ &#x27;South Africa&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;South Africa&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;South Africa&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Angola&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Angola&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Angola&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Senegal&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Senegal&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Senegal&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Mali&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Mali&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Mali&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Morocco&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Morocco&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Morocco&#x27;, &#x27;Japan&#x27;, 3 ]]df = pd.DataFrame(data, columns=[&#x27;source&#x27;, &#x27;target&#x27;, &#x27;value&#x27;])print(&#x27;- data shape: &#x27;, df.shape, &#x27;\\n&#x27;)# 生成节点， 先合并源节点和目标节点，然后去除重复的节点，最后输出成 dict 形式nn = pd.concat([df[&#x27;source&#x27;], df[&#x27;target&#x27;]])nn = nn.drop_duplicates()nodes = pd.DataFrame(nn, columns=[&#x27;name&#x27;]).to_dict(orient=&#x27;records&#x27;)print(&#x27;- nodes:\\n&#x27;, nodes, &#x27;\\n&#x27;)# 生成连接， dict 形式links = df.to_dict(orient=&#x27;records&#x27;)print(&#x27;- links:\\n&#x27;, links, &#x27;\\n&#x27;)# 绘制桑基图sk =(    Sankey(init_opts=opts.InitOpts(width=&quot;800px&quot;, height=&quot;600px&quot;)) # 页面大小    .add(        series_name=&quot;legend&quot;, # legend        nodes=nodes,        links=links,        # opacity 透明度； curve 弯曲程度； color 色系        linestyle_opt=opts.LineStyleOpts(opacity=0.2, curve=0.5, color=&quot;source&quot;),         label_opts=opts.LabelOpts(position=&quot;right&quot;), # 节点名称    )    .set_global_opts(title_opts=opts.TitleOpts(title=&quot;sankey&quot;)) # 标题    .render(&quot;sankey.html&quot;) # 保存成 html 文件)\n\n\n\n代码说明：\n\npyecharts的桑基图对于原始数据的格式比较啰嗦，这里用 pandas 处理了一下，还可以修改一下去读取 csv 文件。\npyecharts直接保存图片也比较麻烦，需要用 selenium 之类的工具，配置一大堆；还不如直接在浏览器截图。\n\n\n使用 D3 绘制D3 绘制桑基图貌似更简便一点，可惜不能用 python。\nhttps://github.com/d3/d3-sankey\n这里还有个在线可实时编辑版。\nhttps://observablehq.com/@mbostock/flow-o-matic\n厉害了！\n","categories":["sci"],"tags":["pandas","seaborn"]},{"title":"数据可视化-等高线-pandas透视图-seaborn热力图-桑基图(Sankey)","url":"/2020/02/17/sci-matplotlib/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-%E6%A1%91%E5%9F%BA%E5%9B%BE(Sankey)/","content":"matplotlib绘制等高线ref: https://matplotlib.org/api/_as_gen/matplotlib.pyplot.contour.html\nimport numpy as npimport matplotlib.pyplot as pltx = np.arange(0, 10.0, 0.1)y = np.arange(0, 10.0, 0.1)X, Y = np.meshgrid(x, y)    # 生成x-y网格图Z = X**1.5 + Y**1.5plt.figure()CS = plt.contour(X, Y, Z, levels=6)                   # 设置距离plt.clabel(CS, inline=1, fontsize=10, fmt=&#x27;%d ℃&#x27;)   # 设置标签plt.savefig(&#x27;Temp.png&#x27;, dpi=300, bbox_inches=&#x27;tight&#x27;)plt.show()\n\n\n \n\n\n\npandas透视图1. 创建需要展示的数据import itertoolsimport matplotlib.pyplot as pltimport numpy as npimport pandas as pdimport seaborn as sns# === define paras ==================para_names = [&#x27;layer_n&#x27;, &#x27;activition&#x27;, &#x27;seed&#x27;]layer_n = [1, 2, 3, 4, 5, 6]activition = [&#x27;tanh&#x27;, &#x27;sigmod&#x27;, &#x27;relu&#x27;]seed = [11, 17, 19]# 创建 dataframedf =  pd.DataFrame([], columns=para_names)for values in itertools.product(layer_n, activition, seed):    newline = pd.DataFrame(list(values), index=para_names)    df = df.append(newline.T, ignore_index=True)# 伪造一些训练结果，方便展示# activ_2_num = pd.factorize(df[&#x27;activition&#x27;])[0].astype(&#x27;int&#x27;)  # 激活函数是字符类型，将其映射成整数形activ_dict = &#123;&#x27;tanh&#x27;: 2, &#x27;sigmod&#x27;: 4, &#x27;relu&#x27;: 6&#125;  # 也可以直接定义字典，然后replacedf[&#x27;results&#x27;] = df[&#x27;layer_n&#x27;] + df[&#x27;activition&#x27;].replace(activ_dict) + df[&#x27;seed&#x27;] * 0.1 + np.random.random((54,))df[&#x27;results&#x27;] = df[&#x27;results&#x27;].astype(&#x27;float&#x27;)  # 转换成浮点类型print(df.head())\n\n输出：\n  layer_n activition seed   results\n0       1       tanh   11  4.261361\n1       1       tanh   17  4.822595\n2       1       tanh   19  4.929088\n3       1     sigmod   11  6.698047\n4       1     sigmod   17  7.020531\n\n\n2. 绘制带误差的折线图展示训练结果# 绘制带误差的折线图，横轴为网络层数，纵轴为训练结果，# 激活函数采用不同颜色的线型，误差来自于没有指定的列：不同的随机种子seedplt.figure(figsize=(8, 6))sns.lineplot(x=&#x27;layer_n&#x27;, y=&#x27;results&#x27;, hue=&#x27;activition&#x27;,  style=&#x27;activition&#x27;,              markers=True, data=df)plt.grid(linestyle=&#x27;:&#x27;)plt.show()\n\n\n\n\n3. 使用pandas透视图、seaborn热力图来展示# 创建透视图，# 对于没有指定的列（seed），按最大值进行统计dt = pd.pivot_table(df, index=[&#x27;layer_n&#x27;], columns=[&#x27;activition&#x27;], values=[&#x27;results&#x27;], aggfunc=[max])print(dt)print(dt.columns)  # 找到最大值、最大值所对应的索引max_value, max_idx = dt.stack().max(), dt.stack().idxmax()print(f&#x27; - the max value is &#123;max_value&#125;;\\n - the index is &#123;max_idx&#125;...&#x27;)# 透视图变成了多重索引(MultiIndex)，重新调整一下new_col = dt.columns.levels[2]dt.columns = new_col# dt.index = list(dt.index)print(dt)dt.sort_index(axis=0, ascending=False, inplace=True)  # 必要时将索引重新排序dt.sort_index(axis=1, ascending=False, inplace=True)  # 必要时将索引重新排序# 绘制热力图，横轴为网络层数，纵轴为激活函数，# 栅格的颜色代表训练结果，颜色越深结果越好plt.figure(figsize=(8, 6))g = sns.heatmap(dt, vmin=0.0, annot=True, fmt=&#x27;.2g&#x27;, cmap=&#x27;Blues&#x27;, cbar=True)plt.show()\n\n\n\n\nref:\n\npandas.pivot_table https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html\n\nseaborn.lineplot https://seaborn.pydata.org/generated/seaborn.lineplot.html\n\nseaborn.heatplot https://seaborn.pydata.org/generated/seaborn.heatmap.html\n\n\n\n桑基图(Sankey)1. 桑基图(Sankey)介绍sankey图可用于数据从一系列节点到另一系列节点流入流出的可视化。\n主要有两个基本概念：\n\n节点 （nodes）\n连接 （links）： 源节点至目标节点之间的关系，每个连接包括三个元素：\nsource： 源节点\ntarget： 目标节点\nvalue： 数据\n\n\n\n\nref: https://developers.google.com/chart/interactive/docs/gallery/sankey\n\n2. 绘制桑基图（使用pyecharts）常用的绘图库 matplotlib, seaborn 好像不支持桑基图， 这里使用了 pyecharts 。\n这里 https://gallery.pyecharts.org/#/Sankey/sankey_base 有几个例子。\n\n\n简单用法如下：\nimport pandas as pdfrom pyecharts import options as optsfrom pyecharts.charts import Sankey# 数据data = [[ &#x27;Brazil&#x27;, &#x27;Portugal&#x27;, 5 ],       [ &#x27;Brazil&#x27;, &#x27;France&#x27;, 1 ],       [ &#x27;Brazil&#x27;, &#x27;Spain&#x27;, 1 ],       [ &#x27;Brazil&#x27;, &#x27;England&#x27;, 1 ],       [ &#x27;Canada&#x27;, &#x27;Portugal&#x27;, 1 ],       [ &#x27;Canada&#x27;, &#x27;France&#x27;, 5 ],       [ &#x27;Canada&#x27;, &#x27;England&#x27;, 1 ],       [ &#x27;Mexico&#x27;, &#x27;Portugal&#x27;, 1 ],       [ &#x27;Mexico&#x27;, &#x27;France&#x27;, 1 ],       [ &#x27;Mexico&#x27;, &#x27;Spain&#x27;, 5 ],       [ &#x27;Mexico&#x27;, &#x27;England&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;Portugal&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;France&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;Spain&#x27;, 1 ],       [ &#x27;USA&#x27;, &#x27;England&#x27;, 5 ],       [ &#x27;Portugal&#x27;, &#x27;Angola&#x27;, 2 ],       [ &#x27;Portugal&#x27;, &#x27;Senegal&#x27;, 1 ],       [ &#x27;Portugal&#x27;, &#x27;Morocco&#x27;, 1 ],       [ &#x27;Portugal&#x27;, &#x27;South Africa&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;Angola&#x27;, 1 ],       [ &#x27;France&#x27;, &#x27;Senegal&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;Mali&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;Morocco&#x27;, 3 ],       [ &#x27;France&#x27;, &#x27;South Africa&#x27;, 1 ],       [ &#x27;Spain&#x27;, &#x27;Senegal&#x27;, 1 ],       [ &#x27;Spain&#x27;, &#x27;Morocco&#x27;, 3 ],       [ &#x27;Spain&#x27;, &#x27;South Africa&#x27;, 1 ],       [ &#x27;England&#x27;, &#x27;Angola&#x27;, 1 ],       [ &#x27;England&#x27;, &#x27;Senegal&#x27;, 1 ],       [ &#x27;England&#x27;, &#x27;Morocco&#x27;, 2 ],       [ &#x27;England&#x27;, &#x27;South Africa&#x27;, 7 ],       [ &#x27;South Africa&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;South Africa&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;South Africa&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Angola&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Angola&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Angola&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Senegal&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Senegal&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Senegal&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Mali&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Mali&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Mali&#x27;, &#x27;Japan&#x27;, 3 ],       [ &#x27;Morocco&#x27;, &#x27;China&#x27;, 5 ],       [ &#x27;Morocco&#x27;, &#x27;India&#x27;, 1 ],       [ &#x27;Morocco&#x27;, &#x27;Japan&#x27;, 3 ]]df = pd.DataFrame(data, columns=[&#x27;source&#x27;, &#x27;target&#x27;, &#x27;value&#x27;])print(&#x27;- data shape: &#x27;, df.shape, &#x27;\\n&#x27;)# 生成节点， 先合并源节点和目标节点，然后去除重复的节点，最后输出成 dict 形式nn = pd.concat([df[&#x27;source&#x27;], df[&#x27;target&#x27;]])nn = nn.drop_duplicates()nodes = pd.DataFrame(nn, columns=[&#x27;name&#x27;]).to_dict(orient=&#x27;records&#x27;)print(&#x27;- nodes:\\n&#x27;, nodes, &#x27;\\n&#x27;)# 生成连接， dict 形式links = df.to_dict(orient=&#x27;records&#x27;)print(&#x27;- links:\\n&#x27;, links, &#x27;\\n&#x27;)# 绘制桑基图sk =(    Sankey(init_opts=opts.InitOpts(width=&quot;800px&quot;, height=&quot;600px&quot;)) # 页面大小    .add(        series_name=&quot;legend&quot;, # legend        nodes=nodes,        links=links,        # opacity 透明度； curve 弯曲程度； color 色系        linestyle_opt=opts.LineStyleOpts(opacity=0.2, curve=0.5, color=&quot;source&quot;),         label_opts=opts.LabelOpts(position=&quot;right&quot;), # 节点名称    )    .set_global_opts(title_opts=opts.TitleOpts(title=&quot;sankey&quot;)) # 标题    .render(&quot;sankey.html&quot;) # 保存成 html 文件)\n\n\n\n代码说明：\n\npyecharts的桑基图对于原始数据的格式比较啰嗦，这里用 pandas 处理了一下，还可以修改一下去读取 csv 文件。\npyecharts直接保存图片也比较麻烦，需要用 selenium 之类的工具，配置一大堆；还不如直接在浏览器截图。\n\n\n使用 D3 绘制D3 绘制桑基图貌似更简便一点，可惜不能用 python。\nhttps://github.com/d3/d3-sankey\n这里还有个在线可实时编辑版。\nhttps://observablehq.com/@mbostock/flow-o-matic\n厉害了！\n","categories":["sci"],"tags":["pandas","seaborn"]},{"title":"元宵","url":"/2020/02/08/yoyo/20200208-%E5%85%83%E5%AE%B5%E8%8A%82/","content":"\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"听不到","url":"/2020/02/07/yoyo/20200207-%E5%90%AC%E4%B8%8D%E5%88%B0/","content":"悠悠：我又听不到你说话了，我的耳朵又听不到说话了。\n妈妈：怎么了？耳朵哪不舒服了？\n悠悠：你不说表扬的话，我都听不到。\n妈妈：[捂脸][捂脸][捂脸][捂脸]\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"raspberry pi 运行状态提醒","url":"/2020/02/03/raspi/raspberry-pi-%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81/","content":"1.获取运行状态获取树莓派运行状态用到的命令如下表：\n\n\n\n命令\n说明\n\n\n\nvcgencmd measure_temp\n获取CPU温度\n\n\ntop\n获取CPU使用率\n\n\nfree\n获取RAM使用率\n\n\ndf\n获取DISK使用率\n\n\nifconfig\n获取IP地址\n\n\n\n1.1 获取CPU温度：\n\n$ vcgencmd measure_temp    temp=40.8C   # 直接返回温度，只要把 temp= 去掉就行\n\n\n\n\n1.2 获取CPU使用率\n\n$ top -bn1    top - 16:27:28 up 1 day, 18:49,  1 user,  load average: 0.00, 0.00, 0.00    Tasks: 105 total,   1 running, 104 sleeping,   0 stopped,   0 zombie    %Cpu(s):  1.4 us,  2.7 sy,  0.0 ni, 95.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st    MiB Mem :    926.1 total,    697.2 free,     51.3 used,    177.6 buff/cache    MiB Swap:    100.0 total,    100.0 free,      0.0 used.    797.4 avail Mem    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND    411 pi        20   0   10188   2804   2500 R   5.9   0.3   0:00.04 top    ...    ...# -bn1 参数： n1指定只运行一次，b输出结果为batch-mode，避免出现乱码# 可以看到CPU的信息在第3行，只要输出CPU这一行$ top -bn1 | awk &#x27;/Cpu\\(s\\)/&#x27;    %Cpu(s):  1.4 us,  2.7 sy,  0.0 ni, 95.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st# 缩写分别是user, system, nice, idle, wait, ...# 计算CPU使用率等于 1 - idle%\n\n\n1.3 获取RAM使用率\n\n$ free -m                total        used        free      shared  buff/cache   available    Mem:            926          52         696          23         177         796    Swap:            99           0          99# -m 参数是指定输出结果以 MB 为单位# 修改一下命令，只要输出 Mem 这一行$ free -m | awk &#x27;/Mem/&#x27;    Mem:            926          52         696          23         177         796# 计算RAM使用率等于 (total - available) / total； （仅供参考）\n\n\n1.4 获取DISK使用率\n\n$ df -h    Filesystem      Size  Used Avail Use% Mounted on    /dev/root        29G  1.7G   27G   6% /    devtmpfs        459M     0  459M   0% /dev    tmpfs           464M     0  464M   0% /dev/shm    tmpfs           464M   24M  440M   6% /run    tmpfs           5.0M  4.0K  5.0M   1% /run/lock    tmpfs           464M     0  464M   0% /sys/fs/cgroup    /dev/mmcblk0p1  253M   53M  200M  21% /boot    tmpfs            93M     0   93M   0% /run/user/1000# -h 参数是指定输出结果人性化，自动选择单位# 修改一下命令，只要输出 /dev/root 这一行$ df -h | awk &#x27;/root/&#x27;    /dev/root        29G  1.7G   27G   6% /\n\n\n1.5 获取 IP 地址\n\n$ sudo ifconfig wlan0    wlan0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500            inet 192.168.1.12  netmask 255.255.255.0  broadcast 192.168.1.255            ...            ...# ifconfig 命令要用管理员运行# wlan0 参数是指wifi网络；如果是有线网络，改为： eth0# 修改一下命令，只要输出 inet 这一行$ sudo ifconfig wlan0 | awk &#x27;/inet/&#x27;    inet 192.168.1.12  netmask 255.255.255.0  broadcast 192.168.1.255\n\n2. 完整的代码import osimport timeimport requestsdef now():    return &#x27;[&#x27; + time.strftime(&#x27;%Y-%m-%d %H:%M:%S&#x27;) + &#x27;]&#x27;# run commanddef run_cmd(cmd):    p = os.popen(cmd).readline().strip().split()    return pcpu_temp = run_cmd(&quot; vcgencmd measure_temp &quot;)cpu_stat = run_cmd(&quot; top -bn1 | awk &#x27;/Cpu\\(s\\)/&#x27; &quot;)cpu_used = 1 - float(cpu_stat[7])/100.0ram_stat = run_cmd(&quot; free -m | awk &#x27;/Mem/&#x27; &quot;)ram_used = (int(ram_stat[1]) - int(ram_stat[6])) / float(ram_stat[1])dsk_stat = run_cmd(&quot; df -h | awk &#x27;/root/&#x27; &quot;)ipconfig = run_cmd(&quot;sudo ifconfig wlan0 | awk &#x27;/inet/&#x27;&quot;)print(cpu_temp, cpu_stat, cpu_used, ram_stat, ram_used, dsk_stat, ipconfig, sep=&#x27;\\n&#x27;)###status = now() + &#x27;\\n\\n&#x27;status += &#x27;Raspi Status:       \\n&#x27;status += &#x27;CPU  Used  = &#123;:.2%&#125; \\n&#x27;.format(cpu_used)status += &#x27;CPU  Temp  = &#123;&#125;     \\n&#x27;.format(cpu_temp[0].replace(&#x27;temp=&#x27;, &#x27;&#x27;))status += &#x27;RAM  Total = &#123;&#125;M    \\n&#x27;.format(ram_stat[1])status += &#x27;RAM  Used  = &#123;:.2%&#125; \\n&#x27;.format(ram_used)status += &#x27;DISK Total = &#123;&#125;     \\n&#x27;.format(dsk_stat[1])status += &#x27;DISK Used  = &#123;&#125;     \\n&#x27;.format(dsk_stat[2])status += &#x27;DISK Perc  = &#123;&#125;     \\n&#x27;.format(dsk_stat[4])status += &#x27;IP Address = &#123;&#125;     \\n&#x27;.format(ipconfig[1])print(status)# Send to ftqqkey = &#x27;SCUxxxxxxxxxxxxxxx&#x27;api = &#x27;https://sc.ftqq.com/&#123;&#125;.send&#x27;.format(key)send_data = &#123;&#x27;text&#x27;: &#x27;Raspi_Status&#x27;, &#x27;desp&#x27;: status&#125;res = requests.post(api, data=send_data)print(res.content)# Send to wechatimport wechat_push as wpaccess_token, _ = wp.get_access_token(wp.corp_id, wp.corp_secret)wp.wechat_push_text(agent_id=wp.agent_id, access_token=access_token, message=status)\n","categories":["raspi"],"tags":["raspberry-pi"]},{"title":"群晖python3配置","url":"/2020/01/16/synology/%E7%BE%A4%E6%99%96-python3%E9%85%8D%E7%BD%AE/","content":"pip3 安装、配置群晖默认不支持 apt-get 之类的命令，使用 wget 下载 get-pip.py 安装 pip。\nwget -O /tmp/get-pip.py &#x27;https://bootstrap.pypa.io/get-pip.py&#x27;python3 /tmp/get-pip.py# 权限不够的话，加上 --user# python3 /tmp/get-pip.py --userrm /tmp/get-pip.py\n\n安装之后提示 pip3 的安装目录（一般是 /homes/USERNAME/.local/bin）不在系统的环境变量里。每次要先跳到安装目录里。\ncd .local/bin./pip3 -V./pip3 list\n\n\n配置环境变量可以手动把 pip3 目录加入环境变量。\nvim ~/.bash_profile# 写入以下内容export PATH=$PATH:/volume1/homes/USERNAME/.local/bin# 保存、退出# 运行以下命令使生效source ~/.bash_profile# 最后可以检查一下echo $PATH\n\n更改源pip3 config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simplepip3 config list\n\npip3 卸载python3 -m pip uninstall pip\n\n\nref：\n\nhttps://github.com/docker-library/python/blob/855b85c8309e925814dfa97d61310080dcd08db6/3.5/Dockerfile#L53\n\n","categories":["synology"],"tags":["python","synology"]},{"title":"常用 DNS","url":"/2019/12/30/apps/%E5%B8%B8%E7%94%A8DNS/","content":"国内\n腾讯 DNS (DNSPod)\n\n119.29.29.29182.254.116.116\n\n\n114DNS\n\n114.114.114.114114.114.115.115\n\n\n清华大学 TUNA 协会\n\n101.6.6.6\n\n国外\nGoogle Public DNS\n\n8.8.8.88.8.4.4\n\n\nCloudflare DNS\n\n1.1.1.11.0.0.1\n","categories":["apps"],"tags":["DNS"]},{"title":"厦门","url":"/2019/11/15/yoyo/20191115-%E5%8E%A6%E9%97%A8/","content":"\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"深度学习调参-keras,tensorflow设置随机种子，保证结果可复现","url":"/2019/11/03/tensorflow/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%B0%83%E5%8F%82-keras,tensorflow%E8%AE%BE%E7%BD%AE%E9%9A%8F%E6%9C%BA%E7%A7%8D%E5%AD%90%EF%BC%8C%E4%BF%9D%E8%AF%81%E7%BB%93%E6%9E%9C%E5%8F%AF%E5%A4%8D%E7%8E%B0/","content":"keras,tensorflow设置随机种子，保证结果可复现ref: https://keras.io/getting-started/faq/#how-can-i-obtain-reproducible-results-using-keras-during-development\nref: https://tensorflow.google.cn/api_docs/python/tf/random/set_seed\nnp.random.seed(42)# tensorflow V1.xtf.set_random_seed(1234)# tensorflow V2.x# For Tensorflow 2.0 tf.random.set_random_seed(seed) changed to tf.random.set_seed(seed).tf.random.set_seed(1234)\n","categories":["tensorflow"],"tags":["tensorflow","keras"]},{"title":"Hexo 使用 Github Actions 自动更新","url":"/2019/10/10/hexo/hexo-%E4%BD%BF%E7%94%A8Github-Actions%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0/","content":"准备\n需要两个 github 仓库：\n一个用于发布页面： XXXXXX.github.io\n一个用于放源码： hexo-source （可设为隐私仓库）\n\n\n\n1. 创建 hexo-source 仓库\n在hexo的根目录下（ ~&#x2F;hexo）运行：\n\ncd hexogit initgit add .git commit -m &quot;first commit&quot;git remote add origin https://github.com/XXXXXX/hexo-source.gitgit push -u origin master\n\n2. Github Actions 设置\n运行 ssh-keygen 生成一对密钥。\n\nssh-keygen\n\n\n打开 XXXXXX.github.io 仓库设置，在 Deploye keys 选项中，添加公钥~/.ssh/id_rsa.pub的内容。\n打开 hexo-source 仓库设置，在 Secrets 选项中，新建 repo secret: 名称设为GITHUB_ACTION, 内容为~/.ssh/id_rsa的内容。\n\n\n\n3. 添加 Github Actions 配置文件内容如下：\nname: Hexo Auto-Deployon: [push]jobs:  build:    name: Hexo Auto-Deploy by GitHub Actions    runs-on: ubuntu-latest    steps:    - name: 1. git checkout...      uses: actions/checkout@v1          - name: 2. setup nodejs...      uses: actions/setup-node@v1        - name: 3. install hexo...      run: |        npm install hexo-cli -g        npm install            - name: 4. hexo generate public files...      run: |        hexo clean        hexo g      - name: 5. hexo deploy ...      run: |        mkdir -p ~/.ssh/        echo &quot;$&#123;&#123; secrets.GITHUB_ACTION &#125;&#125;&quot; &gt; ~/.ssh/id_rsa        chmod 600 ~/.ssh/id_rsa        ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts                git config --global user.name &quot;XXXXXX&quot;        git config --global user.email &quot;XXXXXX@XXXXXX.com&quot;        git config --global core.quotepath false                hexo d\n\n\n以上。\n","categories":["hexo"],"tags":["hexo","github_actions"]},{"title":"latex插入eps图片","url":"/2019/10/08/sci/%E8%AE%BA%E6%96%87-latex%E6%8F%92%E5%85%A5eps%E5%9B%BE%E7%89%87/","content":"1. 创建eps图片\n从png图片转换: texlive中自带了一个命令： bmeps\n\nbmeps img.png img.eps\n\n\n从python创建, 调用matplotlib能直接存为eps格式，可直接保存一份eps的\n\nplt.savefig(&#x27;fig1.eps&#x27;, dpi=300)\n\n\nPPT转为png、eps的方法\nppt导出png: 默认dpi较低，需要在注册表改一下dpi&#x3D;300。\nppt导出eps: 先另存为pdf，再用adobe acrobat转为eps。\n\n\n\n2. 去除eps图片的空白\n\n有时候遇到eps图片周边空白较多的情况，需要把空白去掉。建议生成图片时就设置好，而不是去修改eps文件。\n2.1 python调用matplotlib保存图片时, 调整图片的边界框（bounding box)。plt.savefig(&#x27;fig1.eps&#x27;, dpi=300, bbox_inches=&#x27;tight&#x27;)\n\n2.2 python调用matplotlib创建图片包含多个子图时，设置为紧凑布局。fig.tight_layout() # 自动调整# fig.tight_layout(pad=1.0，w_pad=1.0， h_pad=1.0)  # 精确调整\n\n2.3 ppt的图片可直接修改幻灯片母版页大小。A4 paper size：   21*29.7 cm   // 单个图片A6 paper size： 10.5*14.8 cm   // 并排放两个图片\n\n2.4 使用Gsview直接修改eps图片。Ctex套件中带有Gsview工具，可以裁剪EPS。（Gsview官网： https://www.gsview.com/）\n使用步骤：\n\nGsvier菜单栏 -&gt; Options -&gt; Show bounding boxs -&gt; 选中\nFile -&gt; PS to EPS -&gt; 不选 Automatically calculate Bounding Box -&gt; 然后点击yes -&gt; 保存。\n\n","categories":["sci"],"tags":["latex"]},{"title":"latex 环境安装与配置","url":"/2019/10/06/sci/%E8%AE%BA%E6%96%87-latex%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/","content":"在 win10 下尝试过的 latex 环境有以下三种：\n\ntexlive + texstudio \nctex (集成 miktex + winedt， 以及中文支持)\nmiktex + texstudio &#x2F; （vscode + latex workshop）\n\n1. texlive + texstudio这个是最常用的配置方法，建议新手从这个开始使用。优点：基本适用于所有的场景（中文除外），一劳永逸；缺点：默认不支持中文，安装包巨大。\n\ntexlive 安装： 可以在线安装，也可以离线安装（推荐，安装包3.2G），安装后6G的空间。\n\n推荐清华大学源： https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive\n\n\ntexstudio 安装：下载安装包（~89M），正常的安装方法即可。\n\n官网下载： http://texstudio.sourceforge.net/\nScoop 安装： scoop install texstudio\n\n\ntexstudio 默认的配置就基本够用，不要乱改。\n\n中文，字体，字号\n高级配置：行号、空白等\n\n\n\n\nps: texstudio的提示、警告、错误信息非常明确，出现问题先看提示。\n\n\n\n2. ctex这个其实是 miktex + winedt + 中文支持 的集成版，用中文写作时可直接用。\n但是最后一次更新是在2016年4月，坑比较多。\n\nctex 安装（完整版安装包 ~1.3G 左右）： http://www.ctex.org/CTeXDownload\n\n3. miktex + texstudio &#x2F; (vscode + latex workshop)这是适合折腾的使用方法。\n\n使用 Scoop 安装 miktex， texstudio， perl scoop install texstudioscoop install latex         # miktex， ~200Mscoop install perl          # latexmk 需要用 perl 环境， ~150M\n在 vscode 里 安装 latex workshop 插件，可实时预览\n这是比较折腾的做法， miktex中只有基本的包； 后续用到需要的包，会自动提示下载\n慢慢折腾吧\n\n\nlatex 入门教程\n《LATEX 排版学习笔记》\nhttp://static.latexstudio.net/wp-content/uploads/2014/02/latexlog-1310.pdf\n\n\n《一份（不太）简短的 LATEX 介绍》\nhttp://mirrors.sjtug.sjtu.edu.cn/ctan/info/lshort/chinese/lshort-zh-cn.pdf\n\n\n\nlatex 简单用法\n图片转换 \n\npng转eps: texlive中 自带了一个命令： bmeps\npython 调用 matplotlib 能直接存为 eps 格式，可直接多保存一份eps的\n\n\nPPT转为png、eps \n\nppt导出png: 默认dpi较低，需要在注册表改一下dpi&#x3D;300。\nppt导出eps: 先另存为pdf，再用 adobe acrobat 转为eps。\n\n\n图片并排\n\n\n\\begin&#123;figure&#125;[h]\\begin&#123;tabular&#125;&#123;cc&#125;  \\begin&#123;minipage&#125;[t]&#123;0.5\\linewidth&#125;    \\centering    &#123;\\includegraphics[]&#123;2d.png&#125;&#125; \\\\    &#123;(a) 2D Plot&#125;  \\end&#123;minipage&#125;  \\begin&#123;minipage&#125;[t]&#123;0.5\\linewidth&#125;    \\centering    \\includegraphics[]&#123;3d.png&#125; \\\\    &#123;(b) 3D Plot&#125;  \\end&#123;minipage&#125;\\end&#123;tabular&#125;\\caption&#123;Results&#125;\\end&#123;figure&#125;\n\n\n多行公式\n\n\\begin&#123;equation&#125;\\left\\&#123;\\begin&#123;array&#125;&#123;rl&#125;\tf(x) &amp; = \\sin (x) \\\\\tf(x) &amp; = \\cos (x) \\\\\tf(x) &amp; = \\tan (x)\\end&#123;array&#125;\\right.\\end&#123;equation&#125;\n\n\n参考文献 bib\n\n%\\usepackage&#123;hyperref&#125;\\usepackage&#123;cite&#125;% ---- Bibliography ----\\bibliographystyle&#123;unsrt&#125;\\bibliography&#123;0_references&#125;\n\n\n","categories":["sci"],"tags":["latex"]},{"title":"数据处理-scipy中值滤波、pandas重采样","url":"/2019/09/21/sci-pandas/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-scipy%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E3%80%81pandas%E9%87%8D%E9%87%87%E6%A0%B7/","content":"1. scipy中值滤波使用scipy中的signal.medfilt对数组进行中值滤波。方法： scipy.signal.medfilt\n\n滤波器的kernel_size必须是奇数\n输出数组的size与输入的数组一致\n\nimport scipy.signal as signalimport matplotlib.pyplot as pltimport numpy as npimport pandas as pdn = 51 y = np.sin(np.linspace(0, 10, n)) + np.random.rand(n)y_med = signal.medfilt(y, kernel_size=5)plt.figure()plt.plot(y, &#x27;r--&#x27;, label=&#x27;y&#x27;)plt.plot(y_med, &#x27;b-.&#x27;, label=&#x27;y_med&#x27;)plt.legend()plt.show()\n\n\n\nsignal.medfilt还可以对矩阵（图像）进行滤波处理，以消除噪音。ref： https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.medfilt.html\n\n\n2. pandas重采样(1) pandas可对时间序列进行重采样对带有时间序列的DataFrame，pandas中内置了重采样的功能，可以灵活的自定义各种频率以及统计函数。\nn = 51index = pd.date_range(&#x27;2019-01-01 00:00:00&#x27;, periods=n, freq=&#x27;S&#x27;)y = np.sin(np.linspace(0, 10, n)) + np.random.rand(n)dt = pd.DataFrame(&#123;&#x27;value&#x27;: y&#125;, index=index)dt = dt.resample(&#x27;5S&#x27;).mean()print(dt.head())plt.figure()plt.plot(index, y, &#x27;r--&#x27;, label=&#x27;y&#x27;)plt.plot(dt.index, dt[&#x27;value&#x27;], &#x27;b-.&#x27;, label=&#x27;y_resample&#x27;)plt.legend()plt.show()\n\n\n\n(2) 对非时间序列的重采样引入时间差序列: timedelta_range\nn = 51t = np.linspace(0, 10, n)x = np.sin(t) + np.random.rand(n)index = pd.timedelta_range(0, periods=n, freq=&#x27;s&#x27;)dt = pd.DataFrame(&#123;&#x27;key&#x27;: np.arange(n), &#x27;value&#x27;: x&#125;, index=index)dt = dt.resample(&#x27;5s&#x27;).mean()print(dt.head())plt.figure()plt.plot(np.arange(n), x, &#x27;r--&#x27;, label=&#x27;x&#x27;)plt.plot(dt[&#x27;key&#x27;], dt[&#x27;value&#x27;], &#x27;b-.&#x27;, label=&#x27;x_resample&#x27;)plt.legend()plt.show()\n\n\n\n\nref：https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.resample.html\n","categories":["sci"],"tags":["scipy","pandas"]},{"title":"深度学习调参-自动化运行多组超参数","url":"/2019/09/03/tensorflow/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%B0%83%E5%8F%82-%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E8%A1%8C%E5%A4%9A%E7%BB%84%E8%B6%85%E5%8F%82%E6%95%B0/","content":"1. 创建一个神经网络模型比如用cnn在mnist数据集上训练，关于模型建立和训练的代码这里不写了。。。\n在程序开头加入超参数的定义：建议至少包括参数名称、类型、和初始值。\n\nref： https://docs.python.org/3/library/argparse.html\n\n########################## filename: mnist_cnn.py#########################import argparse# -------parser paras--------------------parser = argparse.ArgumentParser(description=&#x27;Trains a simple CNN on MNIST dataset&#x27;)parser.add_argument(&#x27;--layer_n&#x27;, type=int, default=1)parser.add_argument(&#x27;--activition&#x27;, type=str, default=&#x27;tanh&#x27;)parser.add_argument(&#x27;--seed&#x27;, type=int, default=11)args = parser.parse_args()print(args.__dict__)seed = args.seedlayer_n = args.layer_nactivition = args.activition# --- CNN model ----# balabala ...# --- train ----# balabala ...\n\n\n2. 再创建一个脚本文件，用来执行mnist_cnn.py。########################## filename: run_all.py#########################import subprocesscmds = [&#x27;python mnist_cnn.py --layer_n=1 --activition=tanh --seed=11&#x27;,        &#x27;python mnist_cnn.py --layer_n=1 --activition=tanh --seed=17&#x27;,        &#x27;python mnist_cnn.py --layer_n=1 --activition=tanh --seed=19&#x27;]for cmd in cmds:    p = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE)    for line in iter(p.stdout.readline, b&#x27;&#x27;):        msg = line.strip().decode(&#x27;gbk&#x27;)        print(msg)\n","categories":["tensorflow"],"tags":["tensorflow","keras"]},{"title":"深度学习调参-超参数排列组合","url":"/2019/09/03/tensorflow/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%B0%83%E5%8F%82-%E8%B6%85%E5%8F%82%E6%95%B0%E6%8E%92%E5%88%97%E7%BB%84%E5%90%88/","content":"首先定义超参数的名称和取值范围，然后调用itertools.product，可以生成所有超参数的排列组合。\n\nref： https://docs.python.org/3/library/itertools.html#itertools.product\n\nimport itertoolsimport subprocess# === define paras ==================para_names = [&#x27;layer_n&#x27;, &#x27;activition&#x27;, &#x27;seed&#x27;]layer_n = [1, 2, 3, 4, 5, 6]activition = [&#x27;tanh&#x27;, &#x27;sigmod&#x27;, &#x27;relu&#x27;]seed = [11, 17, 19]# calc cases numberi = 1nums = sum(1 for _ in itertools.product(layer_n, activition, seed))print(f&#x27;==== we have &#123;nums&#125; cases in total&#x27;, &#x27;===&#x27; * 3)# === run all case ===========for values in itertools.product(layer_n, activition, seed):    print(f&#x27; *** &#123;i&#125; / &#123;nums&#125; &#x27;, &#x27;***&#x27; * 3)        cmd = f&#x27;python mnist_cnn.py&#x27;    for p, v in zip(para_names, values):        cmd += f&#x27; --&#123;p&#125;=&#123;v&#125;&#x27;    print(cmd)        # p = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE)    # print(p.stdout.read().decode(&#x27;utf8&#x27;))        i += 1        \n\n输出：\n==== we have 54 cases in total =========\n *** 1 / 54  *********\npython mnist_cnn.py --layer_n=1 --activition=tanh --seed=11\n *** 2 / 54  *********\npython mnist_cnn.py --layer_n=1 --activition=tanh --seed=17\n *** 3 / 54  *********\npython mnist_cnn.py --layer_n=1 --activition=tanh --seed=19\n *** 4 / 54  *********\npython mnist_cnn.py --layer_n=1 --activition=sigmod --seed=11\n *** 5 / 54  *********\npython mnist_cnn.py --layer_n=1 --activition=sigmod --seed=17\n *** 6 / 54  *********\n \n ...\n\n *** 53 / 54  *********\npython mnist_cnn.py --layer_n=6 --activition=relu --seed=17\n *** 54 / 54  *********\npython mnist_cnn.py --layer_n=6 --activition=relu --seed=19\n\n","categories":["tensorflow"],"tags":["tensorflow","keras"]},{"title":"数据可视化-混淆矩阵(confusion matrix)","url":"/2019/08/19/sci-matplotlib/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5(confusion-matrix)/","content":"1. 混淆矩阵（confusion matrix）介绍在基于深度学习的分类识别领域中，经常采用统计学中的混淆矩阵（confusion matrix）来评价分类器的性能。\n它是一种特定的二维矩阵：\n\n列代表预测的类别；行代表实际的类别。\n对角线上的值表示预测正确的数量&#x2F;比例；非对角线元素是预测错误的部分。\n\n混淆矩阵的对角线值越高越好，表明许多正确的预测。\n特别是在各分类数据的数量不平衡的情况下，混淆矩阵可以直观的显示分类模型对应各个类别的准确率。\n\nref: https://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.html\n\n2. 混淆矩阵示列\n数据集： MNIST\ntensorflow,keras,\n神经网络：CNN\n\n依赖：keras，matplotlib，numpy，seaborn，tensorflow，sklearn\n\n\nimport kerasimport matplotlib.pyplot as pltimport numpy as npimport seaborn as snsfrom sklearn.metrics import confusion_matrix# === dataset ===with np.load(&#x27;mnist.npz&#x27;) as f:    x_train, y_train = f[&#x27;x_train&#x27;], f[&#x27;y_train&#x27;]    x_test, y_test = f[&#x27;x_test&#x27;], f[&#x27;y_test&#x27;]x_train = x_train.reshape(60000, 28, 28, 1)x_test = x_test.reshape(10000, 28, 28, 1)print(x_train.shape)print(x_test.shape)# === model: CNN ===model = keras.models.Sequential()model.add(keras.layers.Conv2D(32, (3, 3), activation=&#x27;relu&#x27;, input_shape=(28, 28, 1)))model.add(keras.layers.MaxPooling2D((2, 2)))model.add(keras.layers.Conv2D(64, (3, 3), activation=&#x27;relu&#x27;))model.add(keras.layers.MaxPooling2D((2, 2)))model.add(keras.layers.Flatten())model.add(keras.layers.Dense(64, activation=&#x27;relu&#x27;))model.add(keras.layers.Dense(10, activation=&#x27;softmax&#x27;))model.compile(optimizer=&#x27;adam&#x27;,              loss=&#x27;sparse_categorical_crossentropy&#x27;,              metrics=[&#x27;accuracy&#x27;])model.summary()# === train ===model.fit(x=x_train, y=y_train,          batch_size=512,          epochs=10,          validation_data=(x_test, y_test))# === pred ===y_pred = model.predict_classes(x_test)print(y_pred)# === 混淆矩阵：真实值与预测值的对比 ===# https://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.htmlcon_mat = confusion_matrix(y_test, y_pred)con_mat_norm = con_mat.astype(&#x27;float&#x27;) / con_mat.sum(axis=1)[:, np.newaxis]     # 归一化con_mat_norm = np.around(con_mat_norm, decimals=2)# === plot ===plt.figure(figsize=(8, 8))sns.heatmap(con_mat_norm, annot=True, cmap=&#x27;Blues&#x27;)plt.ylim(0, 10)plt.xlabel(&#x27;Predicted labels&#x27;)plt.ylabel(&#x27;True labels&#x27;)plt.show()\n\n\n","categories":["sci"],"tags":["tensorflow","seaborn","keras","confusion_matrix"]},{"title":"jupyter lab 打开方式","url":"/2019/08/15/python/jupyter-lab-%E6%89%93%E5%BC%80%E6%96%B9%E5%BC%8F/","content":"Jupyter Lab 是 Jupyter Notebook 的下一代升级版，界面相对更友好，功能也更强大，更像一个IDE了。\n\n\n\n可以到这个页面 https://jupyter.org/try 试用一下。\n0. 安装jupyterlabpip install jupyterlab\n\n1. jupyterlab的三种打开方式（windows）\n\n1.1 命令行打开在工作目录，打开命令行工具，输入：\njupyter lab\n浏览器(会自动)打开jupyterlab页面：http://localhost:8888/lab\n\n\n注意，jupyter lab 会默认继承 jupyter notebook 的相关配置，如果之前有改过的话。\n\n\n1.2 用bat文件打开在工作目录，新建jupyter_lab.bat文件，文件内容填入：\njupyter lab\n\n下次双击打开jupyter_lab.bat文件即可。\n\n\nps： 如果想用无窗口模式（去掉黑乎乎的终端窗口）打开，可以新建一个vbs，丢到工作目录里。\nCreateObject(&quot;WScript.Shell&quot;).Run &quot;C:\\\\xxxx\\\\python\\\\3.7.4\\\\Scripts\\\\jupyter-lab.exe&quot;,0\n1.3 右键菜单打开在右键菜单里添加 jupyter lab here按钮，方法如下：\n\n新建注册表文件jupyter lab here.reg，内容：\n\nWindows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Classes\\Directory\\Background\\shell\\Jupyter Lab Here]&quot;Icon&quot;=&quot;\\&quot;C:\\\\Users\\\\XXXX\\\\scoop\\\\apps\\\\python\\\\current\\\\Lib\\\\site-packages\\\\notebook\\\\static\\\\favicon.ico\\&quot;&quot;[HKEY_CURRENT_USER\\Software\\Classes\\Directory\\Background\\shell\\Jupyter Lab Here\\command]@=&quot;\\&quot;C:\\\\Users\\\\XXXX\\\\scoop\\\\apps\\\\python\\\\current\\\\Scripts\\\\jupyter-lab.exe\\&quot;&quot;\n\n\nfavicon.ico,jupyter-lab.exe的路径按实际情况修改\n\n\n\n双击jupyter lab here.reg文件，注入注册表即可！\n\n","categories":["python"],"tags":["python","jupyter","jupyterlab"]},{"title":"Hexo 使用 Travis CI 自动更新","url":"/2019/06/10/hexo/hexo-%E4%BD%BF%E7%94%A8Travis-CI%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0/","content":"准备\n需要两个 github 仓库：\n一个用于发布页面： shenbo.github.io\n一个用于放源码： hexo-source\n\n\nTravis CI 账户 (https://www.travis-ci.org/)\n\n1. 创建 hexo-source 仓库\n在hexo的根目录下（ ~&#x2F;hexo）运行：\n\ncd hexogit initgit add .git commit -m &quot;first commit&quot;git remote add origin https://github.com/shenbo/hexo-source.gitgit push -u origin master\n\n2. Travis CI 与 Github 设置2.1 打开 Github 个人设置，创建授权 tokens\n路径 Settings - Developer settings - Personal access tokens\n链接：(https://github.com/settings/tokens)\ngenerate new token\n复制token\n\n2.2 设置 Travis CI 与 Github 绑定\n将 Travis 账号 与 Github绑定，激活 hexo-source仓库的开关\n打开仓库设置，在 Environment Variables 选项中新建 github_token 项,将刚刚获得的token填进去\n其他默认选项不用管\n\n\n\n3. 添加 Travis CI 配置文件\n在hexo的根目录下（ ~&#x2F;hexo）新建 .travis.yml内容如下：\n\nlanguage: node_jsnode_js: stablecache:    apt: true    directories:        - node_modulesbefore_install:    - npm install hexo-cli -ginstall:  - npm install  - npm install hexo-deployer-git --savescript:  - hexo clean  - hexo gafter_script:  - git clone $&#123;GH_REF&#125; hexo-public  - cp -rf public/* hexo-public/  - cd hexo-public  - git config user.name &quot;shenbo&quot;  - git config user.email &quot;shenbo@hotmail.com&quot;  - git add .  - git commit -am &quot;Travis CI Auto Builder...&quot;  - git push origin master branches:  only:    - masterenv: global:   - GH_REF: https://shenbo:$&#123;github_token&#125;@github.com/shenbo/shenbo.github.io.git \n\n\n在 hexo-source 仓库 push 一下, 几秒钟后在 Travis CI 页面应该能看到正在 build。\n\n4. 使用配置成功后，可以发现，本地就不需要nodejs环境了；\n即使换了电脑只要clone hexo-source 仓库，更新这个仓库即可。\n","categories":["hexo"],"tags":["hexo","travis_ci"]},{"title":"幼儿园报名","url":"/2019/06/07/yoyo/20190606-%E5%B9%BC%E5%84%BF%E5%9B%AD/","content":"\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"python简单爬虫：selenium webdriver (phantomjs) 和 beautifulSoup","url":"/2019/05/28/python/python-%E7%AE%80%E5%8D%95%E7%88%AC%E8%99%AB%EF%BC%9Aselenium-webdriver-(phantomjs)-%E5%92%8C-beautifulSoup/","content":"1. Selenium\n\nhttps://docs.seleniumhq.org/\n\n\n\n\nhttps://phantomjs.org/\nhttps://github.com/ariya/phantomjs\n\n\nSelenium 是一个JavaScript框架，调用 webdriver 模拟在浏览器内的操作，可以适用 Chrome、 Firefox 、IE 等浏览器。\n本文用的是 PhantomJS，一个在可以后台运行的无头浏览器(Scriptable Headless Browser)。\n\nPhantomJS 项目目前已经暂停更新。\nSelenium 推荐用 Chrome 或 Firefox 的无头模式。\n但 chromedriver 无头模式启动时，还是会有一个空白的命令行窗口，比较讨厌，因此还是用 PhantomJS。\n\n\n\nimport timefrom bs4 import BeautifulSoupfrom selenium import webdriver# # ====== chrome config ==========# # chromedriver 下载地址 http://npm.taobao.org/mirrors/chromedriver/# # 或： scoop install chromedriver# chrome_options = webdriver.ChromeOptions()# chrome_options.headless = True  # 无界面## chromedriver_path = r&#x27;C:\\xxx\\scoop\\apps\\chromedriver\\current\\chromedriver&#x27;# driver = webdriver.Chrome(executable_path=chromedriver_path, options=chrome_options)# ====== phantomjs config ========# 安装： scoop install phantomjsphantomjs_path = r&#x27;C:\\xxx\\scoop\\apps\\PhantomJS\\current\\phantomjs&#x27;driver = webdriver.PhantomJS(executable_path=phantomjs_path)driver.get(&#x27;https://www.baidu.com&#x27;)time.sleep(1)print(driver.title)print(driver.page_source)driver.close()driver.quit()\n\n2. BeautifulSoupdriver.get(url)content = driver.page_sourcesoup = BeautifulSoup(content, &#x27;html.parser&#x27;)  # 解析器：&#x27;lxml&#x27;# 匹配第一个 class 为 title 的 div 标签div = soup.find(&#x27;div&#x27;, &#123;&#x27;class&#x27;: &#x27;title&#x27;&#125;)# 匹配第一个 class 包含 title 的 div 标签div = soup.find(&#x27;div&#x27;, &#123;&#x27;class&#x27;: [&#x27;title&#x27;, &#x27; &#x27;]&#125;)# 获得 div 标签内的 子标签 &lt;a&gt; 的 title 属性title = div.a.get(&#x27;title&#x27;)# 获得 div 标签内的 子标签 &lt;a&gt; 的 文字text = div.a.text# 匹配所有 class 包含 sound 的 div 标签sound_list = soup.find_all(&#x27;div&#x27;, &#123;&#x27;class&#x27;: [&#x27;sound&#x27;, &#x27; &#x27;]&#125;)for sound in sound_list：    print(sound)# 匹配第一个 class 包含 title, id 为 sound 的 div 标签div = soup.find(&#x27;div&#x27;, &#123;&#x27;class&#x27;: [&#x27;title&#x27;, &#x27; &#x27;], &#x27;id&#x27;: &#x27;sound&#x27;&#125;)\n\n3. Selenium 模拟浏览器翻页 (滚动条)# == loading all pages ==driver.get(url)page_num = 10for i in range(page_num):    driver.execute_script(&#x27;window.scrollBy(0, document.body.scrollHeight)&#x27;)    time.sleep(3)content = driver.page_source\n","categories":["python"],"tags":["python","selenium","beautifulSoup"]},{"title":"数据可视化：matplotlib animation 绘制动画","url":"/2019/05/27/sci-matplotlib/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-matplotlib-animation-%E7%BB%98%E5%88%B6%E5%8A%A8%E7%94%BB/","content":"1. 用 matplotlib animation 绘制动画ref: https://matplotlib.org/3.1.1/api/animation_api.html\nimport matplotlib.animation as animationimport matplotlib.pyplot as pltimport numpy as np# 数据集：X轴数据固定；Y轴的数据更新X = np.arange(0, 10, 0.01)  # X shape： (N,)Ys = [np.sin(X + k / 10) for k in range(100)]  # Ys shape： (k, N)def my_ani(x, ys):    fig, ax = plt.subplots()    ax.set_title(&#x27;y = sin(x + k/10)&#x27;)    ax.set_xlim([0, 10]), ax.set_xlabel(&#x27;X&#x27;)    ax.set_ylim([-1, 1]), ax.set_ylabel(&#x27;Y&#x27;)    line, = ax.plot(x, ys[0])    ano = plt.annotate(&#x27;k: 0&#x27;, (1, 1))    def animate(i):        line.set_ydata(ys[i])       # update the y data.        ano.set_text(&#x27;k: %d&#x27; % i)  # update the annotate.        return line,    # animation.FuncAnimation 参数说明    # fig:          figure 对象    # func:         动画函数，自定义函数 animate    # frames:       总帧数    # interval:     间隔时间，ms    ani = animation.FuncAnimation(fig, animate, frames=30, interval=50)    # ani.save(&#x27;sin_ani.mp4&#x27;, dpi=300, writer=&#x27;ffmpeg&#x27;)     # scoop install ffmpeg    # ani.save(&#x27;sin_ani.gif&#x27;, dpi=300, writer=&#x27;pillow&#x27;)     # pip install pillow    plt.show()my_ani(X, Ys)\n\n\n\n\n\n\n2. 也用 plot 的方法显示动画，保存不太方便import matplotlib.pyplot as pltimport numpy as np# 数据集：X轴数据固定；Y轴的数据更新X = np.arange(0, 10, 0.01)  # X shape： (N,)Ys = [np.sin(X + k / 10) for k in range(100)]  # Ys shape： (k, N)plt.ion()plt.show()for i in range(len(Ys)):    plt.cla()    plt.title(&#x27;y = sin(x + k/10)&#x27;)    plt.xlim(0, 10)    plt.ylim(-1, 1)        plt.plot(X, Ys[i], &#x27;r&#x27;, alpha=0.7, linewidth=0.7)    plt.text(1, 1, &#x27;k: %d&#x27; % i)    plt.draw()    plt.pause(0.05)  # 间隔时间，s\n\n\ntitle: 数据可视化：matplotlib animation 绘制动画(2)date: 2020-10-08 16:42:45tags: matplotlibcategories: sciref: https://matplotlib.org/3.1.1/api/animation_api.html\nmatplotlib animation 动画教程都是针对曲线类型的,\n对于包含子图、或含有类似直方图等图形的情况，就不适用了。\n下面尝试实现包含多个子图，同时有直方图的动画效果。\nimport matplotlib.animation as animationimport matplotlib.pyplot as pltimport numpy as npX = np.arange(0, 10, 0.01)  # X shape： (N,)Ys = [np.sin(X + k/10.0) for k in range(100)]  # Ys shape： (k, N)fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(8, 4))def animate(i):    axes[0].cla()    axes[0].plot(X, Ys[i])    axes[0].set_title(f&#x27;y = sin(x + &#123;i&#125;/10)&#x27;)    axes[1].cla()    axes[1].hist(Ys[i], bins=50, orientation=&#x27;horizontal&#x27;)ani = animation.FuncAnimation(fig, animate, frames=50, interval=50)ani.save(&#x27;matplotlib-animation-hist.gif&#x27;)plt.show()\n\n\n\n\nok！\n\n\ntitle: 数据可视化：matplotlib animation 绘制 Lorenz 随机函数三维动画date: 2022-11-08 19:42:49tags: matplotlibcategories: sci1. 创建 Lorenz 函数，生成随机数据import numpy as npimport matplotlib.pyplot as pltfrom scipy.integrate import odeintfrom mpl_toolkits.mplot3d.axes3d import Axes3Dimport matplotlib.animation as animation# === define the lorenz system ===# x, y, and z make up the system state# t is time,# sigma, rho, beta are the system parametersdef lorenz_system(current_state, t):    x, y, z = current_state    dx_dt = sigma * (y - x)    dy_dt = x * (rho - z) - y    dz_dt = x * y - beta * z    return [dx_dt, dy_dt, dz_dt]# define the initial system state, system parametersinitial_state = [-0.1, 0.01, 0.08]sigma = 10.rho = 50.beta = 3.start_time = 0end_time = 10num_points = 100 * (end_time - start_time)time_points = np.linspace(start_time, end_time, num_points)# === generate datas =========xyz = odeint(lorenz_system, initial_state, time_points)data = np.array(xyz).T * 0.01  # scale down to 0.01print(data)print(data[0])\n\n\n\n2. 绘制二维图# === 2d plot lorenz ====def lorenz_2d_plot(data):    fig, axs = plt.subplots(3, 1, sharex=&#x27;all&#x27;)    xxx = range(len(data[2]))    axs[2].set_xlim(0, 1000)    axs[2].set_xlabel(&#x27;time&#x27;)    axs[0].plot(xxx, data[0], color=&#x27;r&#x27;, alpha=0.7, linewidth=0.7)    axs[0].set_ylabel(&#x27;x&#x27;)    axs[1].plot(xxx, data[1], color=&#x27;g&#x27;, alpha=0.7, linewidth=0.7)    axs[1].set_ylabel(&#x27;y&#x27;)    axs[2].plot(xxx, data[2], color=&#x27;b&#x27;, alpha=0.7, linewidth=0.7)    axs[2].set_ylabel(&#x27;z&#x27;)    fig.tight_layout()    fig.savefig(&#x27;matplotlib_lorenz-2d.png&#x27;, dpi=300, bbox_inches=&#x27;tight&#x27;)    plt.show()lorenz_2d_plot(data)\n\n\n\n3. 绘制三维图# === 3d plot lorenz ====def lorenz_3d_plot(data):    fig = plt.figure()    ax = Axes3D(fig)    ax.xaxis.set_pane_color((1, 1, 1, 1))    ax.yaxis.set_pane_color((1, 1, 1, 1))    ax.zaxis.set_pane_color((1, 1, 1, 1))    ax.set_title(&#x27;Lorenz&#x27;)    ax.set_xlim3d([-0.5, 0.5]), ax.set_xlabel(&#x27;X&#x27;)    ax.set_ylim3d([-0.5, 0.5]), ax.set_ylabel(&#x27;Y&#x27;)    ax.set_zlim3d([0.0, 1.0]), ax.set_zlabel(&#x27;Z&#x27;)    # ax.view_init(30, -60)               # default view    ax.plot(data[0], data[1], data[2], color=&#x27;r&#x27;, alpha=0.7, linewidth=0.75)    ax.set_title(&#x27;Lorenz_3d&#x27;)    fig.savefig(&#x27;matplotlib_lorenz-3d.png&#x27;, dpi=300, bbox_inches=&#x27;tight&#x27;)    plt.show()lorenz_3d_plot(data)\n\n\n4. 绘制三维动画# === 3d plot lorenz ====def lorenz_3d_plot_ani(data):    fig = plt.figure()    ax = Axes3D(fig)    ax.xaxis.set_pane_color((1, 1, 1, 1))    ax.yaxis.set_pane_color((1, 1, 1, 1))    ax.zaxis.set_pane_color((1, 1, 1, 1))    ax.set_title(&#x27;Lorenz_3d_animation&#x27;)    ax.set_xlim3d([-0.5, 0.5]), ax.set_xlabel(&#x27;X&#x27;)    ax.set_ylim3d([-0.5, 0.5]), ax.set_ylabel(&#x27;Y&#x27;)    ax.set_zlim3d([0.0, 1.0]), ax.set_zlabel(&#x27;Z&#x27;)    # ax.view_init(30, -60)               # default view    # === Animation Functions ===    def update_line(num, data, line):        line.set_data(data[0:2, :num])        line.set_3d_properties(data[2, :num])        return line    # initial with the start point    line, = ax.plot(data[0][0:1], data[1][0:1], data[2][0:1], color=&#x27;r&#x27;, alpha=0.7, linewidth=0.75)    ani = animation.FuncAnimation(fig, update_line, 1000, fargs=(data, line), interval=1)    # ani.save(&#x27;matplotlib_lorenz_3d_ani.mp4&#x27;, fps=24, dpi=300)    ani.save(&#x27;03_lorenz_3d_ani.gif&#x27;)    plt.show()lorenz_3d_plot_ani(data)\n\nok！\n","categories":["sci"],"tags":["matplotlib"]},{"title":"数据可视化：matplotlib animation 绘制动画","url":"/2019/05/27/sci-matplotlib/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-matplotlib-animation-%E7%BB%98%E5%88%B6%E5%8A%A8%E7%94%BB2/","content":"1. 用 matplotlib animation 绘制动画ref: https://matplotlib.org/3.1.1/api/animation_api.html\nimport matplotlib.animation as animationimport matplotlib.pyplot as pltimport numpy as np# 数据集：X轴数据固定；Y轴的数据更新X = np.arange(0, 10, 0.01)  # X shape： (N,)Ys = [np.sin(X + k / 10) for k in range(100)]  # Ys shape： (k, N)def my_ani(x, ys):    fig, ax = plt.subplots()    ax.set_title(&#x27;y = sin(x + k/10)&#x27;)    ax.set_xlim([0, 10]), ax.set_xlabel(&#x27;X&#x27;)    ax.set_ylim([-1, 1]), ax.set_ylabel(&#x27;Y&#x27;)    line, = ax.plot(x, ys[0])    ano = plt.annotate(&#x27;k: 0&#x27;, (1, 1))    def animate(i):        line.set_ydata(ys[i])       # update the y data.        ano.set_text(&#x27;k: %d&#x27; % i)  # update the annotate.        return line,    # animation.FuncAnimation 参数说明    # fig:          figure 对象    # func:         动画函数，自定义函数 animate    # frames:       总帧数    # interval:     间隔时间，ms    ani = animation.FuncAnimation(fig, animate, frames=30, interval=50)    # ani.save(&#x27;sin_ani.mp4&#x27;, dpi=300, writer=&#x27;ffmpeg&#x27;)     # scoop install ffmpeg    # ani.save(&#x27;sin_ani.gif&#x27;, dpi=300, writer=&#x27;pillow&#x27;)     # pip install pillow    plt.show()my_ani(X, Ys)\n\n\n\n\n\n\n2. 也用 plot 的方法显示动画，保存不太方便import matplotlib.pyplot as pltimport numpy as np# 数据集：X轴数据固定；Y轴的数据更新X = np.arange(0, 10, 0.01)  # X shape： (N,)Ys = [np.sin(X + k / 10) for k in range(100)]  # Ys shape： (k, N)plt.ion()plt.show()for i in range(len(Ys)):    plt.cla()    plt.title(&#x27;y = sin(x + k/10)&#x27;)    plt.xlim(0, 10)    plt.ylim(-1, 1)        plt.plot(X, Ys[i], &#x27;r&#x27;, alpha=0.7, linewidth=0.7)    plt.text(1, 1, &#x27;k: %d&#x27; % i)    plt.draw()    plt.pause(0.05)  # 间隔时间，s\n\n\ntitle: 数据可视化：matplotlib animation 绘制动画(2)date: 2020-10-08 16:42:45tags: matplotlibcategories: sciref: https://matplotlib.org/3.1.1/api/animation_api.html\nmatplotlib animation 动画教程都是针对曲线类型的,\n对于包含子图、或含有类似直方图等图形的情况，就不适用了。\n下面尝试实现包含多个子图，同时有直方图的动画效果。\nimport matplotlib.animation as animationimport matplotlib.pyplot as pltimport numpy as npX = np.arange(0, 10, 0.01)  # X shape： (N,)Ys = [np.sin(X + k/10.0) for k in range(100)]  # Ys shape： (k, N)fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(8, 4))def animate(i):    axes[0].cla()    axes[0].plot(X, Ys[i])    axes[0].set_title(f&#x27;y = sin(x + &#123;i&#125;/10)&#x27;)    axes[1].cla()    axes[1].hist(Ys[i], bins=50, orientation=&#x27;horizontal&#x27;)ani = animation.FuncAnimation(fig, animate, frames=50, interval=50)ani.save(&#x27;matplotlib-animation-hist.gif&#x27;)plt.show()\n\n\n\n\nok！\n\n\ntitle: 数据可视化：matplotlib animation 绘制 Lorenz 随机函数三维动画date: 2022-11-08 19:42:49tags: matplotlibcategories: sci1. 创建 Lorenz 函数，生成随机数据import numpy as npimport matplotlib.pyplot as pltfrom scipy.integrate import odeintfrom mpl_toolkits.mplot3d.axes3d import Axes3Dimport matplotlib.animation as animation# === define the lorenz system ===# x, y, and z make up the system state# t is time,# sigma, rho, beta are the system parametersdef lorenz_system(current_state, t):    x, y, z = current_state    dx_dt = sigma * (y - x)    dy_dt = x * (rho - z) - y    dz_dt = x * y - beta * z    return [dx_dt, dy_dt, dz_dt]# define the initial system state, system parametersinitial_state = [-0.1, 0.01, 0.08]sigma = 10.rho = 50.beta = 3.start_time = 0end_time = 10num_points = 100 * (end_time - start_time)time_points = np.linspace(start_time, end_time, num_points)# === generate datas =========xyz = odeint(lorenz_system, initial_state, time_points)data = np.array(xyz).T * 0.01  # scale down to 0.01print(data)print(data[0])\n\n\n\n2. 绘制二维图# === 2d plot lorenz ====def lorenz_2d_plot(data):    fig, axs = plt.subplots(3, 1, sharex=&#x27;all&#x27;)    xxx = range(len(data[2]))    axs[2].set_xlim(0, 1000)    axs[2].set_xlabel(&#x27;time&#x27;)    axs[0].plot(xxx, data[0], color=&#x27;r&#x27;, alpha=0.7, linewidth=0.7)    axs[0].set_ylabel(&#x27;x&#x27;)    axs[1].plot(xxx, data[1], color=&#x27;g&#x27;, alpha=0.7, linewidth=0.7)    axs[1].set_ylabel(&#x27;y&#x27;)    axs[2].plot(xxx, data[2], color=&#x27;b&#x27;, alpha=0.7, linewidth=0.7)    axs[2].set_ylabel(&#x27;z&#x27;)    fig.tight_layout()    fig.savefig(&#x27;matplotlib_lorenz-2d.png&#x27;, dpi=300, bbox_inches=&#x27;tight&#x27;)    plt.show()lorenz_2d_plot(data)\n\n\n\n3. 绘制三维图# === 3d plot lorenz ====def lorenz_3d_plot(data):    fig = plt.figure()    ax = Axes3D(fig)    ax.xaxis.set_pane_color((1, 1, 1, 1))    ax.yaxis.set_pane_color((1, 1, 1, 1))    ax.zaxis.set_pane_color((1, 1, 1, 1))    ax.set_title(&#x27;Lorenz&#x27;)    ax.set_xlim3d([-0.5, 0.5]), ax.set_xlabel(&#x27;X&#x27;)    ax.set_ylim3d([-0.5, 0.5]), ax.set_ylabel(&#x27;Y&#x27;)    ax.set_zlim3d([0.0, 1.0]), ax.set_zlabel(&#x27;Z&#x27;)    # ax.view_init(30, -60)               # default view    ax.plot(data[0], data[1], data[2], color=&#x27;r&#x27;, alpha=0.7, linewidth=0.75)    ax.set_title(&#x27;Lorenz_3d&#x27;)    fig.savefig(&#x27;matplotlib_lorenz-3d.png&#x27;, dpi=300, bbox_inches=&#x27;tight&#x27;)    plt.show()lorenz_3d_plot(data)\n\n\n4. 绘制三维动画# === 3d plot lorenz ====def lorenz_3d_plot_ani(data):    fig = plt.figure()    ax = Axes3D(fig)    ax.xaxis.set_pane_color((1, 1, 1, 1))    ax.yaxis.set_pane_color((1, 1, 1, 1))    ax.zaxis.set_pane_color((1, 1, 1, 1))    ax.set_title(&#x27;Lorenz_3d_animation&#x27;)    ax.set_xlim3d([-0.5, 0.5]), ax.set_xlabel(&#x27;X&#x27;)    ax.set_ylim3d([-0.5, 0.5]), ax.set_ylabel(&#x27;Y&#x27;)    ax.set_zlim3d([0.0, 1.0]), ax.set_zlabel(&#x27;Z&#x27;)    # ax.view_init(30, -60)               # default view    # === Animation Functions ===    def update_line(num, data, line):        line.set_data(data[0:2, :num])        line.set_3d_properties(data[2, :num])        return line    # initial with the start point    line, = ax.plot(data[0][0:1], data[1][0:1], data[2][0:1], color=&#x27;r&#x27;, alpha=0.7, linewidth=0.75)    ani = animation.FuncAnimation(fig, update_line, 1000, fargs=(data, line), interval=1)    # ani.save(&#x27;matplotlib_lorenz_3d_ani.mp4&#x27;, fps=24, dpi=300)    ani.save(&#x27;03_lorenz_3d_ani.gif&#x27;)    plt.show()lorenz_3d_plot_ani(data)\n\nok！\n","categories":["sci"],"tags":["matplotlib"]},{"title":"数据可视化：matplotlib animation 绘制动画","url":"/2019/05/27/sci-matplotlib/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-matplotlib-animation-%E7%BB%98%E5%88%B6%E5%8A%A8%E7%94%BB3/","content":"1. 用 matplotlib animation 绘制动画ref: https://matplotlib.org/3.1.1/api/animation_api.html\nimport matplotlib.animation as animationimport matplotlib.pyplot as pltimport numpy as np# 数据集：X轴数据固定；Y轴的数据更新X = np.arange(0, 10, 0.01)  # X shape： (N,)Ys = [np.sin(X + k / 10) for k in range(100)]  # Ys shape： (k, N)def my_ani(x, ys):    fig, ax = plt.subplots()    ax.set_title(&#x27;y = sin(x + k/10)&#x27;)    ax.set_xlim([0, 10]), ax.set_xlabel(&#x27;X&#x27;)    ax.set_ylim([-1, 1]), ax.set_ylabel(&#x27;Y&#x27;)    line, = ax.plot(x, ys[0])    ano = plt.annotate(&#x27;k: 0&#x27;, (1, 1))    def animate(i):        line.set_ydata(ys[i])       # update the y data.        ano.set_text(&#x27;k: %d&#x27; % i)  # update the annotate.        return line,    # animation.FuncAnimation 参数说明    # fig:          figure 对象    # func:         动画函数，自定义函数 animate    # frames:       总帧数    # interval:     间隔时间，ms    ani = animation.FuncAnimation(fig, animate, frames=30, interval=50)    # ani.save(&#x27;sin_ani.mp4&#x27;, dpi=300, writer=&#x27;ffmpeg&#x27;)     # scoop install ffmpeg    # ani.save(&#x27;sin_ani.gif&#x27;, dpi=300, writer=&#x27;pillow&#x27;)     # pip install pillow    plt.show()my_ani(X, Ys)\n\n\n\n\n\n\n2. 也用 plot 的方法显示动画，保存不太方便import matplotlib.pyplot as pltimport numpy as np# 数据集：X轴数据固定；Y轴的数据更新X = np.arange(0, 10, 0.01)  # X shape： (N,)Ys = [np.sin(X + k / 10) for k in range(100)]  # Ys shape： (k, N)plt.ion()plt.show()for i in range(len(Ys)):    plt.cla()    plt.title(&#x27;y = sin(x + k/10)&#x27;)    plt.xlim(0, 10)    plt.ylim(-1, 1)        plt.plot(X, Ys[i], &#x27;r&#x27;, alpha=0.7, linewidth=0.7)    plt.text(1, 1, &#x27;k: %d&#x27; % i)    plt.draw()    plt.pause(0.05)  # 间隔时间，s\n\n\ntitle: 数据可视化：matplotlib animation 绘制动画(2)date: 2020-10-08 16:42:45tags: matplotlibcategories: sciref: https://matplotlib.org/3.1.1/api/animation_api.html\nmatplotlib animation 动画教程都是针对曲线类型的,\n对于包含子图、或含有类似直方图等图形的情况，就不适用了。\n下面尝试实现包含多个子图，同时有直方图的动画效果。\nimport matplotlib.animation as animationimport matplotlib.pyplot as pltimport numpy as npX = np.arange(0, 10, 0.01)  # X shape： (N,)Ys = [np.sin(X + k/10.0) for k in range(100)]  # Ys shape： (k, N)fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(8, 4))def animate(i):    axes[0].cla()    axes[0].plot(X, Ys[i])    axes[0].set_title(f&#x27;y = sin(x + &#123;i&#125;/10)&#x27;)    axes[1].cla()    axes[1].hist(Ys[i], bins=50, orientation=&#x27;horizontal&#x27;)ani = animation.FuncAnimation(fig, animate, frames=50, interval=50)ani.save(&#x27;matplotlib-animation-hist.gif&#x27;)plt.show()\n\n\n\n\nok！\n\n\ntitle: 数据可视化：matplotlib animation 绘制 Lorenz 随机函数三维动画date: 2022-11-08 19:42:49tags: matplotlibcategories: sci1. 创建 Lorenz 函数，生成随机数据import numpy as npimport matplotlib.pyplot as pltfrom scipy.integrate import odeintfrom mpl_toolkits.mplot3d.axes3d import Axes3Dimport matplotlib.animation as animation# === define the lorenz system ===# x, y, and z make up the system state# t is time,# sigma, rho, beta are the system parametersdef lorenz_system(current_state, t):    x, y, z = current_state    dx_dt = sigma * (y - x)    dy_dt = x * (rho - z) - y    dz_dt = x * y - beta * z    return [dx_dt, dy_dt, dz_dt]# define the initial system state, system parametersinitial_state = [-0.1, 0.01, 0.08]sigma = 10.rho = 50.beta = 3.start_time = 0end_time = 10num_points = 100 * (end_time - start_time)time_points = np.linspace(start_time, end_time, num_points)# === generate datas =========xyz = odeint(lorenz_system, initial_state, time_points)data = np.array(xyz).T * 0.01  # scale down to 0.01print(data)print(data[0])\n\n\n\n2. 绘制二维图# === 2d plot lorenz ====def lorenz_2d_plot(data):    fig, axs = plt.subplots(3, 1, sharex=&#x27;all&#x27;)    xxx = range(len(data[2]))    axs[2].set_xlim(0, 1000)    axs[2].set_xlabel(&#x27;time&#x27;)    axs[0].plot(xxx, data[0], color=&#x27;r&#x27;, alpha=0.7, linewidth=0.7)    axs[0].set_ylabel(&#x27;x&#x27;)    axs[1].plot(xxx, data[1], color=&#x27;g&#x27;, alpha=0.7, linewidth=0.7)    axs[1].set_ylabel(&#x27;y&#x27;)    axs[2].plot(xxx, data[2], color=&#x27;b&#x27;, alpha=0.7, linewidth=0.7)    axs[2].set_ylabel(&#x27;z&#x27;)    fig.tight_layout()    fig.savefig(&#x27;matplotlib_lorenz-2d.png&#x27;, dpi=300, bbox_inches=&#x27;tight&#x27;)    plt.show()lorenz_2d_plot(data)\n\n\n\n3. 绘制三维图# === 3d plot lorenz ====def lorenz_3d_plot(data):    fig = plt.figure()    ax = Axes3D(fig)    ax.xaxis.set_pane_color((1, 1, 1, 1))    ax.yaxis.set_pane_color((1, 1, 1, 1))    ax.zaxis.set_pane_color((1, 1, 1, 1))    ax.set_title(&#x27;Lorenz&#x27;)    ax.set_xlim3d([-0.5, 0.5]), ax.set_xlabel(&#x27;X&#x27;)    ax.set_ylim3d([-0.5, 0.5]), ax.set_ylabel(&#x27;Y&#x27;)    ax.set_zlim3d([0.0, 1.0]), ax.set_zlabel(&#x27;Z&#x27;)    # ax.view_init(30, -60)               # default view    ax.plot(data[0], data[1], data[2], color=&#x27;r&#x27;, alpha=0.7, linewidth=0.75)    ax.set_title(&#x27;Lorenz_3d&#x27;)    fig.savefig(&#x27;matplotlib_lorenz-3d.png&#x27;, dpi=300, bbox_inches=&#x27;tight&#x27;)    plt.show()lorenz_3d_plot(data)\n\n\n4. 绘制三维动画# === 3d plot lorenz ====def lorenz_3d_plot_ani(data):    fig = plt.figure()    ax = Axes3D(fig)    ax.xaxis.set_pane_color((1, 1, 1, 1))    ax.yaxis.set_pane_color((1, 1, 1, 1))    ax.zaxis.set_pane_color((1, 1, 1, 1))    ax.set_title(&#x27;Lorenz_3d_animation&#x27;)    ax.set_xlim3d([-0.5, 0.5]), ax.set_xlabel(&#x27;X&#x27;)    ax.set_ylim3d([-0.5, 0.5]), ax.set_ylabel(&#x27;Y&#x27;)    ax.set_zlim3d([0.0, 1.0]), ax.set_zlabel(&#x27;Z&#x27;)    # ax.view_init(30, -60)               # default view    # === Animation Functions ===    def update_line(num, data, line):        line.set_data(data[0:2, :num])        line.set_3d_properties(data[2, :num])        return line    # initial with the start point    line, = ax.plot(data[0][0:1], data[1][0:1], data[2][0:1], color=&#x27;r&#x27;, alpha=0.7, linewidth=0.75)    ani = animation.FuncAnimation(fig, update_line, 1000, fargs=(data, line), interval=1)    # ani.save(&#x27;matplotlib_lorenz_3d_ani.mp4&#x27;, fps=24, dpi=300)    ani.save(&#x27;03_lorenz_3d_ani.gif&#x27;)    plt.show()lorenz_3d_plot_ani(data)\n\nok！\n","categories":["sci"],"tags":["matplotlib"]},{"title":"XPS9370 关闭屏幕动态亮度","url":"/2019/05/12/xps/XPS9370-%E6%98%BE%E7%A4%BA%E5%99%A8%E5%8A%A8%E6%80%81%E4%BA%AE%E5%BA%A6%E8%B0%83%E8%8A%82/","content":"问题XPS13 9370用了之后发现屏幕亮度会随显示内容而自动调节。调节机制太弱智，眼睛都要瞎了。\n解决方案：\n开机后立即点 F2，进入Bios，我的版本是1.10.0\n找到 Video - Dynamic Backlight Control，然后选择 Disabled， 然后单击右下角 Apply\nOK !\n\n\n\n\n\n\n\n","categories":["xps"],"tags":["xps"]},{"title":"数据可视化：matplotlib marker 类型字符对照、设置间隔","url":"/2019/03/07/sci-matplotlib/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-matplotlib-marker-%E7%B1%BB%E5%9E%8B%E5%AD%97%E7%AC%A6%E5%AF%B9%E7%85%A7/","content":"matplotlib marker 类型字符对照\nref: https://matplotlib.org/stable/api/markers_api.htmlref: https://matplotlib.org/stable/gallery/lines_bars_and_markers/marker_reference.html#sphx-glr-gallery-lines-bars-and-markers-marker-reference-py\n\nunfilled_markers = (&#x27;,&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;+&#x27;, &#x27;x&#x27;, &#x27;|&#x27;, &#x27;_&#x27;) unfilled_markers = (0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11)           # intfilled_markers = (&#x27;.&#x27;, &#x27;o&#x27;, &#x27;v&#x27;, &#x27;^&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;8&#x27;, &#x27;s&#x27;, &#x27;p&#x27;, &#x27;*&#x27;, &#x27;h&#x27;, &#x27;H&#x27;, &#x27;D&#x27;, &#x27;d&#x27;, &#x27;P&#x27;, &#x27;X&#x27;)\n\n\n\n\n\n\nmatplotlib marker 设置间隔\nref: https://matplotlib.org/3.1.1/gallery/lines_bars_and_markers/markevery_demo.html?highlight=markevery\n\nmatplotlib 绘制曲线时如果数据点较多， 添加 marker 后会出现 marker 重叠或太密集的现象， 可以用 markevery 来控制 marker 的间距。\nplt.plot(x, y, marker=&#x27;o&#x27;, markevery=10)\n\n\n\nmarkevery 可以设置整数，也可以设为数组格式。\n\n\n\n\n\n\n\n","categories":["sci"],"tags":["matplotlib"]},{"title":"数据可视化：matplotlib marker 类型字符对照、设置间隔","url":"/2019/03/07/sci-matplotlib/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-matplotlib-marker-%E8%AE%BE%E7%BD%AE%E9%97%B4%E9%9A%94/","content":"matplotlib marker 类型字符对照\nref: https://matplotlib.org/stable/api/markers_api.htmlref: https://matplotlib.org/stable/gallery/lines_bars_and_markers/marker_reference.html#sphx-glr-gallery-lines-bars-and-markers-marker-reference-py\n\nunfilled_markers = (&#x27;,&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;+&#x27;, &#x27;x&#x27;, &#x27;|&#x27;, &#x27;_&#x27;) unfilled_markers = (0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11)           # intfilled_markers = (&#x27;.&#x27;, &#x27;o&#x27;, &#x27;v&#x27;, &#x27;^&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;8&#x27;, &#x27;s&#x27;, &#x27;p&#x27;, &#x27;*&#x27;, &#x27;h&#x27;, &#x27;H&#x27;, &#x27;D&#x27;, &#x27;d&#x27;, &#x27;P&#x27;, &#x27;X&#x27;)\n\n\n\n\n\n\nmatplotlib marker 设置间隔\nref: https://matplotlib.org/3.1.1/gallery/lines_bars_and_markers/markevery_demo.html?highlight=markevery\n\nmatplotlib 绘制曲线时如果数据点较多， 添加 marker 后会出现 marker 重叠或太密集的现象， 可以用 markevery 来控制 marker 的间距。\nplt.plot(x, y, marker=&#x27;o&#x27;, markevery=10)\n\n\n\nmarkevery 可以设置整数，也可以设为数组格式。\n\n\n\n\n\n\n\n","categories":["sci"],"tags":["matplotlib"]},{"title":"frp配置内网穿透、ssh远程连接、systemctl自启动","url":"/2019/02/27/network/frp%E9%85%8D%E7%BD%AE%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E3%80%81ssh%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5%E3%80%81systemctl%E8%87%AA%E5%90%AF%E5%8A%A8/","content":"\nref: https://github.com/fatedier/frp\n\n1.内网穿透1.1 服务器端 VPS 配置下载匹配的版本，https://github.com/fatedier/frp/releases\n\n修改 frps.ini 文件：\n\n# frps.ini[common]bind_port = 7000\n\n启动 frps：\n\n./frps -c ./frps.ini\n\n\n1.2 客户端配置\n修改 frpc.ini 文件，假设 frps 所在服务器的公网 IP 为 123.123.1.0；\n\n# frpc.ini[common]server_addr = 123.123.1.0server_port = 7000[ssh]type = tcplocal_ip = 127.0.0.1local_port = 22remote_port = 6000\n\n启动 frpc：\n\n./frpc -c ./frpc.ini\n\n1.3 远程访问ssh root@123.123.1.0 -oPort=6000 \n\n2. 自动启动 frp 服务–使用 systemctl\n2.1 新建 frp.service 文件\n\nsudo nano /lib/systemd/system/frp.service \n\n2.2 写入以下内容，注意区分 服务端 和 客户端\n\n[Unit]Description=frp serviceAfter=network.target syslog.targetWants=network.target[Service]Type=simple# 服务端ExecStart=/home/ubuntu/frp/frps -c /home/ubuntu/frp/frps.ini# 客户端# ExecStart=/root/frp/frpc -c /root/frp/frpc.ini[Install]WantedBy=multi-user.target\n\n\n2.3 使用 systemctl 启动服务\n\n# 启动frpsudo systemctl start frp# 开机自启动 sudo systemctl enable frp\n\n# 重启sudo systemctl restart frp# 停止sudo systemctl stop frp# 查看日志sudo systemctl status frp\n","categories":["apps"],"tags":["frp","rdp","systemctl"]},{"title":"frp配置内网穿透、通过rdp远程桌面控制windows系统","url":"/2019/02/27/network/frp%E9%85%8D%E7%BD%AE%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E3%80%81%E9%80%9A%E8%BF%87rdp%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%8E%A7%E5%88%B6windows%E7%B3%BB%E7%BB%9F/","content":"\nref: https://github.com/fatedier/frp\n\n1.内网穿透1.1 服务器端 VPS 配置下载匹配的版本，https://github.com/fatedier/frp/releases\n\n修改 frps.ini 文件：\n\n# frps.ini[common]bind_port = 7000\n\n启动 frps：\n\n./frps -c ./frps.ini\n\n\n1.2 客户端配置\n修改 frpc.ini 文件，假设 frps 所在服务器的公网 IP 为 123.123.1.0；\n\n# frpc.ini[common]server_addr = 123.123.1.0server_port = 7000[rdp]type = tcplocal_ip = 0.0.0.0local_port = 3389remote_port = 5200\n\n启动 frpc：\n\nfrpc.exe -c frpc.ini\n\n2 远程访问\nip 123.123.1.0:5200\n\n输入用户名，密码\n\n\n3 将 frp 封装成 windows 后台服务windows下 frp 程序启动后会有一个cmd窗口，需要一直开着，不能关闭。\n以下将 frp 封装成 windows 服务，可以在后台运行，并且开机自启动。\n\n需要下载 NSSM, http://www.nssm.cc/usage, 它可以将普通的 windows 程序封装成服务。\n\n3.1 使用 GUI 配置：\n运行 nssm install frpc\n在弹出的对话框中填写：\nPath：              C:/frpc/frpc.exe\nStartup directory： C:/frpc/\nArguments：         -c C:/frpc/frpc.ini\n\n\n\n\n3.2 使用命令行配置：NSSM 也可以使用命令行配置：\nnssm install frpc &quot;C:/frpc/frpc.exe&quot;nssm set frpc AppParameters  &quot;-c C:/frpc/frpc.ini&quot;\n\n3.3 启动服务等# 启动服务nssm start frpc# 停止服务nssm stop frpc# 编辑服务配置nssm edit frpc# 删除服务nssm remove frpc\n\n3.4 测试\n检查远程访问端口 3389 是否正常\n\n运行 netstat -ano, 寻找是否有 0.0.0.0:3389 端口；\n如果没有，我的电脑-右键属性-高级系统设置-远程选项卡-勾选允许远程访问，确定。\n\n\n检查 frpc 服务是否运行\n\n运行 services.msc，可以打开 windows 的服务管理器；\n检查 frpc 服务是否启动。\n\n\n\n","categories":["apps"],"tags":["frp","rdp"]},{"title":"使用 scoop 安装管理 windows 软件","url":"/2019/02/23/scoop/%E4%BD%BF%E7%94%A8scoop%E5%AE%89%E8%A3%85%E7%AE%A1%E7%90%86windows%E8%BD%AF%E4%BB%B6/","content":"\nref: (https://github.com/lukesampson/scoop)\n\n1. 安装 scoop\n1.1 安装 PowerShell 5.0 以上版本\n\nwin10： 已自带；\nwin7 x64： 下载 Win7AndW2K8R2-KB3191566-x64.zip，安装；\nref: https://docs.microsoft.com/zh-cn/powershell/scripting/install/installing-windows-powershell?view=powershell-6\n\n\n\n\n1.2 以当前Win账户运行PowerShell\n\n\nset-executionpolicy remotesigned -s cu\n\n\n1.3 安装 scoop\n\niex (new-object net.webclient).downloadstring(&#x27;https://get.scoop.sh&#x27;)\n\n\n\n2. 使用方法\n2.1 安装常用软件\n\nscoop install sudoscoop install git 7zip opensshscoop install aria2scoop install ffmpegscoop install nodejsscoop install python# 安装指定的版本，不要更新scoop install python@3.6.8scoop hold python# scoop unhold python\n\n\n\ngit 配置\n右键菜单里添加 git bash here 的方法\n新建注册表文件 git bash here.reg, 内容如下（路径按需修改）\n\nWindows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Classes\\Directory\\Background\\shell\\Git Bash Here]&quot;ICON&quot;=&quot;\\&quot;C:\\\\Users\\\\XXXX\\\\scoop\\\\apps\\\\git\\\\current\\\\git-bash.exe\\&quot;&quot; [HKEY_CURRENT_USER\\Software\\Classes\\Directory\\Background\\shell\\Git Bash Here\\command]@=&quot;\\&quot;C:\\\\Users\\\\XXXX\\\\scoop\\\\apps\\\\git\\\\current\\\\git-bash.exe\\&quot;&quot; \n\n\n2.2 安装 extras 库的软件\n\n# 添加库 extras scoop bucket add extras# 安装scoop install googlechromescoop install everythingscoop install screentogifscoop install snipastescoop install vscode# 添加库 versions, 可以安装其他（落后的)版本scoop bucket add versionsscoop install python@3.7.7# 添加库 jetbrainsscoop bucket add jetbrainsscoop install pycharm-professional# 添加库 Ash258scoop bucket add Ash258 &#x27;https://github.com/Ash258/scoop-Ash258.git&#x27;scoop install potplayer# 添加 第三方库 doradoscoop bucket add dorado &#x27;https://github.com/h404bi/dorado&#x27;scoop install trafficmonitorscoop install wechatscoop install qqplayer\n\n\n更多的库 https://github.com/lukesampson/scoop/blob/master/buckets.json\n\n&#123;    &quot;main&quot;: &quot;https://github.com/ScoopInstaller/Main&quot;,    &quot;extras&quot;: &quot;https://github.com/lukesampson/scoop-extras&quot;,    &quot;versions&quot;: &quot;https://github.com/ScoopInstaller/Versions&quot;,    &quot;nightlies&quot;: &quot;https://github.com/ScoopInstaller/Nightlies&quot;,    &quot;nirsoft&quot;: &quot;https://github.com/kodybrown/scoop-nirsoft&quot;,    &quot;php&quot;: &quot;https://github.com/ScoopInstaller/PHP&quot;,    &quot;nerd-fonts&quot;: &quot;https://github.com/matthewjberger/scoop-nerd-fonts&quot;,    &quot;nonportable&quot;: &quot;https://github.com/oltolm/scoop-nonportable&quot;,    &quot;java&quot;: &quot;https://github.com/ScoopInstaller/Java&quot;,    &quot;games&quot;: &quot;https://github.com/Calinou/scoop-games&quot;,    &quot;jetbrains&quot;: &quot;https://github.com/Ash258/Scoop-JetBrains&quot;&#125;\n\n\n\n更多更多的第三方库 https://github.com/rasa/scoop-directory/\n\n\n\n2.3 其他命令\n\n# 显示已安装软件scoop list# 显示可更新的软件scoop status# 更新scoop, 更新指定软件scoop updatescoop update &lt;app&gt;scoop update vscode-insiders -kf    # 更新 nightly 版本# 清理所有旧版软件, 清理指定软件, 清理过期的安装包scoop cleanup *scoop cleanup &lt;app&gt;scoop cleanup -k *  # 或 scoop cleanup --cache *# 查找软件scoop search &lt;app&gt;# 显示软件信息（含必要配置说明）scoop info &lt;app&gt;\n\n\n用scoop管理软件，清爽多了，全部都在c：/user/xxx/scoop/app里，但是也有几个问题：\n\n好多软件是从官网，github，amazon下载的，网速比较渣，可以先安装aria2，安装后scoop会优先调用aria2来下载软件；\n安装之后一般系统环境变量是设置好了的，但是有些软件的文件关联，右键菜单之类需要手动添加，可以先scoop info ，看看有没有相关配置说明参考。\n\n\nscoop 调用 aria2 的相关配置, 配置文件路径 c：/user/xxx/.config/scoop/config.json , 加入以下：\n&#123;  &quot;aria2-enabled&quot;:  true,  &quot;aria2-retry-wait&quot;:  5,  &quot;aria2-split&quot;:  10,  &quot;aria2-min-split-size&quot;:  &quot;2M&quot;&#125;\n\n也可以用命令行 scoop config :\nscoop config aria2-enabled true                   # default: truescoop config aria2-retry-wait 8                   # default: 2scoop config aria2-split 8                        # default: 5scoop config aria2-max-connection-per-server 8   # default: 5scoop config aria2-min-split-size] 2M             # default: 5M\n","categories":["apps"],"tags":["scoop"]},{"title":"runcat-pyqt5-win：在windows任务栏养猫","url":"/2019/01/24/python-app/runcat-for-win-%E5%9C%A8windows%E4%BB%BB%E5%8A%A1%E6%A0%8F%E5%85%BB%E7%8C%AB/","content":"runcat-pyqt5-winRunCat是一款 mac应用，用奔跑的猫来显示当前系统资源（CPU）占用情况。\n但是只有mac版，于是用python撸了一个，可以在windows任务栏（通知区域）养猫。\n首先用psutil获得CPU或内存的使用情况，然后用pyqt5创建QSystemTrayIcon显示在任务栏的托盘区域。\nGPU的使用情况可以用 nvidia-ml-py, https://pypi.org/project/nvidia-ml-py/的pynvml模块（仅限nvidia gpu）。\n\n\n运行效果\n\nRequirements\npsutil\npyqt5\nnvidia-ml-py\n\nCode\ngithub仓库： https://github.com/shenbo/runcat-pyqt5-win\n\nCPU 版\n\n\nimport sysimport timeimport threadingfrom PyQt5.QtGui import QIconfrom PyQt5.QtWidgets import QApplication, QSystemTrayIconimport psutil# Get cpu usagedef func():    while True:        global cpu        cpu = psutil.cpu_percent(interval=1) / 100        time.sleep(1)# Create Qt Appapp = QApplication(sys.argv)app.setQuitOnLastWindowClosed(False)# Create trayicontray = QSystemTrayIcon()tray.setIcon(QIcon(&#x27;0.ico&#x27;))tray.setVisible(True)cpu = 0.1timer = threading.Timer(1, func, [])timer.start()while True:    t = (cpu * cpu - 10 * cpu + 10) / 40    for i in range(5):        # Update trayicon        tray.setIcon(QIcon(&#x27;&#123;&#125;.ico&#x27;.format(i)))        tray.setToolTip(&#x27;CPU: &#123;:.2%&#125;&#x27;.format(cpu))        time.sleep(t)app.exec_()\n\n\n内存版\n\nimport sysimport timeimport threadingfrom PyQt5.QtGui import QIconfrom PyQt5.QtWidgets import QApplication, QSystemTrayIconimport psutil# Get memory usagedef func():    while True:        global mem        mem = psutil.virtual_memory().percent / 100        time.sleep(1)# Create Qt Appapp = QApplication(sys.argv)app.setQuitOnLastWindowClosed(False)# Create trayicontray = QSystemTrayIcon()tray.setIcon(QIcon(&#x27;0.ico&#x27;))tray.setVisible(True)mem = 0.1timer = threading.Timer(1, func, [])timer.start()while True:    t = (mem * mem - 10 * mem + 10) / 40    for i in range(5):        # Update trayicon        tray.setIcon(QIcon(&#x27;&#123;&#125;.ico&#x27;.format(i)))        tray.setToolTip(&#x27;Memory: &#123;:.2%&#125;&#x27;.format(mem))        time.sleep(t)app.exec_()\n\n\nGPU 版\n\nimport sysimport timeimport threadingfrom PyQt5.QtGui import QIconfrom PyQt5.QtWidgets import QApplication, QSystemTrayIconimport pynvmlpynvml.nvmlInit()handle = pynvml.nvmlDeviceGetHandleByIndex(0)   # GPU id: 0# Get gpu usagedef func():    while True:        global gpu        meminfo = pynvml.nvmlDeviceGetMemoryInfo(handle)        gpu = meminfo.used / meminfo.total        time.sleep(1)# Create Qt Appapp = QApplication(sys.argv)app.setQuitOnLastWindowClosed(False)# Create trayicontray = QSystemTrayIcon()tray.setIcon(QIcon(&#x27;0.ico&#x27;))tray.setVisible(True)gpu = 0.1timer = threading.Timer(1, func, [])timer.start()while True:    t = (gpu * gpu - 10 * gpu + 10) / 40    for i in range(5):        # Update trayicon        tray.setIcon(QIcon(&#x27;&#123;&#125;.ico&#x27;.format(i)))        tray.setToolTip(&#x27;GPU: &#123;:.2%&#125;&#x27;.format(gpu))        time.sleep(t)app.exec_()\n\nUsage\n直接clone或下载， 改 *.pyw 运行\n\n或者下载打包后的 *.exe， 但是有30多M。。。下载exe\n\n\n\nref:\n\nhttps://github.com/Kyome22/menubar_runcat\nhttps://github.com/sunthx/RunCat-Win\n\n\n","categories":["python"],"tags":["python","pyqt5"]},{"title":"XPS9370(UHD620集显)使用Solidworks卡顿","url":"/2019/01/12/xps/XPS9370-UHD620%E9%9B%86%E6%98%BE-Solidworks%E5%8D%A1%E9%A1%BF/","content":"2019年升级了装备 XPS 9370，但是 Solidworks 2014使用时非常卡。XPS 9370 配置的是 Intel UHD 620 集显，公司还有个笔记本是 ThinkPad New S2，是HD 620显卡，solidworks 却不卡。\n解决办法：改注册表将 Solidworks 2016 原有的显卡系列随便选一个导出来，然后用文本编辑器打开，将显卡系列的名称（如 HD Graphics）改为 UHD Graphics 620，Workarounds 值改为 00000009。\n\n\n或直接将以下导入注册表。\nWindows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\SolidWorks\\SOLIDWORKS 2016\\Performance\\Graphics\\Hardware\\Intel\\Intel(R) UHD Graphics 620]&quot;Workarounds&quot;=dword:00000009[HKEY_CURRENT_USER\\Software\\SolidWorks\\SOLIDWORKS 2016\\Performance\\Graphics\\Hardware\\Intel\\Intel(R) UHD Graphics 620\\V001_FG_X614105256_V815102256]&quot;Workarounds&quot;=dword:10000480[HKEY_CURRENT_USER\\Software\\SolidWorks\\SOLIDWORKS 2016\\Performance\\Graphics\\Hardware\\Intel\\Intel(R) UHD Graphics 620\\V002_FG_V815102345]&quot;Workarounds&quot;=dword:10000080\n\n\n以下方法已失效！\n在网上搜了一圈大致有以下几个解决方法：\n\n一、在 Solidworks  的选项里，勾选启动 OpenGL 软件加速；\n找到了 OpenGL 选项，发现默认是已勾选的，状态还是灰色的，根本改不了；\n\n\n\n\n\n\n\n\n二、换 Solidworks 2016版以后的版本，2016版之后对 WIN10 的支持比较好；\n装了2016版，问题还是一样；\n重装了 WIN10 专业版也不行；\n\n\n三、可能是显卡驱动的问题，把显卡驱动降级；\n没有尝试；XPS 出厂的显卡驱动版本时是22.xx，官网最新显卡驱动已经是25.xx了，不想再降级了；\n后续又检查 ThinkPad New S2 出厂的显卡驱动版本时是21.xx；很有可能是驱动的问题\n\n\n四、由于UHD 620是新推出的显卡，不在 Solidworks  默认支持的列表里面，需要改注册表，将新驱动添加进去；\n检查注册表，支持列表里确实没有UHD 620；但是将UHD 620加进去还是没用；\n\n\n\n\n\n\n将原有的显卡系列随便选一个导出来，然后用文本编辑器打开，将显卡系列的名称（如 HD Graphics）改为 UHD Graphics 即可。\n\n\n几乎要放弃了，大不了就卡着卡着用吧。想到显卡驱动还没更新到最新版，更新一下驱动吧，更新到了 Dell 官网的24.xx版；\n\n\n\n注：虽然是 Intel 的显卡，但是驱动貌似不是Intel官网上的官方驱动（最新版是25.xx），Intel官网的驱动安不上去；估计是 dell自己做了一些（负）优化，需要到 Dell 官网下载显卡驱动（最新版是24.xx，写于2019年1月）。\n\n\n再打开 Solidworks 2016，发现启动 OpenGL 软件加速选项变成白色，可以取消勾选了！！！\n\n卡顿问题终于解决了。。。\n\n但是一打开工程图就崩溃。。。\n\nWTF!\n\n\n\n最终解决方案：\n打开Solidworks Rx，以安全模式打开。\n\n\n\n\nOK！！暂未发现问题。\n\n","categories":["xps"],"tags":["xps","solidworks"]},{"title":"RTX2070显卡、tensorflow-gpu、CUDA10安装","url":"/2018/12/29/tensorflow/RTX2070%E6%98%BE%E5%8D%A1%E3%80%81tensorflow-gpu%E3%80%81CUDA10%E5%AE%89%E8%A3%85/","content":"1.硬件安装前一段用 tensorflow 玩深度学习，笔记本只能跑个 mnist，再大点的模型都跑不动。试了腾讯云、极客云，用着也不方便。\n还是上显卡吧！\n\n本来一门心思想买1080，看着看着RTX20系列出了，买新不买旧，那就买2070吧。\n学校有个台式机是dell optix 7020，小机箱，原装电源只有～300w。还得换个电源。\n机械硬盘还得再换个ssd。。。\n\n\n\n最后选择：\n\n凄惨红 iGame GeForce RTX 2070 Ultra  OC\n\n\n\n\nIntel 545S 256G固态硬盘 2.5英寸盘 SATA接口 SSD\n\n\n\n\n安钛克 EAG550evo金牌全模组电源\n\n\n\n这个台式机的主板供电接口不是通用的，坑爹，还得配一个转接头：\n\nDELL Optiplex 3020 7020 9020主板 8针电源线 电源24PIN转8PIN线\n\n\n\n东西到齐开始安装。。。\n\n原机箱\n\n\n\n\n\n显卡、电源到货\n\n\n\n\n原硬盘和支架挡到了显卡，果断拆掉。。。\n\n\n\n\n\n\n\n事实证明，并不好拆。。。\n\n\n安装完成！\n\n\n\n2.软件安装\n参考Tensorflow官网的tensorflow-gpu版本,安装指南, https://tensorflow.google.cn/install/gpu。\n\nNVIDIA® GPU 驱动程序, https://www.nvidia.com/drivers - CUDA 9.0 需要 384.x 或更高版本。\nCUDA® 工具包, https://developer.nvidia.com/cuda-zone - TensorFlow 支持 CUDA 9.0。\nCUDA 工具包附带的 CUPTI, http://docs.nvidia.com/cuda/cupti/ \ncuDNN SDK, https://developer.nvidia.com/cudnn （7.2 及更高版本）\n\n\n注意只支持到CUDA 9，到处是坑。。。\n\n\n\n\n\n首先，安装显卡驱动，Win10已经自动装好了。可以到nvidia官网确认一下驱动的版本是不是最新的。\n\n\n\n\n\n安装CUDA 9.2\n\nCUDA官网的最新版已经是CUDA10；找到历史版本试着安装CUDA9.2，但是试了几次都安装失败。。。估计是CUDA9.2不支持RTX2070。。。那就硬着头皮安装CUDA10吧。\n\n\n安装CUDA 10\n\n\n\n\n安装cuDNN 7.3.1，需要注册一个 nvidia developer账号。\n\n\n\n\n安装 tensorflow-gpu，最新版是 tensorflow_gpu-1.11.0，直接用pip安装。\n\npip install tensorflow-gpu\n\n\n赶紧 import 试一下：\n\nimport tensorflow as tfprint(tf.__version__)\n\n但是运行时却报错 Import Error: DLL load fail: 找不到指定的模块\n阿西吧。。。看来真不支持CUDA10啊\n最后请教论坛大神，找到了野生版轮子：\n\ntensorflow-windows-wheel, https://github.com/fo40225/tensorflow-windows-wheel\n\n\n\n\n找到tensorflow_gpu-1.11.0-CP36-cp36m-win_amd64.whl\n\n\n\n\n下载到本地安装\n\npip install tensorflow_gpu-1.11.0-CP36-cp36m-win_amd64.whl\n\n\n运行 import ... ，成功！\n\n以上， 全部搞定！！\n","categories":["tensorflow"],"tags":["tensorflow","keras","RTX2070","tensorflow-gpu","CUDA10"]},{"title":"使用 python 批量将xls文件转换为xlsx","url":"/2018/12/28/python/Python-%E6%89%B9%E9%87%8F%E5%B0%86xls%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E4%B8%BAxlsx/","content":"处理excel数据时遇到了个问题，数据导出来总是不全。\n后来发现是 *.xls 格式的问题：\n\nxls格式 最大行数为65535\n\n\nxlsx格式 最大行数为1048576（满足要求了）\n\n而且xlsx文件大小只有原来的1&#x2F;3左右。\n但是手上有一大堆旧的xls文件需要转换。\n解决方法：安装pywin32pip install pywin32\n\n代码import osimport os.pathimport win32com.client as win32## 根目录rootdir = u&#x27;E:\\\\temp1&#x27;# 三个参数：父目录；所有文件夹名（不含路径）；所有文件名for parent, dirnames, filenames in os.walk(rootdir):    for fn in filenames:        filedir = os.path.join(parent, fn)        print(filedir)        excel = win32.gencache.EnsureDispatch(&#x27;Excel.Application&#x27;)        wb = excel.Workbooks.Open(filedir)        # xlsx: FileFormat=51        # xls:  FileFormat=56,        wb.SaveAs(filedir.replace(&#x27;xls&#x27;, &#x27;xlsx&#x27;).replace(&#x27;XLS&#x27;, &#x27;xlsx&#x27;), FileFormat=51)        wb.Close()                                         excel.Application.Quit()\n","categories":["python"],"tags":["python","excel"]},{"title":"使用python定时自动截屏，发邮件通知","url":"/2018/12/28/python/Python-%E5%AE%9A%E6%97%B6%E8%87%AA%E5%8A%A8%E6%88%AA%E5%B1%8F%EF%BC%8C%E5%8F%91%E9%82%AE%E4%BB%B6%E9%80%9A%E7%9F%A5/","content":"前一段做试验，需要远程监控现场的电脑；写了一个定时截屏并把图片发送至邮箱的脚本，这样微信就可以得到通知。\n1. 截屏，并保存图片from PIL import ImageGrabimport timetime_now = time.strftime(&#x27;%Y%m%d-%H%M%S&#x27;)pic = ImageGrab.grab()pic_name = time_now+&#x27;.jpg&#x27;pic.save(pic_name)\n\n2. 定时任务import threadingdef func():    t = time.localtime(time.time())    min, hour, wkday = t.tm_min, t.tm_hour, t.tm_wday    # --------add tasks here--------------------------    if min in [0, 15, 30, 45]:        print(&#x27;tasks&#x27;)       # --------tasks end----------------------------    global timer    timer = threading.Timer(60, func, [])    timer.start()timer = threading.Timer(1, func, [])timer.start()\n\n\n\n3.发邮件，将图片作为附件from email.mime.text import MIMETextfrom email.header import Headerfrom smtplib import SMTP_SSLfrom email.mime.application import MIMEApplicationfrom email.mime.multipart import MIMEMultipartdef send_mail(mail_title=&#x27;&#x27;, mail_content=&#x27;&#x27;, pic_name=&#x27;&#x27;):    sender = &#x27;xx@qq.com&#x27;    receiver = &#x27;xx@qq.com&#x27;    pwd = &#x27;xxxxxxxxxxxx&#x27;                # qq邮箱授权码    smtp = SMTP_SSL(&#x27;smtp.qq.com&#x27;)      # ssl登录    smtp.login(sender, pwd)    msg = MIMEMultipart()    msg[&quot;Subject&quot;] = Header(mail_title, &#x27;utf-8&#x27;)    msg[&quot;from&quot;] = sender    msg[&quot;to&quot;] = receiver    puretext = MIMEText(&#x27;content: &#x27;+mail_content)    msg.attach(puretext)        jpgpart = MIMEApplication(open(pic_name, &#x27;rb&#x27;).read())    jpgpart.add_header(&#x27;Content-Disposition&#x27;, &#x27;attachment&#x27;, filename=pic_name)    msg.attach(jpgpart)        smtp.sendmail(sender, receiver, msg.as_string())    smtp.quit()\n\n\n完整代码from datetime import datetimeimport timefrom PIL import ImageGrabimport osimport threadingdef send_mail(mail_title=&#x27;&#x27;, mail_content=&#x27;&#x27;, pic_name=&#x27;&#x27;):    from email.mime.text import MIMEText    from email.header import Header    from smtplib import SMTP_SSL    from email.mime.application import MIMEApplication    from email.mime.multipart import MIMEMultipart    sender = &#x27;xx@qq.com&#x27;    receiver = &#x27;xx@qq.com&#x27;    pwd = &#x27;xxxxxxxxxxxx&#x27;                # qq邮箱授权码    smtp = SMTP_SSL(&#x27;smtp.qq.com&#x27;)      # ssl登录    smtp.login(sender, pwd)    msg = MIMEMultipart()    msg[&quot;Subject&quot;] = Header(mail_title, &#x27;utf-8&#x27;)    msg[&quot;from&quot;] = sender    msg[&quot;to&quot;] = receiver    puretext = MIMEText(&#x27;content: &#x27;+mail_content)    msg.attach(puretext)    jpgpart = MIMEApplication(open(pic_name, &#x27;rb&#x27;).read())    jpgpart.add_header(&#x27;Content-Disposition&#x27;, &#x27;attachment&#x27;, filename=pic_name)    msg.attach(jpgpart)        smtp.sendmail(sender, receiver, msg.as_string())    smtp.quit()        def func():    t = time.localtime(time.time())    min, hour, wkday = t.tm_min, t.tm_hour, t.tm_wday    # --------add tasks here--------------------------    if min in [0, 15, 30, 45]:        time_now = time.strftime(&#x27;%Y%m%d-%H%M%S&#x27;)        pic = ImageGrab.grab()        pic_name = time_now+&#x27;.jpg&#x27;        pic.save(pic_name)        title = &#x27;mgso4 test monitor &#x27; + time_now        send_mail(title, title, pic_name)        # os.remove(pic_name)    # --------tasks end----------------------------    global timer    timer = threading.Timer(60, func, [])    timer.start()if __name__ == &quot;__main__&quot;:    timer = threading.Timer(1, func, [])    timer.start()\n\nPS1：去掉python程序的命令行窗口把 *.py 文件后缀改成 *.pyw ，即可去掉运行时出现的cmd窗口，直接后台运行。\nPS2：加入开机启动（Win10）将 *.pyw 文件做一个快捷方式，放到开始菜单的启动文件夹C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp里，这样每次开机就能直接启动了。\n～\n","categories":["python"],"tags":["python"]},{"title":"jupyter 设置远程访问","url":"/2018/12/28/python/jupyter-%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE/","content":"在vps上安装jupyter，设置远程访问。0. 安装jupyterpip install jupyter\n\n1. 生成密码打开python：\nfrom notebook.auth import passwdpasswd()\n根据提示输入密码，得到类似下面的密文：‘sha1:ce23d945972*********’复制下来。\n2. 生成配置文件：jupyter notebook --generate-config# 生成完可以看到配置文件的存储位置\n\n3. 修改配置文件sudo nano jupyter_notebook_config.py\nc.NotebookApp.ip = &#x27;*&#x27;c.NotebookApp.password = u&#x27;sha:ce..粘贴密文..&#x27;c.NotebookApp.open_browser = False c.NotebookApp.port = 3333\n\n4. 启动jupyternohup jupyter notebook  &amp;\n\n5. 远程登录试试打开 http://xxx.xxx.xxx.xxx:3333输入第一步设置的密码即可\n","categories":["python"],"tags":["python","jupyter"]},{"title":"PPT导出高分辨率的图片","url":"/2018/10/11/office/ppt-%E5%AF%BC%E5%87%BA%E9%AB%98%E5%88%86%E8%BE%A8%E7%8E%87%E7%9A%84%E5%9B%BE%E7%89%87/","content":"PPT导出高分辨率的图片（300dpi）\n1. 打开注册表\nwin + R 调出命令行, 键入 regedit , 回车\n\n2. 查找注册表路径（Office 2016版）：HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\16\\PowerPoint\\Options\n\n3. 新建 DWORD 值(D)：\n名称为 ExportBitmapResolution\n数值为 300 （十进制）\n\n4. 打开需要的PPT，另存为或导出为图片格式。","categories":["office"],"tags":["ppt"]},{"title":"Hexo 使用 Webhook 自动部署","url":"/2018/07/31/hexo/hexo-%E4%BD%BF%E7%94%A8webhook%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/","content":"准备\n需要两个 github 仓库：\n一个用于发布页面： shenbo.github.io\n一个用于放源码： hexo-source\n\n\n已配置好 hexo 的 VPS 服务器\n\n1. 创建 hexo-source 仓库\n在hexo的source目录下（ ~&#x2F;hexo&#x2F;source）运行：\n\ncd hexo/sourcegit initgit add .git commit -m &quot;first commit&quot;git remote add origin https://github.com/shenbo/hexo-source.gitgit push -u origin master\n\n\n\n2. 搭建Webhook 服务2.1 编写 hexo 部署命令新建文件 hexo-d.sh ，内容如下：\ncd ~/hexo/sourcegit pull origin mastercd ~/hexohexo cleanhexo generatehexo deploy\n\n2.2 方案1：用 Python 接收 webhook\n新建文件 webhook.py ，内容如下：\n\nfrom wsgiref.simple_server import make_serverimport osdef application(environ, start_response):    start_response(&#x27;200 OK&#x27;, [(&#x27;Content-Type&#x27;, &#x27;text/html&#x27;)])    print(&#x27;blog.sh....&#x27;)    os.system(&#x27;/bin/bash hexo-d.sh &amp;&#x27;)        return [b&#x27;Hello, webhook!&#x27;]httpd = make_server(&#x27;&#x27;, 9000, application)print(&#x27;Serving HTTP on port 9000...&#x27;)# start HTTP server:httpd.serve_forever()\n\n\n运行webhook.py服务\n\nnohup python3 webhook.py &amp;\n\n2.3 方案二：直接安装 webhook 应用\n安装 webhook, https://github.com/adnanh/webhook 应用\n\nsudo apt-get install webhook\n\n\n新建配置文件 hexo-hooks.json，内容为：\n\n[  &#123;    &quot;id&quot;: &quot;blog&quot;,    &quot;execute-command&quot;: &quot;hexo-d.sh&quot;,    &quot;response-message&quot;: &quot;job done!&quot;  &#125;]\n\n\n启动 webhook 服务，默认端口为9000\n\nnohup webhook -hooks hexo-hook.json -verbose &amp;\n\n\nPS: 查看端口占用情况\n\nsudo netstat -peanut\n\n3. 配置 github 仓库的 webhook进入 github.com -&gt; repository -&gt; hexo-source -&gt; settings -&gt; webhook\n填写 webhook配置信息.\n\nPayload URL :  http://xxx.xxx.xxx.xxx:9000/\nPayload URL :  http://xxx.xxx.xxx.xxx:9000/hooks/blog\nContent type : aplacation&#x2F;json\n\n— ok！\n4. 测试在笔记本上 git clone hexo-source 仓库，然后 push 一下。\n","categories":["hexo"],"tags":["hexo","webhook"]},{"title":"pandas列名的修改","url":"/2018/07/06/sci-pandas/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-pandas%E5%88%97%E5%90%8D%E7%9A%84%E4%BF%AE%E6%94%B9/","content":"生成一个 dataframeimport pandas as pdimport numpy as npdf = pd.DataFrame(np.random.rand(2, 4))print(df)##              0         1         2         3#    0  0.714730  0.566612  0.764352  0.728862#    1  0.823414  0.662657  0.800281  0.711702\n\n\n\n定义列名df.columns = [&#x27;beijing&#x27;, &#x27;shanghai&#x27;, &#x27;guangzhou&#x27;, &#x27;shenzhou&#x27;]print(df)##        beijing  shanghai  guangzhou  shenzhou#    0  0.714730  0.566612   0.764352  0.728862#    1  0.823414  0.662657   0.800281  0.711702\n\n重命名列df.rename(&#123;&#x27;beijing&#x27;:&#x27;A&#x27;, &#x27;shanghai&#x27;:&#x27;B&#x27;, &#x27;guangzhou&#x27;:&#x27;C&#x27;, &#x27;shenzhou&#x27;:&#x27;D&#x27;&#125;, axis=&#x27;columns&#x27;, inplace=True)print(df)##              A         B         C         D#    0  0.714730  0.566612  0.764352  0.728862#    1  0.823414  0.662657  0.800281  0.711702\n\n重命名列2df.rename(columns=&#123;&#x27;A&#x27;:&#x27;A_1&#x27;, &#x27;B&#x27;:&#x27;B_1&#x27;, &#x27;C&#x27;:&#x27;C_1&#x27;, &#x27;D&#x27;:&#x27;D_1&#x27;&#125;, inplace=True)print(df)##            A_1       B_1       C_1       D_1#    0  0.714730  0.566612  0.764352  0.728862#    1  0.823414  0.662657  0.800281  0.711702\n\n替换特定的字符或前缀&#x2F;后缀df.columns = df.columns.str.replace(&#x27;_&#x27;, &#x27;&#x27;)print(df)##             A1        B1        C1        D1#    0  0.714730  0.566612  0.764352  0.728862#    1  0.823414  0.662657  0.800281  0.711702","categories":["sci"],"tags":["pandas"]},{"title":"pandas显示完整的行或列","url":"/2018/07/06/sci-pandas/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-pandas%E6%98%BE%E7%A4%BA%E5%AE%8C%E6%95%B4%E7%9A%84%E8%A1%8C%E6%88%96%E5%88%97/","content":"pandas显示完整的行或列，避免省略中间行或列、以及自动换行。\nimport pandas as pdpd.set_option(&#x27;display.width&#x27;, 1000)pd.set_option(&#x27;display.max_rows&#x27;, 500)pd.set_option(&#x27;display.max_columns&#x27;, 500)\n","categories":["sci"],"tags":["pandas"]},{"title":"pandas时间序列及绘图","url":"/2018/07/06/sci-pandas/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-pandas%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97-datetime%E6%A0%BC%E5%BC%8F/","content":"1. 由字符串格式生成时间数据import pandas as pdimport numpy as np# string datetime --&gt; pandas datetimedt_start = &#x27;2018-07-04 12:00&#x27;pd_dt_start = pd.datetime.strptime(dt_start, &#x27;%Y-%m-%d %H:%M&#x27;)print(dt_start)         # 2018-07-04 12:00print(pd_dt_start)      # 2018-07-04 12:00:00\n\n\n\n2. 生成时间序列# pandas datetime rangedt_list = pd.date_range(&#x27;2018-07-04 09:00&#x27;, &#x27;2018-07-05 09:00&#x27;, freq=&#x27;H&#x27;)print(dt_list)# 构建 DataFramedf = pd.DataFrame(dt_list, columns=[&#x27;Time&#x27;])                # 将时间序列作为 &#x27;Time&#x27; 列df[&#x27;Temp&#x27;] = np.random.normal(30, 5, size=len(dt_list))     # 添加一列温度数据，&#x27;Temp&#x27;print(df)df.to_csv(&#x27;data.csv&#x27;)    # 保存为csv文件\n\n3. 读取文件中的时间# csv file datetime --&gt; pandas datetimedf = pd.read_csv(&#x27;data.csv&#x27;)     # 读取csv文件print(df[&#x27;Time&#x27;].head())         # dtype应该是datetime64[ns]； 如dtype是object，需转换一下df[&#x27;Time&#x27;] = pd.to_datetime(df[&#x27;Time&#x27;])     # 调用pd.to_datetime 转换print(df[&#x27;Time&#x27;].head())\n\n4. 数据筛选df = df[[&#x27;Time&#x27;, &#x27;Temp&#x27;]].dropna()      # 去除异常数据df = df[df[&#x27;Time&#x27;] &gt;= pd_dt_start]      # 时间筛选df = df[df[&#x27;Temp&#x27;] &lt;= 35.0]             # 温度筛选print(df[&#x27;Time&#x27;].head())\n\n5. 绘图import matplotlib.pyplot as pltimport matplotlib.ticker as tickerimport matplotlib.dates as datesplt.figure(figsize=(12, 8))plt.plot(df[&#x27;Time&#x27;], df[&#x27;Temp&#x27;])plt.xlabel(&#x27;Time&#x27;)plt.ylabel(&#x27;Temp (C)&#x27;)# 自定义刻度ax = plt.gca()ax.xaxis.set_major_locator(dates.DayLocator(interval=1))     # 主刻度为 每天ax.xaxis.set_major_formatter(dates.DateFormatter(&#x27;00\\n%Y-%m-%d&#x27;))ax.xaxis.set_minor_locator(dates.HourLocator(interval=1))   # 副刻度为 每小时ax.xaxis.set_minor_formatter(dates.DateFormatter(&#x27;%H&#x27;))ax.yaxis.set_major_locator(ticker.MultipleLocator(10))plt.show()\n\n\n\n\n\n时间字符串格式\nref: https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes\n\n\n\n\nDirective\nMeaning\nExample\n\n\n\n%a\nWeekday\nSun, Mon, …, Sat (en_US)\n\n\n%A\nWeekday  full name.\nSunday, Monday, …, Saturday (en_US)\n\n\n%w\nWeekday as a decimal number, where 0 is Sunday .\n0, 1, …, 6\n\n\n%d\nDay of the month as a zero-padded decimal number.\n01, 02, …, 31\n\n\n%b\nMonth as locale’s abbreviated name.\nJan, Feb, …, Dec (en_US);\n\n\n%B\nMonth as locale’s full name.\nJanuary, February, …, December (en_US);\n\n\n%m\nMonth as a zero-padded decimal number.\n01, 02, …, 12\n\n\n%y\nYear without century as a zero-padded decimal number.\n00, 01, …, 99\n\n\n%Y\nYear with century as a decimal number.\n0001, 0002, …, 2013, 2014, …, 9998, 9999\n\n\n%H\nHour (24-hour clock) as a zero-padded decimal number.\n00, 01, …, 23\n\n\n%I\nHour (12-hour clock) as a zero-padded decimal number.\n01, 02, …, 12\n\n\n%p\nLocale’s equivalent of either AM or PM.\nAM, PM (en_US);\n\n\n%M\nMinute as a zero-padded decimal number.\n00, 01, …, 59\n\n\n%S\nSecond as a zero-padded decimal number.\n00, 01, …, 59\n\n\n%f\nMicrosecond as a decimal number, zero-padded to 6 digits.\n000000, 000001, …, 999999\n\n\n%z\nUTC offset in the form ±HHMM[SS[.ffffff]]\n(empty), +0000, -0400, +1030, +063415, -030712.345216\n\n\n%Z\nTime zone name (empty string if the object is naive).\n(empty), UTC, GMT\n\n\n%j\nDay of the year as a zero-padded decimal number.\n001, 002, …, 366\n\n\n%U\nWeek number of the year (Sunday as the first day)\n00, 01, …, 53\n\n\n%W\nWeek number of the year (Monday as the first day)\n00, 01, …, 53\n\n\n%c\nLocale’s appropriate date and time representation.\nTue Aug 16 21:30:00 1988 (en_US);\n\n\n%x\nLocale’s appropriate date representation.\n08&#x2F;16&#x2F;88 (None);\n\n\n%X\nLocale’s appropriate time representation.\n21:30:00 (en_US);\n\n\n%%\nA literal ‘%’ character.\n%\n\n\n# === 1. 获取当前时间，返回指定的字符串 ===import time now = time.strftime(&#x27;%Y-%m-%d %H:%M:%S&#x27;)print(now)from datetime import datetimenow = datetime.now().strftime(&#x27;%Y-%m-%d %a %H:%M:%S&#x27;)print(now)# === 2. 将时间字符串， 转化为时间对象 ===from datetime import datetimedt = datetime.strptime(&#x27;2023-01-01 12:00:00&#x27;, &#x27;%Y-%m-%d %H:%M:%S&#x27;)import pandas as pdpd_dt = pd.to_datetime(&#x27;2023-01-01 12:00&#x27;, format=&#x27;%Y-%m-%d %H:%M&#x27;)print(dt)print(pd_dt)\n","categories":["sci"],"tags":["pandas"]},{"title":"pandas时间序列及绘图","url":"/2018/07/06/sci-pandas/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-pandas%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%8F%8A%E7%BB%98%E5%9B%BE/","content":"1. 由字符串格式生成时间数据import pandas as pdimport numpy as np# string datetime --&gt; pandas datetimedt_start = &#x27;2018-07-04 12:00&#x27;pd_dt_start = pd.datetime.strptime(dt_start, &#x27;%Y-%m-%d %H:%M&#x27;)print(dt_start)         # 2018-07-04 12:00print(pd_dt_start)      # 2018-07-04 12:00:00\n\n\n\n2. 生成时间序列# pandas datetime rangedt_list = pd.date_range(&#x27;2018-07-04 09:00&#x27;, &#x27;2018-07-05 09:00&#x27;, freq=&#x27;H&#x27;)print(dt_list)# 构建 DataFramedf = pd.DataFrame(dt_list, columns=[&#x27;Time&#x27;])                # 将时间序列作为 &#x27;Time&#x27; 列df[&#x27;Temp&#x27;] = np.random.normal(30, 5, size=len(dt_list))     # 添加一列温度数据，&#x27;Temp&#x27;print(df)df.to_csv(&#x27;data.csv&#x27;)    # 保存为csv文件\n\n3. 读取文件中的时间# csv file datetime --&gt; pandas datetimedf = pd.read_csv(&#x27;data.csv&#x27;)     # 读取csv文件print(df[&#x27;Time&#x27;].head())         # dtype应该是datetime64[ns]； 如dtype是object，需转换一下df[&#x27;Time&#x27;] = pd.to_datetime(df[&#x27;Time&#x27;])     # 调用pd.to_datetime 转换print(df[&#x27;Time&#x27;].head())\n\n4. 数据筛选df = df[[&#x27;Time&#x27;, &#x27;Temp&#x27;]].dropna()      # 去除异常数据df = df[df[&#x27;Time&#x27;] &gt;= pd_dt_start]      # 时间筛选df = df[df[&#x27;Temp&#x27;] &lt;= 35.0]             # 温度筛选print(df[&#x27;Time&#x27;].head())\n\n5. 绘图import matplotlib.pyplot as pltimport matplotlib.ticker as tickerimport matplotlib.dates as datesplt.figure(figsize=(12, 8))plt.plot(df[&#x27;Time&#x27;], df[&#x27;Temp&#x27;])plt.xlabel(&#x27;Time&#x27;)plt.ylabel(&#x27;Temp (C)&#x27;)# 自定义刻度ax = plt.gca()ax.xaxis.set_major_locator(dates.DayLocator(interval=1))     # 主刻度为 每天ax.xaxis.set_major_formatter(dates.DateFormatter(&#x27;00\\n%Y-%m-%d&#x27;))ax.xaxis.set_minor_locator(dates.HourLocator(interval=1))   # 副刻度为 每小时ax.xaxis.set_minor_formatter(dates.DateFormatter(&#x27;%H&#x27;))ax.yaxis.set_major_locator(ticker.MultipleLocator(10))plt.show()\n\n\n\n\n\n时间字符串格式\nref: https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes\n\n\n\n\nDirective\nMeaning\nExample\n\n\n\n%a\nWeekday\nSun, Mon, …, Sat (en_US)\n\n\n%A\nWeekday  full name.\nSunday, Monday, …, Saturday (en_US)\n\n\n%w\nWeekday as a decimal number, where 0 is Sunday .\n0, 1, …, 6\n\n\n%d\nDay of the month as a zero-padded decimal number.\n01, 02, …, 31\n\n\n%b\nMonth as locale’s abbreviated name.\nJan, Feb, …, Dec (en_US);\n\n\n%B\nMonth as locale’s full name.\nJanuary, February, …, December (en_US);\n\n\n%m\nMonth as a zero-padded decimal number.\n01, 02, …, 12\n\n\n%y\nYear without century as a zero-padded decimal number.\n00, 01, …, 99\n\n\n%Y\nYear with century as a decimal number.\n0001, 0002, …, 2013, 2014, …, 9998, 9999\n\n\n%H\nHour (24-hour clock) as a zero-padded decimal number.\n00, 01, …, 23\n\n\n%I\nHour (12-hour clock) as a zero-padded decimal number.\n01, 02, …, 12\n\n\n%p\nLocale’s equivalent of either AM or PM.\nAM, PM (en_US);\n\n\n%M\nMinute as a zero-padded decimal number.\n00, 01, …, 59\n\n\n%S\nSecond as a zero-padded decimal number.\n00, 01, …, 59\n\n\n%f\nMicrosecond as a decimal number, zero-padded to 6 digits.\n000000, 000001, …, 999999\n\n\n%z\nUTC offset in the form ±HHMM[SS[.ffffff]]\n(empty), +0000, -0400, +1030, +063415, -030712.345216\n\n\n%Z\nTime zone name (empty string if the object is naive).\n(empty), UTC, GMT\n\n\n%j\nDay of the year as a zero-padded decimal number.\n001, 002, …, 366\n\n\n%U\nWeek number of the year (Sunday as the first day)\n00, 01, …, 53\n\n\n%W\nWeek number of the year (Monday as the first day)\n00, 01, …, 53\n\n\n%c\nLocale’s appropriate date and time representation.\nTue Aug 16 21:30:00 1988 (en_US);\n\n\n%x\nLocale’s appropriate date representation.\n08&#x2F;16&#x2F;88 (None);\n\n\n%X\nLocale’s appropriate time representation.\n21:30:00 (en_US);\n\n\n%%\nA literal ‘%’ character.\n%\n\n\n# === 1. 获取当前时间，返回指定的字符串 ===import time now = time.strftime(&#x27;%Y-%m-%d %H:%M:%S&#x27;)print(now)from datetime import datetimenow = datetime.now().strftime(&#x27;%Y-%m-%d %a %H:%M:%S&#x27;)print(now)# === 2. 将时间字符串， 转化为时间对象 ===from datetime import datetimedt = datetime.strptime(&#x27;2023-01-01 12:00:00&#x27;, &#x27;%Y-%m-%d %H:%M:%S&#x27;)import pandas as pdpd_dt = pd.to_datetime(&#x27;2023-01-01 12:00&#x27;, format=&#x27;%Y-%m-%d %H:%M&#x27;)print(dt)print(pd_dt)\n","categories":["sci"],"tags":["pandas"]},{"title":"pycharm配置pyqt5-tools","url":"/2018/06/13/python/pycharm%E9%85%8D%E7%BD%AEpyqt5-tools/","content":"pip 安装 pyqt5-toolspip install pyqt5-tools -i https://pypi.mirrors.ustc.edu.cn/simple/\n\n启动 pycharm， 打开 Settings -&gt; Tools -&gt; External Tools\n点击+，添加工具\n\n添加 pyqtdesigner\n\n\n- Name:  pyqtdesigner- Program:  C:\\......\\designer.exe- Working dir:  $ProjectFileDir$\n\n\n添加 pyuic5\n\n- Name:  pyuic5- Program:  C:\\......\\pyuic5.exe- Arguments:  $FileName$ -o $FileNameWithoutExtension$.py- Working dir:  $FileDir$\n","categories":["python"],"tags":["python","pycharm","pyqt5"]},{"title":"python调用ffmpeg处理视频-提取图片","url":"/2018/04/13/python/python-%E8%B0%83%E7%94%A8ffmpeg%E5%A4%84%E7%90%86%E8%A7%86%E9%A2%91-%E6%8F%90%E5%8F%96%E5%9B%BE%E7%89%87/","content":"ffmpeg 使用说明查看使用说明：ffmpeg -h。\n# usage: ffmpeg [options] [[infile options] -i infile]... &#123;[outfile options] outfile&#125;...# options:-ss:   set the start time offset-f:    force format-t:    record or transcode &quot;duration&quot; seconds of audio/video-r     set frame rate (Hz value, fraction or abbreviation)-y:    overwrite output files\n\n\n\n遍历文件夹中的所有视频文件, 提取特定时间点的图片import os# 提取特定时间点（第12s）的图片# ffmpeg -ss 0:0:12 -i xxx.mp4 -t 0.01 -f image2 yyy.jpg -ystr = &#x27;c:/users/xxxx/ffmpeg/ffmpeg.exe &#x27; +       &#x27;-ss 0:0:12 -i &#123;&#125; -t 0.01 -f image2 d:&#123;&#125;.jpg -y&#x27;for parent, dirnames, filenames in os.walk(&#x27;d:/videos/&#x27;):    for filename in filenames:        video_dir = os.path.join(parent, filename)        str_cmd = str.format(video_dir, filename)        print(str_cmd)        os.popen(str_cmd)\n\n定时提取视频中的图片import os# 第12s之后每隔1s钟，定时提取视频中的图片# ffmpeg -ss 0:0:12 -i xxx.mp4 -r 1 -f image2 yyy_%03d.jpg -ystr = &#x27;c:/users/xxxx/ffmpeg/ffmpeg.exe &#x27; +       &#x27;-ss 0:0:12 -i xxx.mp4 -r 1 -f image2 d:&#123;&#125;_%03d.jpg -y&#x27;str_cmd = strprint(str_cmd)os.popen(str_cmd)\n\n\n定时提取视频中的图片，并截取需要的区域import osimport timeimport cv2import matplotlib.pyplot as pltss = &#x27;c:/users/xxxx/ffmpeg/ffmpeg.exe &#x27; +       &#x27;-ss &#123;&#125; -i xxx.mp4 -t 0.01 -f image2 d:&#123;&#125;.jpg -y&#x27;for sec in range(60):    cmd = ss.format(str(sec), str(sec))    print(cmd)    os.popen(cmd)    time.sleep(0.5)for i in range(60):    img = cv2.imread(&#x27;d:&#123;&#125;.jpg&#x27;.format(str(i)), 0)    cut = img[803:835, 533:595]    # 二值化    # _, cut1 = cv2.threshold(cut, 50, 220, cv2.THRESH_BINARY)    cv2.imwrite(&#x27;d:/cuts/&#123;&#125;.jpg&#x27;.format(str(i)), cut)    plt.subplot(6, 10, i+1)    plt.imshow(cut)    # plt.title(i)    plt.xticks([]), plt.yticks([])# plt.savefig(&#x27;yyy.png&#x27;, dpi=300)plt.show()\n","categories":["python"],"tags":["python","ffmpeg"]},{"title":"excel常用函数：查找、线性插值","url":"/2017/12/14/office/excel-%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/","content":"\nref: excel_formulas_and_functions, https://support.office.com/en-us/article/overview-of-formulas-in-excel-ecfdc708-9162-49e8-b993-c311f47ca173?wt.mc_id=fsn_excel_formulas_and_functions\n\n0 示例表格\n\n\n\nA\nB\nC\n\n\n\n1\nNO\nkey\nvalue\n\n\n2\n1\n0\n0\n\n\n3\n2\n5\n25\n\n\n4\n3\n10\n100\n\n\n5\n4\n15\n225\n\n\n6\n5\n20\n400\n\n\n7\n6\n25\n625\n\n\n8\n7\n30\n900\n\n\n9\n8\n35\n1225\n\n\n10\n9\n40\n1600\n\n\n11\n10\n45\n2025\n\n\n1 已知key，查找对应value\nVLOOKUP(lookup value, lookup array, column, range lookup)\n\n\n\n\n\nF\nG\nH\n\n\n\n4\nkey\nFormula\nvalue\n\n\n5\n20\n&#x3D;VLOOKUP(F5,B2:C11,2)\n400\n\n\n6\n25\n&#x3D;VLOOKUP(F6,B2:C11,2,FALSE)\n625\n\n\n7\n24\n&#x3D;VLOOKUP(F7,B2:C11,2)\n400\n\n\n8\n24\n&#x3D;VLOOKUP(F8,B2:C11,2,FALSE)\n#N&#x2F;A\n\n\n\n\n2 已知value，查找对应序号\nMATCH(lookup_value, lookup_array, [match_type])\nmatch_type：0 精确；1小于；-1大于\n\n\n\n\n\n\n\nF\nG\nH\n\n\n\n4\nvalue\nFormula\nNO\n\n\n5\n400\n&#x3D;MATCH(F5,C2:C11)\n5\n\n\n6\n500\n&#x3D;MATCH(E6,C2:C11,0)\n#N&#x2F;A\n\n\n7\n500\n&#x3D;MATCH(F7,C2:C11,1)\n5\n\n\n3 已知在数组中的序号，查找value\nINDEX(array, row number )\n\n\n\n\n\nF\nG\nH\n\n\n\n4\nNO\nFormula\nvalue\n\n\n5\n5\n&#x3D;INDEX(C2:C11,F5)\n400\n\n\n6\n6\n&#x3D;INDEX(C2:C11,F6)\n625\n\n\n4 已知 value1，查找偏移n_rows行，n_cols列后对应的 value2\nOFFSET(reference, rows, cols, [height], [width])\t\t\t\nvalue1 设为数组的表头A1, 即参数 reference\n\n\n\n\n\nF\nG\nH\nI\n\n\n\n4\nn_rows\nn_clns\nFormula\nvalue2\n\n\n5\n5\n1\n&#x3D;OFFSET(A1,F5,G5)\n20\n\n\n6\n5\n2\n&#x3D;OFFSET(A1,F6,G6)\n400\n\n\n5 线性趋势\nTREND(known_y’s, [known_x’s], [new_x’s], [const])\n\n\n\n\n\nF\nG\nH\n\n\n\n4\nNO\nFormula\nkey\n\n\n5\n4\n&#x3D;TREND(B2:B11,A2:A11,K5)\n15\n\n\n6\n4.5\n&#x3D;TREND(B2:B11,A2:A11,K6)\n17.5\n\n\n6 线性插值\n线性插值需要用到3个组合函数\t\t\nMATCH(key,x_s)\t\t\t\nOFFSET(y_title,MATCH(key,x_s),,2)\t\t\t\nOFFSET(x_title,MATCH(key,x_s),,2)\t\t\t\nTREND(OFFSET(y_title,MATCH(key,x_s),,2),OFFSET(x_title,MATCH(key,x_s),,2),key)\n\n\n\n\n\nF\nG\nH\n\n\n\n4\nNO\nFormula\nvalue\n\n\n5\n20\n&#x3D;TREND(OFFSET(C1,MATCH(K5,B2:B11),,2),\n400\n\n\n\n\nOFFSET(B1,MATCH(K5,B2:B11),,2),K5)\n\n\n\n6\n24\n&#x3D;TREND(OFFSET(C1,MATCH(K6,B2:B11),,2),\n580\n\n\n\n\nOFFSET(B1,MATCH(K6,B2:B11),,2),K6)\n\n\n\n7\n25\n&#x3D;TREND(OFFSET(C1,MATCH(K7,B2:B11),,2),\n625\n\n\n\n\nOFFSET(B1,MATCH(K7,B2:B11),,2),K7)\n\n\n\n","categories":["office"],"tags":["excel"]},{"title":"excel调用有道翻译api","url":"/2017/11/12/office/excel-%E8%B0%83%E7%94%A8%E6%9C%89%E9%81%93%E7%BF%BB%E8%AF%91/","content":"有道翻译 API 简介\nhttp://fanyi.youdao.com/translate?&amp;i=&quot;text&quot;&amp;doctype=xml\n\n参数说明：\n\ni=&quot;text&quot;，引号内为要翻译的单词或句子，中文、英文都行，默认是中英互译；\ndoctype=xml，指定返回值的格式为 xml 格式，还可以是 text， json等\n\n其他可选：\n\ntype，默认是type=auto；可以指定语言,比如中文-&gt;日语：type=zh_cn2ja\nversion，指定 api 版本等\n\n在 excel 里调用有道翻译 api\n首先用 WEBSERVICE 函数获得调用 api，返回值格式指定为 xml；\n\n然后用 FILTERXML 函数解析 xml，翻译的结果在 &lt;translation&gt; 标签里面\n\n完整代码如下：\n\n\n=FILTERXML(WEBSERVICE(&quot;http://fanyi.youdao.com/translate?&amp;i=&quot;&amp;A1&amp;&quot;&amp;doctype=xml&quot;),&quot;//translation&quot;)\n\n\n这个 api 有调用次数的限制，且用且珍惜。\n","categories":["office"],"tags":["excel"]},{"title":"python 调用 CoolProp 计算介质的物性","url":"/2017/10/24/python/Python-%E4%BD%BF%E7%94%A8CoolProp%E8%AE%A1%E7%AE%97%E4%BB%8B%E8%B4%A8%E7%9A%84%E7%89%A9%E6%80%A7/","content":"之前常用的物性计算软件是 Nist Refprop，在 Excel 中计算时调用起来非常好使。但是计算方程组求解时 Excel 就不太好用了。。\n发现了一个开源软件：CoolProp，它支持多种程序或语言的调用，接口比较好；对 python 的支持也非常方便。\n1. 安装 CoolProp\n直接使用 pip 安装：\n\npip install CoolProp\n\n\n或者安装开发版（稳定版偶尔有编译问题，导致安装失败）：\n\n# install the latest nightly release versionpip install -vvv --pre --trusted-host www.coolprop.dreamhosters.com --find-links http://www.coolprop.dreamhosters.com/binaries/Python/ -U --force-reinstall CoolProp\n\n\n2. 基本使用2.1 参数说明\nref: http://www.coolprop.org/coolprop/HighLevelAPI.html\n\n\n\n\n\n\n\n\n\n\n\nD, DMASS\nkg&#x2F;m^3\nMass density\n密度\n\n\nH, HMASS\nJ&#x2F;kg\nEnthalpy\n焓\n\n\nP\nPa\nPressure\n压力\n\n\nQ\nmol&#x2F;mol\nMass vapor quality\n气体占比\n\n\nT\nK\nTemp\n温度\n\n\nA, SPEED_OF_SOUND\nm&#x2F;s\nSpeed of sound\n声速\n\n\nCONDUCTIVITY, L\nW&#x2F;m&#x2F;K\nThermal conductivity\n热导率\n\n\nCVMASS, O\nJ&#x2F;kg&#x2F;K\nMass specific constant volume specific heat\n定容比热容\n\n\nC, CPMASS\nJ&#x2F;kg&#x2F;K\nMass specific constant pressure specific heat\n定压比热容\n\n\nI, SURFACE_TENSION\nN&#x2F;m\nSurface tension\n表面张力\n\n\nM, MOLARMASS\nkg&#x2F;mol\nMolar mass\n摩尔质量\n\n\nPCRIT\nPa\nPressure at the critical point\n临界压力\n\n\nTCRIT\nK\nTemperature at the critical point\n临界温度\n\n\nV, VISCOSITY\nPa·s\nViscosity\n粘度\n\n\nZ\n\nCompressibility factor\n压缩系数\n\n\n\n示例1：\n\nfrom CoolProp.HumidAirProp import HAPropsSIfrom CoolProp.CoolProp import PropsSIp = 101325t = PropsSI(&#x27;T&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 0, &#x27;Water&#x27;)print(&#x27;\\n-------------CoolProp-------------&#x27;)print(&#x27;- 在 &#123;&#125; Pa(abs) 时，水的饱和温度: &#123;:.2f&#125; K \\n&#x27;.format(p, t))    # 373.12 K\n\n\n示例2：\n\nfrom CoolProp.HumidAirProp import HAPropsSIfrom CoolProp.CoolProp import PropsSIparas = &#123;&#x27;D&#x27;: &#x27;kg/m^3&#x27;,          &#x27;H&#x27;: &#x27;J/kg&#x27;,          &#x27;A&#x27;: &#x27;J/kg/K&#x27;,         &#x27;L&#x27;: &#x27;W/m/K&#x27;,         &#x27;O&#x27;: &#x27;J/kg/K&#x27;,         &#x27;C&#x27;: &#x27;J/kg/K&#x27;,         &#x27;M&#x27;: &#x27;kg/mol&#x27;,         &#x27;V&#x27;: &#x27;Pa.S&#x27;,         &#x27;Z&#x27;: &#x27;-&#x27;&#125;for (k, v) in paras.items():        v1 = CP.PropsSI(k, &#x27;T&#x27;, 273.15+20, &#x27;P&#x27;, 101325, &#x27;water&#x27;)    print(f&#x27;  &#123;k&#125;: &#123;v1:10.4f&#125; &#123;v&#125;&#x27;)\n\n\n\n2.2 直接定义一个类，方便调用from CoolProp.CoolProp import PropsSIclass WaterProp(object):    # 求特定压力下的物性    def __init__(self, p=101325):        self.T = PropsSI(&#x27;T&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 0, &#x27;Water&#x27;)          # 饱和温度        self.C = PropsSI(&#x27;C&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 0, &#x27;Water&#x27;)          # 比热容        self.D_l = PropsSI(&#x27;D&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 0, &#x27;Water&#x27;)        # 液体密度        self.D_v = PropsSI(&#x27;D&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 1, &#x27;Water&#x27;)        # 蒸汽密度        self.H_l = PropsSI(&#x27;H&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 0, &#x27;Water&#x27;)        self.H_v = PropsSI(&#x27;H&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 1, &#x27;Water&#x27;)        self.H = self.H_v - self.H_l                            # 汽化潜热        self.L_l = PropsSI(&#x27;L&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 0, &#x27;Water&#x27;)        # 导热系数        self.I_l = PropsSI(&#x27;I&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 0, &#x27;Water&#x27;)        # 表面张力        self.U_l = PropsSI(&#x27;V&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 0, &#x27;Water&#x27;)        # 动力粘度        self.V_l = self.U_l / self.D_l                          # 运动粘度        self.Prl = PropsSI(&#x27;Prandtl&#x27;, &#x27;P&#x27;, p, &#x27;Q&#x27;, 0, &#x27;Water&#x27;)  # 普朗特数        self.print_prop()    def print_prop(self):        print(&#x27;\\n-------------CoolProp-------------&#x27;)        print(&#x27;- &#123;&#125;: &#123;:&gt;10s&#125;      &#123;:&lt;10&#125;&#x27;.format(&#x27;介质名称&#x27;, &#x27;Water&#x27;,    &#x27;单位&#x27;))        print(&#x27;- &#123;&#125;: &#123;:&gt;10.2f&#125;    &#123;:&lt;10&#125;&#x27;.format(&#x27;计算压力&#x27;, p,          &#x27;Pa&#x27;))        print(&#x27;- &#123;&#125;: &#123;:&gt;10.2f&#125;    &#123;:&lt;10&#125;&#x27;.format(&#x27;饱和温度&#x27;, self.T,     &#x27;K&#x27;))        print(&#x27;- &#123;&#125;: &#123;:&gt;10.2f&#125;    &#123;:&lt;10&#125;&#x27;.format(&#x27;液体密度&#x27;, self.D_l,   &#x27;kg/m3&#x27;))        print(&#x27;- &#123;&#125;: &#123;:&gt;10.4f&#125;    &#123;:&lt;10&#125;&#x27;.format(&#x27;蒸汽密度&#x27;, self.D_v,   &#x27;kg/m3&#x27;))        print(&#x27;- &#123;&#125;: &#123;:&gt;10.2f&#125;    &#123;:&lt;10&#125;&#x27;.format(&#x27;汽化潜热&#x27;, self.H,     &#x27;J/kg&#x27;))        print(&#x27;- &#123;&#125;: &#123;:&gt;10.4f&#125;    &#123;:&lt;10&#125;&#x27;.format(&#x27;导热系数&#x27;, self.L_l,   &#x27;W/m.K&#x27;))        print(&#x27;- &#123;&#125;: &#123;:&gt;10.4e&#125;    &#123;:&lt;10&#125;&#x27;.format(&#x27;运动粘度&#x27;, self.V_l,   &#x27;m2/s&#x27;))        print(&#x27;- &#123;&#125;: &#123;:&gt;10.4f&#125;    &#123;:&lt;10&#125;&#x27;.format(&#x27;普朗特数&#x27;, self.Prl,   &#x27;-&#x27;))WaterProp(p=101325)&#x27;&#x27;&#x27;- 介质名称:      Water      单位- 计算压力:  101325.00    Pa- 饱和温度:     373.12    K- 液体密度:     958.37    kg/m3- 蒸汽密度:     0.5977    kg/m3- 汽化潜热: 2256471.59    J/kg- 导热系数:     0.6772    W/m.K- 运动粘度: 2.9389e-07    m2/s- 普朗特数:     1.7533    &#x27;&#x27;&#x27;\n\n\n3. 湿空气计算CoolProp 可以直接计算 湿空气的物性。\n\n参数说明：\n\n\n\n\n\n\n\n\n\n\n\nP\nPa\nPressure\n压力\n\n\nT\nK\nDry-Bulb Temp\n干球温度\n\n\nTwb\nK\nWet-Bulb Temp\n湿球温度\n\n\nTdp\nK\nDew-Point Temp\n露点温度\n\n\nR\n\nRelative humidity\n相对湿度\n\n\nW\nkg&#x2F;kga\nHumidity Ratio\n含湿量\n\n\nH\nJ&#x2F;kga\nMixture Enthalpy\n比焓\n\n\n\n示例：\n\nfrom CoolProp.HumidAirProp import HAPropsSIw = HAPropsSI(&#x27;W&#x27;, &#x27;T&#x27;, 273.15+25, &#x27;P&#x27;, 101325, &#x27;R&#x27;, 0.5)t_dp = HAPropsSI(&#x27;Tdp&#x27;, &#x27;T&#x27;, 273.15+25, &#x27;P&#x27;, 101325, &#x27;R&#x27;, 0.5)h = HAPropsSI(&#x27;H&#x27;, &#x27;T&#x27;, 273.15+25, &#x27;P&#x27;, 101325, &#x27;R&#x27;, 0.5)print(&#x27;\\n-------------CoolProp-------------&#x27;)print(&#x27;在 25℃ , 101325Pa 时，相对湿度为 50% 的湿空气, &#x27;)print(&#x27;- 含湿量为 &#123;:&gt;8.2%&#125;  kg/kga&#x27;.format(w))               # 0.99%print(&#x27;- 露点为   &#123;:&gt;8.2f&#125;  ℃&#x27;.format(t_dp-273.15))         # 13.87print(&#x27;- 比焓为   &#123;:&gt;8.2f&#125;  kJ/kg&#x27;.format(h/1000))          # 50.42\n\n\n\n更多用法见官网 : http://www.coolprop.org/coolprop/wrappers/Python/index.html#python\n\n","categories":["python"],"tags":["python","coolprop"]},{"title":"excel调用 Nist RefProp 计算介质的物性","url":"/2017/09/09/office/excel-%E8%B0%83%E7%94%A8Nist-RefProp%E8%AE%A1%E7%AE%97%E4%BB%8B%E8%B4%A8%E7%9A%84%E7%89%A9%E6%80%A7/","content":"Nist Refprop 是一个常用到的物性计算软件，在 Excel 中调用起来也比较方便。\n1. 安装 Nist Refprop V9.1\n官网\nNIST2391.EXE\n\n安装完之后：\n\n32位系统默认安装路径是 C:\\Program Files\\REFPROP\n64位系统默认安装路径是 C:\\Program Files (x86)\\REFPROP\n\n\n\n2. Excel 配置\n64位系统：先将 C:\\Program Files (x86) 目录下的 REFPROP 文件夹全部复制到 C:\\Program Files 内。。。\n\n\n新建一个excel表格\n\n打开 文件 - 选项 - 加载项\n\n选择下方的 管理 - excel加载项\n\n点击 转到 - 浏览\n\n选择路径 C:\\Program Files\\REFPROP\\REFPROP.XLA，确定\n\n在单元格里输入 =RefpropXLSVersionNumber() \n\n应该返回 9.1 ，表明配置正确。\n\n\n3. 使用3.1 常用函数\n\n\n函数名\n名称\n单位\n\n\n\nTemperature\n温度\nK\n\n\nPressure\n压力\nMPa\n\n\nDensity\n密度\nkg&#x2F;m^3\n\n\nCompressibilityFactor\n压缩比\n\n\n\nLiquidDensity\n液体密度\nkg&#x2F;m^3\n\n\nVaporDensity\n蒸汽密度\nkg&#x2F;m^3\n\n\nVolume\n体积\nm^3&#x2F;kg\n\n\nEnergy\n能量\nkJ&#x2F;kg\n\n\nEnthalpy\n焓\nkJ&#x2F;kg\n\n\nEntropy\n熵\nkJ&#x2F;kg-K\n\n\nIsochoricHeatCapacity\n等容热容量 (Cv)\nkJ&#x2F;kg-K\n\n\nIsobaricHeatCapacity\n等压热容量 (Cp)\nkJ&#x2F;kg-K\n\n\nSpeedOfSound\n声速\nm&#x2F;s\n\n\nHeatOfVaporization\n汽化潜热\nkJ&#x2F;kg\n\n\nVolumeExpansivity\n体积膨胀率\n1&#x2F;K\n\n\nViscosity\n粘性\nuPa-s\n\n\nKinematicViscosity\n粘性\ncm^2&#x2F;s\n\n\nThermalConductivity\n导热系数\nmW&#x2F;m-K\n\n\nPrandtl\n普朗特数\n\n\n\nSurfaceTension\n表面张力\nmN&#x2F;m\n\n\nDielectricConstant\n介电常数\n\n\n\nMolarMass\n摩尔质量\ng&#x2F;mol\n\n\nMoleFraction\n摩尔分数\nmol&#x2F;mol\n\n\nMassFraction\n质量分数\ng&#x2F;g\n\n\n3.2 使用说明result &#x3D; Float ( FluidName, InpCode, Units, Prop1, Prop2 )  \n\nFluidName: &quot;air&quot;, &quot;water&quot;, &quot;oxygen&quot;, &quot;nitrogen&quot;,      &quot;hydrogen&quot;, &quot;carbon dioxide”, &quot;methane&quot;, etc…\n\nInpCode: \n\n&quot;TP&quot;:     特定温度、压力下，Prop1 为温度，Prop2 为压力\n&quot;Tliq&quot;, &quot;Pvap&quot;:     饱和温度、压力下，Prop1 为温度&#x2F;压力，Prop2 为空\n\n\nUnits: &quot;SI&quot; \n\nProp1: value1\n\nProp2: value2\n\n\n\n示例1\n\n标态下空气密度（0℃, 0.101325MPa）\n公式 = Density(&quot;air&quot;,&quot;TP&quot;,&quot;SI&quot;,273.15,0.101325)\n返回值：1.293 (kg&#x2F;m^3)\n\n示例2\n\n标准大气压下水蒸汽饱和温度（0.101325MPa）\n\n公式 = Temperature(&quot;water&quot;,&quot;Pliq&quot;,&quot;SI&quot;,0.101325)-273.15\n\n返回值：99.97 (℃)\n\n也可以直接使用摄氏度单位制：\n\n公式 = Temperature(&quot;water&quot;,&quot;Pliq&quot;,&quot;SI with C&quot;,0.101325)\n\n返回值：99.97 (℃)\n\n\n示例3\n\n计算水蒸气的汽化潜热（0.101325MPa）\n\n公式 = HeatOfVaporization(&quot;water&quot;,&quot;Pvap&quot;,&quot;SI&quot;,0.101325)\n\n返回值：2256.4 (kJ&#x2F;kg)\n\n也可以使用焓计算：= Enthalpy(&quot;water&quot;,&quot;Pvap&quot;,&quot;SI&quot;,0.101325) - Enthalpy(&quot;water&quot;,&quot;Pliq&quot;,&quot;SI&quot;,0.101325)\n\n返回值：2256.4 (kJ&#x2F;kg)\n\n\n\n更多用法见官方帮助文档 : https://www.nist.gov/sites/default/files/documents/srd/REFPROP9.PDF\n\n","categories":["office"],"tags":["excel","RefProp"]},{"title":"git 常用命令","url":"/2017/09/04/apps/git-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","content":"1. 新建远程仓库\n在 github.com 上新建 repository ：xxxx , 链接为：https://github.com/shenbo/xxxx.git\n本地新建文件夹：xxxx\n\ncd ~/xxxxgit initgit add .git commit -m &quot;first commit&quot;git remote add origin https://github.com/shenbo/xxxx.gitgit push -u origin master\n\n\n2. 远程仓库操作\n检出仓库：git clone https://github.com/shenbo/xxxx.git\n拉取仓库：git pull [remoteName] [localBranchName]\n推送仓库：git push [remoteName] [localBranchName]\n显示日志：git log -1 --stat  # 显示最近一次commit的更改统计概述\n\n3. 放弃本地修改，强制更新git fetch --allgit reset --hard origin/master# 删除 untracked 文件或文件夹，不含.gitignoregit clean -df\n\n3. 暂存本地修改# 暂存git stash# 恢复暂存git stash listgit stash apply 0# 删除暂存git stash clear\n\n4. 配置SSH4.1 生成 ssh key\n打开git bash，设置用户名，并生成ssh-key。\n\ngit config --global user.name &quot;shenbo&quot;git config --global user.email &quot;shenbo@hotmail.com&quot;ssh-keygen -t rsa -b 4096 -C &quot;shenbo@hotmail.com&quot;eval $(ssh-agent -s)     # start the ssh-agent in the backgroundssh-add ~/.ssh/id_rsa    # add SSH private key to the ssh-agentls ~/.ssh                # lists the files in your .ssh directory\n\n\n现在github推荐使用新的 Ed25519 加密算法https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\n\ngit config --global user.name &quot;shenbo&quot;git config --global user.email &quot;shenbo@hotmail.com&quot;ssh-keygen -t ed25519 -C &quot;shenbo@hotmail.com&quot;eval $(ssh-agent -s)         # start the ssh-agent in the backgroundssh-add ~/.ssh/id_ed25519    # add SSH private key to the ssh-agent\n\n4.2 将 ssh 公钥添加到远程服务器如果是连接远程服务器，可使用 ssh-copy-id 命令。\nssh-copy-id -i ~.ssh/id_ed25519.pub user@xxx.xxx.xxx.xxx# 注意如果是使用 win10 的 powershell 终端，会报错&quot; 无法将ssh-copy-id识别为....&quot;，# 这是因为 win10 自带的 openssh 命令集不完整，# 只需要打开git bash终端，运行以上命令就可以了\n\n4.3 将 ssh 公钥添加 github.com\n复制~/.ssh/id_ed25519.pub\n\n在 github.com 个人设置页面，点击新建或添加 SSH key，将id_ed25519.pub内容复制进去。\n\n测试 git 客户端与 github 是否连接成功。\n\n\nssh -T git@github.com\n\n\n如果连接报错ssh: connect to host github.com port 22: Connection &gt; refused， 打开&#x2F;新建~/.ssh/config，修改内容如下，重新测试。\n\nHost github.comUser shenbo@hotmail.comHostname ssh.github.comPreferredAuthentications publickeyIdentityFile ~/.ssh/id_ed25519Port 443\n\n\n5. 永久删除文件(包括历史记录)\nref： https://help.github.com/articles/remove-sensitive-data\n\n\n5.1 删除文件命令：\n\ngit filter-branch --force --index-filter &#x27;git rm --cached --ignore-unmatch PATH-TO-YOUR-FILE-WITH-SENSITIVE-DATA&#x27; --prune-empty --tag-name-filter cat -- --all\n\n\n5.2 删除文件夹命令：\n\ngit filter-branch --force --index-filter \\&#x27;git rm --cached -r --ignore-unmatch PATH-TO-YOUR-FLODER-WITH-SENSITIVE-DATA&#x27; \\--prune-empty --tag-name-filter cat -- --all\n\n\n5.3 把文件或文件夹添加到.gitignore文件里：\n\necho &quot;YOUR-FILE-WITH-SENSITIVE-DATA&quot; &gt;&gt; .gitignoregit add .gitignoregit commit -m &quot;Add YOUR-FILE-WITH-SENSITIVE-DATA to .gitignore&quot;\n\n\n5.4 然后以强制覆盖的方式推送repo, 命令如下:\n\ngit push origin master --force git push origin master --force --tags\n\n\n5.5 清理和回收空间：\n\ngit for-each-ref --format=&#x27;delete %(refname)&#x27; refs/original | git update-ref --stdingit reflog expire --expire=now --allgit gc --prune=now\n\n\n5.6 另外，可以通过 rev-list 命令来找到仓库记录中的大文件：\n\ngit rev-list --objects --all | grep &quot;$(git verify-pack -v .git/objects/pack/*.idx | sort -k 3 -n | tail -5 | awk &#x27;&#123;print$1&#125;&#x27;)&quot;\n","categories":["apps"],"tags":["git"]},{"title":"生日快乐","url":"/2017/06/26/yoyo/20170626-%E5%91%A8%E5%B2%81/","content":"\n可遇不可求的事\n此时此刻的你\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"python执行cmd命令-os.popen与subprocess","url":"/2017/06/04/python/python-%E6%89%A7%E8%A1%8Ccmd%E5%91%BD%E4%BB%A4/","content":"1. os.popen 命令python 内置的 os.popen 命令可以用于执行简单的命令。\nimport os# 直接运行的命令，如：打开记事本os.popen(&#x27;notepad&#x27;)# 获得运行的log或结果，如：列出文件清单r = os.popen(&#x27;tree&#x27;)print(r.read())\n\n2. subprocess 模块复杂一点的命令可以使用 subprocess 模块，也是 python 内置的，可以对输入&#x2F;输出进行操作；\n2.1 subprocess.call 命令import subprocess# 可显示运行log/结果subprocess.call(&#x27;pip list&#x27;, shell=True)# 可交互subprocess.call(&#x27;pip uninstall pip&#x27;, shell=True)# 返回值为错误代码retcode = subprocess.call(&#x27;tree&#x27;, shell=True)print(retcode)\n\n2.2 subprocess.Popen 命令import subprocess# 获得运行结果，一次读取所有，要等待命令运行结束p = subprocess.Popen(&#x27;ping baidu.com&#x27;, shell=True, stdout=subprocess.PIPE).stdoutprint(p.read().decode(&#x27;gbk&#x27;))# 获得运行结果，一次读取一行p = subprocess.Popen(&#x27;ping baidu.com&#x27;, shell=True, stdout=subprocess.PIPE)for line in iter(p.stdout.readline, b&#x27;&#x27;):    print(line.strip().decode(&#x27;gbk&#x27;))\n\n\nsubprocess.Popen 参数比较复杂，更多用法参见：帮助文档\n\n","categories":["python"],"tags":["python"]},{"title":"吃饭","url":"/2017/05/24/yoyo/20170524-%E5%90%83%E9%A5%AD/","content":"\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"蜜糖","url":"/2017/04/18/yoyo/20170418-%E8%9C%9C%E7%B3%96/","content":"\n草在结它的种子\n风在摇它的叶子\n你们坐着，不说话\n就十分美好\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"pip 常用命令","url":"/2017/04/02/python/python-pip%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","content":"1. 设置默认国内源\nWindows系统：\n\n命令行修改配置\npip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simplepip config set global.index-url https://pypi.mirrors.ustc.edu.cn/simple/# pip config list\n\n或手动修改&#x2F;新建文件 C:\\Users\\XXXX\\pip\\pip.ini ，内容为：\n[global]index-url = https://pypi.mirrors.ustc.edu.cn/simple/\n\n\n国内源：\n\n阿里云 http://mirrors.aliyun.com/pypi/simple/\n中国科技大学 https://pypi.mirrors.ustc.edu.cn/simple/\n清华大学 https://pypi.tuna.tsinghua.edu.cn/simple/\n\n\n\n加利福尼亚大学python扩展库（非官方）：\n\nhttps://www.lfd.uci.edu/~gohlke/pythonlibs/\n\n\n2. 更新所有安装包from pip._internal.utils.misc import get_installed_distributionsimport subprocessdef pip_upgrade_all():    for dist in get_installed_distributions():        print(dist)        ustc_source = &#x27;https://pypi.mirrors.ustc.edu.cn/simple/&#x27;        cmd = &#x27;pip install --upgrade &#123;&#125; -i &#123;&#125;&#x27;.format(dist.project_name, ustc_source)        subprocess.call(cmd, shell=True)pip_upgrade_all()\n\n\n\n3. 常用命令# 安装/升级包，指定国内源pip install -U tensorflow -i https://pypi.mirrors.ustc.edu.cn/simple/# 安装指定版本的包pip install tensorboard=1.8.0# 列出所有可以更新的包pip list -o# 从本地的 whl 文件安装pip install numpy-1.13.1+mkl-cp36-cp36m-win_amd64.whl\n\n4. 虚拟环境# 创建虚拟环境python -m venv .venv# 激活虚拟环境.venv/Scripts/activate","categories":["python"],"tags":["python"]},{"title":"发烧","url":"/2017/02/18/yoyo/20170218-%E5%8F%91%E7%83%A7/","content":"\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"raspberry pi 安装配置","url":"/2017/02/03/raspi/raspberry-pi-%E9%85%8D%E7%BD%AE/","content":"硬件准备\n树莓派3B，5V 2A充电器 + 充电线\nTF卡(&gt;8g，class10) + 读卡器\n无线路由器\n笔记本&#x2F;电脑\n显示器 + HDMI线\n\n软件准备\nRaspbian系统， https://www.raspberrypi.org/downloads/raspberry-pi-os/， （下载文件类似“201x-xx-xx-raspbian-buster-lite” ）\n\nWin32diskimager, https://sourceforge.net/projects/win32diskimager/ （用于烧录系统）\n\nSDCardFormatter, https://www.sdcard.org/ （非必需，用于SD卡格式化）\n\nputty （用于SSH；非必需，win10已自带openssh）\n\nVNC-Viewer （远程桌面）\n\n\n\n\n安装配置1. 制作系统盘\nTF卡装系统：将Raspbian系统文件 *.zip 解压，提取出 *.img 镜像文件 ，用 Win32diskimager 将 *.img 文件烧录至TF卡。\n\nSSH 服务：由于Raspbian系统默认关闭SSH，需要在TF卡根目录新建名字为 ssh 的文件或文件夹，开机后可自动启动SSH服务。\n\nWiFi配置：在TF卡根目录下新建 wpa_supplicant.conf 文件，填入以下内容并保存文件。\n\n\ncountry=CNctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdevupdate_config=1network=&#123;ssid=&quot;xxxx&quot;psk=&quot;12345678&quot;key_mgmt=WPA-PSKpriority=1&#125;\n\n2. 开机\n将TF卡插入树莓派，通电后自动开机；\nLED指示灯说明：PWR为电源，红色常亮；ACT为硬盘灯，绿色闪烁。\n\n3. SSH远程连接\n开机后WiFi自动连接(或用网线将pi与路由器连接)，进入路由器管理页面，找到raspi的ip。\n打开Powershell命令行，连接ip进入， 用户名为：pi，密码为：raspberry。\n或者直接ssh：\n\nssh pi@xxx.xxx.xxx.xxx\n\n4. 基本配置\n运行命令 sudo raspi-config\nNetwork Options： WiFi设置；\nInterfacing Options： ssh服务打开，vnc服务打开；\nAdvanced Options： Expand Filesystem。\n\n5. 笔记本端VNC-Viewer软件打开，输入ip连接。6. 启用root账户# 设置 root 账号的密码sudo passwd root# 启用 root 账号登录sudo passwd --unlock root# 测试su root\n\n7. 更换软件更新源。7.1 清华源\n\nref: https://mirrors.tuna.tsinghua.edu.cn/help/raspbian/\n\n\n运行命令 sudo nano /etc/apt/sources.list ，改为以下内容：\n\n# deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contribdeb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib\n\n运行命令 sudo nano /etc/apt/sources.list.d/raspi.list ，改为以下内容：\n\n# deb http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui\n7.2 中科大源\n\nref: https://mirrors.ustc.edu.cn/help/raspbian.htmlref: https://mirrors.ustc.edu.cn/help/ubuntu-ports.html直接运行：\n\nsudo sed -i &#x27;s|raspbian.raspberrypi.org|mirrors.ustc.edu.cn/raspbian|g&#x27; /etc/apt/sources.listsudo sed -i &#x27;s|//archive.raspberrypi.org|//mirrors.ustc.edu.cn/archive.raspberrypi.org|g&#x27; /etc/apt/sources.list.d/raspi.list\n\n当然也可以直接编辑 文件（需要使用 sudo）。删除原文件所有内容，用以下内容取代（以 Buster 示例）：\n# filename: /etc/apt/sources.list deb http://mirrors.ustc.edu.cn/raspbian/raspbian/ buster main contrib non-free rpi#deb-src http://mirrors.ustc.edu.cn/raspbian/raspbian/ buster main contrib non-free rpi# filename: /etc/apt/sources.list.d/raspi.listdeb http://mirrors.ustc.edu.cn/archive.raspberrypi.org/debian/ buster main ui#deb-src http://mirrors.ustc.edu.cn/archive.raspberrypi.org/debian/ buster main ui\n\n\nError:\nW: GPG 错误：http://mirrors.ustc.edu.cn/raspbian/raspbian buster InRelease: 由于没有公钥，无法验证下列签名： NO_PUBKEY &gt; [xxxxxxxxxxxxx]E: 仓库 “http://mirrors.ustc.edu.cn/raspbian/raspbian buster InRelease” 没有数字签名。N: 无法安全地用该源进行更新，所以默认禁用该源。N: 参见 apt-secure(8) 手册以了解仓库创建和用户配置方面的细节。 \n解决方法：sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys [xxxxxxxxxxxxxxx]\n\n7.3 更新、升级\n\n编辑此文件后， 使用 sudo apt-get update命令，更新软件列表。\n使用sudo apt-get upgrade命令，更新软件。\n\n8. 安装中文字体。sudo apt-get install ttf-wqy-zenhei \n\n9. 安装teamviewer, https://www.teamviewer.com/zhcn/download/linux/。wget https://download.teamviewer.com/download/linux/teamviewer-host_armhf.deb\n10. python\n安装pip3\n\nsudo apt install python3-venv python3-pip\n\n修改pip源, sudo nano ~/.pip/pip.conf ，改为以下内容：\n\n[global]index-url = https://pypi.mirrors.ustc.edu.cn/simple/\n\n或 用命令行修改配置\n\npip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple# pip config list\n\n11. zsh &amp; ohmyzsh参考 zsh &amp; oh-my-zsh 安装配置 \n","categories":["raspi"],"tags":["raspberry-pi"]},{"title":"正月初一登紫金山","url":"/2017/01/28/yoyo/20170128-%E7%B4%AB%E9%87%91%E5%B1%B1/","content":"\n青青紫金 悠悠我欣\n\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"横山徒步","url":"/2016/12/04/yoyo/20161204-%E6%A8%AA%E6%BA%AA/","content":"出去兜风，一不小心上新闻了。\n\n\n千人徒步越野 尽赏横山秋色\n2016-12-03 微江宁\n今天，1500多名户外徒步爱好者齐聚秋色迷人的革命老区横山，参加由江宁广电网络公司冠名的2016首届南京横溪•横山徒步越野大会。景致优美的赛道路线，准专业越野赛事的体验，让市民充分领略到全民健身的魅力。\n最小登山者：四个月大的沈悠悠小朋友。\n阅读原文\n\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"百天","url":"/2016/10/13/yoyo/20161014-100%E5%A4%A9/","content":"嘟嘟~\n\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"Hello World","url":"/2016/07/06/yoyo/20160706-%E5%87%BA%E7%94%9F/","content":"hello，world！我出生啦。\n\n\n\n小名\n糖圆\n\n\n\n性别\n女\n\n\n出生时间\n2016-07-06 17:33\n\n\n出生地点\n南京军区总院\n\n\n出生孕周\n41周(+3)\n\n\n出生体重\n3.6kg\n\n\n出生身高\n49cm\n\n\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"Hexo 安装与配置","url":"/2016/06/02/hexo/hexo-%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/","content":"0. 安装前提Windows系统下安装 Hexo，需要先安装下列应用程序。\n\nnode.js, http://nodejs.org/\ngit, http://git-scm.com/\n\n1. 安装、初始化 Hexonpm install -g cnpm --registry=https://registry.npmmirror.comnpm install -g hexo-cli# 创建博客主文件夹为： hexohexo init hexocd hexonpm install\n\n创建新 post，新建的 post 文件位于source/_posts文件夹内。\nhexo new &quot;My New Post&quot;\n\n\n\n2. 服务器首先安装hexo-server，运行服务器。\nnpm install hexo-server --savehexo server\n\n网站会在 http://localhost:4000 下启动。\n3. 更换主题在终端窗口下，定位到 Hexo 站点目录下。使用 Git checkout 主题代码。\ncd hexogit clone https://github.com/theme-next/hexo-theme-next themes/next\n\n打开站点配置文件blog/_config.yaml，找到 theme 字段，并将其值更改为 next。\ntheme: next\n\n运行服务器,验证主题是否正确启用。\nhexo cleanhexo server\n\n3.1 主题配置打开主题配置文件hexo/themes/next/_config.yml，更改Scheme字段。\n#scheme: Muse#scheme: Mistscheme: Pisces\n\n3.2 更新主题打开主题配置文件夹&#96;hexo&#x2F;themes&#x2F;next’。\ncd themes/nextgit pull# 强制更新git fetch --allgit reset --hard origin/master\n\n4. 站点配置打开站点配置文件.\\_config.yaml，更改相关字段。\nauthor: shen bolanguage: zh-Hanstimezone: Asia/Shanghaiurl: https://shenbo.github.iodeploy:    type:  git  repo:  git@github.com:shenbo/shenbo.github.io.git  branch:  master\n\n5. Git 配置打开git bash，设置用户名，并生成ssh-key。\ngit config --global user.name &quot;shenbo&quot;git config --global user.email &quot;shenbo@hotmail.com&quot;ssh-keygen -t rsa -b 4096 -C &quot;shenbo@hotmail.com&quot;eval $(ssh-agent -s)     # start the ssh-agent in the backgroundssh-add ~/.ssh/id_rsa    # add SSH private key to the ssh-agentls ~/.ssh                # lists the files in your .ssh directory\n\n复制~/.ssh/id_rsa.pub，在 github 个人设置页面，点击新建或添加 SSH key，将id_rsa.pub内容复制进去。\n测试 git 客户端与 github 是否连接成功。\nssh -T git@github.com\n\n如果连接报错ssh: connect to host github.com port 22: Connection &gt; refused\n打开&#x2F;新建~/.ssh/config，修改内容如下，重新测试。\nHost github.comUser shenbo@hotmail.comHostname ssh.github.comPreferredAuthentications publickeyIdentityFile ~/.ssh/id_rsaPort 443\n\n如果连接报错&quot;Deployer not found: git&quot;，安装hexo-deployer-git。\nnpm install hexo-deployer-git --save\n\n6. 生成 &amp; 发布hexo generatehexo deploy\n","categories":["hexo"],"tags":["hexo"]},{"title":"常用apps配置","url":"/2016/03/14/apps/apps-config/","content":"pip\n设置默认国内源 - Windows系统\n\npip config set global.index-url &#x27;https://pypi.tuna.tsinghua.edu.cn/simple&#x27;pip config list\n\ngitgit config --global user.name &#x27;shenbo&#x27;git config --global user.email &#x27;shenbo@hotmail.com&#x27;git config --global http.proxy &#x27;http://127.0.0.1:9981&#x27;git config -lgit config --global core.editor code git config --global -e\n\nscoop\n设置 aria2 下载\n\nscoop config aria2-enabled true                   # default: truescoop config aria2-retry-wait 8                   # default: 2scoop config aria2-split 8                        # default: 5scoop config aria2-max-connection-per-server 8    # default: 5scoop config aria2-min-split-size] 2M             # default: 5M\n\n\n设置 proxy\n\nscoop config proxy 127.0.0.1:9981scoop config\n\nnpm\n设置默认国内源\n\nnpm config set registry https://registry.npmmirror.com/# 或用 nrmnpm install nrm -gnrm use taobao\n\n\n设置 proxy\n\nnpm config set proxy http://127.0.0.1:9981npm config list\n\n\n\n\n\nssh\n防止长时间无操作，连接断开\n\n在 C:\\Users\\XXXX\\.ssh\\config，内容为：\nServerAliveInterval 60\n\nyoutube-dl\n设置默认下载目录linux 系统: 修改&#x2F;新建文件 /etc/youtube-dl.conf，或 ~/.config/youtube-dl/config，内容为：\n\n-o ~/Sync/ytb/%(title)s.%(ext)s\n","categories":["apps"],"tags":["config"]},{"title":"田忌赛马","url":"/2016/02/16/yoyo/tianjisaima/","content":"田忌赛马从前，有一只小兔子，它长了三颗牙齿，一颗金牙齿，一颗银牙齿，一颗铜牙齿。\n有一天，它去地里拔萝卜。地里有三棵胡萝卜，一棵金胡萝卜，一棵银胡萝卜，一棵铜胡萝卜。\n小兔子用它的金牙啃金胡萝卜，哎呀，金萝卜太硬，小兔子的金牙一下子断掉了，好疼呀，5555。\n小兔子又用它的银牙啃银胡萝卜，银萝卜也很硬，小兔子的银牙也断了，5555。\n最后，小兔子又用它的铜牙啃铜胡萝卜，铜胡萝卜也很硬，铜牙也断了。小兔子三颗牙都断了，它再也忍不住，哇的一声哭了起来。\n正在这时，兔妈妈来了，小兔子看见妈妈来了，哭的更伤心啦。\n兔妈妈安慰小兔子，孩子，你不要伤心了，牙齿断了还可以再长出来，没关系。吃胡萝卜也要动脑筋呀，不能着急。下次你可以用你的金牙去啃银胡萝卜，用你的银牙去啃铜胡萝卜，铜牙啃不动金胡萝卜就不吃了，两个胡萝卜够你吃饱了呀！\n小兔子听了妈妈的话，恍然大悟。\n第二天，它按兔妈妈讲的方法，果然吃了个饱。\n\n三只斧头有一天，小白兔在河边玩耍，突然不小心摔了一跤，小白兔的门牙磕掉了。小白兔疼的哭了起来，这时小乌龟从河里爬了出来。\n小白兔，你为什么哭的这么伤心啊？\n我的牙磕掉了，好疼啊，555…\n那我帮你找吧。\n小乌龟游到河里，过了一会，拿了一颗金牙出来了，小白兔，这颗金牙是不是你的啊？\n小白兔摇摇头，不是哒。\n小乌龟又游到河里，过了一会，拿了一颗银牙出来了，小白兔，这颗银牙是不是你的啊？\n小白兔摇摇头，不是哒。\n小乌龟又游到河里，过了一会，拿了一颗普通的牙出来了，小白兔，这颗牙是不是你的啊？\n小白兔点点头，是我的，这就是我的牙~\n小乌龟说，小白兔，你真是个诚实的好孩子，这三颗牙都送给你了。\n\n守株待兔有一天，小乌龟在河里寻找食物，突然被什么东西砸了一下。\n原来是小白兔在河边玩耍，突然不小心摔了一跤，小白兔的金牙磕掉了。\n小乌龟捡起金牙高兴的走了，拿金牙换了两条鱼吃。\n第二天，小乌龟又到之前游泳的地方，小白兔在河边玩耍的时候不小心又摔了一跤，小白兔的银牙也磕掉了。\n小乌龟捡起银牙高兴的走了，拿银牙换了一条鱼吃。\n后来，小乌龟天天在河里等着小兔子摔跤，但是小兔子玩了很多天也没摔跤，小乌龟每次都空手而归。\n最后小乌龟饿死了。\n\n刻舟求剑有一天，小兔子在河里划船，突然摔了一跤，小兔子的门牙摔断了，掉进了水里。\n河里水很深，小兔子不会游泳，它打电话给小乌龟，想叫小乌龟帮忙把门牙捞出来，但是小乌龟去外婆家了。\n小兔子想啊想，终于想到一个好办法。它在船上做个记号，然后把船划到岸边水浅的地方，顺着做记号的地方跳到水里，开始找门牙。\n小兔子找了很久，也没找到它的门牙。\n\n乌鸦喝水+司马光砸缸有一天，小兔子和小乌龟在假山上玩，假山下边有一口空的水缸，突然小乌龟掉进了缸里。\n幸好小乌龟有壳，摔下去没有受伤。但是水缸里面很滑，小乌龟爬不出来。水缸很深，小兔子伸手拉小乌龟也拉不到它。\n怎么办呢？小乌龟急的要哭了。\n有了！小兔子找了一个水瓶，从山上接满水，倒进缸里，等缸里水满了，小乌龟就可以游出来了！\n小兔子接水、倒水，过了很长时间，缸里的水终于就要满了。小乌龟快要能爬出来了。\n这时，小熊走了过来，它看见小乌龟掉进了缸里，急忙从路边捡了一块大石头，朝水缸砸去。\n哗～\n水缸碎了个大洞，水从缸里流了出来。\n小乌龟终于得救了。\n","categories":["yoyo"],"tags":["yoyo"]},{"title":"使用scipy库的root和fsolve函数求解方程","url":"/2015/01/31/sci/%E4%BD%BF%E7%94%A8scipy%E5%BA%93%E7%9A%84root%E5%92%8Cfsolve%E5%87%BD%E6%95%B0%E6%B1%82%E8%A7%A3%E6%96%B9%E7%A8%8B/","content":"求解非线性方程使用scipy库的 root, fsolve 函数求解非线性方程。\nfrom scipy.optimize import fsolvefrom scipy.optimize import rootdef func(x):    return x ** 4 - x - 5x_root = root(func, 1.0)x_fsolve = fsolve(func, 1.0)print(x_root.x)print(x_fsolve)# [1.60300708]# [1.60300708]\n\n\n求解传热方程（热辐射+热传导）from scipy.optimize import fsolve# 热流密度q, w/m2# 方程为 q = k1 * (t0 ** 4 - t1 ** 4) + k2 * (t0 - t1)def solver(q, t0):    def func(t1):        eps1, eps2 = 0.1, 0.8   # 表面发射率 epsilon        lam = 0.04              # 热导率 lamda, w/(m.k)        dx = 0.005              # 材料的厚度, m        k1 = 5.67e-8 / (1 / eps1 + 1 / eps2 - 1)        k2 = 0.016 * lam / dx        return k1 * (t0 ** 4 - t1 ** 4) + k2 * (t0 - t1) - q    x = fsolve(func, t0 - 0.01)    return x[0]t = solver(q=1.0, t0=300.)print(t)# 298.6136062486314\n\n\nref：\n\nhttps://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.optimize.fsolve.html\nhttps://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.optimize.root.html\n\n","categories":["sci"],"tags":["scipy"]},{"title":"python自动更新hosts","url":"/2013/01/20/python/python-%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0hosts/","content":"windows 自动获得 google hosts 并更新。\nimport requests# windows系统 hosts文件地址hosts_file_dir = &#x27;C:/Windows/System32/drivers/etc/hosts&#x27;# 自定义 hostslocal_hosts = &#x27;127.0.0.1 localhost\\n\\n\\n&#x27;# google hosts urlgoog_hosts_url = &#x27;https://coding.net/u/scaffrey/p/hosts/git/raw/master/hosts-files/hosts&#x27;headers = &#123;&#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3689.0 Safari/537.36&#x27;&#125;req = requests.get(goog_hosts_url, headers=headers)goog_hosts = req.content.decode(encoding=&#x27;utf-8&#x27;)print(&#x27;- hosts downloaded !!!\\n&#x27;)with open(hosts_file_dir, &#x27;wb&#x27;) as fd:    fd.write(bytes(local_hosts + goog_hosts, &#x27;UTF-8&#x27;))print(&#x27;- hosts update succeed !&#x27;)\n","categories":["python"],"tags":["python"]},{"title":"python暴力穷举求所有四阶幻方","url":"/2013/01/02/python/python-%E6%9A%B4%E5%8A%9B%E7%A9%B7%E4%B8%BE%E6%B1%82%E6%89%80%E6%9C%89%E5%9B%9B%E9%98%B6%E5%B9%BB%E6%96%B9/","content":"四阶幻方构造方法将 1-16 填入4×4的方格里，一共有 16! &#x3D; 20922789888000 种组合，计算量有点大。\n可以先假设其中的 7 个数（用 a-g 表示），就可以推出其他数字：\n\n\n\n\n\n\n\n\n\n\na\nb\nc\n34-a-b-c\n\n\nd\ne\nf\n34-d-e-f\n\n\n34-2a-b-c-d+f+g\ng\n34-e-f-g\n2a+b+c+d+e-g-34\n\n\na+b+c-f-g\n34-b-e-g\n-c+e+g\n-a+f+g\n\n\n这样就减少到 A(16,7) &#x3D; 16! &#x2F; 9! &#x3D; 57657600 种组合。\n\npython 代码：\n\nimport itertoolsimport numpy as npdef gen_ms():    # itertools.permutations 函数 可以生成排列组合    for i in itertools.permutations(range(1, 17), 7):        (a, b, c, d, e, f, g) = i                ms = np.zeros(16, dtype=int)        ms[0] = a        ms[1] = b        ms[2] = c        ms[3] = 34 - a - b - c        ms[4] = d        ms[5] = e        ms[6] = f        ms[7] = 34 - d - e - f        ms[8] = 34 - 2 * a - b - c - d + f + g        ms[9] = g        ms[10] = 34 - e - f - g        ms[11] = 2 * a + b + c + d + e - g -34        ms[12] = a + b + c - f - g        ms[13] = 34 - b - e - g        ms[14] = -c + e + g        ms[15] = -a + f + g                # 判断        if np.max(ms) &gt; 16 or np.min(ms) &lt; 1 or len(np.unique(ms)) &lt; 16:            continue        print(ms)\n\n这是最直观的的穷举方法，性能有点弱鸡，跑完要 4-5 分钟。。。\n总共有 7040 种幻方，包含对称、镜像的形式；所以不重复的是 7040 &#x2F; 8 &#x3D; 880 种。\n\nPS：三阶幻方介绍三阶幻方又叫九宫格，最早是《河图洛书》的描述：\n\n二四为肩，六八为足，左七右三，戴九履一\n\n\n\n\n\n\n\n\n\n\n4\n9\n2\n\n\n3\n5\n7\n\n\n8\n1\n6\n\n\n","categories":["python"],"tags":["python"]}]