<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>yoyo</title>
  
  
  <link href="https://shenbo.github.io/atom.xml" rel="self"/>
  
  <link href="https://shenbo.github.io/"/>
  <updated>2025-08-03T07:26:11.292Z</updated>
  <id>https://shenbo.github.io/</id>
  
  <author>
    <name>yoyo</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>小米wifi-AX3600电流声</title>
    <link href="https://shenbo.github.io/2025/06/21/network/%E5%B0%8F%E7%B1%B3wifi3600%E7%94%B5%E6%B5%81%E5%A3%B0/"/>
    <id>https://shenbo.github.io/2025/06/21/network/%E5%B0%8F%E7%B1%B3wifi3600%E7%94%B5%E6%B5%81%E5%A3%B0/</id>
    <published>2025-06-21T04:00:08.000Z</published>
    <updated>2025-08-03T07:26:11.292Z</updated>
    
    <content type="html"><![CDATA[<p>小米 AX3600 使用过程中很大电流声，声音是在主板上发出来的。</p><p>客服一问三不知；</p><p>网上有说换电源可以解决，原装电源不行。</p><p>额定电压为12V， 空载的实测电压只有10.38V。。。 简直离谱</p><span id="more"></span><img src="/2025/06/21/network/%E5%B0%8F%E7%B1%B3wifi3600%E7%94%B5%E6%B5%81%E5%A3%B0/%E7%94%B5%E5%8E%8B.jpg" class=""><p>找了一个旧的12V电源，接上去就好了！</p><img src="/2025/06/21/network/%E5%B0%8F%E7%B1%B3wifi3600%E7%94%B5%E6%B5%81%E5%A3%B0/%E7%94%B5%E6%BA%90.jpg" class="">]]></content>
    
    
    <summary type="html">&lt;p&gt;小米 AX3600 使用过程中很大电流声，声音是在主板上发出来的。&lt;/p&gt;
&lt;p&gt;客服一问三不知；&lt;/p&gt;
&lt;p&gt;网上有说换电源可以解决，原装电源不行。&lt;/p&gt;
&lt;p&gt;额定电压为12V， 空载的实测电压只有10.38V。。。 简直离谱&lt;/p&gt;</summary>
    
    
    
    <category term="wifi" scheme="https://shenbo.github.io/categories/wifi/"/>
    
    
    <category term="network" scheme="https://shenbo.github.io/tags/network/"/>
    
  </entry>
  
  <entry>
    <title>pdf文档文字识别-MinerU-pdf-ocr-to-markdown</title>
    <link href="https://shenbo.github.io/2025/06/18/office/pdf%E6%96%87%E6%A1%A3%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB-MinerU/"/>
    <id>https://shenbo.github.io/2025/06/18/office/pdf%E6%96%87%E6%A1%A3%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB-MinerU/</id>
    <published>2025-06-18T23:28:43.000Z</published>
    <updated>2025-08-03T07:26:11.305Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>MinerU <a href="https://github.com/opendatalab/MinerU/">https://github.com/opendatalab/MinerU/</a></p></blockquote><p>官网有详细的说明，需要 gpu cuda 支持。</p><p>实测笔记本 cpu 模式也能使用，如下。</p><h2 id="1-pip-安装-mineru-CPU模式"><a href="#1-pip-安装-mineru-CPU模式" class="headerlink" title="1. pip 安装 mineru (CPU模式)"></a>1. pip 安装 mineru (CPU模式)</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建虚拟环境</span></span><br><span class="line">python -m venv .venv_mnu</span><br><span class="line">.venv_mnu\Scripts\activate</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">pip install -U <span class="string">&quot;mineru[core]&quot;</span> -i https://mirrors.aliyun.com/pypi/simple </span><br></pre></td></tr></table></figure><h2 id="2-预训练模型下载"><a href="#2-预训练模型下载" class="headerlink" title="2. 预训练模型下载"></a>2. 预训练模型下载</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cmd</span></span><br><span class="line">mineru-models-download</span><br><span class="line"><span class="comment"># [huggingface|modelscope] 选择 modelscope 源</span></span><br><span class="line"><span class="comment"># [pipeline|vlm|all]       选择 pipeline 模型</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">mineru-models-download -s modelscope -m pipeline</span><br></pre></td></tr></table></figure><p>模型默认会被下载到 <code>~\.cache\modelscope\hub\models </code><br>同时创建一个配置文件 <code>~\mineru.json</code></p><p>默认下载到当前用户目录下。</p><h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>帮助：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mineru --<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">Usage: mineru [OPTIONS]</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -v, --version                   显示版本并退出</span><br><span class="line">  -p, --path PATH                 输入文件路径或目录（必填）</span><br><span class="line">  -o, --output PATH               输出目录（必填）</span><br><span class="line">  -m, --method [auto|txt|ocr]     解析方法：auto（默认）、txt、ocr（仅用于 pipeline 后端）</span><br><span class="line">  -b, --backend [pipeline|vlm-transformers|vlm-sglang-engine|vlm-sglang-client]</span><br><span class="line">                                  解析后端（默认为 pipeline）</span><br><span class="line">  -l, --lang [ch|ch_server|... ]  指定文档语言（可提升 OCR 准确率，仅用于 pipeline 后端）</span><br><span class="line">  -u, --url TEXT                  当使用 sglang-client 时，需指定服务地址</span><br><span class="line">  -s, --start INTEGER             开始解析的页码（从 0 开始）</span><br><span class="line">  -e, --end INTEGER               结束解析的页码（从 0 开始）</span><br><span class="line">  -f, --formula BOOLEAN           是否启用公式解析（默认开启，仅 pipeline 后端）</span><br><span class="line">  -t, --table BOOLEAN             是否启用表格解析（默认开启，仅 pipeline 后端）</span><br><span class="line">  -d, --device TEXT               推理设备（如 cpu/cuda/cuda:0/npu/mps，仅 pipeline 后端）</span><br><span class="line">  --vram INTEGER                  单进程最大 GPU 显存占用（仅 pipeline 后端）</span><br><span class="line">  --<span class="built_in">source</span> [huggingface|modelscope|<span class="built_in">local</span>]</span><br><span class="line">                                  模型来源，默认 huggingface</span><br><span class="line">  --<span class="built_in">help</span>                          显示帮助信息</span><br><span class="line"></span><br></pre></td></tr></table></figure><span id="more"></span><p>例：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mineru -d cpu --<span class="built_in">source</span> <span class="built_in">local</span> -o . -p 123.pdf </span><br><span class="line"></span><br><span class="line">mineru -d cpu --<span class="built_in">source</span> <span class="built_in">local</span> -o . -l ch_lite -p 123.pdf </span><br></pre></td></tr></table></figure><h3 id="耗时"><a href="#耗时" class="headerlink" title="耗时"></a>耗时</h3><p>使用 cpu (笔记本 intel ultra 7 155h)， 检测一个 10 页的pdf，内容主要是中文文字。</p><table><thead><tr><th>步骤</th><th>说明</th><th>数量</th><th>耗时</th></tr></thead><tbody><tr><td>Layout Predict</td><td>pdf 页面解析</td><td>10&#x2F;10</td><td>00:18&lt;00:00,  1.82s&#x2F;it</td></tr><tr><td>MFD Predict</td><td>数学公式检测</td><td>10&#x2F;10</td><td>00:52&lt;00:00,  5.27s&#x2F;it</td></tr><tr><td>MFR Predict</td><td>数学公式识别</td><td>1&#x2F;1</td><td>00:01&lt;00:00,  1.40s&#x2F;it</td></tr><tr><td>OCR-det ch</td><td>OCR检测中文</td><td>51&#x2F;51</td><td>00:23&lt;00:00,  2.14it&#x2F;s</td></tr><tr><td>Table Predict</td><td>表格识别</td><td>1&#x2F;1</td><td>00:04&lt;00:00,  4.47s&#x2F;it</td></tr><tr><td>OCR-rec Predict</td><td>OCR识别</td><td>319&#x2F;319</td><td>00:52&lt;00:00,  6.12it&#x2F;s</td></tr><tr><td>Processing pages</td><td>处理页面</td><td>10&#x2F;10</td><td>00:02&lt;00:00,  3.49it&#x2F;s</td></tr></tbody></table>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;MinerU &lt;a href=&quot;https://github.com/opendatalab/MinerU/&quot;&gt;https://github.com/opendatalab/MinerU/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;官网有详细的说明，需要 gpu cuda 支持。&lt;/p&gt;
&lt;p&gt;实测笔记本 cpu 模式也能使用，如下。&lt;/p&gt;
&lt;h2 id=&quot;1-pip-安装-mineru-CPU模式&quot;&gt;&lt;a href=&quot;#1-pip-安装-mineru-CPU模式&quot; class=&quot;headerlink&quot; title=&quot;1. pip 安装 mineru (CPU模式)&quot;&gt;&lt;/a&gt;1. pip 安装 mineru (CPU模式)&lt;/h2&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 创建虚拟环境&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;python -m venv .venv_mnu&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;.venv_mnu&#92;Scripts&#92;activate&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 安装&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pip install -U &lt;span class=&quot;string&quot;&gt;&amp;quot;mineru[core]&amp;quot;&lt;/span&gt; -i https://mirrors.aliyun.com/pypi/simple &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&quot;2-预训练模型下载&quot;&gt;&lt;a href=&quot;#2-预训练模型下载&quot; class=&quot;headerlink&quot; title=&quot;2. 预训练模型下载&quot;&gt;&lt;/a&gt;2. 预训练模型下载&lt;/h2&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cmd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mineru-models-download&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# [huggingface|modelscope] 选择 modelscope 源&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# [pipeline|vlm|all]       选择 pipeline 模型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 或&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mineru-models-download -s modelscope -m pipeline&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;模型默认会被下载到 &lt;code&gt;~&#92;.cache&#92;modelscope&#92;hub&#92;models &lt;/code&gt;&lt;br&gt;同时创建一个配置文件 &lt;code&gt;~&#92;mineru.json&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;默认下载到当前用户目录下。&lt;/p&gt;
&lt;h2 id=&quot;运行&quot;&gt;&lt;a href=&quot;#运行&quot; class=&quot;headerlink&quot; title=&quot;运行&quot;&gt;&lt;/a&gt;运行&lt;/h2&gt;&lt;p&gt;帮助：&lt;/p&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mineru --&lt;span class=&quot;built_in&quot;&gt;help&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Usage: mineru [OPTIONS]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Options:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -v, --version                   显示版本并退出&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -p, --path PATH                 输入文件路径或目录（必填）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -o, --output PATH               输出目录（必填）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -m, --method [auto|txt|ocr]     解析方法：auto（默认）、txt、ocr（仅用于 pipeline 后端）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -b, --backend [pipeline|vlm-transformers|vlm-sglang-engine|vlm-sglang-client]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                  解析后端（默认为 pipeline）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -l, --lang [ch|ch_server|... ]  指定文档语言（可提升 OCR 准确率，仅用于 pipeline 后端）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -u, --url TEXT                  当使用 sglang-client 时，需指定服务地址&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -s, --start INTEGER             开始解析的页码（从 0 开始）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -e, --end INTEGER               结束解析的页码（从 0 开始）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -f, --formula BOOLEAN           是否启用公式解析（默认开启，仅 pipeline 后端）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -t, --table BOOLEAN             是否启用表格解析（默认开启，仅 pipeline 后端）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -d, --device TEXT               推理设备（如 cpu/cuda/cuda:0/npu/mps，仅 pipeline 后端）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  --vram INTEGER                  单进程最大 GPU 显存占用（仅 pipeline 后端）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  --&lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; [huggingface|modelscope|&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                  模型来源，默认 huggingface&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  --&lt;span class=&quot;built_in&quot;&gt;help&lt;/span&gt;                          显示帮助信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="office" scheme="https://shenbo.github.io/categories/office/"/>
    
    
    <category term="pdf" scheme="https://shenbo.github.io/tags/pdf/"/>
    
  </entry>
  
  <entry>
    <title>PDF文档翻译 pdf2zh</title>
    <link href="https://shenbo.github.io/2025/06/11/office/PDF%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91-pdf2zh/"/>
    <id>https://shenbo.github.io/2025/06/11/office/PDF%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91-pdf2zh/</id>
    <published>2025-06-11T13:32:03.000Z</published>
    <updated>2025-08-03T07:26:11.305Z</updated>
    
    <content type="html"><![CDATA[<p>PDFMathTranslate（pdf2zh）支持科学论文翻译和双语对照。</p><p>支持全文翻译，并且还能保持原来的 pdf 文档中文字、公式、图表的排版形式。</p><p>现在已经发布了 V2.0版。</p><ul><li><p><a href="https://pdf2zh-next.com/zh/index.html">https://pdf2zh-next.com/zh/index.html</a> </p></li><li><p><a href="https://github.com/PDFMathTranslate/PDFMathTranslate-next">https://github.com/PDFMathTranslate/PDFMathTranslate-next</a></p></li><li><p><a href="https://github.com/Byaidu/PDFMathTranslate">https://github.com/Byaidu/PDFMathTranslate</a></p></li></ul><h2 id="1-使用方法"><a href="#1-使用方法" class="headerlink" title="1. 使用方法"></a>1. 使用方法</h2><p><a href="https://pdf2zh-next.com/zh/index.html">https://pdf2zh-next.com/zh/index.html</a></p><h2 id="2-使用方法-加入-scoop-和右键菜单。"><a href="#2-使用方法-加入-scoop-和右键菜单。" class="headerlink" title="2. 使用方法-加入 scoop 和右键菜单。"></a>2. 使用方法-加入 scoop 和右键菜单。</h2><p>2.1 scoop 安装</p><p><a href="https://github.com/shenbo/portablesoft/blob/master/bucket/pdf2zh.json">https://github.com/shenbo/portablesoft/blob/master/bucket/pdf2zh.json</a></p><span id="more"></span><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.0.10&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;PDF scientific paper translation with preserved formats&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;homepage&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.com/PDFMathTranslate/PDFMathTranslate-next/&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.com/PDFMathTranslate/PDFMathTranslate-next/releases/download/v2.0.10/pdf2zh-v2.0.10-BabelDOC-v0.3.69-win64.zip&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;notes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;The version without assets:  pdf2zh without assets(font, model, etc.)&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;It will also dynamically download resources when running, but the download may fail due to network issues.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;Add context menu option: &quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;    reg add \&quot;HKEY_CLASSES_ROOT\\SystemFileAssociations\\.pdf\\shell\\pdf2zh\\command\&quot; /ve /d &#x27;$dir\\pdf2zh.exe --bing --no-mono \\\&quot;%1\\\&quot;&#x27; /f&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;bin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdf2zh.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;shortcuts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;pdf2zh.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;pdf2zh&quot;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;hash&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25f5301db637b106f5de1249408ded5f106d0ea2b0b8434839c4d278933da146&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;extract_dir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdf2zh&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;checkver&quot;</span><span class="punctuation">:</span> <span class="string">&quot;github&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;autoupdate&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.com/PDFMathTranslate/PDFMathTranslate-next/releases/download/v$version/pdf2zh-v$version-BabelDOC-v0.3.69-win64.zip&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.2 安装使用</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scoop install pdf2zh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 右键菜单，管理员模式运行</span></span><br><span class="line">reg add <span class="string">&quot;HKEY_CLASSES_ROOT\SystemFileAssociations\.pdf\shell\pdf2zh\command&quot;</span> /ve /d <span class="string">&#x27;pdf2zh.exe --bing --no-mono \&quot;%1\&quot;&#x27;</span> /f</span><br><span class="line"></span><br><span class="line"><span class="comment"># 常用命令说明</span></span><br><span class="line">pdf2zh ~/local.pdf   --bing    --debug     --pages 1-5   --no-mono </span><br><span class="line">     <span class="comment">#   pdf路径    翻译服务    调试模式    页码范围     不输出仅中文版</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;PDFMathTranslate（pdf2zh）支持科学论文翻译和双语对照。&lt;/p&gt;
&lt;p&gt;支持全文翻译，并且还能保持原来的 pdf 文档中文字、公式、图表的排版形式。&lt;/p&gt;
&lt;p&gt;现在已经发布了 V2.0版。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pdf2zh-next.com/zh/index.html&quot;&gt;https://pdf2zh-next.com/zh/index.html&lt;/a&gt; &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/PDFMathTranslate/PDFMathTranslate-next&quot;&gt;https://github.com/PDFMathTranslate/PDFMathTranslate-next&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/Byaidu/PDFMathTranslate&quot;&gt;https://github.com/Byaidu/PDFMathTranslate&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;1-使用方法&quot;&gt;&lt;a href=&quot;#1-使用方法&quot; class=&quot;headerlink&quot; title=&quot;1. 使用方法&quot;&gt;&lt;/a&gt;1. 使用方法&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://pdf2zh-next.com/zh/index.html&quot;&gt;https://pdf2zh-next.com/zh/index.html&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-使用方法-加入-scoop-和右键菜单。&quot;&gt;&lt;a href=&quot;#2-使用方法-加入-scoop-和右键菜单。&quot; class=&quot;headerlink&quot; title=&quot;2. 使用方法-加入 scoop 和右键菜单。&quot;&gt;&lt;/a&gt;2. 使用方法-加入 scoop 和右键菜单。&lt;/h2&gt;&lt;p&gt;2.1 scoop 安装&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/shenbo/portablesoft/blob/master/bucket/pdf2zh.json&quot;&gt;https://github.com/shenbo/portablesoft/blob/master/bucket/pdf2zh.json&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="office" scheme="https://shenbo.github.io/categories/office/"/>
    
    
    <category term="pdf2zh" scheme="https://shenbo.github.io/tags/pdf2zh/"/>
    
  </entry>
  
  <entry>
    <title>PDF论文文献重命名</title>
    <link href="https://shenbo.github.io/2025/06/11/office/PDF%E6%96%87%E6%A1%A3-%E8%AE%BA%E6%96%87%E6%96%87%E7%8C%AE%E9%87%8D%E5%91%BD%E5%90%8D/"/>
    <id>https://shenbo.github.io/2025/06/11/office/PDF%E6%96%87%E6%A1%A3-%E8%AE%BA%E6%96%87%E6%96%87%E7%8C%AE%E9%87%8D%E5%91%BD%E5%90%8D/</id>
    <published>2025-06-11T11:44:59.000Z</published>
    <updated>2025-08-03T07:26:11.305Z</updated>
    
    <content type="html"><![CDATA[<p>pdf-renamer 可以对已下载的论文 PDF 文件 进行重命名。</p><ul><li><a href="https://github.com/MicheleCotrufo/pdf-renamer">https://github.com/MicheleCotrufo/pdf-renamer</a></li></ul><p>调用 pdf2bib 以及 pdf2doi 查找论文的 DOI、并获得 BibTeX 数据。</p><ul><li><a href="https://github.com/MicheleCotrufo/pdf2bib">https://github.com/MicheleCotrufo/pdf2bib</a></li></ul><h2 id="1-安装"><a href="#1-安装" class="headerlink" title="1. 安装"></a>1. 安装</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install pdf-renamer</span><br><span class="line"></span><br><span class="line">pip install pdf2bib</span><br></pre></td></tr></table></figure><h2 id="2-pdfrenamer-使用方法"><a href="#2-pdfrenamer-使用方法" class="headerlink" title="2. pdfrenamer 使用方法"></a>2. pdfrenamer 使用方法</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ pdfrenamer --h</span><br><span class="line">usage: pdfrenamer [-h] [-s] [-ro] [-f FORMAT] [-sf] [-max_length_authors MAX_LENGTH_AUTHORS]</span><br><span class="line">                  [-max_length_filename MAX_LENGTH_FILENAME] [-max_words_title MAX_WORDS_TITLE] </span><br><span class="line">                  [-<span class="keyword">case</span> CASE]</span><br><span class="line">                  [-add_abbreviation_file PATH_ABBREVIATION_FILE] [-fr] [-sd] </span><br><span class="line">                  [-install--right--click] [-uninstall--right--click]</span><br><span class="line">                  [path ...]</span><br><span class="line"></span><br></pre></td></tr></table></figure><span id="more"></span><table><thead><tr><th>args</th><th>args</th><th>description</th></tr></thead><tbody><tr><td>path</td><td></td><td>pdf文件或文件夹的路径</td></tr><tr><td></td><td></td><td></td></tr><tr><td>-h</td><td>–help</td><td>帮助</td></tr><tr><td>-s</td><td>–decrease_verbose</td><td>默认输出全部搜索记录<br>使用此选项，设为不输出</td></tr><tr><td>-ro</td><td>–readonly</td><td>默认将doi信息写入pdf的metadata信息中<br>使用此选项，设为不写入</td></tr><tr><td>-f</td><td>FORMAT</td><td>设定新文件名的格式，默认为 “{YYYY} - {Jabbr} - {A3etal} - {T}”</td></tr><tr><td></td><td>{YYYY}</td><td>出版年Year of publication</td></tr><tr><td></td><td>{MM}</td><td>出版月 (数字 digits)</td></tr><tr><td></td><td>{DD}</td><td>出版日 (数字 digits)</td></tr><tr><td></td><td>{J}</td><td>期刊全名Journal</td></tr><tr><td></td><td>{Jabbr}</td><td>期刊缩写（如有）</td></tr><tr><td></td><td>{Aall}</td><td>全部作者姓氏 (逗号分隔)</td></tr><tr><td></td><td>{Aetal}</td><td>第一作者姓氏 ‘et al.’</td></tr><tr><td></td><td>{A3etal}</td><td>前三作者姓氏 ‘et al.’</td></tr><tr><td></td><td>{aAall}</td><td>全部作者姓名 (逗号分隔)</td></tr><tr><td></td><td>{aAetal}</td><td>第一作者姓名 ‘et al.’</td></tr><tr><td></td><td>{aA3etal}</td><td>前三作者姓名 ‘et al.’</td></tr><tr><td></td><td>{T}</td><td>论文标题</td></tr><tr><td>-sf</td><td>–sub_folders</td><td>是否重命名子文件夹，默认：False</td></tr><tr><td>-max_length_authors</td><td>MAX_LENGTH_AUTHORS</td><td>设定作者的最大字符长度，默认：80</td></tr><tr><td>-max_length_filename</td><td>MAX_LENGTH_FILENAME</td><td>设定文件名最大字符长度，默认：250</td></tr><tr><td>-max_words_title</td><td>MAX_WORDS_TITLE</td><td>设定标题的最大字符长度，默认：20</td></tr><tr><td>-case</td><td>CASE</td><td>连接符：驼峰、下划线、减号、空格</td></tr><tr><td></td><td></td><td>CASE：[‘camel’, ‘snake’, ‘kebab’, ‘none’ (default)]</td></tr><tr><td>-add_abbreviation_file</td><td>PATH_ABBREVIATION_FILE</td><td>期刊缩写</td></tr><tr><td>-fr</td><td>–force_rename</td><td>默认跳过相同文件<br>使用此选项，设为重命名每一个文件</td></tr><tr><td>-sd</td><td>–set_default</td><td>将现有参数设置为默认值</td></tr><tr><td>-install–right–click</td><td></td><td>加入 Windows 右键菜单</td></tr><tr><td>-uninstall–right–click</td><td></td><td>删除 Windows 右键菜单</td></tr></tbody></table><h2 id="3-pdf2bib-使用方法"><a href="#3-pdf2bib-使用方法" class="headerlink" title="3. pdf2bib 使用方法"></a>3. pdf2bib 使用方法</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pdf2bib --h</span><br><span class="line">usage: pdf2bib [-h] [-v] [-nostore] [-s FILENAME_BIBTEX] [-clip] </span><br><span class="line">               [-install--right--click] [-uninstall--right--click]</span><br><span class="line">               [path ...]</span><br></pre></td></tr></table></figure><table><thead><tr><th>args</th><th>args</th><th>description</th></tr></thead><tbody><tr><td>path</td><td></td><td>pdf文件或文件夹的路径</td></tr><tr><td></td><td></td><td></td></tr><tr><td>-h</td><td>–help</td><td>帮助</td></tr><tr><td>-v</td><td>–verbose</td><td>默认仅输出搜索结果<br>使用此选项，设为输出搜索过程记录</td></tr><tr><td>-nostore</td><td>–no_store_identifier_metadata</td><td>默认将doi信息写入pdf的metadata信息中<br>使用此选项，设为不写入</td></tr><tr><td>-s</td><td>FILENAME_BIBTEX</td><td>将 bibtex 信息写入 FILENAME_BIBTEX 文本文件.</td></tr><tr><td>–make_bibtex_file</td><td>FILENAME_BIBTEX</td><td>将 bibtex 信息写入 FILENAME_BIBTEX 文本文件</td></tr><tr><td>-clip</td><td>–save_bibtex_clipboard</td><td>将 bibtex 写入粘贴板</td></tr><tr><td>-install–right–click</td><td></td><td>加入 Windows 右键菜单</td></tr><tr><td>-uninstall–right–click</td><td></td><td>删除 Windows 右键菜单</td></tr></tbody></table><h2 id="4-加入右键菜单。"><a href="#4-加入右键菜单。" class="headerlink" title="4. 加入右键菜单。"></a>4. 加入右键菜单。</h2><p>Windows 操作系统下，可以将 pdf-renamer 添加到右键菜单作为快捷方式。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pdfrenamer --install-right-click</span><br><span class="line"><span class="comment"># pdfrenamer --uninstall-right-click</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pdf2bib -install--right--click</span><br><span class="line"><span class="comment"># pdf2bib -uninstall--right--click</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;pdf-renamer 可以对已下载的论文 PDF 文件 进行重命名。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/MicheleCotrufo/pdf-renamer&quot;&gt;https://github.com/MicheleCotrufo/pdf-renamer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;调用 pdf2bib 以及 pdf2doi 查找论文的 DOI、并获得 BibTeX 数据。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/MicheleCotrufo/pdf2bib&quot;&gt;https://github.com/MicheleCotrufo/pdf2bib&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;1-安装&quot;&gt;&lt;a href=&quot;#1-安装&quot; class=&quot;headerlink&quot; title=&quot;1. 安装&quot;&gt;&lt;/a&gt;1. 安装&lt;/h2&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;pip install pdf-renamer&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pip install pdf2bib&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;


&lt;h2 id=&quot;2-pdfrenamer-使用方法&quot;&gt;&lt;a href=&quot;#2-pdfrenamer-使用方法&quot; class=&quot;headerlink&quot; title=&quot;2. pdfrenamer 使用方法&quot;&gt;&lt;/a&gt;2. pdfrenamer 使用方法&lt;/h2&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pdfrenamer --h&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;usage: pdfrenamer [-h] [-s] [-ro] [-f FORMAT] [-sf] [-max_length_authors MAX_LENGTH_AUTHORS]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  [-max_length_filename MAX_LENGTH_FILENAME] [-max_words_title MAX_WORDS_TITLE] &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  [-&lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; CASE]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  [-add_abbreviation_file PATH_ABBREVIATION_FILE] [-fr] [-sd] &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  [-install--right--click] [-uninstall--right--click]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  [path ...]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="office" scheme="https://shenbo.github.io/categories/office/"/>
    
    
    <category term="pdf2" scheme="https://shenbo.github.io/tags/pdf2/"/>
    
  </entry>
  
  <entry>
    <title>caj2pdf：将知网caj文件转换为pdf(2)</title>
    <link href="https://shenbo.github.io/2025/06/06/office/caj2pdf%EF%BC%9A%E5%B0%86%E7%9F%A5%E7%BD%91caj%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E4%B8%BApdf(2)/"/>
    <id>https://shenbo.github.io/2025/06/06/office/caj2pdf%EF%BC%9A%E5%B0%86%E7%9F%A5%E7%BD%91caj%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E4%B8%BApdf(2)/</id>
    <published>2025-06-06T14:03:09.000Z</published>
    <updated>2025-08-03T07:26:11.305Z</updated>
    
    <content type="html"><![CDATA[<h1 id="caj2pdf-将知网caj文件转换为pdf"><a href="#caj2pdf-将知网caj文件转换为pdf" class="headerlink" title="caj2pdf: 将知网caj文件转换为pdf"></a>caj2pdf: 将知网caj文件转换为pdf</h1><blockquote><p><a href="https://github.com/shenbo/caj2pdf/">https://github.com/shenbo/caj2pdf/</a></p></blockquote><ul><li>在原来基础上使用 pystand 简单封装，并增加右键菜单快捷命令</li></ul><h3 id="1-克隆仓库"><a href="#1-克隆仓库" class="headerlink" title="1. 克隆仓库"></a>1. 克隆仓库</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/shenbo/caj2pdf.git</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/caj2pdf/caj2pdf.git</span><br></pre></td></tr></table></figure><h3 id="2-创建-python-虚拟环境"><a href="#2-创建-python-虚拟环境" class="headerlink" title="2. 创建 python 虚拟环境"></a>2. 创建 python 虚拟环境</h3><ul><li>只需要安装一个库第三方库：pypdf2</li><li>pystand 需要 Python embed</li><li>原来的 dll 文件路径是相对路径，需要调整一下</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Write-Host <span class="string">&quot;==== 0. Create folders ====&quot;</span></span><br><span class="line">New-Item -Path <span class="string">&quot;./build&quot;</span> -ItemType Directory -Force</span><br><span class="line">New-Item -Path <span class="string">&quot;./.cache&quot;</span> -ItemType Directory -Force</span><br><span class="line"></span><br><span class="line">Write-Host <span class="string">&quot;==== 1. Setup Python venv ====&quot;</span></span><br><span class="line"><span class="keyword">if</span> (-not (Test-Path <span class="string">&quot;.venv_caj&quot;</span>)) &#123;</span><br><span class="line">    python -m venv .venv_caj</span><br><span class="line">&#125;</span><br><span class="line">.venv_caj/Scripts/activate.ps1</span><br><span class="line">python -V</span><br><span class="line">pip install pypdf2</span><br><span class="line"></span><br><span class="line">Write-Host <span class="string">&quot;==== 1.1 Download Python embed version====&quot;</span></span><br><span class="line"><span class="variable">$pythonUrl</span> = <span class="string">&quot;https://www.python.org/ftp/python/3.13.4/python-3.13.4-embed-amd64.zip&quot;</span></span><br><span class="line"><span class="keyword">if</span> (-not (Test-Path <span class="string">&quot;./.cache/python.zip&quot;</span>)) &#123;</span><br><span class="line">    Invoke-WebRequest -Uri <span class="variable">$pythonUrl</span> -OutFile <span class="string">&quot;./.cache/python.zip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">Expand-Archive -Path <span class="string">&quot;./.cache/python.zip&quot;</span> -DestinationPath <span class="string">&quot;./build/runtime&quot;</span> -Force</span><br><span class="line"></span><br><span class="line">Write-Host <span class="string">&quot;==== 2. Copy files to ./build/* ====&quot;</span></span><br><span class="line">Get-ChildItem -Path <span class="string">&quot;./*.py&quot;</span> | Copy-Item -Destination <span class="string">&quot;./build&quot;</span> -Recurse -Force</span><br><span class="line">Get-ChildItem -Path <span class="string">&quot;./lib&quot;</span> | Copy-Item -Destination <span class="string">&quot;./build/lib&quot;</span> -Recurse -Force</span><br><span class="line">Copy-Item -Path <span class="string">&quot;./caj2pdf&quot;</span> -Destination <span class="string">&quot;./build/caj2pdf.int&quot;</span> -Recurse -Force</span><br><span class="line"></span><br><span class="line">Write-Host <span class="string">&quot;==== 2.1  change .dll path ====&quot;</span></span><br><span class="line"><span class="variable">$jbigdec_file</span> = <span class="string">&#x27;./build/jbigdec.py&#x27;</span></span><br><span class="line"><span class="variable">$old_cmd</span> = <span class="string">&#x27;&quot;./lib/bin/libjbigdec-w64.dll&quot;&#x27;</span></span><br><span class="line"><span class="variable">$new_cmd</span> = <span class="string">&#x27;os.path.join(os.path.dirname(__file__), &quot;lib/libjbigdec-w64.dll&quot;)&#x27;</span></span><br><span class="line">(Get-Content <span class="variable">$jbigdec_file</span>).replace(<span class="variable">$old_cmd</span>, <span class="variable">$new_cmd</span>) | Set-Content <span class="variable">$jbigdec_file</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="3-下载-PyStand、-简单配置"><a href="#3-下载-PyStand、-简单配置" class="headerlink" title="3. 下载 PyStand、 简单配置"></a>3. 下载 PyStand、 简单配置</h3><p>ref: </p><ul><li><a href="https://github.com/skywind3000/PyStand/">https://github.com/skywind3000/PyStand/</a></li><li><a href="https://skywind.me/blog/archives/3002">https://skywind.me/blog/archives/3002</a></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Write-Host <span class="string">&quot;==== 3. Download PyStand ====&quot;</span></span><br><span class="line"><span class="variable">$pystandUrl</span> = <span class="string">&quot;https://github.com/skywind3000/PyStand/releases/download/1.1.5/PyStand-v1.1.5-exe.zip&quot;</span></span><br><span class="line"><span class="keyword">if</span> (-not (Test-Path <span class="string">&quot;./.cache/pystand.zip&quot;</span>)) &#123;</span><br><span class="line">    Invoke-WebRequest -Uri <span class="variable">$pystandUrl</span> -OutFile <span class="string">&quot;./.cache/pystand.zip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">Expand-Archive -Path <span class="string">&quot;./.cache/pystand.zip&quot;</span> -DestinationPath <span class="string">&quot;./.cache/pystand&quot;</span> -Force</span><br><span class="line">Copy-Item -Path <span class="string">&quot;./.cache/pystand/PyStand-x64-CLI/PyStand.exe&quot;</span> -Destination <span class="string">&quot;./build/caj2pdf.exe&quot;</span> -Force</span><br></pre></td></tr></table></figure><h3 id="4-PyPDF2"><a href="#4-PyPDF2" class="headerlink" title="4. PyPDF2"></a>4. PyPDF2</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Write-Host <span class="string">&quot;==== 4. Copy venv/Lib/site-packages to build/ ====&quot;</span></span><br><span class="line">Copy-Item -Path <span class="string">&quot;.venv_caj/Lib/site-packages/PyPDF2&quot;</span> -Destination <span class="string">&quot;./build/site-packages/PyPDF2&quot;</span> -Recurse -Force</span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove-Item -Path &quot;./.cache&quot; -Recurse -Force</span></span><br></pre></td></tr></table></figure><h3 id="5-加入右键菜单"><a href="#5-加入右键菜单" class="headerlink" title="5. 加入右键菜单"></a>5. 加入右键菜单</h3><ul><li>需要管理员权限</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Write-Host <span class="string">&quot;==== 5. Add to context ====&quot;</span></span><br><span class="line"><span class="variable">$caj2pdf</span> = Get-Location | Join-Path -ChildPath <span class="string">&quot;build/caj2pdf.exe&quot;</span></span><br><span class="line"><span class="variable">$regKey</span> = <span class="string">&quot;HKEY_CLASSES_ROOT\SystemFileAssociations\.caj\shell\caj2pdf\command&quot;</span></span><br><span class="line"><span class="variable">$regCommand</span> = <span class="variable">$caj2pdf</span> + <span class="string">&#x27; convert \&quot;%1\&quot;&#x27;</span></span><br><span class="line">Write-Host (<span class="string">&#x27;reg add &quot;&#x27;</span> + <span class="variable">$regKey</span> + <span class="string">&#x27;&quot; /ve /d &quot;&#x27;</span> + <span class="variable">$regCommand</span> + <span class="string">&#x27;&quot; /f&#x27;</span>)</span><br><span class="line">reg add <span class="variable">$regKey</span> /ve /d <span class="variable">$regCommand</span> /f</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>详见 <a href="https://github.com/shenbo/caj2pdf/blob/master/build.ps1">https://github.com/shenbo/caj2pdf/blob/master/build.ps1</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;caj2pdf-将知网caj文件转换为pdf&quot;&gt;&lt;a href=&quot;#caj2pdf-将知网caj文件转换为pdf&quot; class=&quot;headerlink&quot; title=&quot;caj2pdf: 将知网caj文件转换为pdf&quot;&gt;&lt;/a&gt;caj2pdf: 将知网caj文件转换为pdf&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/shenbo/caj2pdf/&quot;&gt;https://github.com/shenbo/caj2pdf/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;在原来基础上使用 pystand 简单封装，并增加右键菜单快捷命令&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;1-克隆仓库&quot;&gt;&lt;a href=&quot;#1-克隆仓库&quot; class=&quot;headerlink&quot; title=&quot;1. 克隆仓库&quot;&gt;&lt;/a&gt;1. 克隆仓库&lt;/h3&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/shenbo/caj2pdf.git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 或&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/caj2pdf/caj2pdf.git&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;2-创建-python-虚拟环境&quot;&gt;&lt;a href=&quot;#2-创建-python-虚拟环境&quot; class=&quot;headerlink&quot; title=&quot;2. 创建 python 虚拟环境&quot;&gt;&lt;/a&gt;2. 创建 python 虚拟环境&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;只需要安装一个库第三方库：pypdf2&lt;/li&gt;
&lt;li&gt;pystand 需要 Python embed&lt;/li&gt;
&lt;li&gt;原来的 dll 文件路径是相对路径，需要调整一下&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Write-Host &lt;span class=&quot;string&quot;&gt;&amp;quot;==== 0. Create folders ====&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;New-Item -Path &lt;span class=&quot;string&quot;&gt;&amp;quot;./build&amp;quot;&lt;/span&gt; -ItemType Directory -Force&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;New-Item -Path &lt;span class=&quot;string&quot;&gt;&amp;quot;./.cache&amp;quot;&lt;/span&gt; -ItemType Directory -Force&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Write-Host &lt;span class=&quot;string&quot;&gt;&amp;quot;==== 1. Setup Python venv ====&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (-not (Test-Path &lt;span class=&quot;string&quot;&gt;&amp;quot;.venv_caj&amp;quot;&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    python -m venv .venv_caj&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;.venv_caj/Scripts/activate.ps1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;python -V&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pip install pypdf2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Write-Host &lt;span class=&quot;string&quot;&gt;&amp;quot;==== 1.1 Download Python embed version====&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$pythonUrl&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&amp;quot;https://www.python.org/ftp/python/3.13.4/python-3.13.4-embed-amd64.zip&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (-not (Test-Path &lt;span class=&quot;string&quot;&gt;&amp;quot;./.cache/python.zip&amp;quot;&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Invoke-WebRequest -Uri &lt;span class=&quot;variable&quot;&gt;$pythonUrl&lt;/span&gt; -OutFile &lt;span class=&quot;string&quot;&gt;&amp;quot;./.cache/python.zip&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Expand-Archive -Path &lt;span class=&quot;string&quot;&gt;&amp;quot;./.cache/python.zip&amp;quot;&lt;/span&gt; -DestinationPath &lt;span class=&quot;string&quot;&gt;&amp;quot;./build/runtime&amp;quot;&lt;/span&gt; -Force&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Write-Host &lt;span class=&quot;string&quot;&gt;&amp;quot;==== 2. Copy files to ./build/* ====&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Get-ChildItem -Path &lt;span class=&quot;string&quot;&gt;&amp;quot;./*.py&amp;quot;&lt;/span&gt; | Copy-Item -Destination &lt;span class=&quot;string&quot;&gt;&amp;quot;./build&amp;quot;&lt;/span&gt; -Recurse -Force&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Get-ChildItem -Path &lt;span class=&quot;string&quot;&gt;&amp;quot;./lib&amp;quot;&lt;/span&gt; | Copy-Item -Destination &lt;span class=&quot;string&quot;&gt;&amp;quot;./build/lib&amp;quot;&lt;/span&gt; -Recurse -Force&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Copy-Item -Path &lt;span class=&quot;string&quot;&gt;&amp;quot;./caj2pdf&amp;quot;&lt;/span&gt; -Destination &lt;span class=&quot;string&quot;&gt;&amp;quot;./build/caj2pdf.int&amp;quot;&lt;/span&gt; -Recurse -Force&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Write-Host &lt;span class=&quot;string&quot;&gt;&amp;quot;==== 2.1  change .dll path ====&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$jbigdec_file&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&amp;#x27;./build/jbigdec.py&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$old_cmd&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;quot;./lib/bin/libjbigdec-w64.dll&amp;quot;&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$new_cmd&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&amp;#x27;os.path.join(os.path.dirname(__file__), &amp;quot;lib/libjbigdec-w64.dll&amp;quot;)&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(Get-Content &lt;span class=&quot;variable&quot;&gt;$jbigdec_file&lt;/span&gt;).replace(&lt;span class=&quot;variable&quot;&gt;$old_cmd&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$new_cmd&lt;/span&gt;) | Set-Content &lt;span class=&quot;variable&quot;&gt;$jbigdec_file&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="office" scheme="https://shenbo.github.io/categories/office/"/>
    
    
    <category term="caj2pdf" scheme="https://shenbo.github.io/tags/caj2pdf/"/>
    
  </entry>
  
  <entry>
    <title>PDF文档-电子发票信息提取</title>
    <link href="https://shenbo.github.io/2025/05/22/office/PDF%E6%96%87%E6%A1%A3-%E7%94%B5%E5%AD%90%E5%8F%91%E7%A5%A8%E4%BF%A1%E6%81%AF%E6%8F%90%E5%8F%96/"/>
    <id>https://shenbo.github.io/2025/05/22/office/PDF%E6%96%87%E6%A1%A3-%E7%94%B5%E5%AD%90%E5%8F%91%E7%A5%A8%E4%BF%A1%E6%81%AF%E6%8F%90%E5%8F%96/</id>
    <published>2025-05-22T03:22:33.000Z</published>
    <updated>2025-08-03T07:26:11.305Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>pymupdf </p><ul><li>pip install pymupdf</li><li><a href="https://pymupdf.readthedocs.io/en/latest/index.html">https://pymupdf.readthedocs.io/en/latest/index.html</a></li></ul></li><li><p>pyzbar </p><ul><li>pip install pyzbar</li><li><a href="https://github.com/NaturalHistoryMuseum/pyzbar/">https://github.com/NaturalHistoryMuseum/pyzbar/</a></li></ul></li></ul><h2 id="用-pymupdf-提取电子发票中的信息"><a href="#用-pymupdf-提取电子发票中的信息" class="headerlink" title="用 pymupdf 提取电子发票中的信息"></a>用 pymupdf 提取电子发票中的信息</h2><ul><li><p><a href="https://pymupdf.readthedocs.io/en/latest/page.html#Page.get_text">https://pymupdf.readthedocs.io/en/latest/page.html#Page.get_text</a></p></li><li><p><a href="https://pymupdf.readthedocs.io/en/latest/page.html#Page.find_tables">https://pymupdf.readthedocs.io/en/latest/page.html#Page.find_tables</a></p></li></ul><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># %%</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> fitz  <span class="comment"># pip install PyMuPDF</span></span><br><span class="line"><span class="keyword">from</span> rich.pretty <span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fapiao_txt_reg</span>(<span class="params">text=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="comment"># 正则规则</span></span><br><span class="line">    regs = <span class="built_in">dict</span>(</span><br><span class="line">        <span class="built_in">type</span>=<span class="string">r&quot;(电子发票.*[普通发票|增值税专用发票].*)&quot;</span>,</span><br><span class="line">        numb=<span class="string">r&quot;发票号码\s*[:：]\s*(\d&#123;20&#125;)&quot;</span>,</span><br><span class="line">        date=<span class="string">r&quot;开票日期\s*[:：]\s*(\d&#123;4&#125;年\d&#123;2&#125;月\d&#123;2&#125;日)&quot;</span>,</span><br><span class="line">        item=<span class="string">r&quot;(\*[\u4e00-\u9fff]+\*[\u4e00-\u9fff|\w]+)&quot;</span>,</span><br><span class="line">        totl=<span class="string">r&quot;价税合计[\s\S]*[¥￥](\d+\.\d+)&quot;</span>,</span><br><span class="line">    )</span><br><span class="line">    result = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> key, reg <span class="keyword">in</span> regs.items():</span><br><span class="line">        <span class="keyword">match</span> = re.search(reg, text)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            result[key] = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 获取页面中的文字，从文字中正则提取</span></span><br><span class="line">fapiao = <span class="string">&quot;digital_12345678901234567890.pdf&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;filename: <span class="subst">&#123;fapiao&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">src_pdf = fitz.<span class="built_in">open</span>(fapiao)</span><br><span class="line"><span class="keyword">for</span> p, page <span class="keyword">in</span> <span class="built_in">enumerate</span>(src_pdf):</span><br><span class="line">    blks = page.get_text(<span class="string">&quot;words&quot;</span>, sort=<span class="literal">True</span>)</span><br><span class="line">    text = <span class="string">&quot;\n&quot;</span>.join(blk[<span class="number">4</span>] <span class="keyword">for</span> blk <span class="keyword">in</span> blks)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;- page <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line">    pprint(text.split(<span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line">src_pdf.close()</span><br><span class="line"></span><br><span class="line">fapiao_infos = fapiao_txt_reg(text)</span><br><span class="line">pprint(fapiao_infos)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># %%</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">from</span> pyzbar <span class="keyword">import</span> pyzbar</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 获取页面中的二维码图片-解析二维码</span></span><br><span class="line">src_pdf = fitz.<span class="built_in">open</span>(fapiao)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;filename: <span class="subst">&#123;fapiao&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p, page <span class="keyword">in</span> <span class="built_in">enumerate</span>(src_pdf):</span><br><span class="line">    img_list = page.get_images()</span><br><span class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> img_list:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;- page <span class="subst">&#123;p&#125;</span>, &quot;</span>, img)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 跳过长宽不等的图片</span></span><br><span class="line">        <span class="keyword">if</span> img[<span class="number">2</span>] != img[<span class="number">3</span>]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 转为 pillow 图片</span></span><br><span class="line">        pixmap = src_pdf.extract_image(img[<span class="number">0</span>])</span><br><span class="line">        pprint(pixmap)</span><br><span class="line"></span><br><span class="line">        qr_img = Image.<span class="built_in">open</span>(BytesIO(pixmap[<span class="string">&quot;image&quot;</span>]))</span><br><span class="line">        <span class="comment"># qr_img.show()</span></span><br><span class="line"></span><br><span class="line">        qr_decoded = pyzbar.decode(qr_img)</span><br><span class="line">        pprint(qr_decoded)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> qr_decoded:</span><br><span class="line">            qr_data = qr_decoded[<span class="number">0</span>].data.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">            pprint(qr_data)</span><br><span class="line"></span><br><span class="line">src_pdf.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 二维码的字段定义不太确定 ？</span></span><br><span class="line">keys = [<span class="string">&quot;type&quot;</span>, <span class="string">&quot;aera&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;numb&quot;</span>, <span class="string">&quot;totl&quot;</span>, <span class="string">&quot;date&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;code&quot;</span>]</span><br><span class="line">fapiao_infos = <span class="built_in">dict</span>(<span class="built_in">zip</span>(keys, qr_data.split(<span class="string">&quot;,&quot;</span>)))</span><br><span class="line">pprint(fapiao_infos)</span><br><span class="line"></span><br><span class="line"><span class="comment"># %%</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 获取页面中的表格</span></span><br><span class="line"></span><br><span class="line">src_pdf = fitz.<span class="built_in">open</span>(fapiao)</span><br><span class="line"></span><br><span class="line">page = src_pdf[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">tabs = page.find_tables().tables</span><br><span class="line"></span><br><span class="line">table  = tabs[<span class="number">0</span>].extract()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> table:</span><br><span class="line">    pprint(row)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> table:</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> row:</span><br><span class="line">        <span class="keyword">if</span> col:</span><br><span class="line">            <span class="built_in">print</span>(col.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>), end=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># %%</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;pymupdf &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pip install pymupdf&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://pymupdf.readthedocs.io/en/latest/index.html&quot;&gt;https://pymupdf.readthedocs.io/en/latest/index.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pyzbar &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pip install pyzbar&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/NaturalHistoryMuseum/pyzbar/&quot;&gt;https://github.com/NaturalHistoryMuseum/pyzbar/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;用-pymupdf-提取电子发票中的信息&quot;&gt;&lt;a href=&quot;#用-pymupdf-提取电子发票中的信息&quot; class=&quot;headerlink&quot; title=&quot;用 pymupdf 提取电子发票中的信息&quot;&gt;&lt;/a&gt;用 pymupdf 提取电子发票中的信息&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pymupdf.readthedocs.io/en/latest/page.html#Page.get_text&quot;&gt;https://pymupdf.readthedocs.io/en/latest/page.html#Page.get_text&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pymupdf.readthedocs.io/en/latest/page.html#Page.find_tables&quot;&gt;https://pymupdf.readthedocs.io/en/latest/page.html#Page.find_tables&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="office" scheme="https://shenbo.github.io/categories/office/"/>
    
    
    <category term="pdf" scheme="https://shenbo.github.io/tags/pdf/"/>
    
  </entry>
  
  <entry>
    <title>xlwings 在 excel 中使用自定义 python 函数</title>
    <link href="https://shenbo.github.io/2025/05/12/office/python-in-excel-xlwings/"/>
    <id>https://shenbo.github.io/2025/05/12/office/python-in-excel-xlwings/</id>
    <published>2025-05-12T09:40:55.000Z</published>
    <updated>2025-08-03T07:26:11.305Z</updated>
    
    <content type="html"><![CDATA[<blockquote><ul><li>ref: <a href="https://www.xlwings.org/">https://www.xlwings.org/</a></li><li>ref: <a href="https://docs.xlwings.org/en/latest/installation.html#installation">https://docs.xlwings.org/en/latest/installation.html#installation</a></li><li>ref: <a href="https://docs.xlwings.org/en/latest/udfs.html#udfs">https://docs.xlwings.org/en/latest/udfs.html#udfs</a></li></ul></blockquote><h2 id="0-xlwings-简介"><a href="#0-xlwings-简介" class="headerlink" title="0. xlwings 简介"></a>0. xlwings 简介</h2><p>xlwings 提供了四种用法:</p><ul><li>xlwings (Open Source)， 本地 python模块、excel插件，代码在本地，运行在本地</li><li>xlwings PRO， 商业版，收费</li><li>xlwings Lite， 代码内置在excel文件中、运行在云端（代码公开）</li><li>xlwings Server， 商业版，收费</li></ul><h2 id="1-xlwings-Open-Source-本地版，在-excel-中使用自定义-python-函数"><a href="#1-xlwings-Open-Source-本地版，在-excel-中使用自定义-python-函数" class="headerlink" title="1. xlwings (Open Source) 本地版，在 excel 中使用自定义 python 函数"></a>1. xlwings (Open Source) 本地版，在 excel 中使用自定义 python 函数</h2><h3 id="1-1-excel-启用宏"><a href="#1-1-excel-启用宏" class="headerlink" title="1.1 excel 启用宏"></a>1.1 excel 启用宏</h3><p><code>文件</code> -&gt; <code>选项</code> -&gt; <code>信任中心</code> -&gt; <code>信任中心设置</code> -&gt;<br><code>宏设置</code> -&gt; 勾选 <code>启用VBA宏</code> 和 <code>信任对VBA工程对象模型的访问</code></p><h3 id="1-2-安装-xlwings-Open-Source"><a href="#1-2-安装-xlwings-Open-Source" class="headerlink" title="1.2 安装 xlwings (Open Source)"></a>1.2 安装 xlwings (Open Source)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pip install xlwings</span><br><span class="line">xlwings addin install</span><br><span class="line"></span><br><span class="line"><span class="comment"># xlwings addin remove</span></span><br><span class="line"><span class="comment"># pip uninstall xlwings</span></span><br></pre></td></tr></table></figure><h3 id="1-3-快速使用"><a href="#1-3-快速使用" class="headerlink" title="1.3 快速使用"></a>1.3 快速使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xlwings config create --force</span><br><span class="line"><span class="comment"># .xlwings\xlwings.conf </span></span><br><span class="line"></span><br><span class="line">xlwings quickstart xlwings_test</span><br></pre></td></tr></table></figure><p><code>xlwings quickstart</code> 命令会自动建立一个文件夹,内部有两个文件：</p><ul><li>xlwings_test.xlsm</li><li>xlwings_test.py</li></ul><span id="more"></span><p>简单看一下 <code>xlwings_test.py</code> 的代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwings <span class="keyword">as</span> xw</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    wb = xw.Book.caller()</span><br><span class="line">    sheet = wb.sheets[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> sheet[<span class="string">&quot;A1&quot;</span>].value == <span class="string">&quot;Hello xlwings!&quot;</span>:</span><br><span class="line">        sheet[<span class="string">&quot;A1&quot;</span>].value = <span class="string">&quot;Bye xlwings!&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sheet[<span class="string">&quot;A1&quot;</span>].value = <span class="string">&quot;Hello xlwings!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以看出 main 函数的功能是：用于直接操作指定的单元格</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@xw.func</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;Hello <span class="subst">&#123;name&#125;</span>!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># hello 函数则是一个方法函数，有输入输出：</span></span><br><span class="line"><span class="comment"># 输入是 name， </span></span><br><span class="line"><span class="comment"># 输出是 返回一个拼接的字符串</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    xw.Book(<span class="string">&quot;openmc_xlwings.xlsm&quot;</span>).set_mock_caller()</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="1-4-测试-main-函数"><a href="#1-4-测试-main-函数" class="headerlink" title="1.4 测试 main 函数"></a>1.4 测试 main 函数</h3><p>打开 <code>xlwings_test.xlsm</code>, 菜单栏切换到 xlwings 标签：</p><img src="/2025/05/12/office/python-in-excel-xlwings/xlwings.png" class="" title="xlwings"><p>点击 <code>Run main</code>: <code>A1</code> 表格 应该会出现 Hello xlwings!</p><p>再次点击 <code>Run main</code>: <code>A1</code> 表格 应该会出现 Bye xlwings!</p><h3 id="1-5-测试-hello-函数"><a href="#1-5-测试-hello-函数" class="headerlink" title="1.5 测试 hello 函数"></a>1.5 测试 hello 函数</h3><p>打开 <code>xlwings_test.xlsm</code>, 菜单栏切换到 xlwings 标签：</p><p>第一次导入 py 文件或有改动时, 点击 <code>Import Functions</code> （或 <code>Restart UDF Server</code>）。</p><p>在任单元格中输入 <code>=hello</code> , 应该能弹出函数提示。</p><p>假设 D1 单元格内容为： <code>xlwings for excel</code>, 在 D2 中填入： <code>=hello(D1)</code>,  </p><p>D2 最终返回 <code>Hello xlwings for excel!</code></p><h2 id="2-自定义函数：-调用-numpy、pandas-插值函数"><a href="#2-自定义函数：-调用-numpy、pandas-插值函数" class="headerlink" title="2. 自定义函数： 调用 numpy、pandas 插值函数"></a>2. 自定义函数： 调用 numpy、pandas 插值函数</h2><h3 id="2-1-xlwings-test-py"><a href="#2-1-xlwings-test-py" class="headerlink" title="2.1 xlwings_test.py"></a>2.1 <code>xlwings_test.py</code></h3><p>自定义一个插值函数：<code>xl_interp</code></p><blockquote><ul><li>ref： <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html</a></li></ul></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwings <span class="keyword">as</span> xw</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> log, exp, interp</span><br><span class="line"><span class="keyword">from</span> scipy.interpolate <span class="keyword">import</span> interp1d</span><br><span class="line"></span><br><span class="line"><span class="meta">@xw.func</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xl_interp</span>(<span class="params">x_val: <span class="built_in">float</span>, y_str: <span class="built_in">str</span></span>):</span><br><span class="line">    xy_cols = [<span class="string">&quot;xx&quot;</span>, <span class="string">&quot;y1&quot;</span>, <span class="string">&quot;y2&quot;</span>, <span class="string">&quot;y3&quot;</span>, <span class="string">&quot;y4&quot;</span>],</span><br><span class="line">    xy_data = [</span><br><span class="line">            [<span class="number">0.1</span>, <span class="number">0.1509</span>, <span class="number">0.1674</span>, <span class="number">0.3425</span>, <span class="number">5.355</span>],</span><br><span class="line">            [<span class="number">0.15</span>, <span class="number">0.1341</span>, <span class="number">0.149</span>, <span class="number">0.1829</span>, <span class="number">1.921</span>],</span><br><span class="line">            [<span class="number">0.2</span>, <span class="number">0.1225</span>, <span class="number">0.1361</span>, <span class="number">0.1383</span>, <span class="number">0.9432</span>],</span><br><span class="line">            [<span class="number">0.3</span>, <span class="number">0.1063</span>, <span class="number">0.1183</span>, <span class="number">0.1064</span>, <span class="number">0.3772</span>],</span><br><span class="line">            [<span class="number">0.4</span>, <span class="number">0.09525</span>, <span class="number">0.1059</span>, <span class="number">0.092</span>, <span class="number">0.2172</span>],</span><br><span class="line">            [<span class="number">0.5</span>, <span class="number">0.08694</span>, <span class="number">0.09667</span>, <span class="number">0.08282</span>, <span class="number">0.1514</span>],</span><br><span class="line">            [<span class="number">0.6</span>, <span class="number">0.08041</span>, <span class="number">0.08943</span>, <span class="number">0.07611</span>, <span class="number">0.1178</span>],</span><br><span class="line">            [<span class="number">0.8</span>, <span class="number">0.07065</span>, <span class="number">0.07856</span>, <span class="number">0.06644</span>, <span class="number">0.08472</span>],</span><br><span class="line">            [<span class="number">1.0</span>, <span class="number">0.06349</span>, <span class="number">0.07062</span>, <span class="number">0.05957</span>, <span class="number">0.06844</span>],</span><br><span class="line">            [<span class="number">1.5</span>, <span class="number">0.05168</span>, <span class="number">0.05747</span>, <span class="number">0.04862</span>, <span class="number">0.05102</span>],</span><br><span class="line">            [<span class="number">2.0</span>, <span class="number">0.0444</span>, <span class="number">0.04932</span>, <span class="number">0.0425</span>, <span class="number">0.04536</span>],</span><br><span class="line">            [<span class="number">3.0</span>, <span class="number">0.03573</span>, <span class="number">0.03961</span>, <span class="number">0.03611</span>, <span class="number">0.04199</span>],</span><br><span class="line">            [<span class="number">4.0</span>, <span class="number">0.03072</span>, <span class="number">0.03395</span>, <span class="number">0.03303</span>, <span class="number">0.04175</span>],</span><br><span class="line">            [<span class="number">5.0</span>, <span class="number">0.02745</span>, <span class="number">0.03024</span>, <span class="number">0.03139</span>, <span class="number">0.04257</span>],</span><br><span class="line">            [<span class="number">6.0</span>, <span class="number">0.02516</span>, <span class="number">0.02763</span>, <span class="number">0.0305</span>, <span class="number">0.04379</span>],</span><br><span class="line">            [<span class="number">8.0</span>, <span class="number">0.0222</span>, <span class="number">0.02423</span>, <span class="number">0.02985</span>, <span class="number">0.04667</span>],</span><br><span class="line">            [<span class="number">10.0</span>, <span class="number">0.0204</span>, <span class="number">0.02214</span>, <span class="number">0.02989</span>, <span class="number">0.04965</span>],</span><br><span class="line">            [<span class="number">15.0</span>, <span class="number">0.01805</span>, <span class="number">0.01936</span>, <span class="number">0.03088</span>, <span class="number">0.05653</span>],</span><br><span class="line">            [<span class="number">20.0</span>, <span class="number">0.01702</span>, <span class="number">0.01808</span>, <span class="number">0.0322</span>, <span class="number">0.06202</span>],</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">    df = pd.DataFrame(xy_data, columns=xy_cols)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. 线性插值</span></span><br><span class="line">    y_interp = interp(x_val, df[<span class="string">&quot;xx&quot;</span>], df[y_str]) </span><br><span class="line">    <span class="comment"># 2. 指数插值</span></span><br><span class="line">    y_interp_log = exp(interp(log(x_val), log(df[<span class="string">&quot;xx&quot;</span>]), log(df[y_str])))</span><br><span class="line">    <span class="comment"># 3. 样条插值：</span></span><br><span class="line">    <span class="comment"># &#x27;zero&#x27;, &#x27;slinear&#x27;, &#x27;quadratic&#x27;, &#x27;cubic&#x27; : 零阶、一阶、二阶或三阶样条插值</span></span><br><span class="line">    y_interp_quad = scipy.interpolate.interp1d(df[<span class="string">&quot;xx&quot;</span>], df[y_str], kind=<span class="string">&quot;quadratic&quot;</span>)(x_val)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> y_interp</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-2-xlwings-test-xlsm"><a href="#2-2-xlwings-test-xlsm" class="headerlink" title="2.2 xlwings_test.xlsm"></a>2.2 <code>xlwings_test.xlsm</code></h3><p>假设 G1 单元格内容为：<code>2.5</code>;  G2 单元格内容为：<code>y1</code>, </p><p>在 G3 中填入： <code>=xl_interp(G1, G2)</code>,</p><p>G3 最终返回：<code>0.040065</code></p><h2 id="3-xlwings-Lite"><a href="#3-xlwings-Lite" class="headerlink" title="3. xlwings Lite"></a>3. xlwings Lite</h2><blockquote><ul><li>ref: <a href="https://lite.xlwings.org/">https://lite.xlwings.org/</a></li></ul></blockquote><img src="/2025/05/12/office/python-in-excel-xlwings/xlwings-Lite.png" class="" title="xlwings Lite"><p>xlwings Lite 也挺好用的</p><ul><li>不需要本地有 python 环境。（基于 Pyodide）</li><li>代码内置在 excel 文档中。</li><li>库管理功能挺完善，numpy pandas scipy等基本库都没问题</li><li>第一次运行应该是要联网的</li><li>速度比本地慢一点，刷新计算时能感觉到，但也基本不影响正常使用</li></ul><p>使用时直接在侧边栏中编写 python 代码，有一些基本的功能</p><ul><li>配置安装 python 第三方库</li><li>代码格式化： <code>alt + shift + F</code></li><li>简单的终端窗口</li></ul>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ref: &lt;a href=&quot;https://www.xlwings.org/&quot;&gt;https://www.xlwings.org/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ref: &lt;a href=&quot;https://docs.xlwings.org/en/latest/installation.html#installation&quot;&gt;https://docs.xlwings.org/en/latest/installation.html#installation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ref: &lt;a href=&quot;https://docs.xlwings.org/en/latest/udfs.html#udfs&quot;&gt;https://docs.xlwings.org/en/latest/udfs.html#udfs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0-xlwings-简介&quot;&gt;&lt;a href=&quot;#0-xlwings-简介&quot; class=&quot;headerlink&quot; title=&quot;0. xlwings 简介&quot;&gt;&lt;/a&gt;0. xlwings 简介&lt;/h2&gt;&lt;p&gt;xlwings 提供了四种用法:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;xlwings (Open Source)， 本地 python模块、excel插件，代码在本地，运行在本地&lt;/li&gt;
&lt;li&gt;xlwings PRO， 商业版，收费&lt;/li&gt;
&lt;li&gt;xlwings Lite， 代码内置在excel文件中、运行在云端（代码公开）&lt;/li&gt;
&lt;li&gt;xlwings Server， 商业版，收费&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;1-xlwings-Open-Source-本地版，在-excel-中使用自定义-python-函数&quot;&gt;&lt;a href=&quot;#1-xlwings-Open-Source-本地版，在-excel-中使用自定义-python-函数&quot; class=&quot;headerlink&quot; title=&quot;1. xlwings (Open Source) 本地版，在 excel 中使用自定义 python 函数&quot;&gt;&lt;/a&gt;1. xlwings (Open Source) 本地版，在 excel 中使用自定义 python 函数&lt;/h2&gt;&lt;h3 id=&quot;1-1-excel-启用宏&quot;&gt;&lt;a href=&quot;#1-1-excel-启用宏&quot; class=&quot;headerlink&quot; title=&quot;1.1 excel 启用宏&quot;&gt;&lt;/a&gt;1.1 excel 启用宏&lt;/h3&gt;&lt;p&gt;&lt;code&gt;文件&lt;/code&gt; -&amp;gt; &lt;code&gt;选项&lt;/code&gt; -&amp;gt; &lt;code&gt;信任中心&lt;/code&gt; -&amp;gt; &lt;code&gt;信任中心设置&lt;/code&gt; -&amp;gt;&lt;br&gt;&lt;code&gt;宏设置&lt;/code&gt; -&amp;gt; 勾选 &lt;code&gt;启用VBA宏&lt;/code&gt; 和 &lt;code&gt;信任对VBA工程对象模型的访问&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;1-2-安装-xlwings-Open-Source&quot;&gt;&lt;a href=&quot;#1-2-安装-xlwings-Open-Source&quot; class=&quot;headerlink&quot; title=&quot;1.2 安装 xlwings (Open Source)&quot;&gt;&lt;/a&gt;1.2 安装 xlwings (Open Source)&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pip install xlwings&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;xlwings addin install&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# xlwings addin remove&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pip uninstall xlwings&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;1-3-快速使用&quot;&gt;&lt;a href=&quot;#1-3-快速使用&quot; class=&quot;headerlink&quot; title=&quot;1.3 快速使用&quot;&gt;&lt;/a&gt;1.3 快速使用&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;xlwings config create --force&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# .xlwings&#92;xlwings.conf &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;xlwings quickstart xlwings_test&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;xlwings quickstart&lt;/code&gt; 命令会自动建立一个文件夹,内部有两个文件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;xlwings_test.xlsm&lt;/li&gt;
&lt;li&gt;xlwings_test.py&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="office" scheme="https://shenbo.github.io/categories/office/"/>
    
    
    <category term="excel" scheme="https://shenbo.github.io/tags/excel/"/>
    
  </entry>
  
  <entry>
    <title>python-pyproject.toml打包</title>
    <link href="https://shenbo.github.io/2025/04/29/python/python-%E6%89%93%E5%8C%85/"/>
    <id>https://shenbo.github.io/2025/04/29/python/python-%E6%89%93%E5%8C%85/</id>
    <published>2025-04-29T04:19:20.000Z</published>
    <updated>2025-08-03T07:26:11.319Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-pyproject-toml-说明"><a href="#1-pyproject-toml-说明" class="headerlink" title="1. pyproject.toml 说明"></a>1. pyproject.toml 说明</h2><p><code>pyproject.toml</code> 是目前官方推荐的打包方式。</p><ul><li>官网 <a href="https://packaging.python.org/en/latest/guides/writing-pyproject-toml/">https://packaging.python.org/en/latest/guides/writing-pyproject-toml/</a></li><li><a href="https://setuptools.pypa.io/en/latest/userguide/datafiles.html">https://setuptools.pypa.io/en/latest/userguide/datafiles.html</a></li></ul><p>官网写的比较抽象。<br>这里记录下一个简单的使用方法。</p><h2 id="2-包的文件夹结构"><a href="#2-包的文件夹结构" class="headerlink" title="2. 包的文件夹结构"></a>2. 包的文件夹结构</h2><p>建议的包文件结构如下，假设要创建一个名为<code>snake</code>的包：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">snake_proj</span><br><span class="line">├──src/</span><br><span class="line">   └──snake/</span><br><span class="line">      ├──__init__.py</span><br><span class="line">      ├──AA.py</span><br><span class="line">      ├──BB.py</span><br><span class="line">      └──snake_data/</span><br><span class="line">         ├──xx.txt</span><br><span class="line">         └──yy.txt</span><br><span class="line">├──tests/</span><br><span class="line">   └──snake/</span><br><span class="line">├──.gitignore</span><br><span class="line">├──LICENSE</span><br><span class="line">├──pyproject.toml</span><br><span class="line">└──README.md</span><br></pre></td></tr></table></figure><h2 id="3-编写-pyproject-toml"><a href="#3-编写-pyproject-toml" class="headerlink" title="3. 编写 pyproject.toml"></a>3. 编写 pyproject.toml</h2><span id="more"></span><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[project]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&#x27;snake&#x27;</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&#x27;0.0.1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">description</span> = <span class="string">&quot;snake package&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">authors</span> = [&#123; name = <span class="string">&quot;123&quot;</span>, email = <span class="string">&quot;abc@xyz.com&quot;</span> &#125;]</span><br><span class="line"></span><br><span class="line"><span class="section">[build-system]</span></span><br><span class="line"><span class="attr">requires</span> = [<span class="string">&quot;setuptools &gt;= 61.0&quot;</span>]</span><br><span class="line"><span class="attr">build-backend</span> = <span class="string">&quot;setuptools.build_meta&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[tool.setuptools.package-data]</span></span><br><span class="line"><span class="attr">&quot;snake_data&quot;</span> = [<span class="string">&quot;*.txt&quot;</span>]</span><br></pre></td></tr></table></figure><h2 id="4-打包"><a href="#4-打包" class="headerlink" title="4. 打包"></a>4. 打包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 build 工具</span></span><br><span class="line">python -m pip install build</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打包</span></span><br><span class="line">python -m build -w -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 whl</span></span><br><span class="line">python -m pip install dist\snake-0.0.1-py3-none-any.whl --force-reinstall</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;1-pyproject-toml-说明&quot;&gt;&lt;a href=&quot;#1-pyproject-toml-说明&quot; class=&quot;headerlink&quot; title=&quot;1. pyproject.toml 说明&quot;&gt;&lt;/a&gt;1. pyproject.toml 说明&lt;/h2&gt;&lt;p&gt;&lt;code&gt;pyproject.toml&lt;/code&gt; 是目前官方推荐的打包方式。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;官网 &lt;a href=&quot;https://packaging.python.org/en/latest/guides/writing-pyproject-toml/&quot;&gt;https://packaging.python.org/en/latest/guides/writing-pyproject-toml/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://setuptools.pypa.io/en/latest/userguide/datafiles.html&quot;&gt;https://setuptools.pypa.io/en/latest/userguide/datafiles.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;官网写的比较抽象。&lt;br&gt;这里记录下一个简单的使用方法。&lt;/p&gt;
&lt;h2 id=&quot;2-包的文件夹结构&quot;&gt;&lt;a href=&quot;#2-包的文件夹结构&quot; class=&quot;headerlink&quot; title=&quot;2. 包的文件夹结构&quot;&gt;&lt;/a&gt;2. 包的文件夹结构&lt;/h2&gt;&lt;p&gt;建议的包文件结构如下，假设要创建一个名为&lt;code&gt;snake&lt;/code&gt;的包：&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;snake_proj&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├──src/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   └──snake/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ├──__init__.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ├──AA.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ├──BB.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      └──snake_data/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         ├──xx.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         └──yy.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├──tests/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   └──snake/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├──.gitignore&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├──LICENSE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├──pyproject.toml&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;└──README.md&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&quot;3-编写-pyproject-toml&quot;&gt;&lt;a href=&quot;#3-编写-pyproject-toml&quot; class=&quot;headerlink&quot; title=&quot;3. 编写 pyproject.toml&quot;&gt;&lt;/a&gt;3. 编写 pyproject.toml&lt;/h2&gt;</summary>
    
    
    
    <category term="python" scheme="https://shenbo.github.io/categories/python/"/>
    
    
    <category term="python" scheme="https://shenbo.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>Win11-WSL-Ubuntu22.04-openmc 从源码编译安装</title>
    <link href="https://shenbo.github.io/2025/03/27/wsl/wsl-ubuntu-openmc-build/"/>
    <id>https://shenbo.github.io/2025/03/27/wsl/wsl-ubuntu-openmc-build/</id>
    <published>2025-03-27T09:07:00.000Z</published>
    <updated>2025-08-03T07:26:11.379Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、WSL-安装-Ubuntu22-04"><a href="#一、WSL-安装-Ubuntu22-04" class="headerlink" title="一、WSL 安装 Ubuntu22.04"></a>一、WSL 安装 Ubuntu22.04</h2><ol><li><p>启用 WSL</p></li><li><p>打开 Microsoft Store，安装 Ubuntu22.04</p></li><li><p>设置源，更新<br>ref： <a href="https://linuxmirrors.cn/use/">https://linuxmirrors.cn/use/</a></p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用户权限</span></span><br><span class="line"><span class="built_in">sudo</span> -i</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 LinuxMirrors：</span></span><br><span class="line">bash &lt;(curl -sSL https://linuxmirrors.cn/main.sh)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复原始设置：</span></span><br><span class="line"><span class="comment"># bash &lt;(curl -sSL https://linuxmirrors.cn/main.sh) --use-official-source true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker 源：</span></span><br><span class="line"><span class="comment"># bash &lt;(curl -sSL https://linuxmirrors.cn/docker.sh)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt upgrade</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="4"><li>安装 ZSH、oh-my-zsh</li></ol><p>参考 <a href="/2023/02/03/wsl/oh-my-zsh/" title="zsh &amp; oh-my-zsh 安装配置">zsh &amp; oh-my-zsh 安装配置</a> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install zsh</span><br><span class="line">sh -c <span class="string">&quot;<span class="subst">$(wget https://gitee.com/mirrors/oh-my-zsh/raw/master/tools/install.sh -O -)</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sh -c &quot;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)&quot;</span></span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-autosuggestions</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure><h2 id="二、编译安装-openmc"><a href="#二、编译安装-openmc" class="headerlink" title="二、编译安装 openmc"></a>二、编译安装 openmc</h2><p>ref： <a href="https://docs.openmc.org/en/stable/quickinstall.html">https://docs.openmc.org/en/stable/quickinstall.html</a></p><ol><li>参照 Manually Installing from Source, 安装编译所需的基础库</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install g++ cmake libhdf5-dev libpng-dev</span><br></pre></td></tr></table></figure><ol start="2"><li>编译 build</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --recurse-submodules https://github.com/openmc-dev/openmc.git</span><br><span class="line"><span class="built_in">cd</span> openmc</span><br><span class="line"><span class="built_in">mkdir</span> build &amp;&amp; <span class="built_in">cd</span> build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br></pre></td></tr></table></figure><ol start="3"><li>创建虚拟环境，安装 openmc 库</li></ol><span id="more"></span><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">python3 -V</span><br><span class="line"><span class="built_in">sudo</span> apt install python3-pip</span><br><span class="line">pip config <span class="built_in">set</span> global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建虚拟环境</span></span><br><span class="line"><span class="built_in">sudo</span> apt install python3-venv</span><br><span class="line">python3 -m venv ~/openmc-venv</span><br><span class="line"><span class="built_in">source</span> ~/openmc-venv/bin/activate</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 openmc</span></span><br><span class="line">python3 -m pip install .</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="4"><li>下载材料数据集</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/openmc-dev/data openmc-dev_data</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> openmc-dev_data</span><br><span class="line">python3 convert_nndc71.py</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>把 <code>cross_sections.xml</code> 的路径加入环境变量，或直接在openmc程序中设置：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># code /home/xxxx/.local/lib/python3.10/site-packages/openmc/config.py</span></span><br><span class="line">config[<span class="string">&#x27;cross_sections&#x27;</span>] = <span class="string">&quot;/home/xxxx/openmc-dev_data/nndc-b7.1-hdf5/cross_sections.xml&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者 直接加在程序前面</span></span><br><span class="line"><span class="keyword">import</span> openmc</span><br><span class="line">openmc.config[<span class="string">&quot;cross_sections&quot;</span>] = <span class="string">&quot;/home/bo/openmc_data/nndc-b7.1-hdf5/cross_sections.xml&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;一、WSL-安装-Ubuntu22-04&quot;&gt;&lt;a href=&quot;#一、WSL-安装-Ubuntu22-04&quot; class=&quot;headerlink&quot; title=&quot;一、WSL 安装 Ubuntu22.04&quot;&gt;&lt;/a&gt;一、WSL 安装 Ubuntu22.04&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;启用 WSL&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;打开 Microsoft Store，安装 Ubuntu22.04&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;设置源，更新&lt;br&gt;ref： &lt;a href=&quot;https://linuxmirrors.cn/use/&quot;&gt;https://linuxmirrors.cn/use/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 用户权限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;sudo&lt;/span&gt; -i&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 安装 LinuxMirrors：&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bash &amp;lt;(curl -sSL https://linuxmirrors.cn/main.sh)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 恢复原始设置：&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# bash &amp;lt;(curl -sSL https://linuxmirrors.cn/main.sh) --use-official-source true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Docker 源：&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# bash &amp;lt;(curl -sSL https://linuxmirrors.cn/docker.sh)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;sudo&lt;/span&gt; apt update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;sudo&lt;/span&gt; apt upgrade&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;安装 ZSH、oh-my-zsh&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;参考 &lt;a href=&quot;/2023/02/03/wsl/oh-my-zsh/&quot; title=&quot;zsh &amp;amp; oh-my-zsh 安装配置&quot;&gt;zsh &amp;amp; oh-my-zsh 安装配置&lt;/a&gt; &lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;sudo&lt;/span&gt; apt install zsh&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sh -c &lt;span class=&quot;string&quot;&gt;&amp;quot;&lt;span class=&quot;subst&quot;&gt;$(wget https://gitee.com/mirrors/oh-my-zsh/raw/master/tools/install.sh -O -)&lt;/span&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# sh -c &amp;quot;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/zsh-users/zsh-autosuggestions &lt;span class=&quot;variable&quot;&gt;$&amp;#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&amp;#125;&lt;/span&gt;/plugins/zsh-autosuggestions&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/zsh-users/zsh-syntax-highlighting &lt;span class=&quot;variable&quot;&gt;$&amp;#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&amp;#125;&lt;/span&gt;/plugins/zsh-syntax-highlighting&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; ~/.zshrc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&quot;二、编译安装-openmc&quot;&gt;&lt;a href=&quot;#二、编译安装-openmc&quot; class=&quot;headerlink&quot; title=&quot;二、编译安装 openmc&quot;&gt;&lt;/a&gt;二、编译安装 openmc&lt;/h2&gt;&lt;p&gt;ref： &lt;a href=&quot;https://docs.openmc.org/en/stable/quickinstall.html&quot;&gt;https://docs.openmc.org/en/stable/quickinstall.html&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;参照 Manually Installing from Source, 安装编译所需的基础库&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;sudo&lt;/span&gt; apt install g++ cmake libhdf5-dev libpng-dev&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;编译 build&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; --recurse-submodules https://github.com/openmc-dev/openmc.git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; openmc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;mkdir&lt;/span&gt; build &amp;amp;&amp;amp; &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; build&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cmake ..&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;make&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;sudo&lt;/span&gt; make install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;创建虚拟环境，安装 openmc 库&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    <category term="WSL" scheme="https://shenbo.github.io/categories/WSL/"/>
    
    
    <category term="Ubuntu" scheme="https://shenbo.github.io/tags/Ubuntu/"/>
    
    <category term="WSL" scheme="https://shenbo.github.io/tags/WSL/"/>
    
    <category term="openmc" scheme="https://shenbo.github.io/tags/openmc/"/>
    
  </entry>
  
  <entry>
    <title>openmc.model 复合面命令</title>
    <link href="https://shenbo.github.io/2025/02/22/wsl/wsl-ubuntu-openmc-model/"/>
    <id>https://shenbo.github.io/2025/02/22/wsl/wsl-ubuntu-openmc-model/</id>
    <published>2025-02-22T09:23:51.000Z</published>
    <updated>2025-08-03T07:26:11.380Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、openmc-面命令"><a href="#一、openmc-面命令" class="headerlink" title="一、openmc 面命令"></a>一、openmc 面命令</h2><p><a href="https://docs.openmc.org/en/stable/pythonapi/generated/openmc.XPlane.html">https://docs.openmc.org/en/stable/pythonapi/generated/openmc.XPlane.html</a></p><table><thead><tr><th>method</th><th>面</th><th>mcnp</th><th>paras</th><th>参数说明</th><th>geometry</th></tr></thead><tbody><tr><td>openmc.Plane</td><td>任意无限平面</td><td></td><td>a&#x3D;1, b&#x3D;0, c&#x3D;0, d&#x3D;0</td><td>系数</td><td>$Ax+By+Cz&#x3D;D$</td></tr><tr><td>openmc.XPlane</td><td>X无限平面</td><td></td><td>x0&#x3D;0</td><td>与原点的距离</td><td>$x−x_0&#x3D;0$</td></tr><tr><td>openmc.YPlane</td><td>Y无限平面</td><td></td><td>y0&#x3D;0</td><td>与原点的距离</td><td>$y−y_0&#x3D;0$</td></tr><tr><td>openmc.ZPlane</td><td>Z无限平面</td><td></td><td>z0&#x3D;0</td><td>与原点的距离</td><td>$z−z_0​&#x3D;0$</td></tr><tr><td>openmc.XCylinder</td><td>X无限圆柱</td><td></td><td>y0&#x3D;0, z0&#x3D;0, r&#x3D;1</td><td>圆柱中心y0,z0 <br> 圆柱半径r</td><td>$(y−y_0​)^2+(z−z_0​)^2&#x3D;r^2$</td></tr><tr><td>openmc.YCylinder</td><td>Y无限圆柱</td><td></td><td>x0&#x3D;0, z0&#x3D;0, r&#x3D;1</td><td>圆柱中心x0,z0 <br> 圆柱半径r</td><td>$(x−x_0​)^2+(z−z_0​)^2&#x3D;r^2$</td></tr><tr><td>openmc.ZCylinder</td><td>Z无限圆柱</td><td></td><td>x0&#x3D;0, y0&#x3D;0, r&#x3D;1</td><td>圆柱中心x0,y0 <br> 圆柱半径r</td><td>$(x−x_0​)^2+(y−y_0​)^2&#x3D;r^2$</td></tr><tr><td>openmc.Sphere</td><td>球面</td><td></td><td>x0&#x3D;0, y0&#x3D;0, z0&#x3D;0, r&#x3D;1</td><td>球心 x0,y0,z0 <br> 球半径r</td><td>$(x−x_0)^2+(y−y_0)^2+(z−z_0)^2&#x3D;r^2$</td></tr><tr><td>openmc.Cone</td><td>圆锥面</td><td></td><td></td><td></td><td></td></tr><tr><td>openmc.XCone</td><td>x方向圆锥面</td><td></td><td></td><td></td><td>$(y−y_0)^2+(z−z_0)^2&#x3D;r^2(x−x_0)^2$</td></tr><tr><td>openmc.YCone</td><td>y方向圆锥面</td><td></td><td></td><td></td><td></td></tr><tr><td>openmc.ZCone</td><td>z方向圆锥面</td><td></td><td></td><td></td><td></td></tr><tr><td>openmc.Quadric</td><td>二次曲面</td><td></td><td></td><td></td><td></td></tr><tr><td>openmc.XTorus</td><td>x环面</td><td></td><td></td><td></td><td></td></tr><tr><td>openmc.YTorus</td><td>y环面</td><td></td><td></td><td></td><td></td></tr><tr><td>openmc.ZTorus</td><td>z环面</td><td></td><td></td><td></td><td></td></tr></tbody></table><h2 id="二、openmc-复合面命令-（mcnp-macrobody）"><a href="#二、openmc-复合面命令-（mcnp-macrobody）" class="headerlink" title="二、openmc 复合面命令 （mcnp macrobody）"></a>二、openmc 复合面命令 （mcnp macrobody）</h2><p><a href="https://docs.openmc.org/en/stable/pythonapi/model.html#composite-surfaces">https://docs.openmc.org/en/stable/pythonapi/model.html#composite-surfaces</a></p><table><thead><tr><th>method</th><th>复合面</th><th>mcnp</th><th>paras</th></tr></thead><tbody><tr><td>ConicalFrustum</td><td>圆锥台</td><td>TRC</td><td>center_base 底面中心 <br> axis 轴线方向 <br> r1 底面半径 <br> r2 顶面半径</td></tr><tr><td>CruciformPrism</td><td>多边形棱柱体</td><td></td><td>distances 距离 <br> center&#x3D;(0, 0) 中心 <br> axis&#x3D;”z” 轴线</td></tr><tr><td>CylinderSector</td><td>无限扇形柱体</td><td></td><td>r1 扇内半径 r2 扇外半径</td></tr><tr><td></td><td></td><td></td><td>theta1 起始角度  theta2 结束角度</td></tr><tr><td></td><td></td><td></td><td>center 中心轴坐标 <br> axis 中心轴</td></tr><tr><td>HexagonalPrism</td><td>六边形柱体</td><td></td><td>edge_length&#x3D;1 边长 <br> orientation 方向 <br> origin 原点</td></tr><tr><td>IsogonalOctagon</td><td>八边形柱体题</td><td></td><td>center 中心轴坐标 <br> r1 半宽 r2 半宽 <br> axis&#x3D;”z” 轴线</td></tr><tr><td>OrthogonalBox</td><td>任意正交体</td><td>BOX</td><td>v 顶点坐标 <br> a1 边1向量 <br> a2 边2向量 <br> a3 边3向量</td></tr><tr><td>Polygon</td><td>闭合点路径形成的多边形</td><td></td><td>points 点集<br> basis 基</td></tr><tr><td>RectangularParallelepiped</td><td>平行于轴的长方体</td><td>RPP</td><td>xmin xmax ymin ymax zmin zmax 坐标范围</td></tr><tr><td>RectangularPrism</td><td>四面围成的无限长方体</td><td></td><td>width 宽 <br> height 高 <br> axis 轴向 <br> origin 原点</td></tr><tr><td>RightCircularCylinder</td><td>圆柱体</td><td>RCC</td><td>center_base 底面中心 <br> height 高度 <br> radius 半径 <br> axis 中心轴</td></tr><tr><td>Vessel</td><td>圆柱容器及椭圆封头</td><td></td><td>r 半径 <br> p1 坐标 <br> p2 坐标 <br></td></tr><tr><td></td><td></td><td></td><td>h1 下封头高度 <br> h2 上封头高度 <br> center 中心轴坐标 <br> axis 中心轴</td></tr><tr><td>XConeOneSided</td><td>x方向圆锥</td><td></td><td></td></tr><tr><td>YConeOneSided</td><td>y方向圆锥</td><td></td><td></td></tr><tr><td>ZConeOneSided</td><td>z方向圆锥</td><td></td><td></td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;一、openmc-面命令&quot;&gt;&lt;a href=&quot;#一、openmc-面命令&quot; class=&quot;headerlink&quot; title=&quot;一、openmc 面命令&quot;&gt;&lt;/a&gt;一、openmc 面命令&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://docs.openmc.o</summary>
      
    
    
    
    <category term="WSL" scheme="https://shenbo.github.io/categories/WSL/"/>
    
    
    <category term="Ubuntu" scheme="https://shenbo.github.io/tags/Ubuntu/"/>
    
    <category term="WSL" scheme="https://shenbo.github.io/tags/WSL/"/>
    
    <category term="openmc" scheme="https://shenbo.github.io/tags/openmc/"/>
    
  </entry>
  
</feed>
